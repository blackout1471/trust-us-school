<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="851px" preserveAspectRatio="none" style="width:435px;height:851px;background:#FFFFFF;" version="1.1" viewBox="0 0 435 851" width="435px" zoomAndPan="magnify"><defs/><g><ellipse cx="328.3063" cy="16" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="267.8063" y="67"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="277.8063" y="89.457">Recieve login data</text><g id="elem_#5"><polygon fill="#F1F1F1" points="328.3063,143,340.3063,155,328.3063,167,316.3063,155,328.3063,143" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#8"><polygon fill="#F1F1F1" points="284.3063,213.5,296.3063,225.5,284.3063,237.5,272.3063,225.5,284.3063,213.5" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#11"><polygon fill="#F1F1F1" points="259.3063,284,271.3063,296,259.3063,308,247.3063,296,259.3063,284" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#14"><polygon fill="#F1F1F1" points="136.3063,349,148.3063,361,136.3063,373,124.3063,361,136.3063,349" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="17.3063" y="673"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="27.3063" y="695.457">Generate token</text><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="24.3063" y="749"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="70" x="34.3063" y="771.457">Return token</text><ellipse cx="69.3063" cy="835" fill="none" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="69.8063" cy="835.5" fill="#222222" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="183" x="44.8063" y="428"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="163" x="54.8063" y="450.457">Send verification code to User</text><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="176" x="52.3063" y="518"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="156" x="62.3063" y="540.457">User enters verification code</text><g id="elem_#27"><polygon fill="#F1F1F1" points="140.3063,594,152.3063,606,140.3063,618,128.3063,606,140.3063,594" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="198.8063" y="673"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="208.8063" y="695.457">Throw Login failed</text><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="316.8063" y="208"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="93" x="326.8063" y="230.457">Throw Forbidden</text><!--MD5=[0cc5c6088e8b133b764c8e39458fa7f0]
link start to Recieve login data--><g id="link_start_Recieve login data"><path d="M328.3063,26.25 C328.3063,35.43 328.3063,49.84 328.3063,61.9 " fill="none" id="start-to-Recieve login data" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="328.3063,66.91,332.3063,57.91,328.3063,61.91,324.3063,57.91,328.3063,66.91" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[66602bce3d97b17711fac82889a600fb]
link Recieve login data to #5--><g id="link_Recieve login data_#5"><path d="M328.3063,102.08 C328.3063,112.87 328.3063,126.88 328.3063,137.63 " fill="none" id="Recieve login data-to-#5" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="328.3063,142.92,332.3063,133.92,328.3063,137.92,324.3063,133.92,328.3063,142.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="242.4875" y="132.485">Ip not blocked</text></g><!--MD5=[0c0d8213b86c66ad298a167b10270357]
link #5 to #8--><g id="link_#5_#8"><path d="M323.9263,162.82 C316.3463,174.62 300.7263,198.94 291.5263,213.27 " fill="none" id="#5-to-#8" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="288.6663,217.71,296.8894,212.2897,291.3635,213.4999,290.1533,207.9741,288.6663,217.71" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="56" x="210.7993" y="203.2973">Email exists</text></g><!--MD5=[04fae5d0eb764058787a86ce8fc6a833]
link #8 to #11--><g id="link_#8_#11"><path d="M281.3362,234.63 C277.0563,246.37 269.0862,268.19 263.9963,282.14 " fill="none" id="#8-to-#11" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="262.2663,286.88,269.108,279.7955,263.9795,282.1827,261.5924,277.0542,262.2663,286.88" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="94" x="279.44" y="280.0732">Password matches</text></g><!--MD5=[c1bb20eee0439e1debf317a372abdd7f]
link #11 to #14--><g id="link_#11_#14"><path d="M251.9763,300.75 C231.5163,311.23 173.6163,340.89 148.3463,353.83 " fill="none" id="#11-to-#14" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="143.7463,356.19,153.5812,355.6674,148.2011,353.9197,149.9488,348.5396,143.7463,356.19" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="161" x="156.1128" y="353.0773">User has logged in before from ip</text></g><!--MD5=[4f7b89c734b9effb4ad342c99e1677ae]
link #14 to Generate token--><g id="link_#14_Generate token"><path d="M126.4963,363.59 C97.0263,368.97 11.3063,389.38 11.3063,444.5 C11.3063,444.5 11.3063,444.5 11.3063,607 C11.3063,631.53 28.6863,653.93 44.4163,669.17 " fill="none" id="#14-to-Generate token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="48.3663,672.89,44.5539,663.8089,44.7253,669.4632,39.071,669.6345,48.3663,672.89" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="12.3063" y="540.4189">true</text></g><!--MD5=[098c265f84ee990ea225bc2bb82fd240]
link Generate token to Return token--><g id="link_Generate token_Return token"><path d="M69.3063,708.29 C69.3063,718.79 69.3063,732.43 69.3063,743.75 " fill="none" id="Generate token-to-Return token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="69.3063,748.77,73.3063,739.77,69.3063,743.77,65.3063,739.77,69.3063,748.77" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e178f1f4068ee0e7f5aeacc8dbfee9ac]
link Return token to end--><g id="link_Return token_end"><path d="M69.3063,784.28 C69.3063,795.29 69.3063,809.52 69.3063,819.94 " fill="none" id="Return token-to-end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="69.3063,825,73.3063,816,69.3063,820,65.3063,816,69.3063,825" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4450b92500a75d4f6c512929bd8a9280]
link #14 to Send verification code to User--><g id="link_#14_Send verification code to User"><path d="M136.3063,373.13 C136.3063,385.77 136.3063,406.72 136.3063,422.66 " fill="none" id="#14-to-Send verification code to User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="136.3063,427.85,140.3063,418.85,136.3063,422.85,132.3063,418.85,136.3063,427.85" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="137.3063" y="405.4189">false</text></g><!--MD5=[a0ff370cc409434c99cba3229b3f4991]
link Send verification code to User to User enters verification code--><g id="link_Send verification code to User_User enters verification code"><path d="M137.0563,463.05 C137.6963,477.1 138.6163,497.36 139.3163,512.72 " fill="none" id="Send verification code to User-to-User enters verification code" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="139.5463,517.72,143.1311,508.5467,139.3179,512.7252,135.1394,508.9121,139.5463,517.72" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[cbc7cf35062c99b4cdd6e9a7f331ec59]
link User enters verification code to #27--><g id="link_User enters verification code_#27"><path d="M140.3063,553.08 C140.3063,563.87 140.3063,577.88 140.3063,588.63 " fill="none" id="User enters verification code-to-#27" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="140.3063,593.92,144.3063,584.92,140.3063,588.92,136.3063,584.92,140.3063,593.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="114" x="6" y="585.8687">Verification code match</text></g><!--MD5=[15fde578ec644e3e9b1d4c28a8e23d6d]
link #27 to Generate token--><g id="link_#27_Generate token"><path d="M135.1963,612.93 C125.2663,624.47 102.9263,650.43 87.0163,668.92 " fill="none" id="#27-to-Generate token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="83.5263,672.98,92.4204,668.7499,86.7802,669.1837,86.3463,663.5435,83.5263,672.98" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="114.3063" y="650.4189">true</text></g><!--MD5=[2a91e9072930953d142dbf529973e86f]
link #27 to Throw Login failed--><g id="link_#27_Throw Login failed"><path d="M147.0463,611.67 C162.9163,622.67 203.3863,650.73 231.1363,669.97 " fill="none" id="#27-to-Throw Login failed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="235.4663,672.98,230.3495,664.5646,231.3574,670.131,225.791,671.1389,235.4663,672.98" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="205.3063" y="650.4189">false</text></g><!--MD5=[01f1a6d198c9986ab862bd0e2b9d7c33]
link #11 to Throw Login failed--><g id="link_#11_Throw Login failed"><path d="M259.3063,308.15 C259.3063,320.74 259.3063,341.84 259.3063,360 C259.3063,360 259.3063,360 259.3063,607 C259.3063,627.46 259.3063,650.78 259.3063,667.39 " fill="none" id="#11-to-Throw Login failed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="259.3063,672.75,263.3063,663.75,259.3063,667.75,255.3063,663.75,259.3063,672.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="260.3063" y="495.4189">false</text></g><!--MD5=[9665a20f1985d8d609772a5d2be6703e]
link #8 to Throw Login failed--><g id="link_#8_Throw Login failed"><path d="M288.8362,233.37 C296.2863,245.35 310.3063,271.09 310.3063,295 C310.3063,295 310.3063,295 310.3063,607 C310.3063,630.91 294.6262,653.67 280.6462,669.21 " fill="none" id="#8-to-Throw Login failed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="277.1462,673,286.1881,669.0955,280.5359,669.3243,280.307,663.6721,277.1462,673" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="311.3063" y="450.4189">false</text></g><!--MD5=[289bd9f7143d1c97131a8b56bece89fe]
link #5 to Throw Forbidden--><g id="link_#5_Throw Forbidden"><path d="M332.7863,162.82 C338.9863,172.26 350.4763,189.74 359.6362,203.69 " fill="none" id="#5-to-Throw Forbidden" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="362.3962,207.89,360.8091,198.1699,359.6558,203.7079,354.1177,202.5546,362.3962,207.89" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[55be27a123ca9c74b1f2770a5aa18625]
@startuml Login Flowchart

(*) - -> "Recieve login data"

if "Ip not blocked " then
    if "Email exists" then
        if "Password matches" then
            if "User has logged in before from ip" then
                - ->[true] "Generate token"
                - -> "Return token"
                - -> (*)
            else
                - ->[false] Send verification code to User
                - -> User enters verification code
                if "Verification code match" then
                - ->[true] "Generate token"
                else
                - ->[false] "Throw Login failed"
                end if
            end if 
        else
            - ->[false] "Throw Login failed"
        end if
    else
      - ->[false] "Throw Login failed"

    end if 
else 
 - -> "Throw Forbidden"
end if
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: da
Country: DK
--></g></svg>