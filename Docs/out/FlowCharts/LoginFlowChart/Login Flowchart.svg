<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="631px" preserveAspectRatio="none" style="width:405px;height:631px;background:#FFFFFF;" version="1.1" viewBox="0 0 405 631" width="405px" zoomAndPan="magnify"><defs/><g><ellipse cx="297.6751" cy="16" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="237.1751" y="67"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="247.1751" y="89.457">Recieve login data</text><g id="elem_#5"><polygon fill="#F1F1F1" points="297.6751,143,309.6751,155,297.6751,167,285.6751,155,297.6751,143" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#8"><polygon fill="#F1F1F1" points="253.6751,213.5,265.6751,225.5,253.6751,237.5,241.6751,225.5,253.6751,213.5" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#11"><polygon fill="#F1F1F1" points="227.6751,284,239.6751,296,227.6751,308,215.6751,296,227.6751,284" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#14"><polygon fill="#F1F1F1" points="186.6751,368.5,198.6751,380.5,186.6751,392.5,174.6751,380.5,186.6751,368.5" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="87.6751" y="453"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="97.6751" y="475.457">Generate token</text><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="94.6751" y="529"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="70" x="104.6751" y="551.457">Return token</text><ellipse cx="139.6751" cy="615" fill="none" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="140.1751" cy="615.5" fill="#222222" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="212.1751" y="453"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="21" x="222.1751" y="475.457">2FA</text><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="219.1751" y="363"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="229.1751" y="385.457">Throw Login failed</text><rect fill="#F1F1F1" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="286.1751" y="208"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="93" x="296.1751" y="230.457">Throw Forbidden</text><!--MD5=[0cc5c6088e8b133b764c8e39458fa7f0]
link start to Recieve login data--><g id="link_start_Recieve login data"><path d="M297.6751,26.25 C297.6751,35.43 297.6751,49.84 297.6751,61.9 " fill="none" id="start-to-Recieve login data" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="297.6751,66.91,301.6751,57.91,297.6751,61.91,293.6751,57.91,297.6751,66.91" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[66602bce3d97b17711fac82889a600fb]
link Recieve login data to #5--><g id="link_Recieve login data_#5"><path d="M297.6751,102.08 C297.6751,112.87 297.6751,126.88 297.6751,137.63 " fill="none" id="Recieve login data-to-#5" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="297.6751,142.92,301.6751,133.92,297.6751,137.92,293.6751,133.92,297.6751,142.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="211.8563" y="132.485">Ip not blocked</text></g><!--MD5=[0c0d8213b86c66ad298a167b10270357]
link #5 to #8--><g id="link_#5_#8"><path d="M293.2951,162.82 C285.7151,174.62 270.0851,198.94 260.8851,213.27 " fill="none" id="#5-to-#8" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="258.0351,217.71,266.2666,212.3024,260.7389,213.5041,259.5372,207.9764,258.0351,217.71" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="56" x="180.1681" y="203.2973">Email exists</text></g><!--MD5=[04fae5d0eb764058787a86ce8fc6a833]
link #8 to #11--><g id="link_#8_#11"><path d="M250.5851,234.63 C246.1351,246.37 237.8451,268.19 232.5551,282.14 " fill="none" id="#8-to-#11" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="230.7551,286.88,237.6863,279.883,232.5279,282.2048,230.2061,277.0465,230.7551,286.88" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="94" x="247.9701" y="280.0732">Password matches</text></g><!--MD5=[c1bb20eee0439e1debf317a372abdd7f]
link #11 to #14--><g id="link_#11_#14"><path d="M222.9951,303.97 C218.9451,310.14 213.0751,319.48 208.6751,328 C202.0751,340.77 195.7651,355.96 191.6051,366.52 " fill="none" id="#11-to-#14" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="189.7451,371.3,196.7392,364.3659,191.5601,366.6411,189.2849,361.4619,189.7451,371.3" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="161" x="6" y="365.2298">User has logged in before from ip</text></g><!--MD5=[4f7b89c734b9effb4ad342c99e1677ae]
link #14 to Generate token--><g id="link_#14_Generate token"><path d="M182.8251,388.7 C175.9551,401.57 161.3251,428.96 151.0051,448.27 " fill="none" id="#14-to-Generate token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="148.4851,453,156.2528,446.9451,150.8402,448.5894,149.1959,443.1768,148.4851,453" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="167.6751" y="430.4189">true</text></g><!--MD5=[098c265f84ee990ea225bc2bb82fd240]
link Generate token to Return token--><g id="link_Generate token_Return token"><path d="M139.6751,488.29 C139.6751,498.79 139.6751,512.43 139.6751,523.75 " fill="none" id="Generate token-to-Return token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="139.6751,528.77,143.6751,519.77,139.6751,523.77,135.6751,519.77,139.6751,528.77" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e178f1f4068ee0e7f5aeacc8dbfee9ac]
link Return token to end--><g id="link_Return token_end"><path d="M139.6751,564.28 C139.6751,575.29 139.6751,589.52 139.6751,599.94 " fill="none" id="Return token-to-end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="139.6751,605,143.6751,596,139.6751,600,135.6751,596,139.6751,605" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebd2e5635da4566f919c4bf9c9e06ab6]
link #14 to 2FA--><g id="link_#14_2FA"><path d="M190.5951,389 C197.3651,401.95 211.4751,428.96 221.4951,448.11 " fill="none" id="#14-to-2FA" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="223.9451,452.8,223.2969,442.9725,221.6181,448.3745,216.2161,446.6956,223.9451,452.8" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="213.6751" y="430.4189">false</text></g><!--MD5=[01f1a6d198c9986ab862bd0e2b9d7c33]
link #11 to Throw Login failed--><g id="link_#11_Throw Login failed"><path d="M228.1151,307.93 C228.9451,317.72 231.2551,332.17 237.6751,343 C241.2051,348.96 246.0551,354.45 251.2051,359.26 " fill="none" id="#11-to-Throw Login failed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="255.1851,362.8,251.135,353.8224,251.4551,359.4702,245.8073,359.7903,255.1851,362.8" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="238.6751" y="340.4189">false</text></g><!--MD5=[9665a20f1985d8d609772a5d2be6703e]
link #8 to Throw Login failed--><g id="link_#8_Throw Login failed"><path d="M255.2951,236.07 C259.3951,260.17 270.2051,323.81 275.9551,357.64 " fill="none" id="#8-to-Throw Login failed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="276.8351,362.8,279.2607,353.2545,275.9922,357.8715,271.3752,354.6031,276.8351,362.8" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="268.6751" y="300.9189">false</text></g><!--MD5=[289bd9f7143d1c97131a8b56bece89fe]
link #5 to Throw Forbidden--><g id="link_#5_Throw Forbidden"><path d="M302.1551,162.82 C308.3551,172.26 319.8351,189.74 329.0051,203.69 " fill="none" id="#5-to-Throw Forbidden" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="331.7651,207.89,330.1626,198.1724,329.018,203.7122,323.4782,202.5676,331.7651,207.89" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[993e84ae668599c7d16e87c6596c83bd]
@startuml Login Flowchart

(*) - -> "Recieve login data"

if "Ip not blocked " then
    if "Email exists" then
        if "Password matches" then
            if "User has logged in before from ip" then
                - ->[true] "Generate token"
                - -> "Return token"
                - -> (*)
            else
                - ->[false] 2FA
            end if 
        else
            - ->[false] "Throw Login failed"
        end if
    else
      - ->[false] "Throw Login failed"

    end if 
else 
 - -> "Throw Forbidden"
end if
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>