<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1127px" preserveAspectRatio="none" style="width:5385px;height:1127px;background:#FFFFFF;" version="1.1" viewBox="0 0 5385 1127" width="5385px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="206.4844" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="628" x="576" y="326"/><ellipse cx="840.25" cy="342" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M843.0156,337.875 Q843.1719,337.6563 843.3594,337.5469 Q843.5469,337.4375 843.7656,337.4375 Q844.1406,337.4375 844.375,337.7031 Q844.6094,337.9531 844.6094,338.5625 L844.6094,340.0156 Q844.6094,340.625 844.375,340.8906 Q844.1406,341.1563 843.7656,341.1563 Q843.4219,341.1563 843.2188,340.9531 Q843.0156,340.7656 842.9063,340.25 Q842.8594,339.8906 842.6719,339.7031 Q842.3438,339.3281 841.7344,339.1094 Q841.125,338.8906 840.5,338.8906 Q839.7344,338.8906 839.0938,339.2188 Q838.4688,339.5469 837.9688,340.2969 Q837.4844,341.0469 837.4844,342.0781 L837.4844,343.1719 Q837.4844,344.4063 838.375,345.2344 Q839.2656,346.0469 840.8594,346.0469 Q841.7969,346.0469 842.4531,345.7969 Q842.8438,345.6406 843.2656,345.2031 Q843.5313,344.9375 843.6719,344.8594 Q843.8281,344.7813 844.0313,344.7813 Q844.3594,344.7813 844.6094,345.0469 Q844.875,345.2969 844.875,345.6406 Q844.875,345.9844 844.5313,346.3906 Q844.0313,346.9688 843.2344,347.2969 Q842.1563,347.75 840.8594,347.75 Q839.3438,347.75 838.1406,347.125 Q837.1563,346.625 836.4688,345.5625 Q835.7813,344.4844 835.7813,343.2031 L835.7813,342.0469 Q835.7813,340.7188 836.3906,339.5781 Q837.0156,338.4219 838.1094,337.8125 Q839.2031,337.1875 840.4375,337.1875 Q841.1719,337.1875 841.8125,337.3594 Q842.4688,337.5156 843.0156,337.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="860.75" y="347.7285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="577" x2="1203" y1="358" y2="358"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="584" y="369.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="596" y="376.5332">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="584" y="386.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="275" x="596" y="394.1426">_tokenManager{readonly} : ITokenManager</text><line style="stroke:#181818;stroke-width:1.0;" x1="577" x2="1203" y1="401.2188" y2="401.2188"/><ellipse cx="587" cy="415.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="596" y="419.752">UserController(userManager : IUserManager, tokenManager : ITokenManager)</text><ellipse cx="587" cy="433.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="384" x="596" y="437.3613">CreateAsync(userCreate : UserCreate) : Task&lt;ActionResult&gt;</text><ellipse cx="587" cy="450.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="596" y="454.9707">LoginAsync(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="587" cy="468.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="596" y="472.5801">GetUserFromTokenAsync() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="587" cy="485.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="602" x="596" y="490.1895">VerificationLoginAsync(verifyCredentials : VerifyCredentials) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="587" cy="503.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="530" x="596" y="507.7988">VerifyUserRegisterAsync(verifyCredentials : VerifyCredentials) : Task&lt;ActionResult&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="584" y="518.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="211" x="596" y="525.4082">GetUserLocation() : UserLocation</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="34" fill="#F1F1F1" height="136.0469" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="740" x="1049" y="592"/><ellipse cx="1369.25" cy="608" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1370.2031,604.6406 L1370.2031,611.2969 L1371.9219,611.2969 Q1372.5313,611.2969 1372.7969,611.5313 Q1373.0625,611.7656 1373.0625,612.1563 Q1373.0625,612.5313 1372.7969,612.7656 Q1372.5313,613 1371.9219,613 L1366.7813,613 Q1366.1719,613 1365.9063,612.7656 Q1365.6406,612.5313 1365.6406,612.1406 Q1365.6406,611.7656 1365.9063,611.5313 Q1366.1719,611.2969 1366.7813,611.2969 L1368.5,611.2969 L1368.5,604.6406 L1366.7813,604.6406 Q1366.1719,604.6406 1365.9063,604.4063 Q1365.6406,604.1719 1365.6406,603.7813 Q1365.6406,603.4063 1365.9063,603.1719 Q1366.1719,602.9375 1366.7813,602.9375 L1371.9219,602.9375 Q1372.5313,602.9375 1372.7969,603.1719 Q1373.0625,603.4063 1373.0625,603.7813 Q1373.0625,604.1719 1372.7969,604.4063 Q1372.5313,604.6406 1371.9219,604.6406 L1370.2031,604.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="1389.75" y="613.7285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1050" x2="1788" y1="624" y2="624"/><line style="stroke:#181818;stroke-width:0.5;" x1="1050" x2="1788" y1="632" y2="632"/><ellipse cx="1060" cy="646.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="361" x="1069" y="650.5332">CreateUserAsync(userCreate : UserCreate) : Task&lt;bool&gt;</text><ellipse cx="1060" cy="663.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="1069" y="668.1426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="1060" cy="681.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="1069" y="685.752">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="1060" cy="699.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="714" x="1069" y="703.3613">LoginWithVerificationCodeAsync(verifyCredentials : VerifyCredentials, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="1060" cy="716.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="682" x="1069" y="720.9707">VerifyUserRegistrationAsync(verifyCredentials : VerifyCredentials, userLocation: UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="42" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="366" y="609.5"/><ellipse cx="492.75" cy="625.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M493.7031,622.1406 L493.7031,628.7969 L495.4219,628.7969 Q496.0313,628.7969 496.2969,629.0313 Q496.5625,629.2656 496.5625,629.6563 Q496.5625,630.0313 496.2969,630.2656 Q496.0313,630.5 495.4219,630.5 L490.2813,630.5 Q489.6719,630.5 489.4063,630.2656 Q489.1406,630.0313 489.1406,629.6406 Q489.1406,629.2656 489.4063,629.0313 Q489.6719,628.7969 490.2813,628.7969 L492,628.7969 L492,622.1406 L490.2813,622.1406 Q489.6719,622.1406 489.4063,621.9063 Q489.1406,621.6719 489.1406,621.2813 Q489.1406,620.9063 489.4063,620.6719 Q489.6719,620.4375 490.2813,620.4375 L495.4219,620.4375 Q496.0313,620.4375 496.2969,620.6719 Q496.5625,620.9063 496.5625,621.2813 Q496.5625,621.6719 496.2969,621.9063 Q496.0313,622.1406 495.4219,622.1406 L493.7031,622.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="513.25" y="631.2285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="367" x2="729" y1="641.5" y2="641.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="367" x2="729" y1="649.5" y2="649.5"/><ellipse cx="377" cy="663.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="386" y="668.0332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="377" cy="681.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="386" y="685.6426">ValidateToken(token : string) : bool</text><ellipse cx="377" cy="699.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="386" y="703.252">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="246" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="894" y="832"/><ellipse cx="922.5" cy="848" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M925.2656,843.875 Q925.4219,843.6563 925.6094,843.5469 Q925.7969,843.4375 926.0156,843.4375 Q926.3906,843.4375 926.625,843.7031 Q926.8594,843.9531 926.8594,844.5625 L926.8594,846.0156 Q926.8594,846.625 926.625,846.8906 Q926.3906,847.1563 926.0156,847.1563 Q925.6719,847.1563 925.4688,846.9531 Q925.2656,846.7656 925.1563,846.25 Q925.1094,845.8906 924.9219,845.7031 Q924.5938,845.3281 923.9844,845.1094 Q923.375,844.8906 922.75,844.8906 Q921.9844,844.8906 921.3438,845.2188 Q920.7188,845.5469 920.2188,846.2969 Q919.7344,847.0469 919.7344,848.0781 L919.7344,849.1719 Q919.7344,850.4063 920.625,851.2344 Q921.5156,852.0469 923.1094,852.0469 Q924.0469,852.0469 924.7031,851.7969 Q925.0938,851.6406 925.5156,851.2031 Q925.7813,850.9375 925.9219,850.8594 Q926.0781,850.7813 926.2813,850.7813 Q926.6094,850.7813 926.8594,851.0469 Q927.125,851.2969 927.125,851.6406 Q927.125,851.9844 926.7813,852.3906 Q926.2813,852.9688 925.4844,853.2969 Q924.4063,853.75 923.1094,853.75 Q921.5938,853.75 920.3906,853.125 Q919.4063,852.625 918.7188,851.5625 Q918.0313,850.4844 918.0313,849.2031 L918.0313,848.0469 Q918.0313,846.7188 918.6406,845.5781 Q919.2656,844.4219 920.3594,843.8125 Q921.4531,843.1875 922.6875,843.1875 Q923.4219,843.1875 924.0625,843.3594 Q924.7188,843.5156 925.2656,843.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="939.5" y="853.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="895" x2="1027" y1="864" y2="864"/><ellipse cx="905" cy="878.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="914" y="882.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="895" x2="1027" y1="889.6094" y2="889.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="258" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1238" y="823.5"/><ellipse cx="1270.1" cy="839.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1272.8656,835.375 Q1273.0219,835.1563 1273.2094,835.0469 Q1273.3969,834.9375 1273.6156,834.9375 Q1273.9906,834.9375 1274.225,835.2031 Q1274.4594,835.4531 1274.4594,836.0625 L1274.4594,837.5156 Q1274.4594,838.125 1274.225,838.3906 Q1273.9906,838.6563 1273.6156,838.6563 Q1273.2719,838.6563 1273.0688,838.4531 Q1272.8656,838.2656 1272.7563,837.75 Q1272.7094,837.3906 1272.5219,837.2031 Q1272.1938,836.8281 1271.5844,836.6094 Q1270.975,836.3906 1270.35,836.3906 Q1269.5844,836.3906 1268.9438,836.7188 Q1268.3188,837.0469 1267.8188,837.7969 Q1267.3344,838.5469 1267.3344,839.5781 L1267.3344,840.6719 Q1267.3344,841.9063 1268.225,842.7344 Q1269.1156,843.5469 1270.7094,843.5469 Q1271.6469,843.5469 1272.3031,843.2969 Q1272.6938,843.1406 1273.1156,842.7031 Q1273.3813,842.4375 1273.5219,842.3594 Q1273.6781,842.2813 1273.8813,842.2813 Q1274.2094,842.2813 1274.4594,842.5469 Q1274.725,842.7969 1274.725,843.1406 Q1274.725,843.4844 1274.3813,843.8906 Q1273.8813,844.4688 1273.0844,844.7969 Q1272.0063,845.25 1270.7094,845.25 Q1269.1938,845.25 1267.9906,844.625 Q1267.0063,844.125 1266.3188,843.0625 Q1265.6313,841.9844 1265.6313,840.7031 L1265.6313,839.5469 Q1265.6313,838.2188 1266.2406,837.0781 Q1266.8656,835.9219 1267.9594,835.3125 Q1269.0531,834.6875 1270.2875,834.6875 Q1271.0219,834.6875 1271.6625,834.8594 Q1272.3188,835.0156 1272.8656,835.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1287.9" y="845.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="1239" x2="1371" y1="855.5" y2="855.5"/><ellipse cx="1249" cy="869.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1258" y="874.0332">Email : string</text><ellipse cx="1249" cy="887.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1258" y="891.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1239" x2="1371" y1="898.7188" y2="898.7188"/></g><!--MD5=[7e38db3769ab3d4a7934dc4e6ba3ae24]
class VerifyCredentials--><g id="elem_VerifyCredentials"><rect codeLine="263" fill="#F1F1F1" height="83.2188" id="VerifyCredentials" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="1063" y="823.5"/><ellipse cx="1078" cy="839.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1080.7656,835.375 Q1080.9219,835.1563 1081.1094,835.0469 Q1081.2969,834.9375 1081.5156,834.9375 Q1081.8906,834.9375 1082.125,835.2031 Q1082.3594,835.4531 1082.3594,836.0625 L1082.3594,837.5156 Q1082.3594,838.125 1082.125,838.3906 Q1081.8906,838.6563 1081.5156,838.6563 Q1081.1719,838.6563 1080.9688,838.4531 Q1080.7656,838.2656 1080.6563,837.75 Q1080.6094,837.3906 1080.4219,837.2031 Q1080.0938,836.8281 1079.4844,836.6094 Q1078.875,836.3906 1078.25,836.3906 Q1077.4844,836.3906 1076.8438,836.7188 Q1076.2188,837.0469 1075.7188,837.7969 Q1075.2344,838.5469 1075.2344,839.5781 L1075.2344,840.6719 Q1075.2344,841.9063 1076.125,842.7344 Q1077.0156,843.5469 1078.6094,843.5469 Q1079.5469,843.5469 1080.2031,843.2969 Q1080.5938,843.1406 1081.0156,842.7031 Q1081.2813,842.4375 1081.4219,842.3594 Q1081.5781,842.2813 1081.7813,842.2813 Q1082.1094,842.2813 1082.3594,842.5469 Q1082.625,842.7969 1082.625,843.1406 Q1082.625,843.4844 1082.2813,843.8906 Q1081.7813,844.4688 1080.9844,844.7969 Q1079.9063,845.25 1078.6094,845.25 Q1077.0938,845.25 1075.8906,844.625 Q1074.9063,844.125 1074.2188,843.0625 Q1073.5313,841.9844 1073.5313,840.7031 L1073.5313,839.5469 Q1073.5313,838.2188 1074.1406,837.0781 Q1074.7656,835.9219 1075.8594,835.3125 Q1076.9531,834.6875 1078.1875,834.6875 Q1078.9219,834.6875 1079.5625,834.8594 Q1080.2188,835.0156 1080.7656,835.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1092" y="845.2285">VerifyCredentials</text><line style="stroke:#181818;stroke-width:0.5;" x1="1064" x2="1202" y1="855.5" y2="855.5"/><ellipse cx="1074" cy="869.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1083" y="874.0332">Email : string</text><ellipse cx="1074" cy="887.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1083" y="891.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1064" x2="1202" y1="898.7188" y2="898.7188"/></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="230" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1407" y="797"/><ellipse cx="1472.25" cy="813" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1475.0156,808.875 Q1475.1719,808.6563 1475.3594,808.5469 Q1475.5469,808.4375 1475.7656,808.4375 Q1476.1406,808.4375 1476.375,808.7031 Q1476.6094,808.9531 1476.6094,809.5625 L1476.6094,811.0156 Q1476.6094,811.625 1476.375,811.8906 Q1476.1406,812.1563 1475.7656,812.1563 Q1475.4219,812.1563 1475.2188,811.9531 Q1475.0156,811.7656 1474.9063,811.25 Q1474.8594,810.8906 1474.6719,810.7031 Q1474.3438,810.3281 1473.7344,810.1094 Q1473.125,809.8906 1472.5,809.8906 Q1471.7344,809.8906 1471.0938,810.2188 Q1470.4688,810.5469 1469.9688,811.2969 Q1469.4844,812.0469 1469.4844,813.0781 L1469.4844,814.1719 Q1469.4844,815.4063 1470.375,816.2344 Q1471.2656,817.0469 1472.8594,817.0469 Q1473.7969,817.0469 1474.4531,816.7969 Q1474.8438,816.6406 1475.2656,816.2031 Q1475.5313,815.9375 1475.6719,815.8594 Q1475.8281,815.7813 1476.0313,815.7813 Q1476.3594,815.7813 1476.6094,816.0469 Q1476.875,816.2969 1476.875,816.6406 Q1476.875,816.9844 1476.5313,817.3906 Q1476.0313,817.9688 1475.2344,818.2969 Q1474.1563,818.75 1472.8594,818.75 Q1471.3438,818.75 1470.1406,818.125 Q1469.1563,817.625 1468.4688,816.5625 Q1467.7813,815.4844 1467.7813,814.2031 L1467.7813,813.0469 Q1467.7813,811.7188 1468.3906,810.5781 Q1469.0156,809.4219 1470.1094,808.8125 Q1471.2031,808.1875 1472.4375,808.1875 Q1473.1719,808.1875 1473.8125,808.3594 Q1474.4688,808.5156 1475.0156,808.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1492.75" y="818.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="1408" x2="1574" y1="829" y2="829"/><ellipse cx="1418" cy="843.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1427" y="847.5332">ID : int</text><ellipse cx="1418" cy="860.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1427" y="865.1426">IsVerified : bool</text><ellipse cx="1418" cy="878.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1427" y="882.752">IsLocked : bool</text><ellipse cx="1418" cy="896.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1427" y="900.3613">FailedTries : int</text><ellipse cx="1418" cy="913.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="1427" y="917.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1408" x2="1574" y1="925.0469" y2="925.0469"/></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="224" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="654.5" y="814.5"/><ellipse cx="674.9" cy="830.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M677.6656,826.375 Q677.8219,826.1563 678.0094,826.0469 Q678.1969,825.9375 678.4156,825.9375 Q678.7906,825.9375 679.025,826.2031 Q679.2594,826.4531 679.2594,827.0625 L679.2594,828.5156 Q679.2594,829.125 679.025,829.3906 Q678.7906,829.6563 678.4156,829.6563 Q678.0719,829.6563 677.8688,829.4531 Q677.6656,829.2656 677.5563,828.75 Q677.5094,828.3906 677.3219,828.2031 Q676.9938,827.8281 676.3844,827.6094 Q675.775,827.3906 675.15,827.3906 Q674.3844,827.3906 673.7438,827.7188 Q673.1188,828.0469 672.6188,828.7969 Q672.1344,829.5469 672.1344,830.5781 L672.1344,831.6719 Q672.1344,832.9063 673.025,833.7344 Q673.9156,834.5469 675.5094,834.5469 Q676.4469,834.5469 677.1031,834.2969 Q677.4938,834.1406 677.9156,833.7031 Q678.1813,833.4375 678.3219,833.3594 Q678.4781,833.2813 678.6813,833.2813 Q679.0094,833.2813 679.2594,833.5469 Q679.525,833.7969 679.525,834.1406 Q679.525,834.4844 679.1813,834.8906 Q678.6813,835.4688 677.8844,835.7969 Q676.8063,836.25 675.5094,836.25 Q673.9938,836.25 672.7906,835.625 Q671.8063,835.125 671.1188,834.0625 Q670.4313,832.9844 670.4313,831.7031 L670.4313,830.5469 Q670.4313,829.2188 671.0406,828.0781 Q671.6656,826.9219 672.7594,826.3125 Q673.8531,825.6875 675.0875,825.6875 Q675.8219,825.6875 676.4625,825.8594 Q677.1188,826.0156 677.6656,826.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="690.1" y="836.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="655.5" x2="766.5" y1="846.5" y2="846.5"/><ellipse cx="665.5" cy="860.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="674.5" y="865.0332">UserID : int</text><ellipse cx="665.5" cy="878.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="674.5" y="882.6426">Email : string</text><ellipse cx="665.5" cy="896.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="674.5" y="900.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="655.5" x2="766.5" y1="907.3281" y2="907.3281"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="268" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="2746.5" y="788"/><ellipse cx="2784" cy="804" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2786.7656,799.875 Q2786.9219,799.6563 2787.1094,799.5469 Q2787.2969,799.4375 2787.5156,799.4375 Q2787.8906,799.4375 2788.125,799.7031 Q2788.3594,799.9531 2788.3594,800.5625 L2788.3594,802.0156 Q2788.3594,802.625 2788.125,802.8906 Q2787.8906,803.1563 2787.5156,803.1563 Q2787.1719,803.1563 2786.9688,802.9531 Q2786.7656,802.7656 2786.6563,802.25 Q2786.6094,801.8906 2786.4219,801.7031 Q2786.0938,801.3281 2785.4844,801.1094 Q2784.875,800.8906 2784.25,800.8906 Q2783.4844,800.8906 2782.8438,801.2188 Q2782.2188,801.5469 2781.7188,802.2969 Q2781.2344,803.0469 2781.2344,804.0781 L2781.2344,805.1719 Q2781.2344,806.4063 2782.125,807.2344 Q2783.0156,808.0469 2784.6094,808.0469 Q2785.5469,808.0469 2786.2031,807.7969 Q2786.5938,807.6406 2787.0156,807.2031 Q2787.2813,806.9375 2787.4219,806.8594 Q2787.5781,806.7813 2787.7813,806.7813 Q2788.1094,806.7813 2788.3594,807.0469 Q2788.625,807.2969 2788.625,807.6406 Q2788.625,807.9844 2788.2813,808.3906 Q2787.7813,808.9688 2786.9844,809.2969 Q2785.9063,809.75 2784.6094,809.75 Q2783.0938,809.75 2781.8906,809.125 Q2780.9063,808.625 2780.2188,807.5625 Q2779.5313,806.4844 2779.5313,805.2031 L2779.5313,804.0469 Q2779.5313,802.7188 2780.1406,801.5781 Q2780.7656,800.4219 2781.8594,799.8125 Q2782.9531,799.1875 2784.1875,799.1875 Q2784.9219,799.1875 2785.5625,799.3594 Q2786.2188,799.5156 2786.7656,799.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="2803" y="809.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="2747.5" x2="2910.5" y1="820" y2="820"/><ellipse cx="2757.5" cy="834.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="2766.5" y="838.5332">ID : int</text><ellipse cx="2757.5" cy="851.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="2766.5" y="856.1426">UserID : int</text><ellipse cx="2757.5" cy="869.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="2766.5" y="873.752">IP : string</text><ellipse cx="2757.5" cy="887.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="2766.5" y="891.3613">UserAgent : string</text><ellipse cx="2757.5" cy="904.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="2766.5" y="908.9707">Successful : bool</text><ellipse cx="2757.5" cy="922.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2766.5" y="926.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="2747.5" x2="2910.5" y1="933.6563" y2="933.6563"/></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="49" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="3935" y="609.5"/><ellipse cx="4128.25" cy="625.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4129.2031,622.1406 L4129.2031,628.7969 L4130.9219,628.7969 Q4131.5313,628.7969 4131.7969,629.0313 Q4132.0625,629.2656 4132.0625,629.6563 Q4132.0625,630.0313 4131.7969,630.2656 Q4131.5313,630.5 4130.9219,630.5 L4125.7813,630.5 Q4125.1719,630.5 4124.9063,630.2656 Q4124.6406,630.0313 4124.6406,629.6406 Q4124.6406,629.2656 4124.9063,629.0313 Q4125.1719,628.7969 4125.7813,628.7969 L4127.5,628.7969 L4127.5,622.1406 L4125.7813,622.1406 Q4125.1719,622.1406 4124.9063,621.9063 Q4124.6406,621.6719 4124.6406,621.2813 Q4124.6406,620.9063 4124.9063,620.6719 Q4125.1719,620.4375 4125.7813,620.4375 L4130.9219,620.4375 Q4131.5313,620.4375 4131.7969,620.6719 Q4132.0625,620.9063 4132.0625,621.2813 Q4132.0625,621.6719 4131.7969,621.9063 Q4131.5313,622.1406 4130.9219,622.1406 L4129.2031,622.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="4148.75" y="631.2285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="3936" x2="4474" y1="641.5" y2="641.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="3936" x2="4474" y1="649.5" y2="649.5"/><ellipse cx="3946" cy="663.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="3955" y="668.0332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="3946" cy="681.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="3955" y="685.6426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="3946" cy="699.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="3955" y="703.252">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[5bbb8fec178e848d13dc3ca00e0fbd40]
class IMessageManager--><g id="elem_IMessageManager"><rect codeLine="55" fill="#F1F1F1" height="83.2188" id="IMessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="497" x="1239.5" y="387.5"/><ellipse cx="1424.25" cy="403.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1425.2031,400.1406 L1425.2031,406.7969 L1426.9219,406.7969 Q1427.5313,406.7969 1427.7969,407.0313 Q1428.0625,407.2656 1428.0625,407.6563 Q1428.0625,408.0313 1427.7969,408.2656 Q1427.5313,408.5 1426.9219,408.5 L1421.7813,408.5 Q1421.1719,408.5 1420.9063,408.2656 Q1420.6406,408.0313 1420.6406,407.6406 Q1420.6406,407.2656 1420.9063,407.0313 Q1421.1719,406.7969 1421.7813,406.7969 L1423.5,406.7969 L1423.5,400.1406 L1421.7813,400.1406 Q1421.1719,400.1406 1420.9063,399.9063 Q1420.6406,399.6719 1420.6406,399.2813 Q1420.6406,398.9063 1420.9063,398.6719 Q1421.1719,398.4375 1421.7813,398.4375 L1426.9219,398.4375 Q1427.5313,398.4375 1427.7969,398.6719 Q1428.0625,398.9063 1428.0625,399.2813 Q1428.0625,399.6719 1427.7969,399.9063 Q1427.5313,400.1406 1426.9219,400.1406 L1425.2031,400.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="119" x="1444.75" y="409.2285">IMessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1240.5" x2="1735.5" y1="419.5" y2="419.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1240.5" x2="1735.5" y1="427.5" y2="427.5"/><ellipse cx="1250.5" cy="441.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="1259.5" y="446.0332">SendLoginAttemptMessageAsync(to : string, otp : string) : Task&lt;bool&gt;</text><ellipse cx="1250.5" cy="459.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="471" x="1259.5" y="463.6426">SendLoginRegistrationMessageAsync(to : string, key : string) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="60" fill="#F1F1F1" height="153.6563" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="534" x="7" y="352"/><ellipse cx="221.75" cy="368" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.5156,363.875 Q224.6719,363.6563 224.8594,363.5469 Q225.0469,363.4375 225.2656,363.4375 Q225.6406,363.4375 225.875,363.7031 Q226.1094,363.9531 226.1094,364.5625 L226.1094,366.0156 Q226.1094,366.625 225.875,366.8906 Q225.6406,367.1563 225.2656,367.1563 Q224.9219,367.1563 224.7188,366.9531 Q224.5156,366.7656 224.4063,366.25 Q224.3594,365.8906 224.1719,365.7031 Q223.8438,365.3281 223.2344,365.1094 Q222.625,364.8906 222,364.8906 Q221.2344,364.8906 220.5938,365.2188 Q219.9688,365.5469 219.4688,366.2969 Q218.9844,367.0469 218.9844,368.0781 L218.9844,369.1719 Q218.9844,370.4063 219.875,371.2344 Q220.7656,372.0469 222.3594,372.0469 Q223.2969,372.0469 223.9531,371.7969 Q224.3438,371.6406 224.7656,371.2031 Q225.0313,370.9375 225.1719,370.8594 Q225.3281,370.7813 225.5313,370.7813 Q225.8594,370.7813 226.1094,371.0469 Q226.375,371.2969 226.375,371.6406 Q226.375,371.9844 226.0313,372.3906 Q225.5313,372.9688 224.7344,373.2969 Q223.6563,373.75 222.3594,373.75 Q220.8438,373.75 219.6406,373.125 Q218.6563,372.625 217.9688,371.5625 Q217.2813,370.4844 217.2813,369.2031 L217.2813,368.0469 Q217.2813,366.7188 217.8906,365.5781 Q218.5156,364.4219 219.6094,363.8125 Q220.7031,363.1875 221.9375,363.1875 Q222.6719,363.1875 223.3125,363.3594 Q223.9688,363.5156 224.5156,363.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="242.25" y="373.7285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="540" y1="384" y2="384"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="395.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="27" y="402.5332">_configuration{readonly} : IConfiguration</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="412.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="285" x="27" y="420.1426">_logger{readonly} : ILogger&lt;TokenManager&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="430.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="27" y="437.752">_secret{readonly} : string</text><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="540" y1="444.8281" y2="444.8281"/><ellipse cx="18" cy="459.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="508" x="27" y="463.3613">TokenManager(configuration : IConfiguration, logger : ILogger&lt;TokenManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="473.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="480.9707">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="491.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="498.5801">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="70" fill="#F1F1F1" height="259.3125" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="1128" x="1368" y="7"/><ellipse cx="1885.25" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1888.0156,18.875 Q1888.1719,18.6563 1888.3594,18.5469 Q1888.5469,18.4375 1888.7656,18.4375 Q1889.1406,18.4375 1889.375,18.7031 Q1889.6094,18.9531 1889.6094,19.5625 L1889.6094,21.0156 Q1889.6094,21.625 1889.375,21.8906 Q1889.1406,22.1563 1888.7656,22.1563 Q1888.4219,22.1563 1888.2188,21.9531 Q1888.0156,21.7656 1887.9063,21.25 Q1887.8594,20.8906 1887.6719,20.7031 Q1887.3438,20.3281 1886.7344,20.1094 Q1886.125,19.8906 1885.5,19.8906 Q1884.7344,19.8906 1884.0938,20.2188 Q1883.4688,20.5469 1882.9688,21.2969 Q1882.4844,22.0469 1882.4844,23.0781 L1882.4844,24.1719 Q1882.4844,25.4063 1883.375,26.2344 Q1884.2656,27.0469 1885.8594,27.0469 Q1886.7969,27.0469 1887.4531,26.7969 Q1887.8438,26.6406 1888.2656,26.2031 Q1888.5313,25.9375 1888.6719,25.8594 Q1888.8281,25.7813 1889.0313,25.7813 Q1889.3594,25.7813 1889.6094,26.0469 Q1889.875,26.2969 1889.875,26.6406 Q1889.875,26.9844 1889.5313,27.3906 Q1889.0313,27.9688 1888.2344,28.2969 Q1887.1563,28.75 1885.8594,28.75 Q1884.3438,28.75 1883.1406,28.125 Q1882.1563,27.625 1881.4688,26.5625 Q1880.7813,25.4844 1880.7813,24.2031 L1880.7813,23.0469 Q1880.7813,21.7188 1881.3906,20.5781 Q1882.0156,19.4219 1883.1094,18.8125 Q1884.2031,18.1875 1885.4375,18.1875 Q1886.1719,18.1875 1886.8125,18.3594 Q1887.4688,18.5156 1888.0156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1905.75" y="28.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1369" x2="2495" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="251" x="1388" y="57.5332">_userProvider{readonly} : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="409" x="1388" y="75.1426">_leakedPasswordProvider{readonly} : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="365" x="1388" y="92.752">_userLocationManager{readonly} : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="103.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="314" x="1388" y="110.3613">_messageManager{readonly} : IMessageManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="120.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="1388" y="127.9707">_logger{readonly} : ILogger&lt;UserManager&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="138.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="1388" y="145.5801">_configuration{readonly} : IConfiguration</text><line style="stroke:#181818;stroke-width:1.0;" x1="1369" x2="2495" y1="152.6563" y2="152.6563"/><ellipse cx="1379" cy="166.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1102" x="1388" y="171.1895">UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="455" x="1388" y="188.7988">messageManager : IMessageManager, logger : ILogger&lt;UserManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="199.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438" x="1388" y="206.4082">IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="216.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="440" x="1388" y="224.0176">CheckPasswordLeakedForUserAsync(password : string) : Task&lt;bool&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="234.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="471" x="1388" y="241.627">IsUserNotVerifiedAsync(userLocation : UserLocation, user : DbUser) : Task</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1376" y="252.0078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="448" x="1388" y="259.2363">IsUserLockedAsync(userLocation : UserLocation, user : DbUser) : Task</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="86" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="461" x="3878.5" y="95"/><ellipse cx="4035.25" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4038.0156,106.875 Q4038.1719,106.6563 4038.3594,106.5469 Q4038.5469,106.4375 4038.7656,106.4375 Q4039.1406,106.4375 4039.375,106.7031 Q4039.6094,106.9531 4039.6094,107.5625 L4039.6094,109.0156 Q4039.6094,109.625 4039.375,109.8906 Q4039.1406,110.1563 4038.7656,110.1563 Q4038.4219,110.1563 4038.2188,109.9531 Q4038.0156,109.7656 4037.9063,109.25 Q4037.8594,108.8906 4037.6719,108.7031 Q4037.3438,108.3281 4036.7344,108.1094 Q4036.125,107.8906 4035.5,107.8906 Q4034.7344,107.8906 4034.0938,108.2188 Q4033.4688,108.5469 4032.9688,109.2969 Q4032.4844,110.0469 4032.4844,111.0781 L4032.4844,112.1719 Q4032.4844,113.4063 4033.375,114.2344 Q4034.2656,115.0469 4035.8594,115.0469 Q4036.7969,115.0469 4037.4531,114.7969 Q4037.8438,114.6406 4038.2656,114.2031 Q4038.5313,113.9375 4038.6719,113.8594 Q4038.8281,113.7813 4039.0313,113.7813 Q4039.3594,113.7813 4039.6094,114.0469 Q4039.875,114.2969 4039.875,114.6406 Q4039.875,114.9844 4039.5313,115.3906 Q4039.0313,115.9688 4038.2344,116.2969 Q4037.1563,116.75 4035.8594,116.75 Q4034.3438,116.75 4033.1406,116.125 Q4032.1563,115.625 4031.4688,114.5625 Q4030.7813,113.4844 4030.7813,112.2031 L4030.7813,111.0469 Q4030.7813,109.7188 4031.3906,108.5781 Q4032.0156,107.4219 4033.1094,106.8125 Q4034.2031,106.1875 4035.4375,106.1875 Q4036.1719,106.1875 4036.8125,106.3594 Q4037.4688,106.5156 4038.0156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="4055.75" y="116.7285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="3879.5" x2="4338.5" y1="127" y2="127"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3886.5" y="138.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="359" x="3898.5" y="145.5332">_userLocationProvider{readonly} : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="3879.5" x2="4338.5" y1="152.6094" y2="152.6094"/><ellipse cx="3889.5" cy="166.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="435" x="3898.5" y="171.1426">UserLocationManager(userLocationProvider : IUserLocationProvider)</text></g><!--MD5=[20fcb2fa68efbd583f0fa2981cab489f]
class MessageManager--><g id="elem_MessageManager"><rect codeLine="92" fill="#F1F1F1" height="136.0469" id="MessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="667" x="665.5" y="68.5"/><ellipse cx="938.25" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M941.0156,80.375 Q941.1719,80.1563 941.3594,80.0469 Q941.5469,79.9375 941.7656,79.9375 Q942.1406,79.9375 942.375,80.2031 Q942.6094,80.4531 942.6094,81.0625 L942.6094,82.5156 Q942.6094,83.125 942.375,83.3906 Q942.1406,83.6563 941.7656,83.6563 Q941.4219,83.6563 941.2188,83.4531 Q941.0156,83.2656 940.9063,82.75 Q940.8594,82.3906 940.6719,82.2031 Q940.3438,81.8281 939.7344,81.6094 Q939.125,81.3906 938.5,81.3906 Q937.7344,81.3906 937.0938,81.7188 Q936.4688,82.0469 935.9688,82.7969 Q935.4844,83.5469 935.4844,84.5781 L935.4844,85.6719 Q935.4844,86.9063 936.375,87.7344 Q937.2656,88.5469 938.8594,88.5469 Q939.7969,88.5469 940.4531,88.2969 Q940.8438,88.1406 941.2656,87.7031 Q941.5313,87.4375 941.6719,87.3594 Q941.8281,87.2813 942.0313,87.2813 Q942.3594,87.2813 942.6094,87.5469 Q942.875,87.7969 942.875,88.1406 Q942.875,88.4844 942.5313,88.8906 Q942.0313,89.4688 941.2344,89.7969 Q940.1563,90.25 938.8594,90.25 Q937.3438,90.25 936.1406,89.625 Q935.1563,89.125 934.4688,88.0625 Q933.7813,86.9844 933.7813,85.7031 L933.7813,84.5469 Q933.7813,83.2188 934.3906,82.0781 Q935.0156,80.9219 936.1094,80.3125 Q937.2031,79.6875 938.4375,79.6875 Q939.1719,79.6875 939.8125,79.8594 Q940.4688,80.0156 941.0156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="958.75" y="90.2285">MessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="666.5" x2="1331.5" y1="100.5" y2="100.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="673.5" y="111.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="296" x="685.5" y="119.0332">_messageService{readonly} : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="673.5" y="129.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="308" x="685.5" y="136.6426">_messageProvider{readonly} : IMessageProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="673.5" y="147.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="237" x="685.5" y="154.252">_logger : ILogger&lt;MessageManager&gt;</text><line style="stroke:#181818;stroke-width:1.0;" x1="666.5" x2="1331.5" y1="161.3281" y2="161.3281"/><ellipse cx="676.5" cy="175.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="641" x="685.5" y="179.8613">MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="234" x="685.5" y="197.4707">logger : ILogger&lt;MessageManager&gt;)</text></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="131" fill="#F1F1F1" height="188.875" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1985" y="334.5"/><ellipse cx="2207.75" cy="350.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2208.7031,347.1406 L2208.7031,353.7969 L2210.4219,353.7969 Q2211.0313,353.7969 2211.2969,354.0313 Q2211.5625,354.2656 2211.5625,354.6563 Q2211.5625,355.0313 2211.2969,355.2656 Q2211.0313,355.5 2210.4219,355.5 L2205.2813,355.5 Q2204.6719,355.5 2204.4063,355.2656 Q2204.1406,355.0313 2204.1406,354.6406 Q2204.1406,354.2656 2204.4063,354.0313 Q2204.6719,353.7969 2205.2813,353.7969 L2207,353.7969 L2207,347.1406 L2205.2813,347.1406 Q2204.6719,347.1406 2204.4063,346.9063 Q2204.1406,346.6719 2204.1406,346.2813 Q2204.1406,345.9063 2204.4063,345.6719 Q2204.6719,345.4375 2205.2813,345.4375 L2210.4219,345.4375 Q2211.0313,345.4375 2211.2969,345.6719 Q2211.5625,345.9063 2211.5625,346.2813 Q2211.5625,346.6719 2211.2969,346.9063 Q2211.0313,347.1406 2210.4219,347.1406 L2208.7031,347.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="2228.25" y="356.2285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1986" x2="2524" y1="366.5" y2="366.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1986" x2="2524" y1="374.5" y2="374.5"/><ellipse cx="1996" cy="388.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2005" y="393.0332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="1996" cy="406.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2005" y="410.6426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="1996" cy="424.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2005" y="428.252">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="1996" cy="441.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="365" x="2005" y="445.8613">UpdateUserFailedTriesAsync(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="1996" cy="459.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="2005" y="463.4707">UpdateUserLoginSuccessAsync(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="1996" cy="476.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="409" x="2005" y="481.0801">UpdateUserLoginNewLocationAsync(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="1996" cy="494.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="298" x="2005" y="498.6895">UpdateUserToVerifiedAsync(userID : int) : Task</text><ellipse cx="1996" cy="512.0703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="2005" y="516.2988">UpdateUserLoginSuccessWithVerificationCodeAsync(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="142" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="2560" y="396"/><ellipse cx="2677.25" cy="412" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2678.2031,408.6406 L2678.2031,415.2969 L2679.9219,415.2969 Q2680.5313,415.2969 2680.7969,415.5313 Q2681.0625,415.7656 2681.0625,416.1563 Q2681.0625,416.5313 2680.7969,416.7656 Q2680.5313,417 2679.9219,417 L2674.7813,417 Q2674.1719,417 2673.9063,416.7656 Q2673.6406,416.5313 2673.6406,416.1406 Q2673.6406,415.7656 2673.9063,415.5313 Q2674.1719,415.2969 2674.7813,415.2969 L2676.5,415.2969 L2676.5,408.6406 L2674.7813,408.6406 Q2674.1719,408.6406 2673.9063,408.4063 Q2673.6406,408.1719 2673.6406,407.7813 Q2673.6406,407.4063 2673.9063,407.1719 Q2674.1719,406.9375 2674.7813,406.9375 L2679.9219,406.9375 Q2680.5313,406.9375 2680.7969,407.1719 Q2681.0625,407.4063 2681.0625,407.7813 Q2681.0625,408.1719 2680.7969,408.4063 Q2680.5313,408.6406 2679.9219,408.6406 L2678.2031,408.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="2697.75" y="417.7285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2561" x2="2967" y1="428" y2="428"/><line style="stroke:#181818;stroke-width:0.5;" x1="2561" x2="2967" y1="436" y2="436"/><ellipse cx="2571" cy="450.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="2580" y="454.5332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="238" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="1966" y="592"/><ellipse cx="2043.25" cy="608" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2046.0156,603.875 Q2046.1719,603.6563 2046.3594,603.5469 Q2046.5469,603.4375 2046.7656,603.4375 Q2047.1406,603.4375 2047.375,603.7031 Q2047.6094,603.9531 2047.6094,604.5625 L2047.6094,606.0156 Q2047.6094,606.625 2047.375,606.8906 Q2047.1406,607.1563 2046.7656,607.1563 Q2046.4219,607.1563 2046.2188,606.9531 Q2046.0156,606.7656 2045.9063,606.25 Q2045.8594,605.8906 2045.6719,605.7031 Q2045.3438,605.3281 2044.7344,605.1094 Q2044.125,604.8906 2043.5,604.8906 Q2042.7344,604.8906 2042.0938,605.2188 Q2041.4688,605.5469 2040.9688,606.2969 Q2040.4844,607.0469 2040.4844,608.0781 L2040.4844,609.1719 Q2040.4844,610.4063 2041.375,611.2344 Q2042.2656,612.0469 2043.8594,612.0469 Q2044.7969,612.0469 2045.4531,611.7969 Q2045.8438,611.6406 2046.2656,611.2031 Q2046.5313,610.9375 2046.6719,610.8594 Q2046.8281,610.7813 2047.0313,610.7813 Q2047.3594,610.7813 2047.6094,611.0469 Q2047.875,611.2969 2047.875,611.6406 Q2047.875,611.9844 2047.5313,612.3906 Q2047.0313,612.9688 2046.2344,613.2969 Q2045.1563,613.75 2043.8594,613.75 Q2042.3438,613.75 2041.1406,613.125 Q2040.1563,612.625 2039.4688,611.5625 Q2038.7813,610.4844 2038.7813,609.2031 L2038.7813,608.0469 Q2038.7813,606.7188 2039.3906,605.5781 Q2040.0156,604.4219 2041.1094,603.8125 Q2042.2031,603.1875 2043.4375,603.1875 Q2044.1719,603.1875 2044.8125,603.3594 Q2045.4688,603.5156 2046.0156,603.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2063.75" y="613.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="1967" x2="2175" y1="624" y2="624"/><ellipse cx="1977" cy="638.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="1986" y="642.5332">HashedPassword : string</text><ellipse cx="1977" cy="655.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1986" y="660.1426">Salt : string</text><ellipse cx="1977" cy="673.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1986" y="677.752">SecretKey : string</text><ellipse cx="1977" cy="691.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1986" y="695.3613">Count : long</text><ellipse cx="1977" cy="708.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="1986" y="712.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1967" x2="2175" y1="720.0469" y2="720.0469"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="158" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="3732" y="378.5"/><ellipse cx="3927.75" cy="394.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3928.7031,391.1406 L3928.7031,397.7969 L3930.4219,397.7969 Q3931.0313,397.7969 3931.2969,398.0313 Q3931.5625,398.2656 3931.5625,398.6563 Q3931.5625,399.0313 3931.2969,399.2656 Q3931.0313,399.5 3930.4219,399.5 L3925.2813,399.5 Q3924.6719,399.5 3924.4063,399.2656 Q3924.1406,399.0313 3924.1406,398.6406 Q3924.1406,398.2656 3924.4063,398.0313 Q3924.6719,397.7969 3925.2813,397.7969 L3927,397.7969 L3927,391.1406 L3925.2813,391.1406 Q3924.6719,391.1406 3924.4063,390.9063 Q3924.1406,390.6719 3924.1406,390.2813 Q3924.1406,389.9063 3924.4063,389.6719 Q3924.6719,389.4375 3925.2813,389.4375 L3930.4219,389.4375 Q3931.0313,389.4375 3931.2969,389.6719 Q3931.5625,389.9063 3931.5625,390.2813 Q3931.5625,390.6719 3931.2969,390.9063 Q3931.0313,391.1406 3930.4219,391.1406 L3928.7031,391.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="3948.25" y="400.2285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3733" x2="4271" y1="410.5" y2="410.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="3733" x2="4271" y1="418.5" y2="418.5"/><ellipse cx="3743" cy="432.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="3752" y="437.0332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="3743" cy="450.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="3752" y="454.6426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="3743" cy="468.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="3752" y="472.252">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="146" fill="#F1F1F1" height="100.8281" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="693" x="3003.5" y="378.5"/><ellipse cx="3309.25" cy="394.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3312.0156,390.375 Q3312.1719,390.1563 3312.3594,390.0469 Q3312.5469,389.9375 3312.7656,389.9375 Q3313.1406,389.9375 3313.375,390.2031 Q3313.6094,390.4531 3313.6094,391.0625 L3313.6094,392.5156 Q3313.6094,393.125 3313.375,393.3906 Q3313.1406,393.6563 3312.7656,393.6563 Q3312.4219,393.6563 3312.2188,393.4531 Q3312.0156,393.2656 3311.9063,392.75 Q3311.8594,392.3906 3311.6719,392.2031 Q3311.3438,391.8281 3310.7344,391.6094 Q3310.125,391.3906 3309.5,391.3906 Q3308.7344,391.3906 3308.0938,391.7188 Q3307.4688,392.0469 3306.9688,392.7969 Q3306.4844,393.5469 3306.4844,394.5781 L3306.4844,395.6719 Q3306.4844,396.9063 3307.375,397.7344 Q3308.2656,398.5469 3309.8594,398.5469 Q3310.7969,398.5469 3311.4531,398.2969 Q3311.8438,398.1406 3312.2656,397.7031 Q3312.5313,397.4375 3312.6719,397.3594 Q3312.8281,397.2813 3313.0313,397.2813 Q3313.3594,397.2813 3313.6094,397.5469 Q3313.875,397.7969 3313.875,398.1406 Q3313.875,398.4844 3313.5313,398.8906 Q3313.0313,399.4688 3312.2344,399.7969 Q3311.1563,400.25 3309.8594,400.25 Q3308.3438,400.25 3307.1406,399.625 Q3306.1563,399.125 3305.4688,398.0625 Q3304.7813,396.9844 3304.7813,395.7031 L3304.7813,394.5469 Q3304.7813,393.2188 3305.3906,392.0781 Q3306.0156,390.9219 3307.1094,390.3125 Q3308.2031,389.6875 3309.4375,389.6875 Q3310.1719,389.6875 3310.8125,389.8594 Q3311.4688,390.0156 3312.0156,390.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="3329.75" y="400.2285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3004.5" x2="3695.5" y1="410.5" y2="410.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3004.5" x2="3695.5" y1="418.5" y2="418.5"/><ellipse cx="3014.5" cy="432.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3023.5" y="437.0332">SqlProvider(connection : string)</text><polygon fill="#FFFF44" points="3014.5,445.4141,3018.5,449.4141,3014.5,453.4141,3010.5,449.4141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="667" x="3023.5" y="454.6426">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElement[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3014.5,463.0234,3018.5,467.0234,3014.5,471.0234,3010.5,467.0234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3023.5" y="472.252">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="153" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3052.5" y="103.5"/><ellipse cx="3157.25" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3160.0156,115.375 Q3160.1719,115.1563 3160.3594,115.0469 Q3160.5469,114.9375 3160.7656,114.9375 Q3161.1406,114.9375 3161.375,115.2031 Q3161.6094,115.4531 3161.6094,116.0625 L3161.6094,117.5156 Q3161.6094,118.125 3161.375,118.3906 Q3161.1406,118.6563 3160.7656,118.6563 Q3160.4219,118.6563 3160.2188,118.4531 Q3160.0156,118.2656 3159.9063,117.75 Q3159.8594,117.3906 3159.6719,117.2031 Q3159.3438,116.8281 3158.7344,116.6094 Q3158.125,116.3906 3157.5,116.3906 Q3156.7344,116.3906 3156.0938,116.7188 Q3155.4688,117.0469 3154.9688,117.7969 Q3154.4844,118.5469 3154.4844,119.5781 L3154.4844,120.6719 Q3154.4844,121.9063 3155.375,122.7344 Q3156.2656,123.5469 3157.8594,123.5469 Q3158.7969,123.5469 3159.4531,123.2969 Q3159.8438,123.1406 3160.2656,122.7031 Q3160.5313,122.4375 3160.6719,122.3594 Q3160.8281,122.2813 3161.0313,122.2813 Q3161.3594,122.2813 3161.6094,122.5469 Q3161.875,122.7969 3161.875,123.1406 Q3161.875,123.4844 3161.5313,123.8906 Q3161.0313,124.4688 3160.2344,124.7969 Q3159.1563,125.25 3157.8594,125.25 Q3156.3438,125.25 3155.1406,124.625 Q3154.1563,124.125 3153.4688,123.0625 Q3152.7813,121.9844 3152.7813,120.7031 L3152.7813,119.5469 Q3152.7813,118.2188 3153.3906,117.0781 Q3154.0156,115.9219 3155.1094,115.3125 Q3156.2031,114.6875 3157.4375,114.6875 Q3158.1719,114.6875 3158.8125,114.8594 Q3159.4688,115.0156 3160.0156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="3177.75" y="125.2285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3053.5" x2="3430.5" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3053.5" x2="3430.5" y1="143.5" y2="143.5"/><ellipse cx="3063.5" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3072.5" y="162.0332">LeakedPasswordProvider(configuration : IConfiguration)</text></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="164" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="2654" y="95"/><ellipse cx="2758.75" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2761.5156,106.875 Q2761.6719,106.6563 2761.8594,106.5469 Q2762.0469,106.4375 2762.2656,106.4375 Q2762.6406,106.4375 2762.875,106.7031 Q2763.1094,106.9531 2763.1094,107.5625 L2763.1094,109.0156 Q2763.1094,109.625 2762.875,109.8906 Q2762.6406,110.1563 2762.2656,110.1563 Q2761.9219,110.1563 2761.7188,109.9531 Q2761.5156,109.7656 2761.4063,109.25 Q2761.3594,108.8906 2761.1719,108.7031 Q2760.8438,108.3281 2760.2344,108.1094 Q2759.625,107.8906 2759,107.8906 Q2758.2344,107.8906 2757.5938,108.2188 Q2756.9688,108.5469 2756.4688,109.2969 Q2755.9844,110.0469 2755.9844,111.0781 L2755.9844,112.1719 Q2755.9844,113.4063 2756.875,114.2344 Q2757.7656,115.0469 2759.3594,115.0469 Q2760.2969,115.0469 2760.9531,114.7969 Q2761.3438,114.6406 2761.7656,114.2031 Q2762.0313,113.9375 2762.1719,113.8594 Q2762.3281,113.7813 2762.5313,113.7813 Q2762.8594,113.7813 2763.1094,114.0469 Q2763.375,114.2969 2763.375,114.6406 Q2763.375,114.9844 2763.0313,115.3906 Q2762.5313,115.9688 2761.7344,116.2969 Q2760.6563,116.75 2759.3594,116.75 Q2757.8438,116.75 2756.6406,116.125 Q2755.6563,115.625 2754.9688,114.5625 Q2754.2813,113.4844 2754.2813,112.2031 L2754.2813,111.0469 Q2754.2813,109.7188 2754.8906,108.5781 Q2755.5156,107.4219 2756.6094,106.8125 Q2757.7031,106.1875 2758.9375,106.1875 Q2759.6719,106.1875 2760.3125,106.3594 Q2760.9688,106.5156 2761.5156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="2779.25" y="116.7285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2655" x2="2953" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="2655" x2="2953" y1="135" y2="135"/><ellipse cx="2665" cy="149.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="2674" y="153.5332">UserProvider(configuration : IConfiguration)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2662" y="163.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="2674" y="171.1426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[8a3411a7417fb47332a656be2d7e06fe]
class UserLocationProvider--><g id="elem_UserLocationProvider"><rect codeLine="170" fill="#F1F1F1" height="65.6094" id="UserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="328" x="3499" y="103.5"/><ellipse cx="3590.75" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3593.5156,115.375 Q3593.6719,115.1563 3593.8594,115.0469 Q3594.0469,114.9375 3594.2656,114.9375 Q3594.6406,114.9375 3594.875,115.2031 Q3595.1094,115.4531 3595.1094,116.0625 L3595.1094,117.5156 Q3595.1094,118.125 3594.875,118.3906 Q3594.6406,118.6563 3594.2656,118.6563 Q3593.9219,118.6563 3593.7188,118.4531 Q3593.5156,118.2656 3593.4063,117.75 Q3593.3594,117.3906 3593.1719,117.2031 Q3592.8438,116.8281 3592.2344,116.6094 Q3591.625,116.3906 3591,116.3906 Q3590.2344,116.3906 3589.5938,116.7188 Q3588.9688,117.0469 3588.4688,117.7969 Q3587.9844,118.5469 3587.9844,119.5781 L3587.9844,120.6719 Q3587.9844,121.9063 3588.875,122.7344 Q3589.7656,123.5469 3591.3594,123.5469 Q3592.2969,123.5469 3592.9531,123.2969 Q3593.3438,123.1406 3593.7656,122.7031 Q3594.0313,122.4375 3594.1719,122.3594 Q3594.3281,122.2813 3594.5313,122.2813 Q3594.8594,122.2813 3595.1094,122.5469 Q3595.375,122.7969 3595.375,123.1406 Q3595.375,123.4844 3595.0313,123.8906 Q3594.5313,124.4688 3593.7344,124.7969 Q3592.6563,125.25 3591.3594,125.25 Q3589.8438,125.25 3588.6406,124.625 Q3587.6563,124.125 3586.9688,123.0625 Q3586.2813,121.9844 3586.2813,120.7031 L3586.2813,119.5469 Q3586.2813,118.2188 3586.8906,117.0781 Q3587.5156,115.9219 3588.6094,115.3125 Q3589.7031,114.6875 3590.9375,114.6875 Q3591.6719,114.6875 3592.3125,114.8594 Q3592.9688,115.0156 3593.5156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="3611.25" y="125.2285">UserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3500" x2="3826" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="3500" x2="3826" y1="143.5" y2="143.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3507" y="154.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="302" x="3519" y="162.0332">DrToUserLocation(dr : DataRow) : UserLocation</text></g><!--MD5=[ff7ab1418574995e2d663e91c2a7d400]
class SpElement--><g id="elem_SpElement"><rect codeLine="209" fill="#F1F1F1" height="100.8281" id="SpElement" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="176" x="3262" y="609.5"/><ellipse cx="3311.75" cy="625.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3314.5156,621.375 Q3314.6719,621.1563 3314.8594,621.0469 Q3315.0469,620.9375 3315.2656,620.9375 Q3315.6406,620.9375 3315.875,621.2031 Q3316.1094,621.4531 3316.1094,622.0625 L3316.1094,623.5156 Q3316.1094,624.125 3315.875,624.3906 Q3315.6406,624.6563 3315.2656,624.6563 Q3314.9219,624.6563 3314.7188,624.4531 Q3314.5156,624.2656 3314.4063,623.75 Q3314.3594,623.3906 3314.1719,623.2031 Q3313.8438,622.8281 3313.2344,622.6094 Q3312.625,622.3906 3312,622.3906 Q3311.2344,622.3906 3310.5938,622.7188 Q3309.9688,623.0469 3309.4688,623.7969 Q3308.9844,624.5469 3308.9844,625.5781 L3308.9844,626.6719 Q3308.9844,627.9063 3309.875,628.7344 Q3310.7656,629.5469 3312.3594,629.5469 Q3313.2969,629.5469 3313.9531,629.2969 Q3314.3438,629.1406 3314.7656,628.7031 Q3315.0313,628.4375 3315.1719,628.3594 Q3315.3281,628.2813 3315.5313,628.2813 Q3315.8594,628.2813 3316.1094,628.5469 Q3316.375,628.7969 3316.375,629.1406 Q3316.375,629.4844 3316.0313,629.8906 Q3315.5313,630.4688 3314.7344,630.7969 Q3313.6563,631.25 3312.3594,631.25 Q3310.8438,631.25 3309.6406,630.625 Q3308.6563,630.125 3307.9688,629.0625 Q3307.2813,627.9844 3307.2813,626.7031 L3307.2813,625.5469 Q3307.2813,624.2188 3307.8906,623.0781 Q3308.5156,621.9219 3309.6094,621.3125 Q3310.7031,620.6875 3311.9375,620.6875 Q3312.6719,620.6875 3313.3125,620.8594 Q3313.9688,621.0156 3314.5156,621.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="3332.25" y="631.2285">SpElement</text><line style="stroke:#181818;stroke-width:0.5;" x1="3263" x2="3437" y1="641.5" y2="641.5"/><ellipse cx="3273" cy="655.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="3282" y="660.0332">Key : string,</text><ellipse cx="3273" cy="673.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="3282" y="677.6426">Value : object,</text><ellipse cx="3273" cy="691.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="3282" y="695.252">ValueType : SqlDbType</text><line style="stroke:#181818;stroke-width:0.5;" x1="3263" x2="3437" y1="702.3281" y2="702.3281"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="192" fill="#F1F1F1" height="153.6563" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="580" x="4375" y="59.5"/><ellipse cx="4635.25" cy="75.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4638.0156,71.375 Q4638.1719,71.1563 4638.3594,71.0469 Q4638.5469,70.9375 4638.7656,70.9375 Q4639.1406,70.9375 4639.375,71.2031 Q4639.6094,71.4531 4639.6094,72.0625 L4639.6094,73.5156 Q4639.6094,74.125 4639.375,74.3906 Q4639.1406,74.6563 4638.7656,74.6563 Q4638.4219,74.6563 4638.2188,74.4531 Q4638.0156,74.2656 4637.9063,73.75 Q4637.8594,73.3906 4637.6719,73.2031 Q4637.3438,72.8281 4636.7344,72.6094 Q4636.125,72.3906 4635.5,72.3906 Q4634.7344,72.3906 4634.0938,72.7188 Q4633.4688,73.0469 4632.9688,73.7969 Q4632.4844,74.5469 4632.4844,75.5781 L4632.4844,76.6719 Q4632.4844,77.9063 4633.375,78.7344 Q4634.2656,79.5469 4635.8594,79.5469 Q4636.7969,79.5469 4637.4531,79.2969 Q4637.8438,79.1406 4638.2656,78.7031 Q4638.5313,78.4375 4638.6719,78.3594 Q4638.8281,78.2813 4639.0313,78.2813 Q4639.3594,78.2813 4639.6094,78.5469 Q4639.875,78.7969 4639.875,79.1406 Q4639.875,79.4844 4639.5313,79.8906 Q4639.0313,80.4688 4638.2344,80.7969 Q4637.1563,81.25 4635.8594,81.25 Q4634.3438,81.25 4633.1406,80.625 Q4632.1563,80.125 4631.4688,79.0625 Q4630.7813,77.9844 4630.7813,76.7031 L4630.7813,75.5469 Q4630.7813,74.2188 4631.3906,73.0781 Q4632.0156,71.9219 4633.1094,71.3125 Q4634.2031,70.6875 4635.4375,70.6875 Q4636.1719,70.6875 4636.8125,70.8594 Q4637.4688,71.0156 4638.0156,71.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="4655.75" y="81.2285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="4376" x2="4954" y1="91.5" y2="91.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="4376" x2="4954" y1="99.5" y2="99.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="4383" y="110.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="253" x="4395" y="118.0332">ComputeHash(password : string) : string</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="4383" y="128.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="321" x="4395" y="135.6426">HashPassword(password : salt, salt : string) : string</text><ellipse cx="4386" cy="149.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="4395" y="153.252">GetSalt(saltLength : int) : string</text><ellipse cx="4386" cy="166.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="554" x="4395" y="170.8613">GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string</text><ellipse cx="4386" cy="184.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="4395" y="188.4707">GetHotp(key : string, counter : long) : string</text><ellipse cx="4386" cy="201.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="4395" y="206.0801">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="202" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4990" y="103.5"/><ellipse cx="5139.25" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M5142.0156,115.375 Q5142.1719,115.1563 5142.3594,115.0469 Q5142.5469,114.9375 5142.7656,114.9375 Q5143.1406,114.9375 5143.375,115.2031 Q5143.6094,115.4531 5143.6094,116.0625 L5143.6094,117.5156 Q5143.6094,118.125 5143.375,118.3906 Q5143.1406,118.6563 5142.7656,118.6563 Q5142.4219,118.6563 5142.2188,118.4531 Q5142.0156,118.2656 5141.9063,117.75 Q5141.8594,117.3906 5141.6719,117.2031 Q5141.3438,116.8281 5140.7344,116.6094 Q5140.125,116.3906 5139.5,116.3906 Q5138.7344,116.3906 5138.0938,116.7188 Q5137.4688,117.0469 5136.9688,117.7969 Q5136.4844,118.5469 5136.4844,119.5781 L5136.4844,120.6719 Q5136.4844,121.9063 5137.375,122.7344 Q5138.2656,123.5469 5139.8594,123.5469 Q5140.7969,123.5469 5141.4531,123.2969 Q5141.8438,123.1406 5142.2656,122.7031 Q5142.5313,122.4375 5142.6719,122.3594 Q5142.8281,122.2813 5143.0313,122.2813 Q5143.3594,122.2813 5143.6094,122.5469 Q5143.875,122.7969 5143.875,123.1406 Q5143.875,123.4844 5143.5313,123.8906 Q5143.0313,124.4688 5142.2344,124.7969 Q5141.1563,125.25 5139.8594,125.25 Q5138.3438,125.25 5137.1406,124.625 Q5136.1563,124.125 5135.4688,123.0625 Q5134.7813,121.9844 5134.7813,120.7031 L5134.7813,119.5469 Q5134.7813,118.2188 5135.3906,117.0781 Q5136.0156,115.9219 5137.1094,115.3125 Q5138.2031,114.6875 5139.4375,114.6875 Q5140.1719,114.6875 5140.8125,114.8594 Q5141.4688,115.0156 5142.0156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="5159.75" y="125.2285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4991" x2="5377" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="4991" x2="5377" y1="143.5" y2="143.5"/><ellipse cx="5001" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="5010" y="162.0332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="250" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="1144.5" y="1002"/><ellipse cx="1191.25" cy="1018" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1194.0156,1013.875 Q1194.1719,1013.6563 1194.3594,1013.5469 Q1194.5469,1013.4375 1194.7656,1013.4375 Q1195.1406,1013.4375 1195.375,1013.7031 Q1195.6094,1013.9531 1195.6094,1014.5625 L1195.6094,1016.0156 Q1195.6094,1016.625 1195.375,1016.8906 Q1195.1406,1017.1563 1194.7656,1017.1563 Q1194.4219,1017.1563 1194.2188,1016.9531 Q1194.0156,1016.7656 1193.9063,1016.25 Q1193.8594,1015.8906 1193.6719,1015.7031 Q1193.3438,1015.3281 1192.7344,1015.1094 Q1192.125,1014.8906 1191.5,1014.8906 Q1190.7344,1014.8906 1190.0938,1015.2188 Q1189.4688,1015.5469 1188.9688,1016.2969 Q1188.4844,1017.0469 1188.4844,1018.0781 L1188.4844,1019.1719 Q1188.4844,1020.4063 1189.375,1021.2344 Q1190.2656,1022.0469 1191.8594,1022.0469 Q1192.7969,1022.0469 1193.4531,1021.7969 Q1193.8438,1021.6406 1194.2656,1021.2031 Q1194.5313,1020.9375 1194.6719,1020.8594 Q1194.8281,1020.7813 1195.0313,1020.7813 Q1195.3594,1020.7813 1195.6094,1021.0469 Q1195.875,1021.2969 1195.875,1021.6406 Q1195.875,1021.9844 1195.5313,1022.3906 Q1195.0313,1022.9688 1194.2344,1023.2969 Q1193.1563,1023.75 1191.8594,1023.75 Q1190.3438,1023.75 1189.1406,1023.125 Q1188.1563,1022.625 1187.4688,1021.5625 Q1186.7813,1020.4844 1186.7813,1019.2031 L1186.7813,1018.0469 Q1186.7813,1016.7188 1187.3906,1015.5781 Q1188.0156,1014.4219 1189.1094,1013.8125 Q1190.2031,1013.1875 1191.4375,1013.1875 Q1192.1719,1013.1875 1192.8125,1013.3594 Q1193.4688,1013.5156 1194.0156,1013.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1211.75" y="1023.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="1145.5" x2="1306.5" y1="1034" y2="1034"/><ellipse cx="1155.5" cy="1048.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1164.5" y="1052.5332">Email : string</text><ellipse cx="1155.5" cy="1065.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1164.5" y="1070.1426">FirstName : string</text><ellipse cx="1155.5" cy="1083.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1164.5" y="1087.752">LastName : string</text><ellipse cx="1155.5" cy="1101.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1164.5" y="1105.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1145.5" x2="1306.5" y1="1112.4375" y2="1112.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="21" d="M1126.5,545 C1126.5,545 1126.5,591.67 1126.5,591.67 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1126.5,532,1122.5,538,1126.5,544,1130.5,538,1126.5,532" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1137.3391" y="553.9885">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1088.975" y="581.3093">1</text></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="22" d="M653,545 C653,545 653,609.34 653,609.34 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="653,532,649,538,653,544,657,538,653,532" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="627.5867" y="553.9885">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="660.2734" y="598.6229">1</text></g><!--MD5=[f6beab00d15f8b13a3171d7a5aeb0bdd]
link UserController to UserCreate--><g id="link_UserController_UserCreate"><path codeLine="24" d="M961,532.05 C961,532.05 961,826.6 961,826.6 " fill="none" id="UserController-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="961,831.6,965,822.6,961,826.6,957,822.6,961,831.6" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="959.168" y="554.0423">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="953.3109" y="821.0176">1</text></g><!--MD5=[b99f2b93b0ba1d8f77d1dff39826eaa1]
link UserController to UserLogin--><g id="link_UserController_UserLogin"><path codeLine="25" d="M1043.75,532.19 C1043.75,628.68 1043.75,758 1043.75,758 C1043.75,758 1282.67,758 1282.67,758 C1282.67,758 1282.67,818.32 1282.67,818.32 " fill="none" id="UserController-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1282.67,823.32,1286.67,814.32,1282.67,818.32,1278.67,814.32,1282.67,823.32" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1047.784" y="553.8458">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1271.3919" y="812.5979">1</text></g><!--MD5=[fc4d4c58227c704dd75699b2989cdd99]
link UserController to VerifyCredentials--><g id="link_UserController_VerifyCredentials"><path codeLine="26" d="M1033.25,532.01 C1033.25,650.23 1033.25,828 1033.25,828 C1033.25,828 1057.91,828 1057.91,828 " fill="none" id="UserController-to-VerifyCredentials" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1062.91,828,1053.91,824,1057.91,828,1053.91,832,1062.91,828" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1036.9496" y="553.9992">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1047.8611" y="820.5805">1</text></g><!--MD5=[11e5b9a9bd37746b63b8fb5dbd005d0d]
link UserController to User--><g id="link_UserController_User"><path codeLine="27" d="M1038.5,532.19 C1038.5,642.89 1038.5,803 1038.5,803 C1038.5,803 1401.95,803 1401.95,803 " fill="none" id="UserController-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1406.95,803,1397.95,799,1401.95,803,1397.95,807,1406.95,803" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1042.1484" y="553.8458">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1391.879" y="794.056">1</text></g><!--MD5=[75cbc5dcd27fd661cabdc1d644f8c2e7]
link UserController to UserToken--><g id="link_UserController_UserToken"><path codeLine="28" d="M748.75,532.05 C748.75,532.05 748.75,809.33 748.75,809.33 " fill="none" id="UserController-to-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="748.75,814.33,752.75,805.33,748.75,809.33,744.75,805.33,748.75,814.33" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="730.6676" y="554.0423">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="746.5664" y="803.6115">1</text></g><!--MD5=[058fbdb5b39b0d43ca4065519acd5c0f]
link UserController to UserLocation--><g id="link_UserController_UserLocation"><path codeLine="29" d="M1204.23,528 C1753.17,528 2829,528 2829,528 C2829,528 2829,782.69 2829,782.69 " fill="none" id="UserController-to-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2829,787.69,2833,778.69,2829,782.69,2825,778.69,2829,787.69" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1211.6768" y="527.6264">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2821.6664" y="777.0871">1</text></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="104" d="M1056,728.26 C1056,787.9 1056,865 1056,865 C1056,865 1033.01,865 1033.01,865 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1028.01,865,1037.01,869,1033.01,865,1037.01,861,1028.01,865" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1033.5383" y="744.9788">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1036.1627" y="861.613">1</text></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="105" d="M1327.33,728.26 C1327.33,728.26 1327.33,818.31 1327.33,818.31 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1327.33,823.31,1331.33,814.31,1327.33,818.31,1323.33,814.31,1327.33,823.31" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1310.5156" y="749.6351">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1323.4487" y="812.5862">1</text></g><!--MD5=[dded4780050378040eec2375ee9f8cef]
link IUserManager to UserLocation--><g id="link_IUserManager_UserLocation"><path codeLine="106" d="M1682,728.06 C1682,760.78 1682,793 1682,793 C1682,793 2741.05,793 2741.05,793 " fill="none" id="IUserManager-to-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2746.05,793,2737.05,789,2741.05,793,2737.05,797,2746.05,793" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1701.7609" y="749.4145">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2731.6207" y="783.65">1</text></g><!--MD5=[bda616a4ec88bb93f38d43595a1d9abc]
link IUserManager to VerifyCredentials--><g id="link_IUserManager_VerifyCredentials"><path codeLine="107" d="M1133,728.26 C1133,728.26 1133,818.31 1133,818.31 " fill="none" id="IUserManager-to-VerifyCredentials" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1133,823.31,1137,814.31,1133,818.31,1129,814.31,1133,823.31" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1096.1453" y="749.6351">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1125.4203" y="812.5862">1</text></g><!--MD5=[9ee9fe879b30b50d6d040f556cdccece]
link IUserManager to User--><g id="link_IUserManager_User"><path codeLine="108" d="M1491,728.26 C1491,728.26 1491,791.69 1491,791.69 " fill="none" id="IUserManager-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1491,796.69,1495,787.69,1491,791.69,1487,787.69,1491,796.69" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1491.0641" y="749.6351">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1483.6391" y="786.3314">1</text></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="109" d="M1762.75,266.24 C1762.75,266.24 1762.75,571.76 1762.75,571.76 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1769.75,571.76,1762.75,591.76,1755.75,571.76,1769.75,571.76" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d484ee4b213f86a79b7b13bd52fde3a]
link MessageManager to IMessageManager--><g id="link_MessageManager_IMessageManager"><path codeLine="110" d="M1286,204.71 C1286,204.71 1286,367.39 1286,367.39 " fill="none" id="MessageManager-to-IMessageManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1293,367.39,1286,387.39,1279,367.39,1293,367.39" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="112" d="M2240.5,279.07 C2240.5,279.07 2240.5,334.21 2240.5,334.21 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2240.5,266.07,2236.5,272.07,2240.5,278.07,2244.5,272.07,2240.5,266.07" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2252.0859" y="287.9495">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2232.0656" y="323.533">1</text></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="113" d="M2509.16,231 C2509.16,231 4288.88,231 4288.88,231 C4288.88,231 4288.88,495.47 4288.88,609.1 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2496.16,231,2502.16,235,2508.16,231,2502.16,227,2496.16,231" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2504.1427" y="229.7118">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="4292.6811" y="598.7156">1</text></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="114" d="M2509.29,249 C2509.29,249 2607,249 2607,249 C2607,249 2607,344.02 2607,395.99 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2496.29,249,2502.29,253,2508.29,249,2502.29,245,2496.29,249" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2504.2745" y="247.9649">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2566.8969" y="385.1033">1</text></g><!--MD5=[f1b914c86bbf4264254e7be00f738a27]
reverse link UserManager to IMessageManager--><g id="link_UserManager_IMessageManager"><path codeLine="115" d="M1552.25,279.07 C1552.25,279.07 1552.25,387.34 1552.25,387.34 " fill="none" id="UserManager-backto-IMessageManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1552.25,266.07,1548.25,272.07,1552.25,278.07,1556.25,272.07,1552.25,266.07" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1521.8957" y="287.9495">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1555.3117" y="376.6212">1</text></g><!--MD5=[b10f378a107f0b1cd3f676caa667fcd6]
link UserManager to DbUser--><g id="link_UserManager_DbUser"><path codeLine="117" d="M1975.5,266.24 C1975.5,266.24 1975.5,586.76 1975.5,586.76 " fill="none" id="UserManager-to-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1975.5,591.76,1979.5,582.76,1975.5,586.76,1971.5,582.76,1975.5,591.76" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1970.8125" y="287.6993">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1957.6719" y="580.933">1</text></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="119" d="M453.5,506.24 C453.5,506.24 453.5,589.36 453.5,589.36 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="460.5,589.36,453.5,609.36,446.5,589.36,460.5,589.36" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[83d2da606a637cbfe390f11661f915db]
link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="120" d="M679.67,710.67 C679.67,710.67 679.67,809.2 679.67,809.2 " fill="none" id="ITokenManager-to-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="679.67,814.2,683.67,805.2,679.67,809.2,675.67,805.2,679.67,814.2" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="689.0918" y="731.7157">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="667.772" y="803.4632">1</text></g><!--MD5=[79cea14ce7bae1b938676bb2dfff7270]
link ITokenManager to User--><g id="link_ITokenManager_User"><path codeLine="121" d="M704.83,710.86 C704.83,754.02 704.83,809 704.83,809 C704.83,809 1401.87,809 1401.87,809 " fill="none" id="ITokenManager-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1406.87,809,1397.87,805,1401.87,809,1397.87,813,1406.87,809" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="717.4754" y="731.9301">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1392.0655" y="818.2337">1</text></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="123" d="M4322.62,178.02 C4322.62,178.02 4322.62,589.4 4322.62,589.4 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="4329.63,589.4,4322.62,609.4,4315.63,589.39,4329.63,589.4" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="127" d="M4305.75,178.02 C4305.75,178.02 4305.75,589.4 4305.75,589.4 " fill="none" id="UserLocationManager-to-IUserLocationManager-1" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="4312.75,589.4,4305.75,609.4,4298.75,589.39,4312.75,589.4" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="124" d="M4009.67,191.1 C4009.67,191.1 4009.67,378.47 4009.67,378.47 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="4009.67,178.1,4005.67,184.1,4009.67,190.1,4013.67,184.1,4009.67,178.1" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3985.6388" y="199.8211">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="4003.2564" y="367.7711">1</text></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="128" d="M4140.83,191.1 C4140.83,191.1 4140.83,378.47 4140.83,378.47 " fill="none" id="UserLocationManager-backto-IUserLocationProvider-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="4140.83,178.1,4136.83,184.1,4140.83,190.1,4144.83,184.1,4140.83,178.1" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="4138.5222" y="199.8211">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="4152.8608" y="367.7711">1</text></g><!--MD5=[5d20175c5fe60285932eacfa6ee8152d]
link IUserLocationManager to UserLocation--><g id="link_IUserLocationManager_UserLocation"><path codeLine="125" d="M4205,710.69 C4205,778.69 4205,891 4205,891 C4205,891 2916.72,891 2916.72,891 " fill="none" id="IUserLocationManager-to-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2911.72,891,2920.72,895,2916.72,891,2920.72,887,2911.72,891" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="4197.5516" y="731.7383">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2919.399" y="890.1292">1</text></g><!--MD5=[54515f07698f5b2152d8c654d2195fb9]
link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="177" d="M2080.5,523.62 C2080.5,523.62 2080.5,586.68 2080.5,586.68 " fill="none" id="IUserProvider-to-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2080.5,591.68,2084.5,582.68,2080.5,586.68,2076.5,582.68,2080.5,591.68" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2059.8719" y="544.9902">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2074.1188" y="581.3203">1</text></g><!--MD5=[bebf74b03ae186b0c114f43b31b141a5]
link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="178" d="M3833.5,479.81 C3833.5,589.77 3833.5,840 3833.5,840 C3833.5,840 2916.63,840 2916.63,840 " fill="none" id="IUserLocationProvider-to-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2911.63,840,2920.63,844,2916.63,840,2920.63,836,2911.63,840" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3804.4625" y="500.8737">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2919.5701" y="834.485">1</text></g><!--MD5=[b277768c59baede30d8d76cb5d520459]
link UserLocationProvider to IUserLocationProvider--><g id="link_UserLocationProvider_IUserLocationProvider"><path codeLine="179" d="M3779.5,169.77 C3779.5,169.77 3779.5,358.39 3779.5,358.39 " fill="none" id="UserLocationProvider-to-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3786.5,358.39,3779.5,378.39,3772.5,358.39,3786.5,358.39" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="181" d="M3052.23,137 C3001.76,137 2961,137 2961,137 C2961,137 2961,375.79 2961,375.79 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2968,375.79,2961,395.79,2954,375.79,2968,375.79" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="182" d="M3242,169.77 C3242,169.77 3242,358.39 3242,358.39 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3249,358.39,3242,378.39,3235,358.39,3249,358.39" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="184" d="M2653.81,137 C2581.6,137 2510.5,137 2510.5,137 C2510.5,137 2510.5,314.2 2510.5,314.2 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2517.5,314.2,2510.5,334.2,2503.5,314.2,2517.5,314.2" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="185" d="M2954.03,174 C2994.84,174 3028,174 3028,174 C3028,174 3028,358.32 3028,358.32 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3035,358.32,3028,378.32,3021,358.32,3035,358.32" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1c3b6c3bff29ae13800513a76cf51c7e]
link UserLocationProvider to SqlProvider--><g id="link_UserLocationProvider_SqlProvider"><path codeLine="186" d="M3597.75,169.77 C3597.75,169.77 3597.75,358.39 3597.75,358.39 " fill="none" id="UserLocationProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3604.75,358.39,3597.75,378.39,3590.75,358.39,3604.75,358.39" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f38462d5a69f1e7a321ad47f950d53fd]
link SqlProvider to SpElement--><g id="link_SqlProvider_SpElement"><path codeLine="188" d="M3350,479.69 C3350,479.69 3350,604.42 3350,604.42 " fill="none" id="SqlProvider-to-SpElement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="3350,609.42,3354,600.42,3350,604.42,3346,600.42,3350,609.42" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3342.5516" y="500.7383">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="3344.6484" y="598.7141">*</text></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="217" d="M1406.93,925 C1345.45,925 1272.75,925 1272.75,925 C1272.75,925 1272.75,981.74 1272.75,981.74 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1279.75,981.74,1272.75,1001.74,1265.75,981.74,1279.75,981.74" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="218" d="M961,898.25 C961,954.17 961,1061 961,1061 C961,1061 1124.33,1061 1124.33,1061 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1124.33,1054,1144.33,1061,1124.33,1068,1124.33,1054" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="220" d="M2071,728.26 C2071,787.9 2071,865 2071,865 C2071,865 1595.03,865 1595.03,865 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1595.03,872,1575.03,865,1595.03,858,1595.03,872" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2ed4e8a90e2d3d4bfb8e612d16632b55]
@startuml API class diagram

top to bottom direction
skinparam linetype ortho
'Controllers'

class UserController {
    -_userManager{readonly} : IUserManager
    -_tokenManager{readonly} : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +CreateAsync(userCreate : UserCreate) : Task<ActionResult>
    +LoginAsync(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromTokenAsync() : Task<ActionResult<User>>
    +VerificationLoginAsync(verifyCredentials : VerifyCredentials) : Task<ActionResult<UserToken>>
    +VerifyUserRegisterAsync(verifyCredentials : VerifyCredentials) : Task<ActionResult>
    -GetUserLocation() : UserLocation
}

'Controllers mappings' 

UserController "1" o- - "1" IUserManager
UserController "1" o- - "1" ITokenManager

UserController "1" - -> "1" UserCreate
UserController "1" - -> "1" UserLogin
UserController "1" - -> "1" VerifyCredentials
UserController "1" - -> "1" User
UserController "1" - -> "1" UserToken
UserController "1" - -> "1" UserLocation


'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(verifyCredentials : VerifyCredentials, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(verifyCredentials : VerifyCredentials, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessageAsync(to : string, otp : string) : Task<bool>
    +SendLoginRegistrationMessageAsync(to : string, key : string) : Task<bool>
}

class TokenManager {
    -_configuration{readonly} : IConfiguration
    -_logger{readonly} : ILogger<TokenManager>
    -_secret{readonly} : string
    - -
    +TokenManager(configuration : IConfiguration, logger : ILogger<TokenManager>)
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider{readonly} : IUserProvider
    -_leakedPasswordProvider{readonly} : ILeakedPasswordProvider;
    -_userLocationManager{readonly} : IUserLocationManager
    -_messageManager{readonly} : IMessageManager
    -_logger{readonly} : ILogger<UserManager>
    -_configuration{readonly} : IConfiguration
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    -CheckPasswordLeakedForUserAsync(password : string) : Task<bool>
    -IsUserNotVerifiedAsync(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLockedAsync(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider{readonly} : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : IUserLocationProvider)
}

class MessageManager {
    -_messageService{readonly} : IMessageService
    -_messageProvider{readonly} : IMessageProvider
    -_logger : ILogger<MessageManager>
    - -
    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider,
    logger : ILogger<MessageManager>)
}


'Managers mappings'

IUserManager "1" - -> "1" UserCreate
IUserManager "1" - -> "1" UserLogin
IUserManager "1" - -> "1" UserLocation
IUserManager "1" - -> "1" VerifyCredentials
IUserManager "1" - -> "1" User
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager "1" o- - "1" IUserProvider
UserManager "1" o- - "1" IUserLocationManager
UserManager "1" o- - "1" ILeakedPasswordProvider
UserManager "1" o- - "1" IMessageManager

UserManager "1" - -> "1" DbUser

TokenManager .-|> ITokenManager
ITokenManager "1" - -> "1" UserToken
ITokenManager "1" - -> "1" User

UserLocationManager .- -|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider
IUserLocationManager "1" - -> "1" UserLocation

UserLocationManager .- -|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTriesAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocationAsync(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCodeAsync(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElement[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}

class UserLocationProvider{
    -DrToUserLocation(dr : DataRow) : UserLocation
} 


'Providers mappings'

IUserProvider "1" - -> "1" DbUser
IUserLocationProvider "1" - -> "1" UserLocation  
UserLocationProvider .-|> IUserLocationProvider

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider
UserLocationProvider - -|> SqlProvider

SqlProvider "1" - -> "*" SpElement

'Utility'

class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Models'

class SpElement{
    +Key : string,
    +Value : object,
    +ValueType : SqlDbType
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class VerifyCredentials {
    +Email : string
    +Password : string
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction
skinparam linetype ortho

class UserController {
    -_userManager{readonly} : IUserManager
    -_tokenManager{readonly} : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +CreateAsync(userCreate : UserCreate) : Task<ActionResult>
    +LoginAsync(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromTokenAsync() : Task<ActionResult<User>>
    +VerificationLoginAsync(verifyCredentials : VerifyCredentials) : Task<ActionResult<UserToken>>
    +VerifyUserRegisterAsync(verifyCredentials : VerifyCredentials) : Task<ActionResult>
    -GetUserLocation() : UserLocation
}


UserController "1" o- - "1" IUserManager
UserController "1" o- - "1" ITokenManager

UserController "1" - -> "1" UserCreate
UserController "1" - -> "1" UserLogin
UserController "1" - -> "1" VerifyCredentials
UserController "1" - -> "1" User
UserController "1" - -> "1" UserToken
UserController "1" - -> "1" UserLocation



Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(verifyCredentials : VerifyCredentials, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(verifyCredentials : VerifyCredentials, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessageAsync(to : string, otp : string) : Task<bool>
    +SendLoginRegistrationMessageAsync(to : string, key : string) : Task<bool>
}

class TokenManager {
    -_configuration{readonly} : IConfiguration
    -_logger{readonly} : ILogger<TokenManager>
    -_secret{readonly} : string
    - -
    +TokenManager(configuration : IConfiguration, logger : ILogger<TokenManager>)
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider{readonly} : IUserProvider
    -_leakedPasswordProvider{readonly} : ILeakedPasswordProvider;
    -_userLocationManager{readonly} : IUserLocationManager
    -_messageManager{readonly} : IMessageManager
    -_logger{readonly} : ILogger<UserManager>
    -_configuration{readonly} : IConfiguration
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    -CheckPasswordLeakedForUserAsync(password : string) : Task<bool>
    -IsUserNotVerifiedAsync(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLockedAsync(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider{readonly} : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : IUserLocationProvider)
}

class MessageManager {
    -_messageService{readonly} : IMessageService
    -_messageProvider{readonly} : IMessageProvider
    -_logger : ILogger<MessageManager>
    - -
    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider,
    logger : ILogger<MessageManager>)
}



IUserManager "1" - -> "1" UserCreate
IUserManager "1" - -> "1" UserLogin
IUserManager "1" - -> "1" UserLocation
IUserManager "1" - -> "1" VerifyCredentials
IUserManager "1" - -> "1" User
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager "1" o- - "1" IUserProvider
UserManager "1" o- - "1" IUserLocationManager
UserManager "1" o- - "1" ILeakedPasswordProvider
UserManager "1" o- - "1" IMessageManager

UserManager "1" - -> "1" DbUser

TokenManager .-|> ITokenManager
ITokenManager "1" - -> "1" UserToken
ITokenManager "1" - -> "1" User

UserLocationManager .- -|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider
IUserLocationManager "1" - -> "1" UserLocation

UserLocationManager .- -|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTriesAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocationAsync(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCodeAsync(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElement[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}

class UserLocationProvider{
    -DrToUserLocation(dr : DataRow) : UserLocation
} 



IUserProvider "1" - -> "1" DbUser
IUserLocationProvider "1" - -> "1" UserLocation  
UserLocationProvider .-|> IUserLocationProvider

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider
UserLocationProvider - -|> SqlProvider

SqlProvider "1" - -> "*" SpElement


class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


class SpElement{
    +Key : string,
    +Value : object,
    +ValueType : SqlDbType
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class VerifyCredentials {
    +Email : string
    +Password : string
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>