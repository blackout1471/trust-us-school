<<<<<<< HEAD
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="987px" preserveAspectRatio="none" style="width:4656px;height:987px;background:#FFFFFF;" version="1.1" viewBox="0 0 4656 987" width="4656px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="188.875" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="736" x="575.5" y="7"/><ellipse cx="893.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M896.5156,18.875 Q896.6719,18.6563 896.8594,18.5469 Q897.0469,18.4375 897.2656,18.4375 Q897.6406,18.4375 897.875,18.6953 Q898.1094,18.9531 898.1094,19.5625 L898.1094,21.0156 Q898.1094,21.625 897.875,21.8906 Q897.6406,22.1563 897.2656,22.1563 Q896.9219,22.1563 896.7188,21.9531 Q896.5156,21.7656 896.4063,21.25 Q896.3594,20.8906 896.1719,20.7031 Q895.8438,20.3281 895.2344,20.1094 Q894.625,19.8906 894,19.8906 Q893.2344,19.8906 892.6016,20.2188 Q891.9688,20.5469 891.4766,21.2969 Q890.9844,22.0469 890.9844,23.0781 L890.9844,24.1719 Q890.9844,25.4063 891.875,26.2266 Q892.7656,27.0469 894.3594,27.0469 Q895.2969,27.0469 895.9531,26.7969 Q896.3438,26.6406 896.7656,26.2031 Q897.0313,25.9375 897.1797,25.8594 Q897.3281,25.7813 897.5313,25.7813 Q897.8594,25.7813 898.1172,26.0391 Q898.375,26.2969 898.375,26.6406 Q898.375,26.9844 898.0313,27.3906 Q897.5313,27.9688 896.7344,28.2969 Q895.6563,28.75 894.3594,28.75 Q892.8438,28.75 891.6406,28.125 Q890.6563,27.625 889.9688,26.5547 Q889.2813,25.4844 889.2813,24.2031 L889.2813,23.0469 Q889.2813,21.7188 889.8984,20.5703 Q890.5156,19.4219 891.6094,18.8047 Q892.7031,18.1875 893.9375,18.1875 Q894.6719,18.1875 895.3203,18.3516 Q895.9688,18.5156 896.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="914.25" y="28.7285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="576.5" x2="1310.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="280" x="595.5" y="57.5332">_logger{readonly} : ILogger&lt;UserController&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="595.5" y="75.1426">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="595.5" y="92.752">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="576.5" x2="1310.5" y1="99.8281" y2="99.8281"/><ellipse cx="586.5" cy="114.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="710" x="595.5" y="118.3613">UserController(logger : ILogger&lt;UserController&gt;, userManager : IUserManager, tokenManager : ITokenManager)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="595.5" y="135.9707"> </text><ellipse cx="586.5" cy="149.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="595.5" y="153.5801">Create(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586.5" cy="166.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="595.5" y="171.1895">Login(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586.5" cy="184.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="318" x="595.5" y="188.7988">GetUserFromToken() : Task&lt;ActionResult&lt;User&gt;&gt;</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="24" fill="#F1F1F1" height="100.8281" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="389" x="749" y="273.5"/><ellipse cx="893.75" cy="289.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M894.7031,286.1406 L894.7031,292.7969 L896.4219,292.7969 Q897.0313,292.7969 897.2969,293.0313 Q897.5625,293.2656 897.5625,293.6563 Q897.5625,294.0313 897.2969,294.2656 Q897.0313,294.5 896.4219,294.5 L891.2813,294.5 Q890.6719,294.5 890.4063,294.2656 Q890.1406,294.0313 890.1406,293.6406 Q890.1406,293.2656 890.4063,293.0313 Q890.6719,292.7969 891.2813,292.7969 L893,292.7969 L893,286.1406 L891.2813,286.1406 Q890.6719,286.1406 890.4063,285.9063 Q890.1406,285.6719 890.1406,285.2813 Q890.1406,284.9063 890.4063,284.6719 Q890.6719,284.4375 891.2813,284.4375 L896.4219,284.4375 Q897.0313,284.4375 897.2969,284.6719 Q897.5625,284.9063 897.5625,285.2813 Q897.5625,285.6719 897.2969,285.9063 Q897.0313,286.1406 896.4219,286.1406 L894.7031,286.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="914.25" y="295.2285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="750" x2="1137" y1="305.5" y2="305.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="750" x2="1137" y1="313.5" y2="313.5"/><ellipse cx="760" cy="327.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="363" x="769" y="332.0332">CreateUserAsync(userCreate : UserCreate) : Task&lt;User&gt;</text><ellipse cx="760" cy="345.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="310" x="769" y="349.6426">LoginAsync(userLogin : UserLogin) : Task&lt;User&gt;</text><ellipse cx="760" cy="363.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="769" y="367.252">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="30" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="220.5" y="273.5"/><ellipse cx="347.25" cy="289.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M348.2031,286.1406 L348.2031,292.7969 L349.9219,292.7969 Q350.5313,292.7969 350.7969,293.0313 Q351.0625,293.2656 351.0625,293.6563 Q351.0625,294.0313 350.7969,294.2656 Q350.5313,294.5 349.9219,294.5 L344.7813,294.5 Q344.1719,294.5 343.9063,294.2656 Q343.6406,294.0313 343.6406,293.6406 Q343.6406,293.2656 343.9063,293.0313 Q344.1719,292.7969 344.7813,292.7969 L346.5,292.7969 L346.5,286.1406 L344.7813,286.1406 Q344.1719,286.1406 343.9063,285.9063 Q343.6406,285.6719 343.6406,285.2813 Q343.6406,284.9063 343.9063,284.6719 Q344.1719,284.4375 344.7813,284.4375 L349.9219,284.4375 Q350.5313,284.4375 350.7969,284.6719 Q351.0625,284.9063 351.0625,285.2813 Q351.0625,285.6719 350.7969,285.9063 Q350.5313,286.1406 349.9219,286.1406 L348.2031,286.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="367.75" y="295.2285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="221.5" x2="583.5" y1="305.5" y2="305.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="221.5" x2="583.5" y1="313.5" y2="313.5"/><ellipse cx="231.5" cy="327.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="240.5" y="332.0332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="231.5" cy="345.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="240.5" y="349.6426">ValidateToken(token : string) : bool</text><ellipse cx="231.5" cy="363.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="240.5" y="367.252">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="37" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1748.5" y="273.5"/><ellipse cx="1941.75" cy="289.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1942.7031,286.1406 L1942.7031,292.7969 L1944.4219,292.7969 Q1945.0313,292.7969 1945.2969,293.0313 Q1945.5625,293.2656 1945.5625,293.6563 Q1945.5625,294.0313 1945.2969,294.2656 Q1945.0313,294.5 1944.4219,294.5 L1939.2813,294.5 Q1938.6719,294.5 1938.4063,294.2656 Q1938.1406,294.0313 1938.1406,293.6406 Q1938.1406,293.2656 1938.4063,293.0313 Q1938.6719,292.7969 1939.2813,292.7969 L1941,292.7969 L1941,286.1406 L1939.2813,286.1406 Q1938.6719,286.1406 1938.4063,285.9063 Q1938.1406,285.6719 1938.1406,285.2813 Q1938.1406,284.9063 1938.4063,284.6719 Q1938.6719,284.4375 1939.2813,284.4375 L1944.4219,284.4375 Q1945.0313,284.4375 1945.2969,284.6719 Q1945.5625,284.9063 1945.5625,285.2813 Q1945.5625,285.6719 1945.2969,285.9063 Q1945.0313,286.1406 1944.4219,286.1406 L1942.7031,286.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="1962.25" y="295.2285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1749.5" x2="2287.5" y1="305.5" y2="305.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1749.5" x2="2287.5" y1="313.5" y2="313.5"/><ellipse cx="1759.5" cy="327.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1768.5" y="332.0332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1759.5" cy="345.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="1768.5" y="349.6426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1759.5" cy="363.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1768.5" y="367.252">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="43" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="60"/><ellipse cx="221.25" cy="76" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,71.875 Q224.1719,71.6563 224.3594,71.5469 Q224.5469,71.4375 224.7656,71.4375 Q225.1406,71.4375 225.375,71.6953 Q225.6094,71.9531 225.6094,72.5625 L225.6094,74.0156 Q225.6094,74.625 225.375,74.8906 Q225.1406,75.1563 224.7656,75.1563 Q224.4219,75.1563 224.2188,74.9531 Q224.0156,74.7656 223.9063,74.25 Q223.8594,73.8906 223.6719,73.7031 Q223.3438,73.3281 222.7344,73.1094 Q222.125,72.8906 221.5,72.8906 Q220.7344,72.8906 220.1016,73.2188 Q219.4688,73.5469 218.9766,74.2969 Q218.4844,75.0469 218.4844,76.0781 L218.4844,77.1719 Q218.4844,78.4063 219.375,79.2266 Q220.2656,80.0469 221.8594,80.0469 Q222.7969,80.0469 223.4531,79.7969 Q223.8438,79.6406 224.2656,79.2031 Q224.5313,78.9375 224.6797,78.8594 Q224.8281,78.7813 225.0313,78.7813 Q225.3594,78.7813 225.6172,79.0391 Q225.875,79.2969 225.875,79.6406 Q225.875,79.9844 225.5313,80.3906 Q225.0313,80.9688 224.2344,81.2969 Q223.1563,81.75 221.8594,81.75 Q220.3438,81.75 219.1406,81.125 Q218.1563,80.625 217.4688,79.5547 Q216.7813,78.4844 216.7813,77.2031 L216.7813,76.0469 Q216.7813,74.7188 217.3984,73.5703 Q218.0156,72.4219 219.1094,71.8047 Q220.2031,71.1875 221.4375,71.1875 Q222.1719,71.1875 222.8203,71.3516 Q223.4688,71.5156 224.0156,71.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="81.7285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="92" y2="92"/><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="100" y2="100"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="111.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="118.5332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="128.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="136.1426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="48" fill="#F1F1F1" height="136.0469" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="939" x="1950" y="33.5"/><ellipse cx="2372.75" cy="49.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2375.5156,45.375 Q2375.6719,45.1563 2375.8594,45.0469 Q2376.0469,44.9375 2376.2656,44.9375 Q2376.6406,44.9375 2376.875,45.1953 Q2377.1094,45.4531 2377.1094,46.0625 L2377.1094,47.5156 Q2377.1094,48.125 2376.875,48.3906 Q2376.6406,48.6563 2376.2656,48.6563 Q2375.9219,48.6563 2375.7188,48.4531 Q2375.5156,48.2656 2375.4063,47.75 Q2375.3594,47.3906 2375.1719,47.2031 Q2374.8438,46.8281 2374.2344,46.6094 Q2373.625,46.3906 2373,46.3906 Q2372.2344,46.3906 2371.6016,46.7188 Q2370.9688,47.0469 2370.4766,47.7969 Q2369.9844,48.5469 2369.9844,49.5781 L2369.9844,50.6719 Q2369.9844,51.9063 2370.875,52.7266 Q2371.7656,53.5469 2373.3594,53.5469 Q2374.2969,53.5469 2374.9531,53.2969 Q2375.3438,53.1406 2375.7656,52.7031 Q2376.0313,52.4375 2376.1797,52.3594 Q2376.3281,52.2813 2376.5313,52.2813 Q2376.8594,52.2813 2377.1172,52.5391 Q2377.375,52.7969 2377.375,53.1406 Q2377.375,53.4844 2377.0313,53.8906 Q2376.5313,54.4688 2375.7344,54.7969 Q2374.6563,55.25 2373.3594,55.25 Q2371.8438,55.25 2370.6406,54.625 Q2369.6563,54.125 2368.9688,53.0547 Q2368.2813,51.9844 2368.2813,50.7031 L2368.2813,49.5469 Q2368.2813,48.2188 2368.8984,47.0703 Q2369.5156,45.9219 2370.6094,45.3047 Q2371.7031,44.6875 2372.9375,44.6875 Q2373.6719,44.6875 2374.3203,44.8516 Q2374.9688,45.0156 2375.5156,45.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="2393.25" y="55.2285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1951" x2="2888" y1="65.5" y2="65.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1958" y="76.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="1970" y="84.0332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1958" y="94.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="1970" y="101.6426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1958" y="112.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="1970" y="119.252">_userLocationManager : IUserLocationManager</text><ellipse cx="1961" cy="132.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="913" x="1970" y="136.8613">UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1951" x2="2888" y1="143.9375" y2="143.9375"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1958" y="155.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="402" x="1970" y="162.4707">CheckPasswordLeakedForUser(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="57" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="458" x="1359.5" y="60"/><ellipse cx="1514.75" cy="76" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1517.5156,71.875 Q1517.6719,71.6563 1517.8594,71.5469 Q1518.0469,71.4375 1518.2656,71.4375 Q1518.6406,71.4375 1518.875,71.6953 Q1519.1094,71.9531 1519.1094,72.5625 L1519.1094,74.0156 Q1519.1094,74.625 1518.875,74.8906 Q1518.6406,75.1563 1518.2656,75.1563 Q1517.9219,75.1563 1517.7188,74.9531 Q1517.5156,74.7656 1517.4063,74.25 Q1517.3594,73.8906 1517.1719,73.7031 Q1516.8438,73.3281 1516.2344,73.1094 Q1515.625,72.8906 1515,72.8906 Q1514.2344,72.8906 1513.6016,73.2188 Q1512.9688,73.5469 1512.4766,74.2969 Q1511.9844,75.0469 1511.9844,76.0781 L1511.9844,77.1719 Q1511.9844,78.4063 1512.875,79.2266 Q1513.7656,80.0469 1515.3594,80.0469 Q1516.2969,80.0469 1516.9531,79.7969 Q1517.3438,79.6406 1517.7656,79.2031 Q1518.0313,78.9375 1518.1797,78.8594 Q1518.3281,78.7813 1518.5313,78.7813 Q1518.8594,78.7813 1519.1172,79.0391 Q1519.375,79.2969 1519.375,79.6406 Q1519.375,79.9844 1519.0313,80.3906 Q1518.5313,80.9688 1517.7344,81.2969 Q1516.6563,81.75 1515.3594,81.75 Q1513.8438,81.75 1512.6406,81.125 Q1511.6563,80.625 1510.9688,79.5547 Q1510.2813,78.4844 1510.2813,77.2031 L1510.2813,76.0469 Q1510.2813,74.7188 1510.8984,73.5703 Q1511.5156,72.4219 1512.6094,71.8047 Q1513.7031,71.1875 1514.9375,71.1875 Q1515.6719,71.1875 1516.3203,71.3516 Q1516.9688,71.5156 1517.5156,71.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1535.25" y="81.7285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1360.5" x2="1816.5" y1="92" y2="92"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1367.5" y="103.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="1379.5" y="110.5332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1360.5" x2="1816.5" y1="117.6094" y2="117.6094"/><ellipse cx="1370.5" cy="131.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="432" x="1379.5" y="136.1426">UserLocationManager(userLocationProvider : UserLocationProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="170" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1474.5" y="701"/><ellipse cx="1503" cy="717" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1505.7656,712.875 Q1505.9219,712.6563 1506.1094,712.5469 Q1506.2969,712.4375 1506.5156,712.4375 Q1506.8906,712.4375 1507.125,712.6953 Q1507.3594,712.9531 1507.3594,713.5625 L1507.3594,715.0156 Q1507.3594,715.625 1507.125,715.8906 Q1506.8906,716.1563 1506.5156,716.1563 Q1506.1719,716.1563 1505.9688,715.9531 Q1505.7656,715.7656 1505.6563,715.25 Q1505.6094,714.8906 1505.4219,714.7031 Q1505.0938,714.3281 1504.4844,714.1094 Q1503.875,713.8906 1503.25,713.8906 Q1502.4844,713.8906 1501.8516,714.2188 Q1501.2188,714.5469 1500.7266,715.2969 Q1500.2344,716.0469 1500.2344,717.0781 L1500.2344,718.1719 Q1500.2344,719.4063 1501.125,720.2266 Q1502.0156,721.0469 1503.6094,721.0469 Q1504.5469,721.0469 1505.2031,720.7969 Q1505.5938,720.6406 1506.0156,720.2031 Q1506.2813,719.9375 1506.4297,719.8594 Q1506.5781,719.7813 1506.7813,719.7813 Q1507.1094,719.7813 1507.3672,720.0391 Q1507.625,720.2969 1507.625,720.6406 Q1507.625,720.9844 1507.2813,721.3906 Q1506.7813,721.9688 1505.9844,722.2969 Q1504.9063,722.75 1503.6094,722.75 Q1502.0938,722.75 1500.8906,722.125 Q1499.9063,721.625 1499.2188,720.5547 Q1498.5313,719.4844 1498.5313,718.2031 L1498.5313,717.0469 Q1498.5313,715.7188 1499.1484,714.5703 Q1499.7656,713.4219 1500.8594,712.8047 Q1501.9531,712.1875 1503.1875,712.1875 Q1503.9219,712.1875 1504.5703,712.3516 Q1505.2188,712.5156 1505.7656,712.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1520" y="722.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="1475.5" x2="1607.5" y1="733" y2="733"/><ellipse cx="1485.5" cy="747.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1494.5" y="751.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1475.5" x2="1607.5" y1="758.6094" y2="758.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="182" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="876.5" y="487.5"/><ellipse cx="908.6" cy="503.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M911.3656,499.375 Q911.5219,499.1563 911.7094,499.0469 Q911.8969,498.9375 912.1156,498.9375 Q912.4906,498.9375 912.725,499.1953 Q912.9594,499.4531 912.9594,500.0625 L912.9594,501.5156 Q912.9594,502.125 912.725,502.3906 Q912.4906,502.6563 912.1156,502.6563 Q911.7719,502.6563 911.5688,502.4531 Q911.3656,502.2656 911.2563,501.75 Q911.2094,501.3906 911.0219,501.2031 Q910.6938,500.8281 910.0844,500.6094 Q909.475,500.3906 908.85,500.3906 Q908.0844,500.3906 907.4516,500.7188 Q906.8188,501.0469 906.3266,501.7969 Q905.8344,502.5469 905.8344,503.5781 L905.8344,504.6719 Q905.8344,505.9063 906.725,506.7266 Q907.6156,507.5469 909.2094,507.5469 Q910.1469,507.5469 910.8031,507.2969 Q911.1938,507.1406 911.6156,506.7031 Q911.8813,506.4375 912.0297,506.3594 Q912.1781,506.2813 912.3813,506.2813 Q912.7094,506.2813 912.9672,506.5391 Q913.225,506.7969 913.225,507.1406 Q913.225,507.4844 912.8813,507.8906 Q912.3813,508.4688 911.5844,508.7969 Q910.5063,509.25 909.2094,509.25 Q907.6938,509.25 906.4906,508.625 Q905.5063,508.125 904.8188,507.0547 Q904.1313,505.9844 904.1313,504.7031 L904.1313,503.5469 Q904.1313,502.2188 904.7484,501.0703 Q905.3656,499.9219 906.4594,499.3047 Q907.5531,498.6875 908.7875,498.6875 Q909.5219,498.6875 910.1703,498.8516 Q910.8188,499.0156 911.3656,499.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="926.4" y="509.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="877.5" x2="1009.5" y1="519.5" y2="519.5"/><ellipse cx="887.5" cy="533.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="896.5" y="538.0332">Email : string</text><ellipse cx="887.5" cy="551.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="896.5" y="555.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="877.5" x2="1009.5" y1="562.7188" y2="562.7188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="81" fill="#F1F1F1" height="136.0469" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="382" x="2323.5" y="256"/><ellipse cx="2467.25" cy="272" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2468.2031,268.6406 L2468.2031,275.2969 L2469.9219,275.2969 Q2470.5313,275.2969 2470.7969,275.5313 Q2471.0625,275.7656 2471.0625,276.1563 Q2471.0625,276.5313 2470.7969,276.7656 Q2470.5313,277 2469.9219,277 L2464.7813,277 Q2464.1719,277 2463.9063,276.7656 Q2463.6406,276.5313 2463.6406,276.1406 Q2463.6406,275.7656 2463.9063,275.5313 Q2464.1719,275.2969 2464.7813,275.2969 L2466.5,275.2969 L2466.5,268.6406 L2464.7813,268.6406 Q2464.1719,268.6406 2463.9063,268.4063 Q2463.6406,268.1719 2463.6406,267.7813 Q2463.6406,267.4063 2463.9063,267.1719 Q2464.1719,266.9375 2464.7813,266.9375 L2469.9219,266.9375 Q2470.5313,266.9375 2470.7969,267.1719 Q2471.0625,267.4063 2471.0625,267.7813 Q2471.0625,268.1719 2470.7969,268.4063 Q2470.5313,268.6406 2469.9219,268.6406 L2468.2031,268.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="2487.75" y="277.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2324.5" x2="2704.5" y1="288" y2="288"/><line style="stroke:#181818;stroke-width:0.5;" x1="2324.5" x2="2704.5" y1="296" y2="296"/><ellipse cx="2334.5" cy="310.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2343.5" y="314.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2334.5" cy="327.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2343.5" y="332.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2334.5" cy="345.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2343.5" y="349.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2334.5" cy="363.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="2343.5" y="367.3613">UpdateUserFailedTries(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2334.5" cy="380.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2343.5" y="384.9707">UpdateUserLoginSuccess(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="89" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="2740.5" y="291"/><ellipse cx="2857.75" cy="307" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2858.7031,303.6406 L2858.7031,310.2969 L2860.4219,310.2969 Q2861.0313,310.2969 2861.2969,310.5313 Q2861.5625,310.7656 2861.5625,311.1563 Q2861.5625,311.5313 2861.2969,311.7656 Q2861.0313,312 2860.4219,312 L2855.2813,312 Q2854.6719,312 2854.4063,311.7656 Q2854.1406,311.5313 2854.1406,311.1406 Q2854.1406,310.7656 2854.4063,310.5313 Q2854.6719,310.2969 2855.2813,310.2969 L2857,310.2969 L2857,303.6406 L2855.2813,303.6406 Q2854.6719,303.6406 2854.4063,303.4063 Q2854.1406,303.1719 2854.1406,302.7813 Q2854.1406,302.4063 2854.4063,302.1719 Q2854.6719,301.9375 2855.2813,301.9375 L2860.4219,301.9375 Q2861.0313,301.9375 2861.2969,302.1719 Q2861.5625,302.4063 2861.5625,302.7813 Q2861.5625,303.1719 2861.2969,303.4063 Q2861.0313,303.6406 2860.4219,303.6406 L2858.7031,303.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="2878.25" y="312.7285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2741.5" x2="3147.5" y1="323" y2="323"/><line style="stroke:#181818;stroke-width:0.5;" x1="2741.5" x2="3147.5" y1="331" y2="331"/><ellipse cx="2751.5" cy="345.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="2760.5" y="349.5332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="151" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="346" y="478.5"/><ellipse cx="366.4" cy="494.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M369.1656,490.375 Q369.3219,490.1563 369.5094,490.0469 Q369.6969,489.9375 369.9156,489.9375 Q370.2906,489.9375 370.525,490.1953 Q370.7594,490.4531 370.7594,491.0625 L370.7594,492.5156 Q370.7594,493.125 370.525,493.3906 Q370.2906,493.6563 369.9156,493.6563 Q369.5719,493.6563 369.3688,493.4531 Q369.1656,493.2656 369.0563,492.75 Q369.0094,492.3906 368.8219,492.2031 Q368.4938,491.8281 367.8844,491.6094 Q367.275,491.3906 366.65,491.3906 Q365.8844,491.3906 365.2516,491.7188 Q364.6188,492.0469 364.1266,492.7969 Q363.6344,493.5469 363.6344,494.5781 L363.6344,495.6719 Q363.6344,496.9063 364.525,497.7266 Q365.4156,498.5469 367.0094,498.5469 Q367.9469,498.5469 368.6031,498.2969 Q368.9938,498.1406 369.4156,497.7031 Q369.6813,497.4375 369.8297,497.3594 Q369.9781,497.2813 370.1813,497.2813 Q370.5094,497.2813 370.7672,497.5391 Q371.025,497.7969 371.025,498.1406 Q371.025,498.4844 370.6813,498.8906 Q370.1813,499.4688 369.3844,499.7969 Q368.3063,500.25 367.0094,500.25 Q365.4938,500.25 364.2906,499.625 Q363.3063,499.125 362.6188,498.0547 Q361.9313,496.9844 361.9313,495.7031 L361.9313,494.5469 Q361.9313,493.2188 362.5484,492.0703 Q363.1656,490.9219 364.2594,490.3047 Q365.3531,489.6875 366.5875,489.6875 Q367.3219,489.6875 367.9703,489.8516 Q368.6188,490.0156 369.1656,490.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="381.6" y="500.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="347" x2="458" y1="510.5" y2="510.5"/><ellipse cx="357" cy="524.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="366" y="529.0332">UserID : int</text><ellipse cx="357" cy="542.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="366" y="546.6426">Email : string</text><ellipse cx="357" cy="560.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="366" y="564.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="347" x2="458" y1="571.3281" y2="571.3281"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="105" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1173.5" y="273.5"/><ellipse cx="1369.25" cy="289.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1370.2031,286.1406 L1370.2031,292.7969 L1371.9219,292.7969 Q1372.5313,292.7969 1372.7969,293.0313 Q1373.0625,293.2656 1373.0625,293.6563 Q1373.0625,294.0313 1372.7969,294.2656 Q1372.5313,294.5 1371.9219,294.5 L1366.7813,294.5 Q1366.1719,294.5 1365.9063,294.2656 Q1365.6406,294.0313 1365.6406,293.6406 Q1365.6406,293.2656 1365.9063,293.0313 Q1366.1719,292.7969 1366.7813,292.7969 L1368.5,292.7969 L1368.5,286.1406 L1366.7813,286.1406 Q1366.1719,286.1406 1365.9063,285.9063 Q1365.6406,285.6719 1365.6406,285.2813 Q1365.6406,284.9063 1365.9063,284.6719 Q1366.1719,284.4375 1366.7813,284.4375 L1371.9219,284.4375 Q1372.5313,284.4375 1372.7969,284.6719 Q1373.0625,284.9063 1373.0625,285.2813 Q1373.0625,285.6719 1372.7969,285.9063 Q1372.5313,286.1406 1371.9219,286.1406 L1370.2031,286.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="1389.75" y="295.2285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1174.5" x2="1712.5" y1="305.5" y2="305.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1174.5" x2="1712.5" y1="313.5" y2="313.5"/><ellipse cx="1184.5" cy="327.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1193.5" y="332.0332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1184.5" cy="345.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="1193.5" y="349.6426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1184.5" cy="363.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1193.5" y="367.252">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="93" fill="#F1F1F1" height="118.4375" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="3183.5" y="265"/><ellipse cx="3492.75" cy="281" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3495.5156,276.875 Q3495.6719,276.6563 3495.8594,276.5469 Q3496.0469,276.4375 3496.2656,276.4375 Q3496.6406,276.4375 3496.875,276.6953 Q3497.1094,276.9531 3497.1094,277.5625 L3497.1094,279.0156 Q3497.1094,279.625 3496.875,279.8906 Q3496.6406,280.1563 3496.2656,280.1563 Q3495.9219,280.1563 3495.7188,279.9531 Q3495.5156,279.7656 3495.4063,279.25 Q3495.3594,278.8906 3495.1719,278.7031 Q3494.8438,278.3281 3494.2344,278.1094 Q3493.625,277.8906 3493,277.8906 Q3492.2344,277.8906 3491.6016,278.2188 Q3490.9688,278.5469 3490.4766,279.2969 Q3489.9844,280.0469 3489.9844,281.0781 L3489.9844,282.1719 Q3489.9844,283.4063 3490.875,284.2266 Q3491.7656,285.0469 3493.3594,285.0469 Q3494.2969,285.0469 3494.9531,284.7969 Q3495.3438,284.6406 3495.7656,284.2031 Q3496.0313,283.9375 3496.1797,283.8594 Q3496.3281,283.7813 3496.5313,283.7813 Q3496.8594,283.7813 3497.1172,284.0391 Q3497.375,284.2969 3497.375,284.6406 Q3497.375,284.9844 3497.0313,285.3906 Q3496.5313,285.9688 3495.7344,286.2969 Q3494.6563,286.75 3493.3594,286.75 Q3491.8438,286.75 3490.6406,286.125 Q3489.6563,285.625 3488.9688,284.5547 Q3488.2813,283.4844 3488.2813,282.2031 L3488.2813,281.0469 Q3488.2813,279.7188 3488.8984,278.5703 Q3489.5156,277.4219 3490.6094,276.8047 Q3491.7031,276.1875 3492.9375,276.1875 Q3493.6719,276.1875 3494.3203,276.3516 Q3494.9688,276.5156 3495.5156,276.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="3513.25" y="286.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3184.5" x2="3882.5" y1="297" y2="297"/><line style="stroke:#181818;stroke-width:0.5;" x1="3184.5" x2="3882.5" y1="305" y2="305"/><ellipse cx="3194.5" cy="319.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3203.5" y="323.5332">SqlProvider(connection : string)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="3203.5" y="341.1426"> </text><polygon fill="#FFFF44" points="3194.5,349.5234,3198.5,353.5234,3194.5,357.5234,3190.5,353.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="3203.5" y="358.752">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3194.5,367.1328,3198.5,371.1328,3194.5,375.1328,3190.5,371.1328" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3203.5" y="376.3613">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="100" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3332" y="68.5"/><ellipse cx="3436.75" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3439.5156,80.375 Q3439.6719,80.1563 3439.8594,80.0469 Q3440.0469,79.9375 3440.2656,79.9375 Q3440.6406,79.9375 3440.875,80.1953 Q3441.1094,80.4531 3441.1094,81.0625 L3441.1094,82.5156 Q3441.1094,83.125 3440.875,83.3906 Q3440.6406,83.6563 3440.2656,83.6563 Q3439.9219,83.6563 3439.7188,83.4531 Q3439.5156,83.2656 3439.4063,82.75 Q3439.3594,82.3906 3439.1719,82.2031 Q3438.8438,81.8281 3438.2344,81.6094 Q3437.625,81.3906 3437,81.3906 Q3436.2344,81.3906 3435.6016,81.7188 Q3434.9688,82.0469 3434.4766,82.7969 Q3433.9844,83.5469 3433.9844,84.5781 L3433.9844,85.6719 Q3433.9844,86.9063 3434.875,87.7266 Q3435.7656,88.5469 3437.3594,88.5469 Q3438.2969,88.5469 3438.9531,88.2969 Q3439.3438,88.1406 3439.7656,87.7031 Q3440.0313,87.4375 3440.1797,87.3594 Q3440.3281,87.2813 3440.5313,87.2813 Q3440.8594,87.2813 3441.1172,87.5391 Q3441.375,87.7969 3441.375,88.1406 Q3441.375,88.4844 3441.0313,88.8906 Q3440.5313,89.4688 3439.7344,89.7969 Q3438.6563,90.25 3437.3594,90.25 Q3435.8438,90.25 3434.6406,89.625 Q3433.6563,89.125 3432.9688,88.0547 Q3432.2813,86.9844 3432.2813,85.7031 L3432.2813,84.5469 Q3432.2813,83.2188 3432.8984,82.0703 Q3433.5156,80.9219 3434.6094,80.3047 Q3435.7031,79.6875 3436.9375,79.6875 Q3437.6719,79.6875 3438.3203,79.8516 Q3438.9688,80.0156 3439.5156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="3457.25" y="90.2285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3333" x2="3710" y1="100.5" y2="100.5"/><ellipse cx="3343" cy="114.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3352" y="119.0332">LeakedPasswordProvider(configuration : IConfiguration)</text><line style="stroke:#181818;stroke-width:1.0;" x1="3333" x2="3710" y1="126.1094" y2="126.1094"/></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="111" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="2972.5" y="60"/><ellipse cx="3077.25" cy="76" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3080.0156,71.875 Q3080.1719,71.6563 3080.3594,71.5469 Q3080.5469,71.4375 3080.7656,71.4375 Q3081.1406,71.4375 3081.375,71.6953 Q3081.6094,71.9531 3081.6094,72.5625 L3081.6094,74.0156 Q3081.6094,74.625 3081.375,74.8906 Q3081.1406,75.1563 3080.7656,75.1563 Q3080.4219,75.1563 3080.2188,74.9531 Q3080.0156,74.7656 3079.9063,74.25 Q3079.8594,73.8906 3079.6719,73.7031 Q3079.3438,73.3281 3078.7344,73.1094 Q3078.125,72.8906 3077.5,72.8906 Q3076.7344,72.8906 3076.1016,73.2188 Q3075.4688,73.5469 3074.9766,74.2969 Q3074.4844,75.0469 3074.4844,76.0781 L3074.4844,77.1719 Q3074.4844,78.4063 3075.375,79.2266 Q3076.2656,80.0469 3077.8594,80.0469 Q3078.7969,80.0469 3079.4531,79.7969 Q3079.8438,79.6406 3080.2656,79.2031 Q3080.5313,78.9375 3080.6797,78.8594 Q3080.8281,78.7813 3081.0313,78.7813 Q3081.3594,78.7813 3081.6172,79.0391 Q3081.875,79.2969 3081.875,79.6406 Q3081.875,79.9844 3081.5313,80.3906 Q3081.0313,80.9688 3080.2344,81.2969 Q3079.1563,81.75 3077.8594,81.75 Q3076.3438,81.75 3075.1406,81.125 Q3074.1563,80.625 3073.4688,79.5547 Q3072.7813,78.4844 3072.7813,77.2031 L3072.7813,76.0469 Q3072.7813,74.7188 3073.3984,73.5703 Q3074.0156,72.4219 3075.1094,71.8047 Q3076.2031,71.1875 3077.4375,71.1875 Q3078.1719,71.1875 3078.8203,71.3516 Q3079.4688,71.5156 3080.0156,71.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3097.75" y="81.7285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2973.5" x2="3271.5" y1="92" y2="92"/><ellipse cx="2983.5" cy="106.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="2992.5" y="110.5332">UserProvider(configuration : IConfiguration)</text><line style="stroke:#181818;stroke-width:1.0;" x1="2973.5" x2="3271.5" y1="117.6094" y2="117.6094"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2980.5" y="128.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="2992.5" y="136.1426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="165" fill="#F1F1F1" height="83.2188" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="182" x="1992.5" y="487.5"/><ellipse cx="2055.75" cy="503.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2058.5156,499.375 Q2058.6719,499.1563 2058.8594,499.0469 Q2059.0469,498.9375 2059.2656,498.9375 Q2059.6406,498.9375 2059.875,499.1953 Q2060.1094,499.4531 2060.1094,500.0625 L2060.1094,501.5156 Q2060.1094,502.125 2059.875,502.3906 Q2059.6406,502.6563 2059.2656,502.6563 Q2058.9219,502.6563 2058.7188,502.4531 Q2058.5156,502.2656 2058.4063,501.75 Q2058.3594,501.3906 2058.1719,501.2031 Q2057.8438,500.8281 2057.2344,500.6094 Q2056.625,500.3906 2056,500.3906 Q2055.2344,500.3906 2054.6016,500.7188 Q2053.9688,501.0469 2053.4766,501.7969 Q2052.9844,502.5469 2052.9844,503.5781 L2052.9844,504.6719 Q2052.9844,505.9063 2053.875,506.7266 Q2054.7656,507.5469 2056.3594,507.5469 Q2057.2969,507.5469 2057.9531,507.2969 Q2058.3438,507.1406 2058.7656,506.7031 Q2059.0313,506.4375 2059.1797,506.3594 Q2059.3281,506.2813 2059.5313,506.2813 Q2059.8594,506.2813 2060.1172,506.5391 Q2060.375,506.7969 2060.375,507.1406 Q2060.375,507.4844 2060.0313,507.8906 Q2059.5313,508.4688 2058.7344,508.7969 Q2057.6563,509.25 2056.3594,509.25 Q2054.8438,509.25 2053.6406,508.625 Q2052.6563,508.125 2051.9688,507.0547 Q2051.2813,505.9844 2051.2813,504.7031 L2051.2813,503.5469 Q2051.2813,502.2188 2051.8984,501.0703 Q2052.5156,499.9219 2053.6094,499.3047 Q2054.7031,498.6875 2055.9375,498.6875 Q2056.6719,498.6875 2057.3203,498.8516 Q2057.9688,499.0156 2058.5156,499.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2076.25" y="509.2285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="1993.5" x2="2173.5" y1="519.5" y2="519.5"/><ellipse cx="2003.5" cy="533.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2012.5" y="538.0332">HashedPassword : string</text><ellipse cx="2003.5" cy="551.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="2012.5" y="555.6426">Salt : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1993.5" x2="2173.5" y1="562.7188" y2="562.7188"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="187" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="1361" y="452"/><ellipse cx="1398.5" cy="468" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1401.2656,463.875 Q1401.4219,463.6563 1401.6094,463.5469 Q1401.7969,463.4375 1402.0156,463.4375 Q1402.3906,463.4375 1402.625,463.6953 Q1402.8594,463.9531 1402.8594,464.5625 L1402.8594,466.0156 Q1402.8594,466.625 1402.625,466.8906 Q1402.3906,467.1563 1402.0156,467.1563 Q1401.6719,467.1563 1401.4688,466.9531 Q1401.2656,466.7656 1401.1563,466.25 Q1401.1094,465.8906 1400.9219,465.7031 Q1400.5938,465.3281 1399.9844,465.1094 Q1399.375,464.8906 1398.75,464.8906 Q1397.9844,464.8906 1397.3516,465.2188 Q1396.7188,465.5469 1396.2266,466.2969 Q1395.7344,467.0469 1395.7344,468.0781 L1395.7344,469.1719 Q1395.7344,470.4063 1396.625,471.2266 Q1397.5156,472.0469 1399.1094,472.0469 Q1400.0469,472.0469 1400.7031,471.7969 Q1401.0938,471.6406 1401.5156,471.2031 Q1401.7813,470.9375 1401.9297,470.8594 Q1402.0781,470.7813 1402.2813,470.7813 Q1402.6094,470.7813 1402.8672,471.0391 Q1403.125,471.2969 1403.125,471.6406 Q1403.125,471.9844 1402.7813,472.3906 Q1402.2813,472.9688 1401.4844,473.2969 Q1400.4063,473.75 1399.1094,473.75 Q1397.5938,473.75 1396.3906,473.125 Q1395.4063,472.625 1394.7188,471.5547 Q1394.0313,470.4844 1394.0313,469.2031 L1394.0313,468.0469 Q1394.0313,466.7188 1394.6484,465.5703 Q1395.2656,464.4219 1396.3594,463.8047 Q1397.4531,463.1875 1398.6875,463.1875 Q1399.4219,463.1875 1400.0703,463.3516 Q1400.7188,463.5156 1401.2656,463.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="1417.5" y="473.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="1362" x2="1525" y1="484" y2="484"/><ellipse cx="1372" cy="498.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1381" y="502.5332">ID : int</text><ellipse cx="1372" cy="515.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="1381" y="520.1426">UserID : int</text><ellipse cx="1372" cy="533.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1381" y="537.752">IP : string</text><ellipse cx="1372" cy="551.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="1381" y="555.3613">UserAgent : string</text><ellipse cx="1372" cy="568.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1381" y="572.9707">Successful : bool</text><ellipse cx="1372" cy="586.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1381" y="590.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="1362" x2="1525" y1="597.6563" y2="597.6563"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="132" fill="#F1F1F1" height="100.8281" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="480" x="3746.5" y="51"/><ellipse cx="3956.75" cy="67" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3959.5156,62.875 Q3959.6719,62.6563 3959.8594,62.5469 Q3960.0469,62.4375 3960.2656,62.4375 Q3960.6406,62.4375 3960.875,62.6953 Q3961.1094,62.9531 3961.1094,63.5625 L3961.1094,65.0156 Q3961.1094,65.625 3960.875,65.8906 Q3960.6406,66.1563 3960.2656,66.1563 Q3959.9219,66.1563 3959.7188,65.9531 Q3959.5156,65.7656 3959.4063,65.25 Q3959.3594,64.8906 3959.1719,64.7031 Q3958.8438,64.3281 3958.2344,64.1094 Q3957.625,63.8906 3957,63.8906 Q3956.2344,63.8906 3955.6016,64.2188 Q3954.9688,64.5469 3954.4766,65.2969 Q3953.9844,66.0469 3953.9844,67.0781 L3953.9844,68.1719 Q3953.9844,69.4063 3954.875,70.2266 Q3955.7656,71.0469 3957.3594,71.0469 Q3958.2969,71.0469 3958.9531,70.7969 Q3959.3438,70.6406 3959.7656,70.2031 Q3960.0313,69.9375 3960.1797,69.8594 Q3960.3281,69.7813 3960.5313,69.7813 Q3960.8594,69.7813 3961.1172,70.0391 Q3961.375,70.2969 3961.375,70.6406 Q3961.375,70.9844 3961.0313,71.3906 Q3960.5313,71.9688 3959.7344,72.2969 Q3958.6563,72.75 3957.3594,72.75 Q3955.8438,72.75 3954.6406,72.125 Q3953.6563,71.625 3952.9688,70.5547 Q3952.2813,69.4844 3952.2813,68.2031 L3952.2813,67.0469 Q3952.2813,65.7188 3952.8984,64.5703 Q3953.5156,63.4219 3954.6094,62.8047 Q3955.7031,62.1875 3956.9375,62.1875 Q3957.6719,62.1875 3958.3203,62.3516 Q3958.9688,62.5156 3959.5156,62.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="3977.25" y="72.7285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="3747.5" x2="4225.5" y1="83" y2="83"/><line style="stroke:#181818;stroke-width:0.5;" x1="3747.5" x2="4225.5" y1="91" y2="91"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3754.5" y="102.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="312" x="3766.5" y="109.5332">GetEncryptedPassword(password : string) : string</text><ellipse cx="3757.5" cy="122.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="3766.5" y="127.1426">GetSalt(saltLength : int) : string</text><ellipse cx="3757.5" cy="140.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="454" x="3766.5" y="144.752">GetEncryptedAndSaltedPassword(password : string, salt : string) : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="138" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4261.5" y="68.5"/><ellipse cx="4410.75" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4413.5156,80.375 Q4413.6719,80.1563 4413.8594,80.0469 Q4414.0469,79.9375 4414.2656,79.9375 Q4414.6406,79.9375 4414.875,80.1953 Q4415.1094,80.4531 4415.1094,81.0625 L4415.1094,82.5156 Q4415.1094,83.125 4414.875,83.3906 Q4414.6406,83.6563 4414.2656,83.6563 Q4413.9219,83.6563 4413.7188,83.4531 Q4413.5156,83.2656 4413.4063,82.75 Q4413.3594,82.3906 4413.1719,82.2031 Q4412.8438,81.8281 4412.2344,81.6094 Q4411.625,81.3906 4411,81.3906 Q4410.2344,81.3906 4409.6016,81.7188 Q4408.9688,82.0469 4408.4766,82.7969 Q4407.9844,83.5469 4407.9844,84.5781 L4407.9844,85.6719 Q4407.9844,86.9063 4408.875,87.7266 Q4409.7656,88.5469 4411.3594,88.5469 Q4412.2969,88.5469 4412.9531,88.2969 Q4413.3438,88.1406 4413.7656,87.7031 Q4414.0313,87.4375 4414.1797,87.3594 Q4414.3281,87.2813 4414.5313,87.2813 Q4414.8594,87.2813 4415.1172,87.5391 Q4415.375,87.7969 4415.375,88.1406 Q4415.375,88.4844 4415.0313,88.8906 Q4414.5313,89.4688 4413.7344,89.7969 Q4412.6563,90.25 4411.3594,90.25 Q4409.8438,90.25 4408.6406,89.625 Q4407.6563,89.125 4406.9688,88.0547 Q4406.2813,86.9844 4406.2813,85.7031 L4406.2813,84.5469 Q4406.2813,83.2188 4406.8984,82.0703 Q4407.5156,80.9219 4408.6094,80.3047 Q4409.7031,79.6875 4410.9375,79.6875 Q4411.6719,79.6875 4412.3203,79.8516 Q4412.9688,80.0156 4413.5156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="4431.25" y="90.2285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4262.5" x2="4648.5" y1="100.5" y2="100.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="4262.5" x2="4648.5" y1="108.5" y2="108.5"/><ellipse cx="4272.5" cy="122.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="4281.5" y="127.0332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="157" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1821.5" y="666"/><ellipse cx="1886.75" cy="682" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1889.5156,677.875 Q1889.6719,677.6563 1889.8594,677.5469 Q1890.0469,677.4375 1890.2656,677.4375 Q1890.6406,677.4375 1890.875,677.6953 Q1891.1094,677.9531 1891.1094,678.5625 L1891.1094,680.0156 Q1891.1094,680.625 1890.875,680.8906 Q1890.6406,681.1563 1890.2656,681.1563 Q1889.9219,681.1563 1889.7188,680.9531 Q1889.5156,680.7656 1889.4063,680.25 Q1889.3594,679.8906 1889.1719,679.7031 Q1888.8438,679.3281 1888.2344,679.1094 Q1887.625,678.8906 1887,678.8906 Q1886.2344,678.8906 1885.6016,679.2188 Q1884.9688,679.5469 1884.4766,680.2969 Q1883.9844,681.0469 1883.9844,682.0781 L1883.9844,683.1719 Q1883.9844,684.4063 1884.875,685.2266 Q1885.7656,686.0469 1887.3594,686.0469 Q1888.2969,686.0469 1888.9531,685.7969 Q1889.3438,685.6406 1889.7656,685.2031 Q1890.0313,684.9375 1890.1797,684.8594 Q1890.3281,684.7813 1890.5313,684.7813 Q1890.8594,684.7813 1891.1172,685.0391 Q1891.375,685.2969 1891.375,685.6406 Q1891.375,685.9844 1891.0313,686.3906 Q1890.5313,686.9688 1889.7344,687.2969 Q1888.6563,687.75 1887.3594,687.75 Q1885.8438,687.75 1884.6406,687.125 Q1883.6563,686.625 1882.9688,685.5547 Q1882.2813,684.4844 1882.2813,683.2031 L1882.2813,682.0469 Q1882.2813,680.7188 1882.8984,679.5703 Q1883.5156,678.4219 1884.6094,677.8047 Q1885.7031,677.1875 1886.9375,677.1875 Q1887.6719,677.1875 1888.3203,677.3516 Q1888.9688,677.5156 1889.5156,677.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1907.25" y="687.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="1822.5" x2="1988.5" y1="698" y2="698"/><ellipse cx="1832.5" cy="712.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1841.5" y="716.5332">ID : int</text><ellipse cx="1832.5" cy="729.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1841.5" y="734.1426">IsVerified : bool</text><ellipse cx="1832.5" cy="747.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1841.5" y="751.752">IsLocked : bool</text><ellipse cx="1832.5" cy="765.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1841.5" y="769.3613">FailedTries : int</text><ellipse cx="1832.5" cy="782.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="1841.5" y="786.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1822.5" x2="1988.5" y1="794.0469" y2="794.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="174" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="1553" y="862"/><ellipse cx="1599.75" cy="878" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1602.5156,873.875 Q1602.6719,873.6563 1602.8594,873.5469 Q1603.0469,873.4375 1603.2656,873.4375 Q1603.6406,873.4375 1603.875,873.6953 Q1604.1094,873.9531 1604.1094,874.5625 L1604.1094,876.0156 Q1604.1094,876.625 1603.875,876.8906 Q1603.6406,877.1563 1603.2656,877.1563 Q1602.9219,877.1563 1602.7188,876.9531 Q1602.5156,876.7656 1602.4063,876.25 Q1602.3594,875.8906 1602.1719,875.7031 Q1601.8438,875.3281 1601.2344,875.1094 Q1600.625,874.8906 1600,874.8906 Q1599.2344,874.8906 1598.6016,875.2188 Q1597.9688,875.5469 1597.4766,876.2969 Q1596.9844,877.0469 1596.9844,878.0781 L1596.9844,879.1719 Q1596.9844,880.4063 1597.875,881.2266 Q1598.7656,882.0469 1600.3594,882.0469 Q1601.2969,882.0469 1601.9531,881.7969 Q1602.3438,881.6406 1602.7656,881.2031 Q1603.0313,880.9375 1603.1797,880.8594 Q1603.3281,880.7813 1603.5313,880.7813 Q1603.8594,880.7813 1604.1172,881.0391 Q1604.375,881.2969 1604.375,881.6406 Q1604.375,881.9844 1604.0313,882.3906 Q1603.5313,882.9688 1602.7344,883.2969 Q1601.6563,883.75 1600.3594,883.75 Q1598.8438,883.75 1597.6406,883.125 Q1596.6563,882.625 1595.9688,881.5547 Q1595.2813,880.4844 1595.2813,879.2031 L1595.2813,878.0469 Q1595.2813,876.7188 1595.8984,875.5703 Q1596.5156,874.4219 1597.6094,873.8047 Q1598.7031,873.1875 1599.9375,873.1875 Q1600.6719,873.1875 1601.3203,873.3516 Q1601.9688,873.5156 1602.5156,873.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1620.25" y="883.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="1554" x2="1715" y1="894" y2="894"/><ellipse cx="1564" cy="908.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1573" y="912.5332">Email : string</text><ellipse cx="1564" cy="925.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1573" y="930.1426">FirstName : string</text><ellipse cx="1564" cy="943.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1573" y="947.752">LastName : string</text><ellipse cx="1564" cy="961.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1573" y="965.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1554" x2="1715" y1="972.4375" y2="972.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="19" d="M943.5,209.15 C943.5,231.54 943.5,254.14 943.5,273.23 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="943.5,196.01,939.5,202.01,943.5,208.01,947.5,202.01,943.5,196.01" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="20" d="M701.8,201.01 C640.33,226.07 576.84,251.94 524.25,273.38 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="714.07,196.01,707.0028,194.5763,702.9613,200.5485,710.0285,201.9821,714.07,196.01" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="65" d="M1012.26,374.62 C1091.47,431.48 1225.84,526.99 1343.5,606 C1391.1,637.96 1446.03,673.06 1485.95,698.24 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1490.25,700.96,1484.7578,692.7847,1486.0164,698.2997,1480.5014,699.5584,1490.25,700.96" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="66" d="M943.5,374.66 C943.5,407.53 943.5,450.31 943.5,482.33 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="943.5,487.37,947.5,478.37,943.5,482.37,939.5,478.37,943.5,487.37" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="67" d="M2024.33,169.53 C1960.95,179.16 1896,188.38 1834.5,196 C1533.85,233.26 1452.59,196.67 1155.5,256 C1138.95,259.31 1121.87,263.44 1104.92,268.01 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1106.66,274.8,1085.51,273.46,1102.87,261.32,1106.66,274.8" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="69" d="M2453.61,181.66 C2464.08,205.97 2475.49,232.47 2485.58,255.88 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2448.39,169.56,2447.0923,176.6534,2453.1409,180.5795,2454.4386,173.4861,2448.39,169.56" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="70" d="M2286.02,175.9 C2227.75,207.94 2160.95,244.67 2108.67,273.42 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2297.55,169.56,2290.3656,168.9404,2287.0304,175.3339,2294.2148,175.9535,2297.55,169.56" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="71" d="M2591.35,174.68 C2684.9,213.97 2795.96,260.61 2868.21,290.96 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2579.16,169.56,2583.1453,175.5698,2590.2256,174.2025,2586.2403,168.1927,2579.16,169.56" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="73" d="M297.31,143.2 C315.77,174.75 341.74,219.13 363.25,255.91 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="369.35,252.47,373.4,273.27,357.26,259.54,369.35,252.47" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="74" d="M402.5,388.02 C402.5,417.03 402.5,450.96 402.5,478.15 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="402.5,374.66,398.5,380.66,402.5,386.66,406.5,380.66,402.5,374.66" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="77" d="M1667.62,143.07 C1733.84,177.03 1829.19,225.92 1903.79,264.18 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1907.19,258.05,1921.79,273.41,1900.8,270.51,1907.19,258.05" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="78" d="M1554.36,154.42 C1530.74,190.33 1499.5,237.84 1476.2,273.27 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1561.74,143.2,1555.1006,146.014,1555.1446,153.225,1561.784,150.411,1561.74,143.2" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="121" d="M2360.31,397.62 C2296.21,427.81 2224.22,461.72 2169.73,487.39 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2372.18,392.03,2365.0472,390.9705,2361.3258,397.1472,2368.4586,398.2067,2372.18,392.03" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="122" d="M1443.5,387.92 C1443.5,408.17 1443.5,430.84 1443.5,451.94 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1443.5,374.66,1439.5,380.66,1443.5,386.66,1447.5,380.66,1443.5,374.66" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="124" d="M3444.22,134.52 C3399.47,152.87 3341.97,176.15 3290.5,196 C3211.54,226.46 3121.82,259.34 3053.53,284.02 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3055.6,290.71,3034.41,290.91,3050.85,277.54,3055.6,290.71" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="125" d="M3523.24,134.56 C3524.81,163.35 3527.18,206.79 3529.24,244.72 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3536.24,244.45,3530.33,264.8,3522.26,245.21,3536.24,244.45" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="127" d="M3033.95,143.09 C2995.18,160.28 2948.94,179.98 2906.5,196 C2901.49,197.89 2815.25,225.85 2724.94,255.05 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2726.82,261.8,2705.63,261.29,2722.51,248.48,2726.82,261.8" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="128" d="M3198.36,143.2 C3256.81,174.56 3338.9,218.6 3407.21,255.24 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3410.85,249.25,3425.16,264.88,3404.23,261.59,3410.85,249.25" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="144" d="M1821.24,792.52 C1793.31,811.58 1761.98,832.97 1733.08,852.7 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1736.85,858.6,1716.39,864.1,1728.96,847.04,1736.85,858.6" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="145" d="M1557.7,767.22 C1568.31,788.34 1582.66,816.87 1596.07,843.56 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1602.43,840.62,1605.16,861.63,1589.92,846.91,1602.43,840.62" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="147" d="M2047.91,570.59 C2027.79,593.53 2001.9,623.06 1977.72,650.64 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1982.96,655.28,1964.51,665.7,1972.43,646.05,1982.96,655.28" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c4f61d8c1d79f6993e1ceac56abac52a]
=======
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1022px" preserveAspectRatio="none" style="width:4794px;height:1022px;background:#FFFFFF;" version="1.1" viewBox="0 0 4794 1022" width="4794px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="7" fill="#F1F1F1" height="206.4844" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="736" x="575.5" y="7"/><ellipse cx="893.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M896.5156,18.875 Q896.6719,18.6563 896.8594,18.5469 Q897.0469,18.4375 897.2656,18.4375 Q897.6406,18.4375 897.875,18.6953 Q898.1094,18.9531 898.1094,19.5625 L898.1094,21.0156 Q898.1094,21.625 897.875,21.8906 Q897.6406,22.1563 897.2656,22.1563 Q896.9219,22.1563 896.7188,21.9531 Q896.5156,21.7656 896.4063,21.25 Q896.3594,20.8906 896.1719,20.7031 Q895.8438,20.3281 895.2344,20.1094 Q894.625,19.8906 894,19.8906 Q893.2344,19.8906 892.6016,20.2188 Q891.9688,20.5469 891.4766,21.2969 Q890.9844,22.0469 890.9844,23.0781 L890.9844,24.1719 Q890.9844,25.4063 891.875,26.2266 Q892.7656,27.0469 894.3594,27.0469 Q895.2969,27.0469 895.9531,26.7969 Q896.3438,26.6406 896.7656,26.2031 Q897.0313,25.9375 897.1797,25.8594 Q897.3281,25.7813 897.5313,25.7813 Q897.8594,25.7813 898.1172,26.0391 Q898.375,26.2969 898.375,26.6406 Q898.375,26.9844 898.0313,27.3906 Q897.5313,27.9688 896.7344,28.2969 Q895.6563,28.75 894.3594,28.75 Q892.8438,28.75 891.6406,28.125 Q890.6563,27.625 889.9688,26.5547 Q889.2813,25.4844 889.2813,24.2031 L889.2813,23.0469 Q889.2813,21.7188 889.8984,20.5703 Q890.5156,19.4219 891.6094,18.8047 Q892.7031,18.1875 893.9375,18.1875 Q894.6719,18.1875 895.3203,18.3516 Q895.9688,18.5156 896.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="914.25" y="28.7285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="576.5" x2="1310.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="280" x="595.5" y="57.5332">_logger{readonly} : ILogger&lt;UserController&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="595.5" y="75.1426">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="595.5" y="92.752">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="576.5" x2="1310.5" y1="99.8281" y2="99.8281"/><ellipse cx="586.5" cy="114.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="710" x="595.5" y="118.3613">UserController(logger : ILogger&lt;UserController&gt;, userManager : IUserManager, tokenManager : ITokenManager)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="595.5" y="135.9707"> </text><ellipse cx="586.5" cy="149.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="595.5" y="153.5801">Create(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586.5" cy="166.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="595.5" y="171.1895">Login(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586.5" cy="184.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="318" x="595.5" y="188.7988">GetUserFromToken() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="586.5" cy="202.1797" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="477" x="595.5" y="206.4082">VerificationLogin(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="26" fill="#F1F1F1" height="118.4375" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="653" x="617" y="291"/><ellipse cx="893.75" cy="307" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M894.7031,303.6406 L894.7031,310.2969 L896.4219,310.2969 Q897.0313,310.2969 897.2969,310.5313 Q897.5625,310.7656 897.5625,311.1563 Q897.5625,311.5313 897.2969,311.7656 Q897.0313,312 896.4219,312 L891.2813,312 Q890.6719,312 890.4063,311.7656 Q890.1406,311.5313 890.1406,311.1406 Q890.1406,310.7656 890.4063,310.5313 Q890.6719,310.2969 891.2813,310.2969 L893,310.2969 L893,303.6406 L891.2813,303.6406 Q890.6719,303.6406 890.4063,303.4063 Q890.1406,303.1719 890.1406,302.7813 Q890.1406,302.4063 890.4063,302.1719 Q890.6719,301.9375 891.2813,301.9375 L896.4219,301.9375 Q897.0313,301.9375 897.2969,302.1719 Q897.5625,302.4063 897.5625,302.7813 Q897.5625,303.1719 897.2969,303.4063 Q897.0313,303.6406 896.4219,303.6406 L894.7031,303.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="914.25" y="312.7285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="618" x2="1269" y1="323" y2="323"/><line style="stroke:#181818;stroke-width:0.5;" x1="618" x2="1269" y1="331" y2="331"/><ellipse cx="628" cy="345.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="363" x="637" y="349.5332">CreateUserAsync(userCreate : UserCreate) : Task&lt;User&gt;</text><ellipse cx="628" cy="362.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="637" y="367.1426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="628" cy="380.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="637" y="384.752">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="628" cy="398.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="627" x="637" y="402.3613">LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="33" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="154.5" y="299.5"/><ellipse cx="281.25" cy="315.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M282.2031,312.1406 L282.2031,318.7969 L283.9219,318.7969 Q284.5313,318.7969 284.7969,319.0313 Q285.0625,319.2656 285.0625,319.6563 Q285.0625,320.0313 284.7969,320.2656 Q284.5313,320.5 283.9219,320.5 L278.7813,320.5 Q278.1719,320.5 277.9063,320.2656 Q277.6406,320.0313 277.6406,319.6406 Q277.6406,319.2656 277.9063,319.0313 Q278.1719,318.7969 278.7813,318.7969 L280.5,318.7969 L280.5,312.1406 L278.7813,312.1406 Q278.1719,312.1406 277.9063,311.9063 Q277.6406,311.6719 277.6406,311.2813 Q277.6406,310.9063 277.9063,310.6719 Q278.1719,310.4375 278.7813,310.4375 L283.9219,310.4375 Q284.5313,310.4375 284.7969,310.6719 Q285.0625,310.9063 285.0625,311.2813 Q285.0625,311.6719 284.7969,311.9063 Q284.5313,312.1406 283.9219,312.1406 L282.2031,312.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="301.75" y="321.2285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="155.5" x2="517.5" y1="331.5" y2="331.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="155.5" x2="517.5" y1="339.5" y2="339.5"/><ellipse cx="165.5" cy="353.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="174.5" y="358.0332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="165.5" cy="371.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="174.5" y="375.6426">ValidateToken(token : string) : bool</text><ellipse cx="165.5" cy="389.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="174.5" y="393.252">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="40" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1880.5" y="299.5"/><ellipse cx="2073.75" cy="315.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2074.7031,312.1406 L2074.7031,318.7969 L2076.4219,318.7969 Q2077.0313,318.7969 2077.2969,319.0313 Q2077.5625,319.2656 2077.5625,319.6563 Q2077.5625,320.0313 2077.2969,320.2656 Q2077.0313,320.5 2076.4219,320.5 L2071.2813,320.5 Q2070.6719,320.5 2070.4063,320.2656 Q2070.1406,320.0313 2070.1406,319.6406 Q2070.1406,319.2656 2070.4063,319.0313 Q2070.6719,318.7969 2071.2813,318.7969 L2073,318.7969 L2073,312.1406 L2071.2813,312.1406 Q2070.6719,312.1406 2070.4063,311.9063 Q2070.1406,311.6719 2070.1406,311.2813 Q2070.1406,310.9063 2070.4063,310.6719 Q2070.6719,310.4375 2071.2813,310.4375 L2076.4219,310.4375 Q2077.0313,310.4375 2077.2969,310.6719 Q2077.5625,310.9063 2077.5625,311.2813 Q2077.5625,311.6719 2077.2969,311.9063 Q2077.0313,312.1406 2076.4219,312.1406 L2074.7031,312.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="2094.25" y="321.2285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1881.5" x2="2419.5" y1="331.5" y2="331.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1881.5" x2="2419.5" y1="339.5" y2="339.5"/><ellipse cx="1891.5" cy="353.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1900.5" y="358.0332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1891.5" cy="371.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="1900.5" y="375.6426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1891.5" cy="389.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1900.5" y="393.252">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="46" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="68.5"/><ellipse cx="221.25" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,80.375 Q224.1719,80.1563 224.3594,80.0469 Q224.5469,79.9375 224.7656,79.9375 Q225.1406,79.9375 225.375,80.1953 Q225.6094,80.4531 225.6094,81.0625 L225.6094,82.5156 Q225.6094,83.125 225.375,83.3906 Q225.1406,83.6563 224.7656,83.6563 Q224.4219,83.6563 224.2188,83.4531 Q224.0156,83.2656 223.9063,82.75 Q223.8594,82.3906 223.6719,82.2031 Q223.3438,81.8281 222.7344,81.6094 Q222.125,81.3906 221.5,81.3906 Q220.7344,81.3906 220.1016,81.7188 Q219.4688,82.0469 218.9766,82.7969 Q218.4844,83.5469 218.4844,84.5781 L218.4844,85.6719 Q218.4844,86.9063 219.375,87.7266 Q220.2656,88.5469 221.8594,88.5469 Q222.7969,88.5469 223.4531,88.2969 Q223.8438,88.1406 224.2656,87.7031 Q224.5313,87.4375 224.6797,87.3594 Q224.8281,87.2813 225.0313,87.2813 Q225.3594,87.2813 225.6172,87.5391 Q225.875,87.7969 225.875,88.1406 Q225.875,88.4844 225.5313,88.8906 Q225.0313,89.4688 224.2344,89.7969 Q223.1563,90.25 221.8594,90.25 Q220.3438,90.25 219.1406,89.625 Q218.1563,89.125 217.4688,88.0547 Q216.7813,86.9844 216.7813,85.7031 L216.7813,84.5469 Q216.7813,83.2188 217.3984,82.0703 Q218.0156,80.9219 219.1094,80.3047 Q220.2031,79.6875 221.4375,79.6875 Q222.1719,79.6875 222.8203,79.8516 Q223.4688,80.0156 224.0156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="90.2285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="100.5" y2="100.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="108.5" y2="108.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="119.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="127.0332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="137.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="144.6426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="51" fill="#F1F1F1" height="188.875" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="939" x="2032" y="15.5"/><ellipse cx="2454.75" cy="31.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2457.5156,27.375 Q2457.6719,27.1563 2457.8594,27.0469 Q2458.0469,26.9375 2458.2656,26.9375 Q2458.6406,26.9375 2458.875,27.1953 Q2459.1094,27.4531 2459.1094,28.0625 L2459.1094,29.5156 Q2459.1094,30.125 2458.875,30.3906 Q2458.6406,30.6563 2458.2656,30.6563 Q2457.9219,30.6563 2457.7188,30.4531 Q2457.5156,30.2656 2457.4063,29.75 Q2457.3594,29.3906 2457.1719,29.2031 Q2456.8438,28.8281 2456.2344,28.6094 Q2455.625,28.3906 2455,28.3906 Q2454.2344,28.3906 2453.6016,28.7188 Q2452.9688,29.0469 2452.4766,29.7969 Q2451.9844,30.5469 2451.9844,31.5781 L2451.9844,32.6719 Q2451.9844,33.9063 2452.875,34.7266 Q2453.7656,35.5469 2455.3594,35.5469 Q2456.2969,35.5469 2456.9531,35.2969 Q2457.3438,35.1406 2457.7656,34.7031 Q2458.0313,34.4375 2458.1797,34.3594 Q2458.3281,34.2813 2458.5313,34.2813 Q2458.8594,34.2813 2459.1172,34.5391 Q2459.375,34.7969 2459.375,35.1406 Q2459.375,35.4844 2459.0313,35.8906 Q2458.5313,36.4688 2457.7344,36.7969 Q2456.6563,37.25 2455.3594,37.25 Q2453.8438,37.25 2452.6406,36.625 Q2451.6563,36.125 2450.9688,35.0547 Q2450.2813,33.9844 2450.2813,32.7031 L2450.2813,31.5469 Q2450.2813,30.2188 2450.8984,29.0703 Q2451.5156,27.9219 2452.6094,27.3047 Q2453.7031,26.6875 2454.9375,26.6875 Q2455.6719,26.6875 2456.3203,26.8516 Q2456.9688,27.0156 2457.5156,27.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="2475.25" y="37.2285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2033" x2="2970" y1="47.5" y2="47.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2040" y="58.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="2052" y="66.0332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2040" y="76.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2052" y="83.6426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2040" y="94.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="2052" y="101.252">_userLocationManager : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2040" y="111.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="2052" y="118.8613">_messageService : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2040" y="129.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="2052" y="136.4707">_messageProvider : IMessageProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2040" y="146.8516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="2052" y="154.0801">_logger : ILogger</text><ellipse cx="2043" cy="167.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="913" x="2052" y="171.6895">UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager)</text><line style="stroke:#181818;stroke-width:1.0;" x1="2033" x2="2970" y1="178.7656" y2="178.7656"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2040" y="190.0703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="402" x="2052" y="197.2988">CheckPasswordLeakedForUser(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="63" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="458" x="1367.5" y="68.5"/><ellipse cx="1522.75" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1525.5156,80.375 Q1525.6719,80.1563 1525.8594,80.0469 Q1526.0469,79.9375 1526.2656,79.9375 Q1526.6406,79.9375 1526.875,80.1953 Q1527.1094,80.4531 1527.1094,81.0625 L1527.1094,82.5156 Q1527.1094,83.125 1526.875,83.3906 Q1526.6406,83.6563 1526.2656,83.6563 Q1525.9219,83.6563 1525.7188,83.4531 Q1525.5156,83.2656 1525.4063,82.75 Q1525.3594,82.3906 1525.1719,82.2031 Q1524.8438,81.8281 1524.2344,81.6094 Q1523.625,81.3906 1523,81.3906 Q1522.2344,81.3906 1521.6016,81.7188 Q1520.9688,82.0469 1520.4766,82.7969 Q1519.9844,83.5469 1519.9844,84.5781 L1519.9844,85.6719 Q1519.9844,86.9063 1520.875,87.7266 Q1521.7656,88.5469 1523.3594,88.5469 Q1524.2969,88.5469 1524.9531,88.2969 Q1525.3438,88.1406 1525.7656,87.7031 Q1526.0313,87.4375 1526.1797,87.3594 Q1526.3281,87.2813 1526.5313,87.2813 Q1526.8594,87.2813 1527.1172,87.5391 Q1527.375,87.7969 1527.375,88.1406 Q1527.375,88.4844 1527.0313,88.8906 Q1526.5313,89.4688 1525.7344,89.7969 Q1524.6563,90.25 1523.3594,90.25 Q1521.8438,90.25 1520.6406,89.625 Q1519.6563,89.125 1518.9688,88.0547 Q1518.2813,86.9844 1518.2813,85.7031 L1518.2813,84.5469 Q1518.2813,83.2188 1518.8984,82.0703 Q1519.5156,80.9219 1520.6094,80.3047 Q1521.7031,79.6875 1522.9375,79.6875 Q1523.6719,79.6875 1524.3203,79.8516 Q1524.9688,80.0156 1525.5156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1543.25" y="90.2285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1368.5" x2="1824.5" y1="100.5" y2="100.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="111.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="1387.5" y="119.0332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1368.5" x2="1824.5" y1="126.1094" y2="126.1094"/><ellipse cx="1378.5" cy="140.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="432" x="1387.5" y="144.6426">UserLocationManager(userLocationProvider : UserLocationProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="182" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1578.5" y="736"/><ellipse cx="1607" cy="752" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1609.7656,747.875 Q1609.9219,747.6563 1610.1094,747.5469 Q1610.2969,747.4375 1610.5156,747.4375 Q1610.8906,747.4375 1611.125,747.6953 Q1611.3594,747.9531 1611.3594,748.5625 L1611.3594,750.0156 Q1611.3594,750.625 1611.125,750.8906 Q1610.8906,751.1563 1610.5156,751.1563 Q1610.1719,751.1563 1609.9688,750.9531 Q1609.7656,750.7656 1609.6563,750.25 Q1609.6094,749.8906 1609.4219,749.7031 Q1609.0938,749.3281 1608.4844,749.1094 Q1607.875,748.8906 1607.25,748.8906 Q1606.4844,748.8906 1605.8516,749.2188 Q1605.2188,749.5469 1604.7266,750.2969 Q1604.2344,751.0469 1604.2344,752.0781 L1604.2344,753.1719 Q1604.2344,754.4063 1605.125,755.2266 Q1606.0156,756.0469 1607.6094,756.0469 Q1608.5469,756.0469 1609.2031,755.7969 Q1609.5938,755.6406 1610.0156,755.2031 Q1610.2813,754.9375 1610.4297,754.8594 Q1610.5781,754.7813 1610.7813,754.7813 Q1611.1094,754.7813 1611.3672,755.0391 Q1611.625,755.2969 1611.625,755.6406 Q1611.625,755.9844 1611.2813,756.3906 Q1610.7813,756.9688 1609.9844,757.2969 Q1608.9063,757.75 1607.6094,757.75 Q1606.0938,757.75 1604.8906,757.125 Q1603.9063,756.625 1603.2188,755.5547 Q1602.5313,754.4844 1602.5313,753.2031 L1602.5313,752.0469 Q1602.5313,750.7188 1603.1484,749.5703 Q1603.7656,748.4219 1604.8594,747.8047 Q1605.9531,747.1875 1607.1875,747.1875 Q1607.9219,747.1875 1608.5703,747.3516 Q1609.2188,747.5156 1609.7656,747.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1624" y="757.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="1579.5" x2="1711.5" y1="768" y2="768"/><ellipse cx="1589.5" cy="782.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1598.5" y="786.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1579.5" x2="1711.5" y1="793.6094" y2="793.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="194" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="876.5" y="522.5"/><ellipse cx="908.6" cy="538.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M911.3656,534.375 Q911.5219,534.1563 911.7094,534.0469 Q911.8969,533.9375 912.1156,533.9375 Q912.4906,533.9375 912.725,534.1953 Q912.9594,534.4531 912.9594,535.0625 L912.9594,536.5156 Q912.9594,537.125 912.725,537.3906 Q912.4906,537.6563 912.1156,537.6563 Q911.7719,537.6563 911.5688,537.4531 Q911.3656,537.2656 911.2563,536.75 Q911.2094,536.3906 911.0219,536.2031 Q910.6938,535.8281 910.0844,535.6094 Q909.475,535.3906 908.85,535.3906 Q908.0844,535.3906 907.4516,535.7188 Q906.8188,536.0469 906.3266,536.7969 Q905.8344,537.5469 905.8344,538.5781 L905.8344,539.6719 Q905.8344,540.9063 906.725,541.7266 Q907.6156,542.5469 909.2094,542.5469 Q910.1469,542.5469 910.8031,542.2969 Q911.1938,542.1406 911.6156,541.7031 Q911.8813,541.4375 912.0297,541.3594 Q912.1781,541.2813 912.3813,541.2813 Q912.7094,541.2813 912.9672,541.5391 Q913.225,541.7969 913.225,542.1406 Q913.225,542.4844 912.8813,542.8906 Q912.3813,543.4688 911.5844,543.7969 Q910.5063,544.25 909.2094,544.25 Q907.6938,544.25 906.4906,543.625 Q905.5063,543.125 904.8188,542.0547 Q904.1313,540.9844 904.1313,539.7031 L904.1313,538.5469 Q904.1313,537.2188 904.7484,536.0703 Q905.3656,534.9219 906.4594,534.3047 Q907.5531,533.6875 908.7875,533.6875 Q909.5219,533.6875 910.1703,533.8516 Q910.8188,534.0156 911.3656,534.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="926.4" y="544.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="877.5" x2="1009.5" y1="554.5" y2="554.5"/><ellipse cx="887.5" cy="568.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="896.5" y="573.0332">Email : string</text><ellipse cx="887.5" cy="586.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="896.5" y="590.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="877.5" x2="1009.5" y1="597.7188" y2="597.7188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="87" fill="#F1F1F1" height="153.6563" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="397" x="2456" y="273"/><ellipse cx="2607.25" cy="289" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2608.2031,285.6406 L2608.2031,292.2969 L2609.9219,292.2969 Q2610.5313,292.2969 2610.7969,292.5313 Q2611.0625,292.7656 2611.0625,293.1563 Q2611.0625,293.5313 2610.7969,293.7656 Q2610.5313,294 2609.9219,294 L2604.7813,294 Q2604.1719,294 2603.9063,293.7656 Q2603.6406,293.5313 2603.6406,293.1406 Q2603.6406,292.7656 2603.9063,292.5313 Q2604.1719,292.2969 2604.7813,292.2969 L2606.5,292.2969 L2606.5,285.6406 L2604.7813,285.6406 Q2604.1719,285.6406 2603.9063,285.4063 Q2603.6406,285.1719 2603.6406,284.7813 Q2603.6406,284.4063 2603.9063,284.1719 Q2604.1719,283.9375 2604.7813,283.9375 L2609.9219,283.9375 Q2610.5313,283.9375 2610.7969,284.1719 Q2611.0625,284.4063 2611.0625,284.7813 Q2611.0625,285.1719 2610.7969,285.4063 Q2610.5313,285.6406 2609.9219,285.6406 L2608.2031,285.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="2627.75" y="294.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2457" x2="2852" y1="305" y2="305"/><line style="stroke:#181818;stroke-width:0.5;" x1="2457" x2="2852" y1="313" y2="313"/><ellipse cx="2467" cy="327.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2476" y="331.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2467" cy="344.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2476" y="349.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2467" cy="362.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2476" y="366.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2467" cy="380.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="2476" y="384.3613">UpdateUserFailedTries(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2467" cy="397.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2476" y="401.9707">UpdateUserLoginSuccess(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2467" cy="415.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="371" x="2476" y="419.5801">UpdateUserLoginNewLocation(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="96" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="2888.5" y="317"/><ellipse cx="3005.75" cy="333" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3006.7031,329.6406 L3006.7031,336.2969 L3008.4219,336.2969 Q3009.0313,336.2969 3009.2969,336.5313 Q3009.5625,336.7656 3009.5625,337.1563 Q3009.5625,337.5313 3009.2969,337.7656 Q3009.0313,338 3008.4219,338 L3003.2813,338 Q3002.6719,338 3002.4063,337.7656 Q3002.1406,337.5313 3002.1406,337.1406 Q3002.1406,336.7656 3002.4063,336.5313 Q3002.6719,336.2969 3003.2813,336.2969 L3005,336.2969 L3005,329.6406 L3003.2813,329.6406 Q3002.6719,329.6406 3002.4063,329.4063 Q3002.1406,329.1719 3002.1406,328.7813 Q3002.1406,328.4063 3002.4063,328.1719 Q3002.6719,327.9375 3003.2813,327.9375 L3008.4219,327.9375 Q3009.0313,327.9375 3009.2969,328.1719 Q3009.5625,328.4063 3009.5625,328.7813 Q3009.5625,329.1719 3009.2969,329.4063 Q3009.0313,329.6406 3008.4219,329.6406 L3006.7031,329.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="3026.25" y="338.7285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2889.5" x2="3295.5" y1="349" y2="349"/><line style="stroke:#181818;stroke-width:0.5;" x1="2889.5" x2="3295.5" y1="357" y2="357"/><ellipse cx="2899.5" cy="371.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="2908.5" y="375.5332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="160" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="280" y="513.5"/><ellipse cx="300.4" cy="529.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M303.1656,525.375 Q303.3219,525.1563 303.5094,525.0469 Q303.6969,524.9375 303.9156,524.9375 Q304.2906,524.9375 304.525,525.1953 Q304.7594,525.4531 304.7594,526.0625 L304.7594,527.5156 Q304.7594,528.125 304.525,528.3906 Q304.2906,528.6563 303.9156,528.6563 Q303.5719,528.6563 303.3688,528.4531 Q303.1656,528.2656 303.0563,527.75 Q303.0094,527.3906 302.8219,527.2031 Q302.4938,526.8281 301.8844,526.6094 Q301.275,526.3906 300.65,526.3906 Q299.8844,526.3906 299.2516,526.7188 Q298.6188,527.0469 298.1266,527.7969 Q297.6344,528.5469 297.6344,529.5781 L297.6344,530.6719 Q297.6344,531.9063 298.525,532.7266 Q299.4156,533.5469 301.0094,533.5469 Q301.9469,533.5469 302.6031,533.2969 Q302.9938,533.1406 303.4156,532.7031 Q303.6813,532.4375 303.8297,532.3594 Q303.9781,532.2813 304.1813,532.2813 Q304.5094,532.2813 304.7672,532.5391 Q305.025,532.7969 305.025,533.1406 Q305.025,533.4844 304.6813,533.8906 Q304.1813,534.4688 303.3844,534.7969 Q302.3063,535.25 301.0094,535.25 Q299.4938,535.25 298.2906,534.625 Q297.3063,534.125 296.6188,533.0547 Q295.9313,531.9844 295.9313,530.7031 L295.9313,529.5469 Q295.9313,528.2188 296.5484,527.0703 Q297.1656,525.9219 298.2594,525.3047 Q299.3531,524.6875 300.5875,524.6875 Q301.3219,524.6875 301.9703,524.8516 Q302.6188,525.0156 303.1656,525.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="315.6" y="535.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="281" x2="392" y1="545.5" y2="545.5"/><ellipse cx="291" cy="559.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="300" y="564.0332">UserID : int</text><ellipse cx="291" cy="577.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="300" y="581.6426">Email : string</text><ellipse cx="291" cy="595.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="300" y="599.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="281" x2="392" y1="606.3281" y2="606.3281"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="112" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1305.5" y="299.5"/><ellipse cx="1501.25" cy="315.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1502.2031,312.1406 L1502.2031,318.7969 L1503.9219,318.7969 Q1504.5313,318.7969 1504.7969,319.0313 Q1505.0625,319.2656 1505.0625,319.6563 Q1505.0625,320.0313 1504.7969,320.2656 Q1504.5313,320.5 1503.9219,320.5 L1498.7813,320.5 Q1498.1719,320.5 1497.9063,320.2656 Q1497.6406,320.0313 1497.6406,319.6406 Q1497.6406,319.2656 1497.9063,319.0313 Q1498.1719,318.7969 1498.7813,318.7969 L1500.5,318.7969 L1500.5,312.1406 L1498.7813,312.1406 Q1498.1719,312.1406 1497.9063,311.9063 Q1497.6406,311.6719 1497.6406,311.2813 Q1497.6406,310.9063 1497.9063,310.6719 Q1498.1719,310.4375 1498.7813,310.4375 L1503.9219,310.4375 Q1504.5313,310.4375 1504.7969,310.6719 Q1505.0625,310.9063 1505.0625,311.2813 Q1505.0625,311.6719 1504.7969,311.9063 Q1504.5313,312.1406 1503.9219,312.1406 L1502.2031,312.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="1521.75" y="321.2285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1306.5" x2="1844.5" y1="331.5" y2="331.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1306.5" x2="1844.5" y1="339.5" y2="339.5"/><ellipse cx="1316.5" cy="353.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1325.5" y="358.0332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1316.5" cy="371.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="1325.5" y="375.6426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1316.5" cy="389.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1325.5" y="393.252">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="100" fill="#F1F1F1" height="118.4375" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="3331.5" y="291"/><ellipse cx="3640.75" cy="307" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3643.5156,302.875 Q3643.6719,302.6563 3643.8594,302.5469 Q3644.0469,302.4375 3644.2656,302.4375 Q3644.6406,302.4375 3644.875,302.6953 Q3645.1094,302.9531 3645.1094,303.5625 L3645.1094,305.0156 Q3645.1094,305.625 3644.875,305.8906 Q3644.6406,306.1563 3644.2656,306.1563 Q3643.9219,306.1563 3643.7188,305.9531 Q3643.5156,305.7656 3643.4063,305.25 Q3643.3594,304.8906 3643.1719,304.7031 Q3642.8438,304.3281 3642.2344,304.1094 Q3641.625,303.8906 3641,303.8906 Q3640.2344,303.8906 3639.6016,304.2188 Q3638.9688,304.5469 3638.4766,305.2969 Q3637.9844,306.0469 3637.9844,307.0781 L3637.9844,308.1719 Q3637.9844,309.4063 3638.875,310.2266 Q3639.7656,311.0469 3641.3594,311.0469 Q3642.2969,311.0469 3642.9531,310.7969 Q3643.3438,310.6406 3643.7656,310.2031 Q3644.0313,309.9375 3644.1797,309.8594 Q3644.3281,309.7813 3644.5313,309.7813 Q3644.8594,309.7813 3645.1172,310.0391 Q3645.375,310.2969 3645.375,310.6406 Q3645.375,310.9844 3645.0313,311.3906 Q3644.5313,311.9688 3643.7344,312.2969 Q3642.6563,312.75 3641.3594,312.75 Q3639.8438,312.75 3638.6406,312.125 Q3637.6563,311.625 3636.9688,310.5547 Q3636.2813,309.4844 3636.2813,308.2031 L3636.2813,307.0469 Q3636.2813,305.7188 3636.8984,304.5703 Q3637.5156,303.4219 3638.6094,302.8047 Q3639.7031,302.1875 3640.9375,302.1875 Q3641.6719,302.1875 3642.3203,302.3516 Q3642.9688,302.5156 3643.5156,302.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="3661.25" y="312.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3332.5" x2="4030.5" y1="323" y2="323"/><line style="stroke:#181818;stroke-width:0.5;" x1="3332.5" x2="4030.5" y1="331" y2="331"/><ellipse cx="3342.5" cy="345.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3351.5" y="349.5332">SqlProvider(connection : string)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="3351.5" y="367.1426"> </text><polygon fill="#FFFF44" points="3342.5,375.5234,3346.5,379.5234,3342.5,383.5234,3338.5,379.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="3351.5" y="384.752">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3342.5,393.1328,3346.5,397.1328,3342.5,401.1328,3338.5,397.1328" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3351.5" y="402.3613">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="107" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3470" y="77"/><ellipse cx="3574.75" cy="93" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3577.5156,88.875 Q3577.6719,88.6563 3577.8594,88.5469 Q3578.0469,88.4375 3578.2656,88.4375 Q3578.6406,88.4375 3578.875,88.6953 Q3579.1094,88.9531 3579.1094,89.5625 L3579.1094,91.0156 Q3579.1094,91.625 3578.875,91.8906 Q3578.6406,92.1563 3578.2656,92.1563 Q3577.9219,92.1563 3577.7188,91.9531 Q3577.5156,91.7656 3577.4063,91.25 Q3577.3594,90.8906 3577.1719,90.7031 Q3576.8438,90.3281 3576.2344,90.1094 Q3575.625,89.8906 3575,89.8906 Q3574.2344,89.8906 3573.6016,90.2188 Q3572.9688,90.5469 3572.4766,91.2969 Q3571.9844,92.0469 3571.9844,93.0781 L3571.9844,94.1719 Q3571.9844,95.4063 3572.875,96.2266 Q3573.7656,97.0469 3575.3594,97.0469 Q3576.2969,97.0469 3576.9531,96.7969 Q3577.3438,96.6406 3577.7656,96.2031 Q3578.0313,95.9375 3578.1797,95.8594 Q3578.3281,95.7813 3578.5313,95.7813 Q3578.8594,95.7813 3579.1172,96.0391 Q3579.375,96.2969 3579.375,96.6406 Q3579.375,96.9844 3579.0313,97.3906 Q3578.5313,97.9688 3577.7344,98.2969 Q3576.6563,98.75 3575.3594,98.75 Q3573.8438,98.75 3572.6406,98.125 Q3571.6563,97.625 3570.9688,96.5547 Q3570.2813,95.4844 3570.2813,94.2031 L3570.2813,93.0469 Q3570.2813,91.7188 3570.8984,90.5703 Q3571.5156,89.4219 3572.6094,88.8047 Q3573.7031,88.1875 3574.9375,88.1875 Q3575.6719,88.1875 3576.3203,88.3516 Q3576.9688,88.5156 3577.5156,88.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="3595.25" y="98.7285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3471" x2="3848" y1="109" y2="109"/><ellipse cx="3481" cy="123.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3490" y="127.5332">LeakedPasswordProvider(configuration : IConfiguration)</text><line style="stroke:#181818;stroke-width:1.0;" x1="3471" x2="3848" y1="134.6094" y2="134.6094"/></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="118" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="3091.5" y="68.5"/><ellipse cx="3196.25" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3199.0156,80.375 Q3199.1719,80.1563 3199.3594,80.0469 Q3199.5469,79.9375 3199.7656,79.9375 Q3200.1406,79.9375 3200.375,80.1953 Q3200.6094,80.4531 3200.6094,81.0625 L3200.6094,82.5156 Q3200.6094,83.125 3200.375,83.3906 Q3200.1406,83.6563 3199.7656,83.6563 Q3199.4219,83.6563 3199.2188,83.4531 Q3199.0156,83.2656 3198.9063,82.75 Q3198.8594,82.3906 3198.6719,82.2031 Q3198.3438,81.8281 3197.7344,81.6094 Q3197.125,81.3906 3196.5,81.3906 Q3195.7344,81.3906 3195.1016,81.7188 Q3194.4688,82.0469 3193.9766,82.7969 Q3193.4844,83.5469 3193.4844,84.5781 L3193.4844,85.6719 Q3193.4844,86.9063 3194.375,87.7266 Q3195.2656,88.5469 3196.8594,88.5469 Q3197.7969,88.5469 3198.4531,88.2969 Q3198.8438,88.1406 3199.2656,87.7031 Q3199.5313,87.4375 3199.6797,87.3594 Q3199.8281,87.2813 3200.0313,87.2813 Q3200.3594,87.2813 3200.6172,87.5391 Q3200.875,87.7969 3200.875,88.1406 Q3200.875,88.4844 3200.5313,88.8906 Q3200.0313,89.4688 3199.2344,89.7969 Q3198.1563,90.25 3196.8594,90.25 Q3195.3438,90.25 3194.1406,89.625 Q3193.1563,89.125 3192.4688,88.0547 Q3191.7813,86.9844 3191.7813,85.7031 L3191.7813,84.5469 Q3191.7813,83.2188 3192.3984,82.0703 Q3193.0156,80.9219 3194.1094,80.3047 Q3195.2031,79.6875 3196.4375,79.6875 Q3197.1719,79.6875 3197.8203,79.8516 Q3198.4688,80.0156 3199.0156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3216.75" y="90.2285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3092.5" x2="3390.5" y1="100.5" y2="100.5"/><ellipse cx="3102.5" cy="114.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="3111.5" y="119.0332">UserProvider(configuration : IConfiguration)</text><line style="stroke:#181818;stroke-width:1.0;" x1="3092.5" x2="3390.5" y1="126.1094" y2="126.1094"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3099.5" y="137.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="3111.5" y="144.6426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="174" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="2121.5" y="496"/><ellipse cx="2198.75" cy="512" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2201.5156,507.875 Q2201.6719,507.6563 2201.8594,507.5469 Q2202.0469,507.4375 2202.2656,507.4375 Q2202.6406,507.4375 2202.875,507.6953 Q2203.1094,507.9531 2203.1094,508.5625 L2203.1094,510.0156 Q2203.1094,510.625 2202.875,510.8906 Q2202.6406,511.1563 2202.2656,511.1563 Q2201.9219,511.1563 2201.7188,510.9531 Q2201.5156,510.7656 2201.4063,510.25 Q2201.3594,509.8906 2201.1719,509.7031 Q2200.8438,509.3281 2200.2344,509.1094 Q2199.625,508.8906 2199,508.8906 Q2198.2344,508.8906 2197.6016,509.2188 Q2196.9688,509.5469 2196.4766,510.2969 Q2195.9844,511.0469 2195.9844,512.0781 L2195.9844,513.1719 Q2195.9844,514.4063 2196.875,515.2266 Q2197.7656,516.0469 2199.3594,516.0469 Q2200.2969,516.0469 2200.9531,515.7969 Q2201.3438,515.6406 2201.7656,515.2031 Q2202.0313,514.9375 2202.1797,514.8594 Q2202.3281,514.7813 2202.5313,514.7813 Q2202.8594,514.7813 2203.1172,515.0391 Q2203.375,515.2969 2203.375,515.6406 Q2203.375,515.9844 2203.0313,516.3906 Q2202.5313,516.9688 2201.7344,517.2969 Q2200.6563,517.75 2199.3594,517.75 Q2197.8438,517.75 2196.6406,517.125 Q2195.6563,516.625 2194.9688,515.5547 Q2194.2813,514.4844 2194.2813,513.2031 L2194.2813,512.0469 Q2194.2813,510.7188 2194.8984,509.5703 Q2195.5156,508.4219 2196.6094,507.8047 Q2197.7031,507.1875 2198.9375,507.1875 Q2199.6719,507.1875 2200.3203,507.3516 Q2200.9688,507.5156 2201.5156,507.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2219.25" y="517.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="2122.5" x2="2330.5" y1="528" y2="528"/><ellipse cx="2132.5" cy="542.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2141.5" y="546.5332">HashedPassword : string</text><ellipse cx="2132.5" cy="559.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="2141.5" y="564.1426">Salt : string</text><ellipse cx="2132.5" cy="577.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="2141.5" y="581.752">SecretKey : string</text><ellipse cx="2132.5" cy="595.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="2141.5" y="599.3613">Count : long</text><ellipse cx="2132.5" cy="612.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="2141.5" y="616.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="2122.5" x2="2330.5" y1="624.0469" y2="624.0469"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="199" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="1493" y="487"/><ellipse cx="1530.5" cy="503" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1533.2656,498.875 Q1533.4219,498.6563 1533.6094,498.5469 Q1533.7969,498.4375 1534.0156,498.4375 Q1534.3906,498.4375 1534.625,498.6953 Q1534.8594,498.9531 1534.8594,499.5625 L1534.8594,501.0156 Q1534.8594,501.625 1534.625,501.8906 Q1534.3906,502.1563 1534.0156,502.1563 Q1533.6719,502.1563 1533.4688,501.9531 Q1533.2656,501.7656 1533.1563,501.25 Q1533.1094,500.8906 1532.9219,500.7031 Q1532.5938,500.3281 1531.9844,500.1094 Q1531.375,499.8906 1530.75,499.8906 Q1529.9844,499.8906 1529.3516,500.2188 Q1528.7188,500.5469 1528.2266,501.2969 Q1527.7344,502.0469 1527.7344,503.0781 L1527.7344,504.1719 Q1527.7344,505.4063 1528.625,506.2266 Q1529.5156,507.0469 1531.1094,507.0469 Q1532.0469,507.0469 1532.7031,506.7969 Q1533.0938,506.6406 1533.5156,506.2031 Q1533.7813,505.9375 1533.9297,505.8594 Q1534.0781,505.7813 1534.2813,505.7813 Q1534.6094,505.7813 1534.8672,506.0391 Q1535.125,506.2969 1535.125,506.6406 Q1535.125,506.9844 1534.7813,507.3906 Q1534.2813,507.9688 1533.4844,508.2969 Q1532.4063,508.75 1531.1094,508.75 Q1529.5938,508.75 1528.3906,508.125 Q1527.4063,507.625 1526.7188,506.5547 Q1526.0313,505.4844 1526.0313,504.2031 L1526.0313,503.0469 Q1526.0313,501.7188 1526.6484,500.5703 Q1527.2656,499.4219 1528.3594,498.8047 Q1529.4531,498.1875 1530.6875,498.1875 Q1531.4219,498.1875 1532.0703,498.3516 Q1532.7188,498.5156 1533.2656,498.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="1549.5" y="508.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="1494" x2="1657" y1="519" y2="519"/><ellipse cx="1504" cy="533.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1513" y="537.5332">ID : int</text><ellipse cx="1504" cy="550.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="1513" y="555.1426">UserID : int</text><ellipse cx="1504" cy="568.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1513" y="572.752">IP : string</text><ellipse cx="1504" cy="586.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="1513" y="590.3613">UserAgent : string</text><ellipse cx="1504" cy="603.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1513" y="607.9707">Successful : bool</text><ellipse cx="1504" cy="621.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1513" y="625.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="1494" x2="1657" y1="632.6563" y2="632.6563"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="139" fill="#F1F1F1" height="136.0469" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="480" x="3884.5" y="42"/><ellipse cx="4094.75" cy="58" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4097.5156,53.875 Q4097.6719,53.6563 4097.8594,53.5469 Q4098.0469,53.4375 4098.2656,53.4375 Q4098.6406,53.4375 4098.875,53.6953 Q4099.1094,53.9531 4099.1094,54.5625 L4099.1094,56.0156 Q4099.1094,56.625 4098.875,56.8906 Q4098.6406,57.1563 4098.2656,57.1563 Q4097.9219,57.1563 4097.7188,56.9531 Q4097.5156,56.7656 4097.4063,56.25 Q4097.3594,55.8906 4097.1719,55.7031 Q4096.8438,55.3281 4096.2344,55.1094 Q4095.625,54.8906 4095,54.8906 Q4094.2344,54.8906 4093.6016,55.2188 Q4092.9688,55.5469 4092.4766,56.2969 Q4091.9844,57.0469 4091.9844,58.0781 L4091.9844,59.1719 Q4091.9844,60.4063 4092.875,61.2266 Q4093.7656,62.0469 4095.3594,62.0469 Q4096.2969,62.0469 4096.9531,61.7969 Q4097.3438,61.6406 4097.7656,61.2031 Q4098.0313,60.9375 4098.1797,60.8594 Q4098.3281,60.7813 4098.5313,60.7813 Q4098.8594,60.7813 4099.1172,61.0391 Q4099.375,61.2969 4099.375,61.6406 Q4099.375,61.9844 4099.0313,62.3906 Q4098.5313,62.9688 4097.7344,63.2969 Q4096.6563,63.75 4095.3594,63.75 Q4093.8438,63.75 4092.6406,63.125 Q4091.6563,62.625 4090.9688,61.5547 Q4090.2813,60.4844 4090.2813,59.2031 L4090.2813,58.0469 Q4090.2813,56.7188 4090.8984,55.5703 Q4091.5156,54.4219 4092.6094,53.8047 Q4093.7031,53.1875 4094.9375,53.1875 Q4095.6719,53.1875 4096.3203,53.3516 Q4096.9688,53.5156 4097.5156,53.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="4115.25" y="63.7285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="3885.5" x2="4363.5" y1="74" y2="74"/><line style="stroke:#181818;stroke-width:0.5;" x1="3885.5" x2="4363.5" y1="82" y2="82"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3892.5" y="93.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="312" x="3904.5" y="100.5332">GetEncryptedPassword(password : string) : string</text><ellipse cx="3895.5" cy="113.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="3904.5" y="118.1426">GetSalt(saltLength : int) : string</text><ellipse cx="3895.5" cy="131.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="454" x="3904.5" y="135.752">GetEncryptedAndSaltedPassword(password : string, salt : string) : string</text><ellipse cx="3895.5" cy="149.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="3904.5" y="153.3613">GetHotp(key : string, counter : long) : string</text><ellipse cx="3895.5" cy="166.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="3904.5" y="170.9707">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="147" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4399.5" y="77"/><ellipse cx="4548.75" cy="93" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4551.5156,88.875 Q4551.6719,88.6563 4551.8594,88.5469 Q4552.0469,88.4375 4552.2656,88.4375 Q4552.6406,88.4375 4552.875,88.6953 Q4553.1094,88.9531 4553.1094,89.5625 L4553.1094,91.0156 Q4553.1094,91.625 4552.875,91.8906 Q4552.6406,92.1563 4552.2656,92.1563 Q4551.9219,92.1563 4551.7188,91.9531 Q4551.5156,91.7656 4551.4063,91.25 Q4551.3594,90.8906 4551.1719,90.7031 Q4550.8438,90.3281 4550.2344,90.1094 Q4549.625,89.8906 4549,89.8906 Q4548.2344,89.8906 4547.6016,90.2188 Q4546.9688,90.5469 4546.4766,91.2969 Q4545.9844,92.0469 4545.9844,93.0781 L4545.9844,94.1719 Q4545.9844,95.4063 4546.875,96.2266 Q4547.7656,97.0469 4549.3594,97.0469 Q4550.2969,97.0469 4550.9531,96.7969 Q4551.3438,96.6406 4551.7656,96.2031 Q4552.0313,95.9375 4552.1797,95.8594 Q4552.3281,95.7813 4552.5313,95.7813 Q4552.8594,95.7813 4553.1172,96.0391 Q4553.375,96.2969 4553.375,96.6406 Q4553.375,96.9844 4553.0313,97.3906 Q4552.5313,97.9688 4551.7344,98.2969 Q4550.6563,98.75 4549.3594,98.75 Q4547.8438,98.75 4546.6406,98.125 Q4545.6563,97.625 4544.9688,96.5547 Q4544.2813,95.4844 4544.2813,94.2031 L4544.2813,93.0469 Q4544.2813,91.7188 4544.8984,90.5703 Q4545.5156,89.4219 4546.6094,88.8047 Q4547.7031,88.1875 4548.9375,88.1875 Q4549.6719,88.1875 4550.3203,88.3516 Q4550.9688,88.5156 4551.5156,88.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="4569.25" y="98.7285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4400.5" x2="4786.5" y1="109" y2="109"/><line style="stroke:#181818;stroke-width:0.5;" x1="4400.5" x2="4786.5" y1="117" y2="117"/><ellipse cx="4410.5" cy="131.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="4419.5" y="135.5332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="166" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1944.5" y="701"/><ellipse cx="2009.75" cy="717" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2012.5156,712.875 Q2012.6719,712.6563 2012.8594,712.5469 Q2013.0469,712.4375 2013.2656,712.4375 Q2013.6406,712.4375 2013.875,712.6953 Q2014.1094,712.9531 2014.1094,713.5625 L2014.1094,715.0156 Q2014.1094,715.625 2013.875,715.8906 Q2013.6406,716.1563 2013.2656,716.1563 Q2012.9219,716.1563 2012.7188,715.9531 Q2012.5156,715.7656 2012.4063,715.25 Q2012.3594,714.8906 2012.1719,714.7031 Q2011.8438,714.3281 2011.2344,714.1094 Q2010.625,713.8906 2010,713.8906 Q2009.2344,713.8906 2008.6016,714.2188 Q2007.9688,714.5469 2007.4766,715.2969 Q2006.9844,716.0469 2006.9844,717.0781 L2006.9844,718.1719 Q2006.9844,719.4063 2007.875,720.2266 Q2008.7656,721.0469 2010.3594,721.0469 Q2011.2969,721.0469 2011.9531,720.7969 Q2012.3438,720.6406 2012.7656,720.2031 Q2013.0313,719.9375 2013.1797,719.8594 Q2013.3281,719.7813 2013.5313,719.7813 Q2013.8594,719.7813 2014.1172,720.0391 Q2014.375,720.2969 2014.375,720.6406 Q2014.375,720.9844 2014.0313,721.3906 Q2013.5313,721.9688 2012.7344,722.2969 Q2011.6563,722.75 2010.3594,722.75 Q2008.8438,722.75 2007.6406,722.125 Q2006.6563,721.625 2005.9688,720.5547 Q2005.2813,719.4844 2005.2813,718.2031 L2005.2813,717.0469 Q2005.2813,715.7188 2005.8984,714.5703 Q2006.5156,713.4219 2007.6094,712.8047 Q2008.7031,712.1875 2009.9375,712.1875 Q2010.6719,712.1875 2011.3203,712.3516 Q2011.9688,712.5156 2012.5156,712.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="2030.25" y="722.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="1945.5" x2="2111.5" y1="733" y2="733"/><ellipse cx="1955.5" cy="747.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1964.5" y="751.5332">ID : int</text><ellipse cx="1955.5" cy="764.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1964.5" y="769.1426">IsVerified : bool</text><ellipse cx="1955.5" cy="782.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1964.5" y="786.752">IsLocked : bool</text><ellipse cx="1955.5" cy="800.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1964.5" y="804.3613">FailedTries : int</text><ellipse cx="1955.5" cy="817.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="1964.5" y="821.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1945.5" x2="2111.5" y1="829.0469" y2="829.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="186" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="1657" y="897"/><ellipse cx="1703.75" cy="913" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1706.5156,908.875 Q1706.6719,908.6563 1706.8594,908.5469 Q1707.0469,908.4375 1707.2656,908.4375 Q1707.6406,908.4375 1707.875,908.6953 Q1708.1094,908.9531 1708.1094,909.5625 L1708.1094,911.0156 Q1708.1094,911.625 1707.875,911.8906 Q1707.6406,912.1563 1707.2656,912.1563 Q1706.9219,912.1563 1706.7188,911.9531 Q1706.5156,911.7656 1706.4063,911.25 Q1706.3594,910.8906 1706.1719,910.7031 Q1705.8438,910.3281 1705.2344,910.1094 Q1704.625,909.8906 1704,909.8906 Q1703.2344,909.8906 1702.6016,910.2188 Q1701.9688,910.5469 1701.4766,911.2969 Q1700.9844,912.0469 1700.9844,913.0781 L1700.9844,914.1719 Q1700.9844,915.4063 1701.875,916.2266 Q1702.7656,917.0469 1704.3594,917.0469 Q1705.2969,917.0469 1705.9531,916.7969 Q1706.3438,916.6406 1706.7656,916.2031 Q1707.0313,915.9375 1707.1797,915.8594 Q1707.3281,915.7813 1707.5313,915.7813 Q1707.8594,915.7813 1708.1172,916.0391 Q1708.375,916.2969 1708.375,916.6406 Q1708.375,916.9844 1708.0313,917.3906 Q1707.5313,917.9688 1706.7344,918.2969 Q1705.6563,918.75 1704.3594,918.75 Q1702.8438,918.75 1701.6406,918.125 Q1700.6563,917.625 1699.9688,916.5547 Q1699.2813,915.4844 1699.2813,914.2031 L1699.2813,913.0469 Q1699.2813,911.7188 1699.8984,910.5703 Q1700.5156,909.4219 1701.6094,908.8047 Q1702.7031,908.1875 1703.9375,908.1875 Q1704.6719,908.1875 1705.3203,908.3516 Q1705.9688,908.5156 1706.5156,908.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1724.25" y="918.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="1658" x2="1819" y1="929" y2="929"/><ellipse cx="1668" cy="943.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1677" y="947.5332">Email : string</text><ellipse cx="1668" cy="960.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1677" y="965.1426">FirstName : string</text><ellipse cx="1668" cy="978.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1677" y="982.752">LastName : string</text><ellipse cx="1668" cy="996.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1677" y="1000.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1658" x2="1819" y1="1007.4375" y2="1007.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="21" d="M943.5,226.4 C943.5,248.71 943.5,271.18 943.5,290.68 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="943.5,213.31,939.5,219.31,943.5,225.31,947.5,219.31,943.5,213.31" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="22" d="M670.46,218.06 C598.1,246.43 523.4,275.72 463.04,299.38 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="683,213.14,675.9541,211.6055,671.8276,217.5193,678.8736,219.0538,683,213.14" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="71" d="M1041.48,409.2 C1189.64,497.21 1466.16,661.47 1586.75,733.1 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1591.32,735.82,1585.6093,727.7958,1587.0162,733.2749,1581.5371,734.6819,1591.32,735.82" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="72" d="M943.5,409.21 C943.5,443.16 943.5,485.39 943.5,517 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="943.5,522.37,947.5,513.37,943.5,517.37,939.5,513.37,943.5,522.37" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="73" d="M2031.64,186.42 C1968.13,195.82 1903.77,204.95 1842.5,213 C1596.51,245.32 1532.33,232.84 1287.5,273 C1262.49,277.1 1236.56,281.87 1210.67,286.97 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1211.88,293.87,1190.9,290.94,1209.13,280.14,1211.88,293.87" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="75" d="M2568.8,215.68 C2581.19,234.96 2593.91,254.75 2605.63,272.98 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2561.75,204.72,2561.627,211.9301,2568.2351,214.8167,2568.3581,207.6067,2561.75,204.72" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="76" d="M2352.55,212 C2307.93,242.26 2260.96,274.1 2223.55,299.47 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2363.53,204.55,2356.3191,204.6028,2353.5944,211.2793,2360.8053,211.2265,2363.53,204.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="77" d="M2746,209.46 C2841.39,247.88 2944.09,289.23 3012.71,316.87 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2733.81,204.55,2737.8807,210.5022,2744.9408,209.034,2740.87,203.0817,2733.81,204.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="79" d="M284.26,151.64 C293.56,186.78 307.21,238.34 318.22,279.94 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="325.03,278.32,323.38,299.45,311.5,281.91,325.03,278.32" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="80" d="M336.5,413.88 C336.5,445.62 336.5,483.57 336.5,513.24 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="336.5,400.7,332.5,406.7,336.5,412.7,340.5,406.7,336.5,400.7" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="83" d="M1690.79,151.51 C1780.35,189.98 1915.91,248.22 2016.64,291.49 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2019.41,285.07,2035.02,299.39,2013.89,297.93,2019.41,285.07" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="84" d="M1591.76,164.75 C1588.19,205.16 1583.34,260.1 1579.87,299.45 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1592.91,151.64,1588.3978,157.2649,1591.8545,163.5935,1596.3667,157.9686,1592.91,151.64" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="128" d="M2488.97,432.99 C2436.1,459.18 2379.07,487.43 2331.72,510.88 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2500.89,427.09,2493.7382,426.1675,2490.1359,432.4143,2497.2877,433.3369,2500.89,427.09" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="129" d="M1575.5,413.75 C1575.5,436.61 1575.5,462.72 1575.5,486.63 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1575.5,400.7,1571.5,406.7,1575.5,412.7,1579.5,406.7,1575.5,400.7" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="131" d="M3583.03,143.1 C3480.59,186.1 3298.85,262.38 3187.67,309.05 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3190.26,315.55,3169.11,316.84,3184.85,302.65,3190.26,315.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="132" d="M3662.47,143.1 C3665.48,175.74 3670.27,227.56 3674.29,271.05 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3681.27,270.41,3676.14,290.97,3667.32,271.7,3681.27,270.41" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="134" d="M3141.59,151.51 C3064.73,182.67 2955.89,226.8 2860.59,265.44 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2863.2,271.94,2842.03,272.96,2857.94,258.96,2863.2,271.94" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="135" d="M3316.64,151.64 C3382.33,187.18 3479.05,239.49 3556.4,281.33 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3559.84,275.24,3574.1,290.91,3553.18,287.55,3559.84,275.24" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="153" d="M1944.23,823.76 C1910.9,845.02 1872.34,869.62 1837.67,891.74 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1841.11,897.85,1820.48,902.7,1833.58,886.04,1841.11,897.85" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="154" d="M1661.7,802.22 C1672.31,823.34 1686.66,851.87 1700.07,878.56 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1706.43,875.62,1709.16,896.63,1693.92,881.91,1706.43,875.62" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="156" d="M2161.12,632.03 C2144.23,649.35 2125.85,668.19 2108.31,686.17 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2113.13,691.26,2094.15,700.69,2103.1,681.49,2113.13,691.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7a45627fbc1e42814c00fe40ab07a4c4]
>>>>>>> main
@startuml API class diagram

top to bottom direction

'Controllers'

class UserController{
    -_logger{readonly} : ILogger<UserController>
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    +UserController(logger : ILogger<UserController>, userManager : IUserManager, tokenManager : ITokenManager)
    
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
}

'Controllers mappings' 

UserController o- - IUserManager
UserController o- - ITokenManager

'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
<<<<<<< HEAD
=======
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger
>>>>>>> main
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager)
    - -
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}


'Managers mappings'

IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
<<<<<<< HEAD
=======
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
>>>>>>> main
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    +SqlProvider(connection : string)

    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    +LeakedPasswordProvider(configuration : IConfiguration)
    - -
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    +UserProvider(configuration : IConfiguration)
    - -
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

'Utility'

class Security{
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction


class UserController{
    -_logger{readonly} : ILogger<UserController>
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    +UserController(logger : ILogger<UserController>, userManager : IUserManager, tokenManager : ITokenManager)
    
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
}


UserController o- - IUserManager
UserController o- - ITokenManager


Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
<<<<<<< HEAD
=======
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger
>>>>>>> main
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager)
    - -
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}



IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
<<<<<<< HEAD
=======
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
>>>>>>> main
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    +SqlProvider(connection : string)

    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    +LeakedPasswordProvider(configuration : IConfiguration)
    - -
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    +UserProvider(configuration : IConfiguration)
    - -
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider


class Security{
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: da
Country: DK
--></g></svg>