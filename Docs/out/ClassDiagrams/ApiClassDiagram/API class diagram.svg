<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1110px" preserveAspectRatio="none" style="width:5384px;height:1110px;background:#FFFFFF;" version="1.1" viewBox="0 0 5384 1110" width="5384px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="188.875" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="521" x="644" y="42"/><ellipse cx="854.75" cy="58" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M857.5156,53.875 Q857.6719,53.6563 857.8594,53.5469 Q858.0469,53.4375 858.2656,53.4375 Q858.6406,53.4375 858.875,53.6953 Q859.1094,53.9531 859.1094,54.5625 L859.1094,56.0156 Q859.1094,56.625 858.875,56.8906 Q858.6406,57.1563 858.2656,57.1563 Q857.9219,57.1563 857.7188,56.9531 Q857.5156,56.7656 857.4063,56.25 Q857.3594,55.8906 857.1719,55.7031 Q856.8438,55.3281 856.2344,55.1094 Q855.625,54.8906 855,54.8906 Q854.2344,54.8906 853.6016,55.2188 Q852.9688,55.5469 852.4766,56.2969 Q851.9844,57.0469 851.9844,58.0781 L851.9844,59.1719 Q851.9844,60.4063 852.875,61.2266 Q853.7656,62.0469 855.3594,62.0469 Q856.2969,62.0469 856.9531,61.7969 Q857.3438,61.6406 857.7656,61.2031 Q858.0313,60.9375 858.1797,60.8594 Q858.3281,60.7813 858.5313,60.7813 Q858.8594,60.7813 859.1172,61.0391 Q859.375,61.2969 859.375,61.6406 Q859.375,61.9844 859.0313,62.3906 Q858.5313,62.9688 857.7344,63.2969 Q856.6563,63.75 855.3594,63.75 Q853.8438,63.75 852.6406,63.125 Q851.6563,62.625 850.9688,61.5547 Q850.2813,60.4844 850.2813,59.2031 L850.2813,58.0469 Q850.2813,56.7188 850.8984,55.5703 Q851.5156,54.4219 852.6094,53.8047 Q853.7031,53.1875 854.9375,53.1875 Q855.6719,53.1875 856.3203,53.3516 Q856.9688,53.5156 857.5156,53.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="875.25" y="63.7285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="645" x2="1164" y1="74" y2="74"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="652" y="85.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="664" y="92.5332">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="652" y="102.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="664" y="110.1426">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:1.0;" x1="645" x2="1164" y1="117.2188" y2="117.2188"/><ellipse cx="655" cy="131.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="664" y="135.752">UserController(userManager : IUserManager, tokenManager : ITokenManager)</text><ellipse cx="655" cy="149.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="664" y="153.3613">Create(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="655" cy="166.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="664" y="170.9707">Login(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="655" cy="184.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="318" x="664" y="188.5801">GetUserFromToken() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="655" cy="201.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="477" x="664" y="206.1895">VerificationLogin(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="655" cy="219.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="406" x="664" y="223.7988">VerifyUserRegister(UserLogin : UserLogin) : Task&lt;ActionResult&gt;</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="25" fill="#F1F1F1" height="136.0469" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="653" x="1066" y="352.5"/><ellipse cx="1342.75" cy="368.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1343.7031,365.1406 L1343.7031,371.7969 L1345.4219,371.7969 Q1346.0313,371.7969 1346.2969,372.0313 Q1346.5625,372.2656 1346.5625,372.6563 Q1346.5625,373.0313 1346.2969,373.2656 Q1346.0313,373.5 1345.4219,373.5 L1340.2813,373.5 Q1339.6719,373.5 1339.4063,373.2656 Q1339.1406,373.0313 1339.1406,372.6406 Q1339.1406,372.2656 1339.4063,372.0313 Q1339.6719,371.7969 1340.2813,371.7969 L1342,371.7969 L1342,365.1406 L1340.2813,365.1406 Q1339.6719,365.1406 1339.4063,364.9063 Q1339.1406,364.6719 1339.1406,364.2813 Q1339.1406,363.9063 1339.4063,363.6719 Q1339.6719,363.4375 1340.2813,363.4375 L1345.4219,363.4375 Q1346.0313,363.4375 1346.2969,363.6719 Q1346.5625,363.9063 1346.5625,364.2813 Q1346.5625,364.6719 1346.2969,364.9063 Q1346.0313,365.1406 1345.4219,365.1406 L1343.7031,365.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="1363.25" y="374.2285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1067" x2="1718" y1="384.5" y2="384.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1067" x2="1718" y1="392.5" y2="392.5"/><ellipse cx="1077" cy="406.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="361" x="1086" y="411.0332">CreateUserAsync(userCreate : UserCreate) : Task&lt;bool&gt;</text><ellipse cx="1077" cy="424.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="1086" y="428.6426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="1077" cy="442.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="1086" y="446.252">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="1077" cy="459.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="627" x="1086" y="463.8613">LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="1077" cy="477.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="595" x="1086" y="481.4707">VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="33" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="91.5" y="370"/><ellipse cx="218.25" cy="386" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M219.2031,382.6406 L219.2031,389.2969 L220.9219,389.2969 Q221.5313,389.2969 221.7969,389.5313 Q222.0625,389.7656 222.0625,390.1563 Q222.0625,390.5313 221.7969,390.7656 Q221.5313,391 220.9219,391 L215.7813,391 Q215.1719,391 214.9063,390.7656 Q214.6406,390.5313 214.6406,390.1406 Q214.6406,389.7656 214.9063,389.5313 Q215.1719,389.2969 215.7813,389.2969 L217.5,389.2969 L217.5,382.6406 L215.7813,382.6406 Q215.1719,382.6406 214.9063,382.4063 Q214.6406,382.1719 214.6406,381.7813 Q214.6406,381.4063 214.9063,381.1719 Q215.1719,380.9375 215.7813,380.9375 L220.9219,380.9375 Q221.5313,380.9375 221.7969,381.1719 Q222.0625,381.4063 222.0625,381.7813 Q222.0625,382.1719 221.7969,382.4063 Q221.5313,382.6406 220.9219,382.6406 L219.2031,382.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="238.75" y="391.7285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="92.5" x2="454.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:0.5;" x1="92.5" x2="454.5" y1="410" y2="410"/><ellipse cx="102.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="111.5" y="428.5332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="102.5" cy="441.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="111.5" y="446.1426">ValidateToken(token : string) : bool</text><ellipse cx="102.5" cy="459.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="111.5" y="463.752">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="40" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1754.5" y="370"/><ellipse cx="1947.75" cy="386" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1948.7031,382.6406 L1948.7031,389.2969 L1950.4219,389.2969 Q1951.0313,389.2969 1951.2969,389.5313 Q1951.5625,389.7656 1951.5625,390.1563 Q1951.5625,390.5313 1951.2969,390.7656 Q1951.0313,391 1950.4219,391 L1945.2813,391 Q1944.6719,391 1944.4063,390.7656 Q1944.1406,390.5313 1944.1406,390.1406 Q1944.1406,389.7656 1944.4063,389.5313 Q1944.6719,389.2969 1945.2813,389.2969 L1947,389.2969 L1947,382.6406 L1945.2813,382.6406 Q1944.6719,382.6406 1944.4063,382.4063 Q1944.1406,382.1719 1944.1406,381.7813 Q1944.1406,381.4063 1944.4063,381.1719 Q1944.6719,380.9375 1945.2813,380.9375 L1950.4219,380.9375 Q1951.0313,380.9375 1951.2969,381.1719 Q1951.5625,381.4063 1951.5625,381.7813 Q1951.5625,382.1719 1951.2969,382.4063 Q1951.0313,382.6406 1950.4219,382.6406 L1948.7031,382.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="1968.25" y="391.7285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1755.5" x2="2293.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:0.5;" x1="1755.5" x2="2293.5" y1="410" y2="410"/><ellipse cx="1765.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1774.5" y="428.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1765.5" cy="441.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="1774.5" y="446.1426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1765.5" cy="459.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1774.5" y="463.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[5bbb8fec178e848d13dc3ca00e0fbd40]
class IMessageManager--><g id="elem_IMessageManager"><rect codeLine="46" fill="#F1F1F1" height="83.2188" id="IMessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="459" x="2330" y="379"/><ellipse cx="2495.75" cy="395" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2496.7031,391.6406 L2496.7031,398.2969 L2498.4219,398.2969 Q2499.0313,398.2969 2499.2969,398.5313 Q2499.5625,398.7656 2499.5625,399.1563 Q2499.5625,399.5313 2499.2969,399.7656 Q2499.0313,400 2498.4219,400 L2493.2813,400 Q2492.6719,400 2492.4063,399.7656 Q2492.1406,399.5313 2492.1406,399.1406 Q2492.1406,398.7656 2492.4063,398.5313 Q2492.6719,398.2969 2493.2813,398.2969 L2495,398.2969 L2495,391.6406 L2493.2813,391.6406 Q2492.6719,391.6406 2492.4063,391.4063 Q2492.1406,391.1719 2492.1406,390.7813 Q2492.1406,390.4063 2492.4063,390.1719 Q2492.6719,389.9375 2493.2813,389.9375 L2498.4219,389.9375 Q2499.0313,389.9375 2499.2969,390.1719 Q2499.5625,390.4063 2499.5625,390.7813 Q2499.5625,391.1719 2499.2969,391.4063 Q2499.0313,391.6406 2498.4219,391.6406 L2496.7031,391.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="119" x="2516.25" y="400.7285">IMessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2331" x2="2788" y1="411" y2="411"/><line style="stroke:#181818;stroke-width:0.5;" x1="2331" x2="2788" y1="419" y2="419"/><ellipse cx="2341" cy="433.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="403" x="2350" y="437.5332">SendLoginAttemptMessage(to : string, otp : string) : Task&lt;bool&gt;</text><ellipse cx="2341" cy="450.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="433" x="2350" y="455.1426">SendLoginRegistrationMessage(to : string, key : string) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="51" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="95"/><ellipse cx="221.25" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,106.875 Q224.1719,106.6563 224.3594,106.5469 Q224.5469,106.4375 224.7656,106.4375 Q225.1406,106.4375 225.375,106.6953 Q225.6094,106.9531 225.6094,107.5625 L225.6094,109.0156 Q225.6094,109.625 225.375,109.8906 Q225.1406,110.1563 224.7656,110.1563 Q224.4219,110.1563 224.2188,109.9531 Q224.0156,109.7656 223.9063,109.25 Q223.8594,108.8906 223.6719,108.7031 Q223.3438,108.3281 222.7344,108.1094 Q222.125,107.8906 221.5,107.8906 Q220.7344,107.8906 220.1016,108.2188 Q219.4688,108.5469 218.9766,109.2969 Q218.4844,110.0469 218.4844,111.0781 L218.4844,112.1719 Q218.4844,113.4063 219.375,114.2266 Q220.2656,115.0469 221.8594,115.0469 Q222.7969,115.0469 223.4531,114.7969 Q223.8438,114.6406 224.2656,114.2031 Q224.5313,113.9375 224.6797,113.8594 Q224.8281,113.7813 225.0313,113.7813 Q225.3594,113.7813 225.6172,114.0391 Q225.875,114.2969 225.875,114.6406 Q225.875,114.9844 225.5313,115.3906 Q225.0313,115.9688 224.2344,116.2969 Q223.1563,116.75 221.8594,116.75 Q220.3438,116.75 219.1406,116.125 Q218.1563,115.625 217.4688,114.5547 Q216.7813,113.4844 216.7813,112.2031 L216.7813,111.0469 Q216.7813,109.7188 217.3984,108.5703 Q218.0156,107.4219 219.1094,106.8047 Q220.2031,106.1875 221.4375,106.1875 Q222.1719,106.1875 222.8203,106.3516 Q223.4688,106.5156 224.0156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="116.7285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="539" y1="135" y2="135"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="146.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="153.5332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="163.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="171.1426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="57" fill="#F1F1F1" height="259.3125" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="1128" x="2448.5" y="7"/><ellipse cx="2965.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2968.5156,18.875 Q2968.6719,18.6563 2968.8594,18.5469 Q2969.0469,18.4375 2969.2656,18.4375 Q2969.6406,18.4375 2969.875,18.6953 Q2970.1094,18.9531 2970.1094,19.5625 L2970.1094,21.0156 Q2970.1094,21.625 2969.875,21.8906 Q2969.6406,22.1563 2969.2656,22.1563 Q2968.9219,22.1563 2968.7188,21.9531 Q2968.5156,21.7656 2968.4063,21.25 Q2968.3594,20.8906 2968.1719,20.7031 Q2967.8438,20.3281 2967.2344,20.1094 Q2966.625,19.8906 2966,19.8906 Q2965.2344,19.8906 2964.6016,20.2188 Q2963.9688,20.5469 2963.4766,21.2969 Q2962.9844,22.0469 2962.9844,23.0781 L2962.9844,24.1719 Q2962.9844,25.4063 2963.875,26.2266 Q2964.7656,27.0469 2966.3594,27.0469 Q2967.2969,27.0469 2967.9531,26.7969 Q2968.3438,26.6406 2968.7656,26.2031 Q2969.0313,25.9375 2969.1797,25.8594 Q2969.3281,25.7813 2969.5313,25.7813 Q2969.8594,25.7813 2970.1172,26.0391 Q2970.375,26.2969 2970.375,26.6406 Q2970.375,26.9844 2970.0313,27.3906 Q2969.5313,27.9688 2968.7344,28.2969 Q2967.6563,28.75 2966.3594,28.75 Q2964.8438,28.75 2963.6406,28.125 Q2962.6563,27.625 2961.9688,26.5547 Q2961.2813,25.4844 2961.2813,24.2031 L2961.2813,23.0469 Q2961.2813,21.7188 2961.8984,20.5703 Q2962.5156,19.4219 2963.6094,18.8047 Q2964.7031,18.1875 2965.9375,18.1875 Q2966.6719,18.1875 2967.3203,18.3516 Q2967.9688,18.5156 2968.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="2986.25" y="28.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2449.5" x2="3575.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="2468.5" y="57.5332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2468.5" y="75.1426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="2468.5" y="92.752">_userLocationManager : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="103.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="249" x="2468.5" y="110.3613">_messageManager : IMessageManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="120.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="2468.5" y="127.9707">_logger : ILogger&lt;UserManager&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="138.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="2468.5" y="145.5801">_configuration : IConfiguration</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="155.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438" x="2468.5" y="163.1895">IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool</text><line style="stroke:#181818;stroke-width:1.0;" x1="2449.5" x2="3575.5" y1="170.2656" y2="170.2656"/><ellipse cx="2459.5" cy="184.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1102" x="2468.5" y="188.7988">UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="455" x="2468.5" y="206.4082">messageManager : IMessageManager, logger : ILogger&lt;UserManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="216.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="402" x="2468.5" y="224.0176">CheckPasswordLeakedForUser(password : string) : Task&lt;bool&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="234.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="433" x="2468.5" y="241.627">IsUserNotVerified(userLocation : UserLocation, user : DbUser) : Task</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2456.5" y="252.0078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="410" x="2468.5" y="259.2363">IsUserLocked(userLocation : UserLocation, user : DbUser) : Task</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="73" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="458" x="1235.5" y="95"/><ellipse cx="1390.75" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1393.5156,106.875 Q1393.6719,106.6563 1393.8594,106.5469 Q1394.0469,106.4375 1394.2656,106.4375 Q1394.6406,106.4375 1394.875,106.6953 Q1395.1094,106.9531 1395.1094,107.5625 L1395.1094,109.0156 Q1395.1094,109.625 1394.875,109.8906 Q1394.6406,110.1563 1394.2656,110.1563 Q1393.9219,110.1563 1393.7188,109.9531 Q1393.5156,109.7656 1393.4063,109.25 Q1393.3594,108.8906 1393.1719,108.7031 Q1392.8438,108.3281 1392.2344,108.1094 Q1391.625,107.8906 1391,107.8906 Q1390.2344,107.8906 1389.6016,108.2188 Q1388.9688,108.5469 1388.4766,109.2969 Q1387.9844,110.0469 1387.9844,111.0781 L1387.9844,112.1719 Q1387.9844,113.4063 1388.875,114.2266 Q1389.7656,115.0469 1391.3594,115.0469 Q1392.2969,115.0469 1392.9531,114.7969 Q1393.3438,114.6406 1393.7656,114.2031 Q1394.0313,113.9375 1394.1797,113.8594 Q1394.3281,113.7813 1394.5313,113.7813 Q1394.8594,113.7813 1395.1172,114.0391 Q1395.375,114.2969 1395.375,114.6406 Q1395.375,114.9844 1395.0313,115.3906 Q1394.5313,115.9688 1393.7344,116.2969 Q1392.6563,116.75 1391.3594,116.75 Q1389.8438,116.75 1388.6406,116.125 Q1387.6563,115.625 1386.9688,114.5547 Q1386.2813,113.4844 1386.2813,112.2031 L1386.2813,111.0469 Q1386.2813,109.7188 1386.8984,108.5703 Q1387.5156,107.4219 1388.6094,106.8047 Q1389.7031,106.1875 1390.9375,106.1875 Q1391.6719,106.1875 1392.3203,106.3516 Q1392.9688,106.5156 1393.5156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1411.25" y="116.7285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1236.5" x2="1692.5" y1="127" y2="127"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1243.5" y="138.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="1255.5" y="145.5332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="1236.5" x2="1692.5" y1="152.6094" y2="152.6094"/><ellipse cx="1246.5" cy="166.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="432" x="1255.5" y="171.1426">UserLocationManager(userLocationProvider : UserLocationProvider)</text></g><!--MD5=[20fcb2fa68efbd583f0fa2981cab489f]
class MessageManager--><g id="elem_MessageManager"><rect codeLine="78" fill="#F1F1F1" height="100.8281" id="MessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="668" x="1745.5" y="86"/><ellipse cx="2018.75" cy="102" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2021.5156,97.875 Q2021.6719,97.6563 2021.8594,97.5469 Q2022.0469,97.4375 2022.2656,97.4375 Q2022.6406,97.4375 2022.875,97.6953 Q2023.1094,97.9531 2023.1094,98.5625 L2023.1094,100.0156 Q2023.1094,100.625 2022.875,100.8906 Q2022.6406,101.1563 2022.2656,101.1563 Q2021.9219,101.1563 2021.7188,100.9531 Q2021.5156,100.7656 2021.4063,100.25 Q2021.3594,99.8906 2021.1719,99.7031 Q2020.8438,99.3281 2020.2344,99.1094 Q2019.625,98.8906 2019,98.8906 Q2018.2344,98.8906 2017.6016,99.2188 Q2016.9688,99.5469 2016.4766,100.2969 Q2015.9844,101.0469 2015.9844,102.0781 L2015.9844,103.1719 Q2015.9844,104.4063 2016.875,105.2266 Q2017.7656,106.0469 2019.3594,106.0469 Q2020.2969,106.0469 2020.9531,105.7969 Q2021.3438,105.6406 2021.7656,105.2031 Q2022.0313,104.9375 2022.1797,104.8594 Q2022.3281,104.7813 2022.5313,104.7813 Q2022.8594,104.7813 2023.1172,105.0391 Q2023.375,105.2969 2023.375,105.6406 Q2023.375,105.9844 2023.0313,106.3906 Q2022.5313,106.9688 2021.7344,107.2969 Q2020.6563,107.75 2019.3594,107.75 Q2017.8438,107.75 2016.6406,107.125 Q2015.6563,106.625 2014.9688,105.5547 Q2014.2813,104.4844 2014.2813,103.2031 L2014.2813,102.0469 Q2014.2813,100.7188 2014.8984,99.5703 Q2015.5156,98.4219 2016.6094,97.8047 Q2017.7031,97.1875 2018.9375,97.1875 Q2019.6719,97.1875 2020.3203,97.3516 Q2020.9688,97.5156 2021.5156,97.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="2039.25" y="107.7285">MessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1746.5" x2="2412.5" y1="118" y2="118"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1753.5" y="129.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="1765.5" y="136.5332">_messageService : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1753.5" y="146.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="1765.5" y="154.1426">_messageProvider : IMessageProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1746.5" x2="2412.5" y1="161.2188" y2="161.2188"/><ellipse cx="1756.5" cy="175.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="642" x="1765.5" y="179.752">MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="206" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="2477.5" y="824"/><ellipse cx="2506" cy="840" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2508.7656,835.875 Q2508.9219,835.6563 2509.1094,835.5469 Q2509.2969,835.4375 2509.5156,835.4375 Q2509.8906,835.4375 2510.125,835.6953 Q2510.3594,835.9531 2510.3594,836.5625 L2510.3594,838.0156 Q2510.3594,838.625 2510.125,838.8906 Q2509.8906,839.1563 2509.5156,839.1563 Q2509.1719,839.1563 2508.9688,838.9531 Q2508.7656,838.7656 2508.6563,838.25 Q2508.6094,837.8906 2508.4219,837.7031 Q2508.0938,837.3281 2507.4844,837.1094 Q2506.875,836.8906 2506.25,836.8906 Q2505.4844,836.8906 2504.8516,837.2188 Q2504.2188,837.5469 2503.7266,838.2969 Q2503.2344,839.0469 2503.2344,840.0781 L2503.2344,841.1719 Q2503.2344,842.4063 2504.125,843.2266 Q2505.0156,844.0469 2506.6094,844.0469 Q2507.5469,844.0469 2508.2031,843.7969 Q2508.5938,843.6406 2509.0156,843.2031 Q2509.2813,842.9375 2509.4297,842.8594 Q2509.5781,842.7813 2509.7813,842.7813 Q2510.1094,842.7813 2510.3672,843.0391 Q2510.625,843.2969 2510.625,843.6406 Q2510.625,843.9844 2510.2813,844.3906 Q2509.7813,844.9688 2508.9844,845.2969 Q2507.9063,845.75 2506.6094,845.75 Q2505.0938,845.75 2503.8906,845.125 Q2502.9063,844.625 2502.2188,843.5547 Q2501.5313,842.4844 2501.5313,841.2031 L2501.5313,840.0469 Q2501.5313,838.7188 2502.1484,837.5703 Q2502.7656,836.4219 2503.8594,835.8047 Q2504.9531,835.1875 2506.1875,835.1875 Q2506.9219,835.1875 2507.5703,835.3516 Q2508.2188,835.5156 2508.7656,835.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="2523" y="845.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="2478.5" x2="2610.5" y1="856" y2="856"/><ellipse cx="2488.5" cy="870.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="2497.5" y="874.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="2478.5" x2="2610.5" y1="881.6094" y2="881.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="218" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1325.5" y="610.5"/><ellipse cx="1357.6" cy="626.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1360.3656,622.375 Q1360.5219,622.1563 1360.7094,622.0469 Q1360.8969,621.9375 1361.1156,621.9375 Q1361.4906,621.9375 1361.725,622.1953 Q1361.9594,622.4531 1361.9594,623.0625 L1361.9594,624.5156 Q1361.9594,625.125 1361.725,625.3906 Q1361.4906,625.6563 1361.1156,625.6563 Q1360.7719,625.6563 1360.5688,625.4531 Q1360.3656,625.2656 1360.2563,624.75 Q1360.2094,624.3906 1360.0219,624.2031 Q1359.6938,623.8281 1359.0844,623.6094 Q1358.475,623.3906 1357.85,623.3906 Q1357.0844,623.3906 1356.4516,623.7188 Q1355.8188,624.0469 1355.3266,624.7969 Q1354.8344,625.5469 1354.8344,626.5781 L1354.8344,627.6719 Q1354.8344,628.9063 1355.725,629.7266 Q1356.6156,630.5469 1358.2094,630.5469 Q1359.1469,630.5469 1359.8031,630.2969 Q1360.1938,630.1406 1360.6156,629.7031 Q1360.8813,629.4375 1361.0297,629.3594 Q1361.1781,629.2813 1361.3813,629.2813 Q1361.7094,629.2813 1361.9672,629.5391 Q1362.225,629.7969 1362.225,630.1406 Q1362.225,630.4844 1361.8813,630.8906 Q1361.3813,631.4688 1360.5844,631.7969 Q1359.5063,632.25 1358.2094,632.25 Q1356.6938,632.25 1355.4906,631.625 Q1354.5063,631.125 1353.8188,630.0547 Q1353.1313,628.9844 1353.1313,627.7031 L1353.1313,626.5469 Q1353.1313,625.2188 1353.7484,624.0703 Q1354.3656,622.9219 1355.4594,622.3047 Q1356.5531,621.6875 1357.7875,621.6875 Q1358.5219,621.6875 1359.1703,621.8516 Q1359.8188,622.0156 1360.3656,622.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1375.4" y="632.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="1326.5" x2="1458.5" y1="642.5" y2="642.5"/><ellipse cx="1336.5" cy="656.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1345.5" y="661.0332">Email : string</text><ellipse cx="1336.5" cy="674.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1345.5" y="678.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1326.5" x2="1458.5" y1="685.7188" y2="685.7188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="106" fill="#F1F1F1" height="188.875" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="502" x="2824.5" y="326"/><ellipse cx="3028.25" cy="342" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3029.2031,338.6406 L3029.2031,345.2969 L3030.9219,345.2969 Q3031.5313,345.2969 3031.7969,345.5313 Q3032.0625,345.7656 3032.0625,346.1563 Q3032.0625,346.5313 3031.7969,346.7656 Q3031.5313,347 3030.9219,347 L3025.7813,347 Q3025.1719,347 3024.9063,346.7656 Q3024.6406,346.5313 3024.6406,346.1406 Q3024.6406,345.7656 3024.9063,345.5313 Q3025.1719,345.2969 3025.7813,345.2969 L3027.5,345.2969 L3027.5,338.6406 L3025.7813,338.6406 Q3025.1719,338.6406 3024.9063,338.4063 Q3024.6406,338.1719 3024.6406,337.7813 Q3024.6406,337.4063 3024.9063,337.1719 Q3025.1719,336.9375 3025.7813,336.9375 L3030.9219,336.9375 Q3031.5313,336.9375 3031.7969,337.1719 Q3032.0625,337.4063 3032.0625,337.7813 Q3032.0625,338.1719 3031.7969,338.4063 Q3031.5313,338.6406 3030.9219,338.6406 L3029.2031,338.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="3048.75" y="347.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2825.5" x2="3325.5" y1="358" y2="358"/><line style="stroke:#181818;stroke-width:0.5;" x1="2825.5" x2="3325.5" y1="366" y2="366"/><ellipse cx="2835.5" cy="380.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2844.5" y="384.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2835.5" cy="397.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2844.5" y="402.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2835.5" cy="415.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2844.5" y="419.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2835.5" cy="433.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="2844.5" y="437.3613">UpdateUserFailedTries(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2835.5" cy="450.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2844.5" y="454.9707">UpdateUserLoginSuccess(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2835.5" cy="468.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="371" x="2844.5" y="472.5801">UpdateUserLoginNewLocation(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2835.5" cy="485.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="298" x="2844.5" y="490.1895">UpdateUserToVerifiedAsync(userID : int) : Task</text><ellipse cx="2835.5" cy="503.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="476" x="2844.5" y="507.7988">UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="117" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="3361.5" y="387.5"/><ellipse cx="3478.75" cy="403.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3479.7031,400.1406 L3479.7031,406.7969 L3481.4219,406.7969 Q3482.0313,406.7969 3482.2969,407.0313 Q3482.5625,407.2656 3482.5625,407.6563 Q3482.5625,408.0313 3482.2969,408.2656 Q3482.0313,408.5 3481.4219,408.5 L3476.2813,408.5 Q3475.6719,408.5 3475.4063,408.2656 Q3475.1406,408.0313 3475.1406,407.6406 Q3475.1406,407.2656 3475.4063,407.0313 Q3475.6719,406.7969 3476.2813,406.7969 L3478,406.7969 L3478,400.1406 L3476.2813,400.1406 Q3475.6719,400.1406 3475.4063,399.9063 Q3475.1406,399.6719 3475.1406,399.2813 Q3475.1406,398.9063 3475.4063,398.6719 Q3475.6719,398.4375 3476.2813,398.4375 L3481.4219,398.4375 Q3482.0313,398.4375 3482.2969,398.6719 Q3482.5625,398.9063 3482.5625,399.2813 Q3482.5625,399.6719 3482.2969,399.9063 Q3482.0313,400.1406 3481.4219,400.1406 L3479.7031,400.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="3499.25" y="409.2285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3362.5" x2="3768.5" y1="419.5" y2="419.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="3362.5" x2="3768.5" y1="427.5" y2="427.5"/><ellipse cx="3372.5" cy="441.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="3381.5" y="446.0332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="184" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="217" y="601.5"/><ellipse cx="237.4" cy="617.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M240.1656,613.375 Q240.3219,613.1563 240.5094,613.0469 Q240.6969,612.9375 240.9156,612.9375 Q241.2906,612.9375 241.525,613.1953 Q241.7594,613.4531 241.7594,614.0625 L241.7594,615.5156 Q241.7594,616.125 241.525,616.3906 Q241.2906,616.6563 240.9156,616.6563 Q240.5719,616.6563 240.3688,616.4531 Q240.1656,616.2656 240.0563,615.75 Q240.0094,615.3906 239.8219,615.2031 Q239.4938,614.8281 238.8844,614.6094 Q238.275,614.3906 237.65,614.3906 Q236.8844,614.3906 236.2516,614.7188 Q235.6188,615.0469 235.1266,615.7969 Q234.6344,616.5469 234.6344,617.5781 L234.6344,618.6719 Q234.6344,619.9063 235.525,620.7266 Q236.4156,621.5469 238.0094,621.5469 Q238.9469,621.5469 239.6031,621.2969 Q239.9938,621.1406 240.4156,620.7031 Q240.6813,620.4375 240.8297,620.3594 Q240.9781,620.2813 241.1813,620.2813 Q241.5094,620.2813 241.7672,620.5391 Q242.025,620.7969 242.025,621.1406 Q242.025,621.4844 241.6813,621.8906 Q241.1813,622.4688 240.3844,622.7969 Q239.3063,623.25 238.0094,623.25 Q236.4938,623.25 235.2906,622.625 Q234.3063,622.125 233.6188,621.0547 Q232.9313,619.9844 232.9313,618.7031 L232.9313,617.5469 Q232.9313,616.2188 233.5484,615.0703 Q234.1656,613.9219 235.2594,613.3047 Q236.3531,612.6875 237.5875,612.6875 Q238.3219,612.6875 238.9703,612.8516 Q239.6188,613.0156 240.1656,613.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="252.6" y="623.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="218" x2="329" y1="633.5" y2="633.5"/><ellipse cx="228" cy="647.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="237" y="652.0332">UserID : int</text><ellipse cx="228" cy="665.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="237" y="669.6426">Email : string</text><ellipse cx="228" cy="683.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="237" y="687.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="218" x2="329" y1="694.3281" y2="694.3281"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="133" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="490.5" y="370"/><ellipse cx="686.25" cy="386" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M687.2031,382.6406 L687.2031,389.2969 L688.9219,389.2969 Q689.5313,389.2969 689.7969,389.5313 Q690.0625,389.7656 690.0625,390.1563 Q690.0625,390.5313 689.7969,390.7656 Q689.5313,391 688.9219,391 L683.7813,391 Q683.1719,391 682.9063,390.7656 Q682.6406,390.5313 682.6406,390.1406 Q682.6406,389.7656 682.9063,389.5313 Q683.1719,389.2969 683.7813,389.2969 L685.5,389.2969 L685.5,382.6406 L683.7813,382.6406 Q683.1719,382.6406 682.9063,382.4063 Q682.6406,382.1719 682.6406,381.7813 Q682.6406,381.4063 682.9063,381.1719 Q683.1719,380.9375 683.7813,380.9375 L688.9219,380.9375 Q689.5313,380.9375 689.7969,381.1719 Q690.0625,381.4063 690.0625,381.7813 Q690.0625,382.1719 689.7969,382.4063 Q689.5313,382.6406 688.9219,382.6406 L687.2031,382.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="706.75" y="391.7285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="491.5" x2="1029.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:0.5;" x1="491.5" x2="1029.5" y1="410" y2="410"/><ellipse cx="501.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="510.5" y="428.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="501.5" cy="441.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="510.5" y="446.1426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="501.5" cy="459.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="510.5" y="463.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="121" fill="#F1F1F1" height="100.8281" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="3804.5" y="370"/><ellipse cx="4113.75" cy="386" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4116.5156,381.875 Q4116.6719,381.6563 4116.8594,381.5469 Q4117.0469,381.4375 4117.2656,381.4375 Q4117.6406,381.4375 4117.875,381.6953 Q4118.1094,381.9531 4118.1094,382.5625 L4118.1094,384.0156 Q4118.1094,384.625 4117.875,384.8906 Q4117.6406,385.1563 4117.2656,385.1563 Q4116.9219,385.1563 4116.7188,384.9531 Q4116.5156,384.7656 4116.4063,384.25 Q4116.3594,383.8906 4116.1719,383.7031 Q4115.8438,383.3281 4115.2344,383.1094 Q4114.625,382.8906 4114,382.8906 Q4113.2344,382.8906 4112.6016,383.2188 Q4111.9688,383.5469 4111.4766,384.2969 Q4110.9844,385.0469 4110.9844,386.0781 L4110.9844,387.1719 Q4110.9844,388.4063 4111.875,389.2266 Q4112.7656,390.0469 4114.3594,390.0469 Q4115.2969,390.0469 4115.9531,389.7969 Q4116.3438,389.6406 4116.7656,389.2031 Q4117.0313,388.9375 4117.1797,388.8594 Q4117.3281,388.7813 4117.5313,388.7813 Q4117.8594,388.7813 4118.1172,389.0391 Q4118.375,389.2969 4118.375,389.6406 Q4118.375,389.9844 4118.0313,390.3906 Q4117.5313,390.9688 4116.7344,391.2969 Q4115.6563,391.75 4114.3594,391.75 Q4112.8438,391.75 4111.6406,391.125 Q4110.6563,390.625 4109.9688,389.5547 Q4109.2813,388.4844 4109.2813,387.2031 L4109.2813,386.0469 Q4109.2813,384.7188 4109.8984,383.5703 Q4110.5156,382.4219 4111.6094,381.8047 Q4112.7031,381.1875 4113.9375,381.1875 Q4114.6719,381.1875 4115.3203,381.3516 Q4115.9688,381.5156 4116.5156,381.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="4134.25" y="391.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3805.5" x2="4503.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:1.0;" x1="3805.5" x2="4503.5" y1="410" y2="410"/><ellipse cx="3815.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3824.5" y="428.5332">SqlProvider(connection : string)</text><polygon fill="#FFFF44" points="3815.5,436.9141,3819.5,440.9141,3815.5,444.9141,3811.5,440.9141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="3824.5" y="446.1426">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3815.5,454.5234,3819.5,458.5234,3815.5,462.5234,3811.5,458.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3824.5" y="463.752">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="128" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3960" y="103.5"/><ellipse cx="4064.75" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4067.5156,115.375 Q4067.6719,115.1563 4067.8594,115.0469 Q4068.0469,114.9375 4068.2656,114.9375 Q4068.6406,114.9375 4068.875,115.1953 Q4069.1094,115.4531 4069.1094,116.0625 L4069.1094,117.5156 Q4069.1094,118.125 4068.875,118.3906 Q4068.6406,118.6563 4068.2656,118.6563 Q4067.9219,118.6563 4067.7188,118.4531 Q4067.5156,118.2656 4067.4063,117.75 Q4067.3594,117.3906 4067.1719,117.2031 Q4066.8438,116.8281 4066.2344,116.6094 Q4065.625,116.3906 4065,116.3906 Q4064.2344,116.3906 4063.6016,116.7188 Q4062.9688,117.0469 4062.4766,117.7969 Q4061.9844,118.5469 4061.9844,119.5781 L4061.9844,120.6719 Q4061.9844,121.9063 4062.875,122.7266 Q4063.7656,123.5469 4065.3594,123.5469 Q4066.2969,123.5469 4066.9531,123.2969 Q4067.3438,123.1406 4067.7656,122.7031 Q4068.0313,122.4375 4068.1797,122.3594 Q4068.3281,122.2813 4068.5313,122.2813 Q4068.8594,122.2813 4069.1172,122.5391 Q4069.375,122.7969 4069.375,123.1406 Q4069.375,123.4844 4069.0313,123.8906 Q4068.5313,124.4688 4067.7344,124.7969 Q4066.6563,125.25 4065.3594,125.25 Q4063.8438,125.25 4062.6406,124.625 Q4061.6563,124.125 4060.9688,123.0547 Q4060.2813,121.9844 4060.2813,120.7031 L4060.2813,119.5469 Q4060.2813,118.2188 4060.8984,117.0703 Q4061.5156,115.9219 4062.6094,115.3047 Q4063.7031,114.6875 4064.9375,114.6875 Q4065.6719,114.6875 4066.3203,114.8516 Q4066.9688,115.0156 4067.5156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="4085.25" y="125.2285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3961" x2="4338" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3961" x2="4338" y1="143.5" y2="143.5"/><ellipse cx="3971" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3980" y="162.0332">LeakedPasswordProvider(configuration : IConfiguration)</text></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="139" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="3620.5" y="95"/><ellipse cx="3725.25" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3728.0156,106.875 Q3728.1719,106.6563 3728.3594,106.5469 Q3728.5469,106.4375 3728.7656,106.4375 Q3729.1406,106.4375 3729.375,106.6953 Q3729.6094,106.9531 3729.6094,107.5625 L3729.6094,109.0156 Q3729.6094,109.625 3729.375,109.8906 Q3729.1406,110.1563 3728.7656,110.1563 Q3728.4219,110.1563 3728.2188,109.9531 Q3728.0156,109.7656 3727.9063,109.25 Q3727.8594,108.8906 3727.6719,108.7031 Q3727.3438,108.3281 3726.7344,108.1094 Q3726.125,107.8906 3725.5,107.8906 Q3724.7344,107.8906 3724.1016,108.2188 Q3723.4688,108.5469 3722.9766,109.2969 Q3722.4844,110.0469 3722.4844,111.0781 L3722.4844,112.1719 Q3722.4844,113.4063 3723.375,114.2266 Q3724.2656,115.0469 3725.8594,115.0469 Q3726.7969,115.0469 3727.4531,114.7969 Q3727.8438,114.6406 3728.2656,114.2031 Q3728.5313,113.9375 3728.6797,113.8594 Q3728.8281,113.7813 3729.0313,113.7813 Q3729.3594,113.7813 3729.6172,114.0391 Q3729.875,114.2969 3729.875,114.6406 Q3729.875,114.9844 3729.5313,115.3906 Q3729.0313,115.9688 3728.2344,116.2969 Q3727.1563,116.75 3725.8594,116.75 Q3724.3438,116.75 3723.1406,116.125 Q3722.1563,115.625 3721.4688,114.5547 Q3720.7813,113.4844 3720.7813,112.2031 L3720.7813,111.0469 Q3720.7813,109.7188 3721.3984,108.5703 Q3722.0156,107.4219 3723.1094,106.8047 Q3724.2031,106.1875 3725.4375,106.1875 Q3726.1719,106.1875 3726.8203,106.3516 Q3727.4688,106.5156 3728.0156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3745.75" y="116.7285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3621.5" x2="3919.5" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="3621.5" x2="3919.5" y1="135" y2="135"/><ellipse cx="3631.5" cy="149.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="3640.5" y="153.5332">UserProvider(configuration : IConfiguration)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3628.5" y="163.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="3640.5" y="171.1426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="198" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="2883.5" y="584"/><ellipse cx="2960.75" cy="600" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2963.5156,595.875 Q2963.6719,595.6563 2963.8594,595.5469 Q2964.0469,595.4375 2964.2656,595.4375 Q2964.6406,595.4375 2964.875,595.6953 Q2965.1094,595.9531 2965.1094,596.5625 L2965.1094,598.0156 Q2965.1094,598.625 2964.875,598.8906 Q2964.6406,599.1563 2964.2656,599.1563 Q2963.9219,599.1563 2963.7188,598.9531 Q2963.5156,598.7656 2963.4063,598.25 Q2963.3594,597.8906 2963.1719,597.7031 Q2962.8438,597.3281 2962.2344,597.1094 Q2961.625,596.8906 2961,596.8906 Q2960.2344,596.8906 2959.6016,597.2188 Q2958.9688,597.5469 2958.4766,598.2969 Q2957.9844,599.0469 2957.9844,600.0781 L2957.9844,601.1719 Q2957.9844,602.4063 2958.875,603.2266 Q2959.7656,604.0469 2961.3594,604.0469 Q2962.2969,604.0469 2962.9531,603.7969 Q2963.3438,603.6406 2963.7656,603.2031 Q2964.0313,602.9375 2964.1797,602.8594 Q2964.3281,602.7813 2964.5313,602.7813 Q2964.8594,602.7813 2965.1172,603.0391 Q2965.375,603.2969 2965.375,603.6406 Q2965.375,603.9844 2965.0313,604.3906 Q2964.5313,604.9688 2963.7344,605.2969 Q2962.6563,605.75 2961.3594,605.75 Q2959.8438,605.75 2958.6406,605.125 Q2957.6563,604.625 2956.9688,603.5547 Q2956.2813,602.4844 2956.2813,601.2031 L2956.2813,600.0469 Q2956.2813,598.7188 2956.8984,597.5703 Q2957.5156,596.4219 2958.6094,595.8047 Q2959.7031,595.1875 2960.9375,595.1875 Q2961.6719,595.1875 2962.3203,595.3516 Q2962.9688,595.5156 2963.5156,595.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2981.25" y="605.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="2884.5" x2="3092.5" y1="616" y2="616"/><ellipse cx="2894.5" cy="630.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2903.5" y="634.5332">HashedPassword : string</text><ellipse cx="2894.5" cy="647.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="2903.5" y="652.1426">Salt : string</text><ellipse cx="2894.5" cy="665.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="2903.5" y="669.752">SecretKey : string</text><ellipse cx="2894.5" cy="683.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="2903.5" y="687.3613">Count : long</text><ellipse cx="2894.5" cy="700.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="2903.5" y="704.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="2884.5" x2="3092.5" y1="712.0469" y2="712.0469"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="223" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="678" y="575"/><ellipse cx="715.5" cy="591" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M718.2656,586.875 Q718.4219,586.6563 718.6094,586.5469 Q718.7969,586.4375 719.0156,586.4375 Q719.3906,586.4375 719.625,586.6953 Q719.8594,586.9531 719.8594,587.5625 L719.8594,589.0156 Q719.8594,589.625 719.625,589.8906 Q719.3906,590.1563 719.0156,590.1563 Q718.6719,590.1563 718.4688,589.9531 Q718.2656,589.7656 718.1563,589.25 Q718.1094,588.8906 717.9219,588.7031 Q717.5938,588.3281 716.9844,588.1094 Q716.375,587.8906 715.75,587.8906 Q714.9844,587.8906 714.3516,588.2188 Q713.7188,588.5469 713.2266,589.2969 Q712.7344,590.0469 712.7344,591.0781 L712.7344,592.1719 Q712.7344,593.4063 713.625,594.2266 Q714.5156,595.0469 716.1094,595.0469 Q717.0469,595.0469 717.7031,594.7969 Q718.0938,594.6406 718.5156,594.2031 Q718.7813,593.9375 718.9297,593.8594 Q719.0781,593.7813 719.2813,593.7813 Q719.6094,593.7813 719.8672,594.0391 Q720.125,594.2969 720.125,594.6406 Q720.125,594.9844 719.7813,595.3906 Q719.2813,595.9688 718.4844,596.2969 Q717.4063,596.75 716.1094,596.75 Q714.5938,596.75 713.3906,596.125 Q712.4063,595.625 711.7188,594.5547 Q711.0313,593.4844 711.0313,592.2031 L711.0313,591.0469 Q711.0313,589.7188 711.6484,588.5703 Q712.2656,587.4219 713.3594,586.8047 Q714.4531,586.1875 715.6875,586.1875 Q716.4219,586.1875 717.0703,586.3516 Q717.7188,586.5156 718.2656,586.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="734.5" y="596.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="679" x2="842" y1="607" y2="607"/><ellipse cx="689" cy="621.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="698" y="625.5332">ID : int</text><ellipse cx="689" cy="638.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="698" y="643.1426">UserID : int</text><ellipse cx="689" cy="656.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="698" y="660.752">IP : string</text><ellipse cx="689" cy="674.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="698" y="678.3613">UserAgent : string</text><ellipse cx="689" cy="691.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="698" y="695.9707">Successful : bool</text><ellipse cx="689" cy="709.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="698" y="713.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="679" x2="842" y1="720.6563" y2="720.6563"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="160" fill="#F1F1F1" height="153.6563" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="580" x="4374.5" y="59.5"/><ellipse cx="4634.75" cy="75.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4637.5156,71.375 Q4637.6719,71.1563 4637.8594,71.0469 Q4638.0469,70.9375 4638.2656,70.9375 Q4638.6406,70.9375 4638.875,71.1953 Q4639.1094,71.4531 4639.1094,72.0625 L4639.1094,73.5156 Q4639.1094,74.125 4638.875,74.3906 Q4638.6406,74.6563 4638.2656,74.6563 Q4637.9219,74.6563 4637.7188,74.4531 Q4637.5156,74.2656 4637.4063,73.75 Q4637.3594,73.3906 4637.1719,73.2031 Q4636.8438,72.8281 4636.2344,72.6094 Q4635.625,72.3906 4635,72.3906 Q4634.2344,72.3906 4633.6016,72.7188 Q4632.9688,73.0469 4632.4766,73.7969 Q4631.9844,74.5469 4631.9844,75.5781 L4631.9844,76.6719 Q4631.9844,77.9063 4632.875,78.7266 Q4633.7656,79.5469 4635.3594,79.5469 Q4636.2969,79.5469 4636.9531,79.2969 Q4637.3438,79.1406 4637.7656,78.7031 Q4638.0313,78.4375 4638.1797,78.3594 Q4638.3281,78.2813 4638.5313,78.2813 Q4638.8594,78.2813 4639.1172,78.5391 Q4639.375,78.7969 4639.375,79.1406 Q4639.375,79.4844 4639.0313,79.8906 Q4638.5313,80.4688 4637.7344,80.7969 Q4636.6563,81.25 4635.3594,81.25 Q4633.8438,81.25 4632.6406,80.625 Q4631.6563,80.125 4630.9688,79.0547 Q4630.2813,77.9844 4630.2813,76.7031 L4630.2813,75.5469 Q4630.2813,74.2188 4630.8984,73.0703 Q4631.5156,71.9219 4632.6094,71.3047 Q4633.7031,70.6875 4634.9375,70.6875 Q4635.6719,70.6875 4636.3203,70.8516 Q4636.9688,71.0156 4637.5156,71.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="4655.25" y="81.2285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="4375.5" x2="4953.5" y1="91.5" y2="91.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="4375.5" x2="4953.5" y1="99.5" y2="99.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="4382.5" y="110.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="253" x="4394.5" y="118.0332">ComputeHash(password : string) : string</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="4382.5" y="128.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="321" x="4394.5" y="135.6426">HashPassword(password : salt, salt : string) : string</text><ellipse cx="4385.5" cy="149.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="4394.5" y="153.252">GetSalt(saltLength : int) : string</text><ellipse cx="4385.5" cy="166.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="554" x="4394.5" y="170.8613">GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string</text><ellipse cx="4385.5" cy="184.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="4394.5" y="188.4707">GetHotp(key : string, counter : long) : string</text><ellipse cx="4385.5" cy="201.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="4394.5" y="206.0801">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="170" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4989.5" y="103.5"/><ellipse cx="5138.75" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M5141.5156,115.375 Q5141.6719,115.1563 5141.8594,115.0469 Q5142.0469,114.9375 5142.2656,114.9375 Q5142.6406,114.9375 5142.875,115.1953 Q5143.1094,115.4531 5143.1094,116.0625 L5143.1094,117.5156 Q5143.1094,118.125 5142.875,118.3906 Q5142.6406,118.6563 5142.2656,118.6563 Q5141.9219,118.6563 5141.7188,118.4531 Q5141.5156,118.2656 5141.4063,117.75 Q5141.3594,117.3906 5141.1719,117.2031 Q5140.8438,116.8281 5140.2344,116.6094 Q5139.625,116.3906 5139,116.3906 Q5138.2344,116.3906 5137.6016,116.7188 Q5136.9688,117.0469 5136.4766,117.7969 Q5135.9844,118.5469 5135.9844,119.5781 L5135.9844,120.6719 Q5135.9844,121.9063 5136.875,122.7266 Q5137.7656,123.5469 5139.3594,123.5469 Q5140.2969,123.5469 5140.9531,123.2969 Q5141.3438,123.1406 5141.7656,122.7031 Q5142.0313,122.4375 5142.1797,122.3594 Q5142.3281,122.2813 5142.5313,122.2813 Q5142.8594,122.2813 5143.1172,122.5391 Q5143.375,122.7969 5143.375,123.1406 Q5143.375,123.4844 5143.0313,123.8906 Q5142.5313,124.4688 5141.7344,124.7969 Q5140.6563,125.25 5139.3594,125.25 Q5137.8438,125.25 5136.6406,124.625 Q5135.6563,124.125 5134.9688,123.0547 Q5134.2813,121.9844 5134.2813,120.7031 L5134.2813,119.5469 Q5134.2813,118.2188 5134.8984,117.0703 Q5135.5156,115.9219 5136.6094,115.3047 Q5137.7031,114.6875 5138.9375,114.6875 Q5139.6719,114.6875 5140.3203,114.8516 Q5140.9688,115.0156 5141.5156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="5159.25" y="125.2285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4990.5" x2="5376.5" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="4990.5" x2="5376.5" y1="143.5" y2="143.5"/><ellipse cx="5000.5" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="5009.5" y="162.0332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="190" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="2818.5" y="789"/><ellipse cx="2883.75" cy="805" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2886.5156,800.875 Q2886.6719,800.6563 2886.8594,800.5469 Q2887.0469,800.4375 2887.2656,800.4375 Q2887.6406,800.4375 2887.875,800.6953 Q2888.1094,800.9531 2888.1094,801.5625 L2888.1094,803.0156 Q2888.1094,803.625 2887.875,803.8906 Q2887.6406,804.1563 2887.2656,804.1563 Q2886.9219,804.1563 2886.7188,803.9531 Q2886.5156,803.7656 2886.4063,803.25 Q2886.3594,802.8906 2886.1719,802.7031 Q2885.8438,802.3281 2885.2344,802.1094 Q2884.625,801.8906 2884,801.8906 Q2883.2344,801.8906 2882.6016,802.2188 Q2881.9688,802.5469 2881.4766,803.2969 Q2880.9844,804.0469 2880.9844,805.0781 L2880.9844,806.1719 Q2880.9844,807.4063 2881.875,808.2266 Q2882.7656,809.0469 2884.3594,809.0469 Q2885.2969,809.0469 2885.9531,808.7969 Q2886.3438,808.6406 2886.7656,808.2031 Q2887.0313,807.9375 2887.1797,807.8594 Q2887.3281,807.7813 2887.5313,807.7813 Q2887.8594,807.7813 2888.1172,808.0391 Q2888.375,808.2969 2888.375,808.6406 Q2888.375,808.9844 2888.0313,809.3906 Q2887.5313,809.9688 2886.7344,810.2969 Q2885.6563,810.75 2884.3594,810.75 Q2882.8438,810.75 2881.6406,810.125 Q2880.6563,809.625 2879.9688,808.5547 Q2879.2813,807.4844 2879.2813,806.2031 L2879.2813,805.0469 Q2879.2813,803.7188 2879.8984,802.5703 Q2880.5156,801.4219 2881.6094,800.8047 Q2882.7031,800.1875 2883.9375,800.1875 Q2884.6719,800.1875 2885.3203,800.3516 Q2885.9688,800.5156 2886.5156,800.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="2904.25" y="810.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="2819.5" x2="2985.5" y1="821" y2="821"/><ellipse cx="2829.5" cy="835.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="2838.5" y="839.5332">ID : int</text><ellipse cx="2829.5" cy="852.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="2838.5" y="857.1426">IsVerified : bool</text><ellipse cx="2829.5" cy="870.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="2838.5" y="874.752">IsLocked : bool</text><ellipse cx="2829.5" cy="888.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="2838.5" y="892.3613">FailedTries : int</text><ellipse cx="2829.5" cy="905.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="2838.5" y="909.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="2819.5" x2="2985.5" y1="917.0469" y2="917.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="210" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="2556" y="985"/><ellipse cx="2602.75" cy="1001" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2605.5156,996.875 Q2605.6719,996.6563 2605.8594,996.5469 Q2606.0469,996.4375 2606.2656,996.4375 Q2606.6406,996.4375 2606.875,996.6953 Q2607.1094,996.9531 2607.1094,997.5625 L2607.1094,999.0156 Q2607.1094,999.625 2606.875,999.8906 Q2606.6406,1000.1563 2606.2656,1000.1563 Q2605.9219,1000.1563 2605.7188,999.9531 Q2605.5156,999.7656 2605.4063,999.25 Q2605.3594,998.8906 2605.1719,998.7031 Q2604.8438,998.3281 2604.2344,998.1094 Q2603.625,997.8906 2603,997.8906 Q2602.2344,997.8906 2601.6016,998.2188 Q2600.9688,998.5469 2600.4766,999.2969 Q2599.9844,1000.0469 2599.9844,1001.0781 L2599.9844,1002.1719 Q2599.9844,1003.4063 2600.875,1004.2266 Q2601.7656,1005.0469 2603.3594,1005.0469 Q2604.2969,1005.0469 2604.9531,1004.7969 Q2605.3438,1004.6406 2605.7656,1004.2031 Q2606.0313,1003.9375 2606.1797,1003.8594 Q2606.3281,1003.7813 2606.5313,1003.7813 Q2606.8594,1003.7813 2607.1172,1004.0391 Q2607.375,1004.2969 2607.375,1004.6406 Q2607.375,1004.9844 2607.0313,1005.3906 Q2606.5313,1005.9688 2605.7344,1006.2969 Q2604.6563,1006.75 2603.3594,1006.75 Q2601.8438,1006.75 2600.6406,1006.125 Q2599.6563,1005.625 2598.9688,1004.5547 Q2598.2813,1003.4844 2598.2813,1002.2031 L2598.2813,1001.0469 Q2598.2813,999.7188 2598.8984,998.5703 Q2599.5156,997.4219 2600.6094,996.8047 Q2601.7031,996.1875 2602.9375,996.1875 Q2603.6719,996.1875 2604.3203,996.3516 Q2604.9688,996.5156 2605.5156,996.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="2623.25" y="1006.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="2557" x2="2718" y1="1017" y2="1017"/><ellipse cx="2567" cy="1031.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="2576" y="1035.5332">Email : string</text><ellipse cx="2567" cy="1048.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="2576" y="1053.1426">FirstName : string</text><ellipse cx="2567" cy="1066.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="2576" y="1070.752">LastName : string</text><ellipse cx="2567" cy="1084.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="2576" y="1088.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="2557" x2="2718" y1="1095.4375" y2="1095.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="20" d="M1077.67,237.57 C1143.53,275.63 1216.92,318.04 1276.27,352.33 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1066.32,231.01,1069.5123,237.476,1076.7087,237.0162,1073.5164,230.5502,1066.32,231.01" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="21" d="M674.81,236.31 C609.29,264.88 537.93,296.36 472.5,326 C441.55,340.02 408.07,355.59 377.56,369.94 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="686.98,231.01,679.8814,229.7409,675.9798,235.8053,683.0783,237.0744,686.98,231.01" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="88" d="M1570.29,488.56 C1827.99,585.76 2293.98,761.51 2472.36,828.79 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2477.3,830.65,2470.2775,823.7446,2472.6184,828.8944,2467.4685,831.2352,2477.3,830.65" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="89" d="M1392.5,488.81 C1392.5,526.22 1392.5,571.8 1392.5,605.1 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1392.5,610.34,1396.5,601.34,1392.5,605.34,1388.5,601.34,1392.5,610.34" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="90" d="M2448.23,263.23 C2442.29,264.18 2436.38,265.1 2430.5,266 C2124.46,312.81 2041.32,271.85 1736.5,326 C1703.77,331.81 1669.64,339.3 1636.12,347.51 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1637.58,354.36,1616.48,352.42,1634.18,340.78,1637.58,354.36" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d484ee4b213f86a79b7b13bd52fde3a]
link MessageManager to IMessageManager--><g id="link_MessageManager_IMessageManager"><path codeLine="91" d="M2163.93,187.1 C2250.76,238.11 2385.31,317.17 2472.92,368.63 " fill="none" id="MessageManager-to-IMessageManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2476.62,362.69,2490.32,378.86,2469.53,374.76,2476.62,362.69" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="93" d="M3044.08,278.84 C3047.62,294.71 3051.17,310.58 3054.53,325.63 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3041.23,266.12,3038.6316,272.8467,3043.8415,277.8324,3046.4399,271.1057,3041.23,266.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="94" d="M2509.68,269.59 C2443.23,288.02 2376.12,307.12 2312.5,326 C2266.77,339.57 2217.26,355.27 2172.41,369.88 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2522.53,266.04,2515.6798,263.7874,2510.9657,269.2442,2517.8159,271.4969,2522.53,266.04" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="95" d="M3276.35,272.05 C3360.71,315.07 3446.65,358.89 3502.66,387.45 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3264.73,266.12,3268.2615,272.4072,3275.4233,271.5655,3271.8918,265.2783,3264.73,266.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f1b914c86bbf4264254e7be00f738a27]
reverse link UserManager to IMessageManager--><g id="link_UserManager_IMessageManager"><path codeLine="96" d="M2794.73,273.07 C2732.7,311.68 2669.79,350.84 2624.66,378.94 " fill="none" id="UserManager-backto-IMessageManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2805.88,266.12,2798.6723,265.8979,2795.6951,272.4658,2802.9028,272.6878,2805.88,266.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="98" d="M273.5,178.2 C273.5,223.01 273.5,295.82 273.5,349.76 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="280.5,349.78,273.5,369.78,266.5,349.78,280.5,349.78" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="99" d="M273.5,484.13 C273.5,520.94 273.5,566.84 273.5,601.18 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="273.5,471.02,269.5,477.02,273.5,483.02,277.5,477.02,273.5,471.02" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="102" d="M1545.03,178.05 C1640.26,226.01 1799.52,306.21 1908.15,360.91 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1911.42,354.72,1926.13,369.97,1905.12,367.22,1911.42,354.72" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="103" d="M1368.1,183.7 C1314,209.06 1245,240.44 1182.5,266 C1091.4,303.26 987.52,341.1 905.62,369.89 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1380.11,178.06,1372.9782,176.9934,1369.2507,183.1664,1376.3825,184.233,1380.11,178.06" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="149" d="M3035.35,527.42 C3028.05,546.66 3020.63,566.24 3013.91,583.97 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="3039.99,515.18,3034.1196,519.3678,3035.7274,526.3974,3041.5978,522.2096,3039.99,515.18" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="150" d="M760.5,484.3 C760.5,512.3 760.5,545.53 760.5,574.93 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="760.5,471.02,756.5,477.02,760.5,483.02,764.5,477.02,760.5,471.02" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="152" d="M4101.8,169.76 C4059.87,197.32 3996.65,237 3938.5,266 C3873.88,298.23 3854.34,298.65 3787.5,326 C3745.24,343.29 3698.65,362.84 3659.11,379.57 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3661.76,386.06,3640.61,387.42,3656.29,373.17,3661.76,386.06" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="153" d="M4150.07,169.57 C4150.84,213.16 4152.24,292.25 4153.26,349.81 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="4160.27,349.82,4153.62,369.94,4146.27,350.07,4160.27,349.82" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="155" d="M3725.24,178.13 C3691.23,206.63 3642.3,243.52 3593.5,266 C3495.19,311.29 3457.18,295.73 3345.96,325.6 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3347.83,332.34,3326.69,331.03,3344.04,318.87,3347.83,332.34" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="156" d="M3824.57,178.22 C3858.37,203.59 3902.86,236.85 3942.5,266 C3984.05,296.56 4030.42,330.19 4069.18,358.17 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="4073.44,352.61,4085.57,369.99,4065.25,363.96,4073.44,352.61" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="177" d="M2818.29,916.79 C2792.06,935.1 2762.9,955.46 2735.8,974.38 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2739.63,980.24,2719.23,985.94,2731.62,968.76,2739.63,980.24" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="178" d="M2560.7,890.22 C2571.31,911.34 2585.66,939.87 2599.07,966.56 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2605.43,963.62,2608.16,984.63,2592.92,969.91,2605.43,963.62" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="180" d="M2960.1,720.03 C2953.31,736.06 2945.97,753.39 2938.88,770.13 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2945.26,773.01,2931.01,788.69,2932.37,767.55,2945.26,773.01" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[13dbe03f8fdd05d7069190fa44c97ae2]
@startuml API class diagram

top to bottom direction

'Controllers'

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +VerifyUserRegister(UserLogin : UserLogin) : Task<ActionResult>
}

'Controllers mappings' 

UserController o- - IUserManager
UserController o- - ITokenManager

'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessage(to : string, otp : string) : Task<bool>
    +SendLoginRegistrationMessage(to : string, key : string) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageManager : IMessageManager
    -_logger : ILogger<UserManager>
    -_configuration : IConfiguration
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
    -IsUserNotVerified(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLocked(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}
class MessageManager {
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider

    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)
}


'Managers mappings'

IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider
UserManager o- - IMessageManager

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

'Utility'

class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction


class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +VerifyUserRegister(UserLogin : UserLogin) : Task<ActionResult>
}


UserController o- - IUserManager
UserController o- - ITokenManager


Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessage(to : string, otp : string) : Task<bool>
    +SendLoginRegistrationMessage(to : string, key : string) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageManager : IMessageManager
    -_logger : ILogger<UserManager>
    -_configuration : IConfiguration
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
    -IsUserNotVerified(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLocked(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}
class MessageManager {
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider

    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)
}



IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider
UserManager o- - IMessageManager

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider


class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: da
Country: DK
--></g></svg>