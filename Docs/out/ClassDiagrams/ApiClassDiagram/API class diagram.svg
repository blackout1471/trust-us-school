<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1110px" preserveAspectRatio="none" style="width:4795px;height:1110px;background:#FFFFFF;" version="1.1" viewBox="0 0 4795 1110" width="4795px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="188.875" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="521" x="575" y="42"/><ellipse cx="785.75" cy="58" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M788.5156,53.875 Q788.6719,53.6563 788.8594,53.5469 Q789.0469,53.4375 789.2656,53.4375 Q789.6406,53.4375 789.875,53.6953 Q790.1094,53.9531 790.1094,54.5625 L790.1094,56.0156 Q790.1094,56.625 789.875,56.8906 Q789.6406,57.1563 789.2656,57.1563 Q788.9219,57.1563 788.7188,56.9531 Q788.5156,56.7656 788.4063,56.25 Q788.3594,55.8906 788.1719,55.7031 Q787.8438,55.3281 787.2344,55.1094 Q786.625,54.8906 786,54.8906 Q785.2344,54.8906 784.6016,55.2188 Q783.9688,55.5469 783.4766,56.2969 Q782.9844,57.0469 782.9844,58.0781 L782.9844,59.1719 Q782.9844,60.4063 783.875,61.2266 Q784.7656,62.0469 786.3594,62.0469 Q787.2969,62.0469 787.9531,61.7969 Q788.3438,61.6406 788.7656,61.2031 Q789.0313,60.9375 789.1797,60.8594 Q789.3281,60.7813 789.5313,60.7813 Q789.8594,60.7813 790.1172,61.0391 Q790.375,61.2969 790.375,61.6406 Q790.375,61.9844 790.0313,62.3906 Q789.5313,62.9688 788.7344,63.2969 Q787.6563,63.75 786.3594,63.75 Q784.8438,63.75 783.6406,63.125 Q782.6563,62.625 781.9688,61.5547 Q781.2813,60.4844 781.2813,59.2031 L781.2813,58.0469 Q781.2813,56.7188 781.8984,55.5703 Q782.5156,54.4219 783.6094,53.8047 Q784.7031,53.1875 785.9375,53.1875 Q786.6719,53.1875 787.3203,53.3516 Q787.9688,53.5156 788.5156,53.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="806.25" y="63.7285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="576" x2="1095" y1="74" y2="74"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583" y="85.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="595" y="92.5332">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583" y="102.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="595" y="110.1426">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:1.0;" x1="576" x2="1095" y1="117.2188" y2="117.2188"/><ellipse cx="586" cy="131.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="595" y="135.752">UserController(userManager : IUserManager, tokenManager : ITokenManager)</text><ellipse cx="586" cy="149.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="595" y="153.3613">Create(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="166.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="595" y="170.9707">Login(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="184.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="318" x="595" y="188.5801">GetUserFromToken() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="586" cy="201.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="477" x="595" y="206.1895">VerificationLogin(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="219.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="406" x="595" y="223.7988">VerifyUserRegister(UserLogin : UserLogin) : Task&lt;ActionResult&gt;</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="25" fill="#F1F1F1" height="136.0469" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="653" x="509" y="352.5"/><ellipse cx="785.75" cy="368.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M786.7031,365.1406 L786.7031,371.7969 L788.4219,371.7969 Q789.0313,371.7969 789.2969,372.0313 Q789.5625,372.2656 789.5625,372.6563 Q789.5625,373.0313 789.2969,373.2656 Q789.0313,373.5 788.4219,373.5 L783.2813,373.5 Q782.6719,373.5 782.4063,373.2656 Q782.1406,373.0313 782.1406,372.6406 Q782.1406,372.2656 782.4063,372.0313 Q782.6719,371.7969 783.2813,371.7969 L785,371.7969 L785,365.1406 L783.2813,365.1406 Q782.6719,365.1406 782.4063,364.9063 Q782.1406,364.6719 782.1406,364.2813 Q782.1406,363.9063 782.4063,363.6719 Q782.6719,363.4375 783.2813,363.4375 L788.4219,363.4375 Q789.0313,363.4375 789.2969,363.6719 Q789.5625,363.9063 789.5625,364.2813 Q789.5625,364.6719 789.2969,364.9063 Q789.0313,365.1406 788.4219,365.1406 L786.7031,365.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="806.25" y="374.2285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="510" x2="1161" y1="384.5" y2="384.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="510" x2="1161" y1="392.5" y2="392.5"/><ellipse cx="520" cy="406.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="361" x="529" y="411.0332">CreateUserAsync(userCreate : UserCreate) : Task&lt;bool&gt;</text><ellipse cx="520" cy="424.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="529" y="428.6426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="520" cy="442.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="529" y="446.252">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="520" cy="459.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="627" x="529" y="463.8613">LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="520" cy="477.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="595" x="529" y="481.4707">VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="33" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="100.5" y="370"/><ellipse cx="227.25" cy="386" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M228.2031,382.6406 L228.2031,389.2969 L229.9219,389.2969 Q230.5313,389.2969 230.7969,389.5313 Q231.0625,389.7656 231.0625,390.1563 Q231.0625,390.5313 230.7969,390.7656 Q230.5313,391 229.9219,391 L224.7813,391 Q224.1719,391 223.9063,390.7656 Q223.6406,390.5313 223.6406,390.1406 Q223.6406,389.7656 223.9063,389.5313 Q224.1719,389.2969 224.7813,389.2969 L226.5,389.2969 L226.5,382.6406 L224.7813,382.6406 Q224.1719,382.6406 223.9063,382.4063 Q223.6406,382.1719 223.6406,381.7813 Q223.6406,381.4063 223.9063,381.1719 Q224.1719,380.9375 224.7813,380.9375 L229.9219,380.9375 Q230.5313,380.9375 230.7969,381.1719 Q231.0625,381.4063 231.0625,381.7813 Q231.0625,382.1719 230.7969,382.4063 Q230.5313,382.6406 229.9219,382.6406 L228.2031,382.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="247.75" y="391.7285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="101.5" x2="463.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:0.5;" x1="101.5" x2="463.5" y1="410" y2="410"/><ellipse cx="111.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="120.5" y="428.5332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="111.5" cy="441.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="120.5" y="446.1426">ValidateToken(token : string) : bool</text><ellipse cx="111.5" cy="459.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="120.5" y="463.752">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="40" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1551.5" y="370"/><ellipse cx="1744.75" cy="386" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1745.7031,382.6406 L1745.7031,389.2969 L1747.4219,389.2969 Q1748.0313,389.2969 1748.2969,389.5313 Q1748.5625,389.7656 1748.5625,390.1563 Q1748.5625,390.5313 1748.2969,390.7656 Q1748.0313,391 1747.4219,391 L1742.2813,391 Q1741.6719,391 1741.4063,390.7656 Q1741.1406,390.5313 1741.1406,390.1406 Q1741.1406,389.7656 1741.4063,389.5313 Q1741.6719,389.2969 1742.2813,389.2969 L1744,389.2969 L1744,382.6406 L1742.2813,382.6406 Q1741.6719,382.6406 1741.4063,382.4063 Q1741.1406,382.1719 1741.1406,381.7813 Q1741.1406,381.4063 1741.4063,381.1719 Q1741.6719,380.9375 1742.2813,380.9375 L1747.4219,380.9375 Q1748.0313,380.9375 1748.2969,381.1719 Q1748.5625,381.4063 1748.5625,381.7813 Q1748.5625,382.1719 1748.2969,382.4063 Q1748.0313,382.6406 1747.4219,382.6406 L1745.7031,382.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="1765.25" y="391.7285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1552.5" x2="2090.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:0.5;" x1="1552.5" x2="2090.5" y1="410" y2="410"/><ellipse cx="1562.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1571.5" y="428.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1562.5" cy="441.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="1571.5" y="446.1426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1562.5" cy="459.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1571.5" y="463.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="46" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="95"/><ellipse cx="221.25" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,106.875 Q224.1719,106.6563 224.3594,106.5469 Q224.5469,106.4375 224.7656,106.4375 Q225.1406,106.4375 225.375,106.6953 Q225.6094,106.9531 225.6094,107.5625 L225.6094,109.0156 Q225.6094,109.625 225.375,109.8906 Q225.1406,110.1563 224.7656,110.1563 Q224.4219,110.1563 224.2188,109.9531 Q224.0156,109.7656 223.9063,109.25 Q223.8594,108.8906 223.6719,108.7031 Q223.3438,108.3281 222.7344,108.1094 Q222.125,107.8906 221.5,107.8906 Q220.7344,107.8906 220.1016,108.2188 Q219.4688,108.5469 218.9766,109.2969 Q218.4844,110.0469 218.4844,111.0781 L218.4844,112.1719 Q218.4844,113.4063 219.375,114.2266 Q220.2656,115.0469 221.8594,115.0469 Q222.7969,115.0469 223.4531,114.7969 Q223.8438,114.6406 224.2656,114.2031 Q224.5313,113.9375 224.6797,113.8594 Q224.8281,113.7813 225.0313,113.7813 Q225.3594,113.7813 225.6172,114.0391 Q225.875,114.2969 225.875,114.6406 Q225.875,114.9844 225.5313,115.3906 Q225.0313,115.9688 224.2344,116.2969 Q223.1563,116.75 221.8594,116.75 Q220.3438,116.75 219.1406,116.125 Q218.1563,115.625 217.4688,114.5547 Q216.7813,113.4844 216.7813,112.2031 L216.7813,111.0469 Q216.7813,109.7188 217.3984,108.5703 Q218.0156,107.4219 219.1094,106.8047 Q220.2031,106.1875 221.4375,106.1875 Q222.1719,106.1875 222.8203,106.3516 Q223.4688,106.5156 224.0156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="116.7285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="539" y1="135" y2="135"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="146.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="153.5332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="163.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="171.1426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="52" fill="#F1F1F1" height="259.3125" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="938" x="1242.5" y="7"/><ellipse cx="1664.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1667.5156,18.875 Q1667.6719,18.6563 1667.8594,18.5469 Q1668.0469,18.4375 1668.2656,18.4375 Q1668.6406,18.4375 1668.875,18.6953 Q1669.1094,18.9531 1669.1094,19.5625 L1669.1094,21.0156 Q1669.1094,21.625 1668.875,21.8906 Q1668.6406,22.1563 1668.2656,22.1563 Q1667.9219,22.1563 1667.7188,21.9531 Q1667.5156,21.7656 1667.4063,21.25 Q1667.3594,20.8906 1667.1719,20.7031 Q1666.8438,20.3281 1666.2344,20.1094 Q1665.625,19.8906 1665,19.8906 Q1664.2344,19.8906 1663.6016,20.2188 Q1662.9688,20.5469 1662.4766,21.2969 Q1661.9844,22.0469 1661.9844,23.0781 L1661.9844,24.1719 Q1661.9844,25.4063 1662.875,26.2266 Q1663.7656,27.0469 1665.3594,27.0469 Q1666.2969,27.0469 1666.9531,26.7969 Q1667.3438,26.6406 1667.7656,26.2031 Q1668.0313,25.9375 1668.1797,25.8594 Q1668.3281,25.7813 1668.5313,25.7813 Q1668.8594,25.7813 1669.1172,26.0391 Q1669.375,26.2969 1669.375,26.6406 Q1669.375,26.9844 1669.0313,27.3906 Q1668.5313,27.9688 1667.7344,28.2969 Q1666.6563,28.75 1665.3594,28.75 Q1663.8438,28.75 1662.6406,28.125 Q1661.6563,27.625 1660.9688,26.5547 Q1660.2813,25.4844 1660.2813,24.2031 L1660.2813,23.0469 Q1660.2813,21.7188 1660.8984,20.5703 Q1661.5156,19.4219 1662.6094,18.8047 Q1663.7031,18.1875 1664.9375,18.1875 Q1665.6719,18.1875 1666.3203,18.3516 Q1666.9688,18.5156 1667.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1685.25" y="28.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1243.5" x2="2179.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="1262.5" y="57.5332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="1262.5" y="75.1426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="1262.5" y="92.752">_userLocationManager : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="103.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="1262.5" y="110.3613">_messageService : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="120.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="1262.5" y="127.9707">_messageProvider : IMessageProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="138.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="1262.5" y="145.5801">_logger : ILogger&lt;UserManager&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="155.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438" x="1262.5" y="163.1895">IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool</text><line style="stroke:#181818;stroke-width:1.0;" x1="1243.5" x2="2179.5" y1="170.2656" y2="170.2656"/><ellipse cx="1253.5" cy="184.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="912" x="1262.5" y="188.7988">UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="680" x="1262.5" y="206.4082">messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger&lt;UserManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="216.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="402" x="1262.5" y="224.0176">CheckPasswordLeakedForUser(password : string) : Task&lt;bool&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="234.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="433" x="1262.5" y="241.627">IsUserNotVerified(userLocation : UserLocation, user : DbUser) : Task</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1250.5" y="252.0078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="410" x="1262.5" y="259.2363">IsUserLocked(userLocation : UserLocation, user : DbUser) : Task</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="68" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="458" x="2486.5" y="95"/><ellipse cx="2641.75" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2644.5156,106.875 Q2644.6719,106.6563 2644.8594,106.5469 Q2645.0469,106.4375 2645.2656,106.4375 Q2645.6406,106.4375 2645.875,106.6953 Q2646.1094,106.9531 2646.1094,107.5625 L2646.1094,109.0156 Q2646.1094,109.625 2645.875,109.8906 Q2645.6406,110.1563 2645.2656,110.1563 Q2644.9219,110.1563 2644.7188,109.9531 Q2644.5156,109.7656 2644.4063,109.25 Q2644.3594,108.8906 2644.1719,108.7031 Q2643.8438,108.3281 2643.2344,108.1094 Q2642.625,107.8906 2642,107.8906 Q2641.2344,107.8906 2640.6016,108.2188 Q2639.9688,108.5469 2639.4766,109.2969 Q2638.9844,110.0469 2638.9844,111.0781 L2638.9844,112.1719 Q2638.9844,113.4063 2639.875,114.2266 Q2640.7656,115.0469 2642.3594,115.0469 Q2643.2969,115.0469 2643.9531,114.7969 Q2644.3438,114.6406 2644.7656,114.2031 Q2645.0313,113.9375 2645.1797,113.8594 Q2645.3281,113.7813 2645.5313,113.7813 Q2645.8594,113.7813 2646.1172,114.0391 Q2646.375,114.2969 2646.375,114.6406 Q2646.375,114.9844 2646.0313,115.3906 Q2645.5313,115.9688 2644.7344,116.2969 Q2643.6563,116.75 2642.3594,116.75 Q2640.8438,116.75 2639.6406,116.125 Q2638.6563,115.625 2637.9688,114.5547 Q2637.2813,113.4844 2637.2813,112.2031 L2637.2813,111.0469 Q2637.2813,109.7188 2637.8984,108.5703 Q2638.5156,107.4219 2639.6094,106.8047 Q2640.7031,106.1875 2641.9375,106.1875 Q2642.6719,106.1875 2643.3203,106.3516 Q2643.9688,106.5156 2644.5156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2662.25" y="116.7285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2487.5" x2="2943.5" y1="127" y2="127"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2494.5" y="138.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="2506.5" y="145.5332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="2487.5" x2="2943.5" y1="152.6094" y2="152.6094"/><ellipse cx="2497.5" cy="166.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="432" x="2506.5" y="171.1426">UserLocationManager(userLocationProvider : UserLocationProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="194" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1275.5" y="824"/><ellipse cx="1304" cy="840" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1306.7656,835.875 Q1306.9219,835.6563 1307.1094,835.5469 Q1307.2969,835.4375 1307.5156,835.4375 Q1307.8906,835.4375 1308.125,835.6953 Q1308.3594,835.9531 1308.3594,836.5625 L1308.3594,838.0156 Q1308.3594,838.625 1308.125,838.8906 Q1307.8906,839.1563 1307.5156,839.1563 Q1307.1719,839.1563 1306.9688,838.9531 Q1306.7656,838.7656 1306.6563,838.25 Q1306.6094,837.8906 1306.4219,837.7031 Q1306.0938,837.3281 1305.4844,837.1094 Q1304.875,836.8906 1304.25,836.8906 Q1303.4844,836.8906 1302.8516,837.2188 Q1302.2188,837.5469 1301.7266,838.2969 Q1301.2344,839.0469 1301.2344,840.0781 L1301.2344,841.1719 Q1301.2344,842.4063 1302.125,843.2266 Q1303.0156,844.0469 1304.6094,844.0469 Q1305.5469,844.0469 1306.2031,843.7969 Q1306.5938,843.6406 1307.0156,843.2031 Q1307.2813,842.9375 1307.4297,842.8594 Q1307.5781,842.7813 1307.7813,842.7813 Q1308.1094,842.7813 1308.3672,843.0391 Q1308.625,843.2969 1308.625,843.6406 Q1308.625,843.9844 1308.2813,844.3906 Q1307.7813,844.9688 1306.9844,845.2969 Q1305.9063,845.75 1304.6094,845.75 Q1303.0938,845.75 1301.8906,845.125 Q1300.9063,844.625 1300.2188,843.5547 Q1299.5313,842.4844 1299.5313,841.2031 L1299.5313,840.0469 Q1299.5313,838.7188 1300.1484,837.5703 Q1300.7656,836.4219 1301.8594,835.8047 Q1302.9531,835.1875 1304.1875,835.1875 Q1304.9219,835.1875 1305.5703,835.3516 Q1306.2188,835.5156 1306.7656,835.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1321" y="845.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="1276.5" x2="1408.5" y1="856" y2="856"/><ellipse cx="1286.5" cy="870.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1295.5" y="874.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1276.5" x2="1408.5" y1="881.6094" y2="881.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="206" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="768.5" y="610.5"/><ellipse cx="800.6" cy="626.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M803.3656,622.375 Q803.5219,622.1563 803.7094,622.0469 Q803.8969,621.9375 804.1156,621.9375 Q804.4906,621.9375 804.725,622.1953 Q804.9594,622.4531 804.9594,623.0625 L804.9594,624.5156 Q804.9594,625.125 804.725,625.3906 Q804.4906,625.6563 804.1156,625.6563 Q803.7719,625.6563 803.5688,625.4531 Q803.3656,625.2656 803.2563,624.75 Q803.2094,624.3906 803.0219,624.2031 Q802.6938,623.8281 802.0844,623.6094 Q801.475,623.3906 800.85,623.3906 Q800.0844,623.3906 799.4516,623.7188 Q798.8188,624.0469 798.3266,624.7969 Q797.8344,625.5469 797.8344,626.5781 L797.8344,627.6719 Q797.8344,628.9063 798.725,629.7266 Q799.6156,630.5469 801.2094,630.5469 Q802.1469,630.5469 802.8031,630.2969 Q803.1938,630.1406 803.6156,629.7031 Q803.8813,629.4375 804.0297,629.3594 Q804.1781,629.2813 804.3813,629.2813 Q804.7094,629.2813 804.9672,629.5391 Q805.225,629.7969 805.225,630.1406 Q805.225,630.4844 804.8813,630.8906 Q804.3813,631.4688 803.5844,631.7969 Q802.5063,632.25 801.2094,632.25 Q799.6938,632.25 798.4906,631.625 Q797.5063,631.125 796.8188,630.0547 Q796.1313,628.9844 796.1313,627.7031 L796.1313,626.5469 Q796.1313,625.2188 796.7484,624.0703 Q797.3656,622.9219 798.4594,622.3047 Q799.5531,621.6875 800.7875,621.6875 Q801.5219,621.6875 802.1703,621.8516 Q802.8188,622.0156 803.3656,622.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="818.4" y="632.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="769.5" x2="901.5" y1="642.5" y2="642.5"/><ellipse cx="779.5" cy="656.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="788.5" y="661.0332">Email : string</text><ellipse cx="779.5" cy="674.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="788.5" y="678.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="769.5" x2="901.5" y1="685.7188" y2="685.7188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="95" fill="#F1F1F1" height="188.875" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="502" x="2126.5" y="326"/><ellipse cx="2330.25" cy="342" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2331.2031,338.6406 L2331.2031,345.2969 L2332.9219,345.2969 Q2333.5313,345.2969 2333.7969,345.5313 Q2334.0625,345.7656 2334.0625,346.1563 Q2334.0625,346.5313 2333.7969,346.7656 Q2333.5313,347 2332.9219,347 L2327.7813,347 Q2327.1719,347 2326.9063,346.7656 Q2326.6406,346.5313 2326.6406,346.1406 Q2326.6406,345.7656 2326.9063,345.5313 Q2327.1719,345.2969 2327.7813,345.2969 L2329.5,345.2969 L2329.5,338.6406 L2327.7813,338.6406 Q2327.1719,338.6406 2326.9063,338.4063 Q2326.6406,338.1719 2326.6406,337.7813 Q2326.6406,337.4063 2326.9063,337.1719 Q2327.1719,336.9375 2327.7813,336.9375 L2332.9219,336.9375 Q2333.5313,336.9375 2333.7969,337.1719 Q2334.0625,337.4063 2334.0625,337.7813 Q2334.0625,338.1719 2333.7969,338.4063 Q2333.5313,338.6406 2332.9219,338.6406 L2331.2031,338.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="2350.75" y="347.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2127.5" x2="2627.5" y1="358" y2="358"/><line style="stroke:#181818;stroke-width:0.5;" x1="2127.5" x2="2627.5" y1="366" y2="366"/><ellipse cx="2137.5" cy="380.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2146.5" y="384.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2137.5" cy="397.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2146.5" y="402.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2137.5" cy="415.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2146.5" y="419.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2137.5" cy="433.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="2146.5" y="437.3613">UpdateUserFailedTries(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2137.5" cy="450.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2146.5" y="454.9707">UpdateUserLoginSuccess(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2137.5" cy="468.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="371" x="2146.5" y="472.5801">UpdateUserLoginNewLocation(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2137.5" cy="485.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="298" x="2146.5" y="490.1895">UpdateUserToVerifiedAsync(userID : int) : Task</text><ellipse cx="2137.5" cy="503.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="476" x="2146.5" y="507.7988">UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="106" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="3238.5" y="387.5"/><ellipse cx="3355.75" cy="403.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3356.7031,400.1406 L3356.7031,406.7969 L3358.4219,406.7969 Q3359.0313,406.7969 3359.2969,407.0313 Q3359.5625,407.2656 3359.5625,407.6563 Q3359.5625,408.0313 3359.2969,408.2656 Q3359.0313,408.5 3358.4219,408.5 L3353.2813,408.5 Q3352.6719,408.5 3352.4063,408.2656 Q3352.1406,408.0313 3352.1406,407.6406 Q3352.1406,407.2656 3352.4063,407.0313 Q3352.6719,406.7969 3353.2813,406.7969 L3355,406.7969 L3355,400.1406 L3353.2813,400.1406 Q3352.6719,400.1406 3352.4063,399.9063 Q3352.1406,399.6719 3352.1406,399.2813 Q3352.1406,398.9063 3352.4063,398.6719 Q3352.6719,398.4375 3353.2813,398.4375 L3358.4219,398.4375 Q3359.0313,398.4375 3359.2969,398.6719 Q3359.5625,398.9063 3359.5625,399.2813 Q3359.5625,399.6719 3359.2969,399.9063 Q3359.0313,400.1406 3358.4219,400.1406 L3356.7031,400.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="3376.25" y="409.2285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3239.5" x2="3645.5" y1="419.5" y2="419.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="3239.5" x2="3645.5" y1="427.5" y2="427.5"/><ellipse cx="3249.5" cy="441.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="3258.5" y="446.0332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[93e51899d99a79ff80efffde6dbc2b8d]
class IMessageService--><g id="elem_IMessageService"><rect fill="#F1F1F1" height="48" id="IMessageService" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="1377" y="396.5"/><ellipse cx="1392" cy="412.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1394.7656,408.375 Q1394.9219,408.1563 1395.1094,408.0469 Q1395.2969,407.9375 1395.5156,407.9375 Q1395.8906,407.9375 1396.125,408.1953 Q1396.3594,408.4531 1396.3594,409.0625 L1396.3594,410.5156 Q1396.3594,411.125 1396.125,411.3906 Q1395.8906,411.6563 1395.5156,411.6563 Q1395.1719,411.6563 1394.9688,411.4531 Q1394.7656,411.2656 1394.6563,410.75 Q1394.6094,410.3906 1394.4219,410.2031 Q1394.0938,409.8281 1393.4844,409.6094 Q1392.875,409.3906 1392.25,409.3906 Q1391.4844,409.3906 1390.8516,409.7188 Q1390.2188,410.0469 1389.7266,410.7969 Q1389.2344,411.5469 1389.2344,412.5781 L1389.2344,413.6719 Q1389.2344,414.9063 1390.125,415.7266 Q1391.0156,416.5469 1392.6094,416.5469 Q1393.5469,416.5469 1394.2031,416.2969 Q1394.5938,416.1406 1395.0156,415.7031 Q1395.2813,415.4375 1395.4297,415.3594 Q1395.5781,415.2813 1395.7813,415.2813 Q1396.1094,415.2813 1396.3672,415.5391 Q1396.625,415.7969 1396.625,416.1406 Q1396.625,416.4844 1396.2813,416.8906 Q1395.7813,417.4688 1394.9844,417.7969 Q1393.9063,418.25 1392.6094,418.25 Q1391.0938,418.25 1389.8906,417.625 Q1388.9063,417.125 1388.2188,416.0547 Q1387.5313,414.9844 1387.5313,413.7031 L1387.5313,412.5469 Q1387.5313,411.2188 1388.1484,410.0703 Q1388.7656,408.9219 1389.8594,408.3047 Q1390.9531,407.6875 1392.1875,407.6875 Q1392.9219,407.6875 1393.5703,407.8516 Q1394.2188,408.0156 1394.7656,408.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1406" y="418.2285">IMessageService</text><line style="stroke:#181818;stroke-width:0.5;" x1="1378" x2="1515" y1="428.5" y2="428.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1378" x2="1515" y1="436.5" y2="436.5"/></g><!--MD5=[5009355033d421c5ef52ff093b464101]
class IMessageProvider--><g id="elem_IMessageProvider"><rect fill="#F1F1F1" height="48" id="IMessageProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145" x="1197" y="396.5"/><ellipse cx="1212" cy="412.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1214.7656,408.375 Q1214.9219,408.1563 1215.1094,408.0469 Q1215.2969,407.9375 1215.5156,407.9375 Q1215.8906,407.9375 1216.125,408.1953 Q1216.3594,408.4531 1216.3594,409.0625 L1216.3594,410.5156 Q1216.3594,411.125 1216.125,411.3906 Q1215.8906,411.6563 1215.5156,411.6563 Q1215.1719,411.6563 1214.9688,411.4531 Q1214.7656,411.2656 1214.6563,410.75 Q1214.6094,410.3906 1214.4219,410.2031 Q1214.0938,409.8281 1213.4844,409.6094 Q1212.875,409.3906 1212.25,409.3906 Q1211.4844,409.3906 1210.8516,409.7188 Q1210.2188,410.0469 1209.7266,410.7969 Q1209.2344,411.5469 1209.2344,412.5781 L1209.2344,413.6719 Q1209.2344,414.9063 1210.125,415.7266 Q1211.0156,416.5469 1212.6094,416.5469 Q1213.5469,416.5469 1214.2031,416.2969 Q1214.5938,416.1406 1215.0156,415.7031 Q1215.2813,415.4375 1215.4297,415.3594 Q1215.5781,415.2813 1215.7813,415.2813 Q1216.1094,415.2813 1216.3672,415.5391 Q1216.625,415.7969 1216.625,416.1406 Q1216.625,416.4844 1216.2813,416.8906 Q1215.7813,417.4688 1214.9844,417.7969 Q1213.9063,418.25 1212.6094,418.25 Q1211.0938,418.25 1209.8906,417.625 Q1208.9063,417.125 1208.2188,416.0547 Q1207.5313,414.9844 1207.5313,413.7031 L1207.5313,412.5469 Q1207.5313,411.2188 1208.1484,410.0703 Q1208.7656,408.9219 1209.8594,408.3047 Q1210.9531,407.6875 1212.1875,407.6875 Q1212.9219,407.6875 1213.5703,407.8516 Q1214.2188,408.0156 1214.7656,408.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="1226" y="418.2285">IMessageProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1198" x2="1341" y1="428.5" y2="428.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1198" x2="1341" y1="436.5" y2="436.5"/></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="172" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="226" y="601.5"/><ellipse cx="246.4" cy="617.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M249.1656,613.375 Q249.3219,613.1563 249.5094,613.0469 Q249.6969,612.9375 249.9156,612.9375 Q250.2906,612.9375 250.525,613.1953 Q250.7594,613.4531 250.7594,614.0625 L250.7594,615.5156 Q250.7594,616.125 250.525,616.3906 Q250.2906,616.6563 249.9156,616.6563 Q249.5719,616.6563 249.3688,616.4531 Q249.1656,616.2656 249.0563,615.75 Q249.0094,615.3906 248.8219,615.2031 Q248.4938,614.8281 247.8844,614.6094 Q247.275,614.3906 246.65,614.3906 Q245.8844,614.3906 245.2516,614.7188 Q244.6188,615.0469 244.1266,615.7969 Q243.6344,616.5469 243.6344,617.5781 L243.6344,618.6719 Q243.6344,619.9063 244.525,620.7266 Q245.4156,621.5469 247.0094,621.5469 Q247.9469,621.5469 248.6031,621.2969 Q248.9938,621.1406 249.4156,620.7031 Q249.6813,620.4375 249.8297,620.3594 Q249.9781,620.2813 250.1813,620.2813 Q250.5094,620.2813 250.7672,620.5391 Q251.025,620.7969 251.025,621.1406 Q251.025,621.4844 250.6813,621.8906 Q250.1813,622.4688 249.3844,622.7969 Q248.3063,623.25 247.0094,623.25 Q245.4938,623.25 244.2906,622.625 Q243.3063,622.125 242.6188,621.0547 Q241.9313,619.9844 241.9313,618.7031 L241.9313,617.5469 Q241.9313,616.2188 242.5484,615.0703 Q243.1656,613.9219 244.2594,613.3047 Q245.3531,612.6875 246.5875,612.6875 Q247.3219,612.6875 247.9703,612.8516 Q248.6188,613.0156 249.1656,613.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="261.6" y="623.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="227" x2="338" y1="633.5" y2="633.5"/><ellipse cx="237" cy="647.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="246" y="652.0332">UserID : int</text><ellipse cx="237" cy="665.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="246" y="669.6426">Email : string</text><ellipse cx="237" cy="683.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="246" y="687.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="227" x2="338" y1="694.3281" y2="694.3281"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="122" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="2663.5" y="370"/><ellipse cx="2859.25" cy="386" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2860.2031,382.6406 L2860.2031,389.2969 L2861.9219,389.2969 Q2862.5313,389.2969 2862.7969,389.5313 Q2863.0625,389.7656 2863.0625,390.1563 Q2863.0625,390.5313 2862.7969,390.7656 Q2862.5313,391 2861.9219,391 L2856.7813,391 Q2856.1719,391 2855.9063,390.7656 Q2855.6406,390.5313 2855.6406,390.1406 Q2855.6406,389.7656 2855.9063,389.5313 Q2856.1719,389.2969 2856.7813,389.2969 L2858.5,389.2969 L2858.5,382.6406 L2856.7813,382.6406 Q2856.1719,382.6406 2855.9063,382.4063 Q2855.6406,382.1719 2855.6406,381.7813 Q2855.6406,381.4063 2855.9063,381.1719 Q2856.1719,380.9375 2856.7813,380.9375 L2861.9219,380.9375 Q2862.5313,380.9375 2862.7969,381.1719 Q2863.0625,381.4063 2863.0625,381.7813 Q2863.0625,382.1719 2862.7969,382.4063 Q2862.5313,382.6406 2861.9219,382.6406 L2860.2031,382.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="2879.75" y="391.7285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2664.5" x2="3202.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:0.5;" x1="2664.5" x2="3202.5" y1="410" y2="410"/><ellipse cx="2674.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="2683.5" y="428.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="2674.5" cy="441.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="2683.5" y="446.1426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="2674.5" cy="459.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="2683.5" y="463.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="110" fill="#F1F1F1" height="100.8281" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="3681.5" y="370"/><ellipse cx="3990.75" cy="386" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3993.5156,381.875 Q3993.6719,381.6563 3993.8594,381.5469 Q3994.0469,381.4375 3994.2656,381.4375 Q3994.6406,381.4375 3994.875,381.6953 Q3995.1094,381.9531 3995.1094,382.5625 L3995.1094,384.0156 Q3995.1094,384.625 3994.875,384.8906 Q3994.6406,385.1563 3994.2656,385.1563 Q3993.9219,385.1563 3993.7188,384.9531 Q3993.5156,384.7656 3993.4063,384.25 Q3993.3594,383.8906 3993.1719,383.7031 Q3992.8438,383.3281 3992.2344,383.1094 Q3991.625,382.8906 3991,382.8906 Q3990.2344,382.8906 3989.6016,383.2188 Q3988.9688,383.5469 3988.4766,384.2969 Q3987.9844,385.0469 3987.9844,386.0781 L3987.9844,387.1719 Q3987.9844,388.4063 3988.875,389.2266 Q3989.7656,390.0469 3991.3594,390.0469 Q3992.2969,390.0469 3992.9531,389.7969 Q3993.3438,389.6406 3993.7656,389.2031 Q3994.0313,388.9375 3994.1797,388.8594 Q3994.3281,388.7813 3994.5313,388.7813 Q3994.8594,388.7813 3995.1172,389.0391 Q3995.375,389.2969 3995.375,389.6406 Q3995.375,389.9844 3995.0313,390.3906 Q3994.5313,390.9688 3993.7344,391.2969 Q3992.6563,391.75 3991.3594,391.75 Q3989.8438,391.75 3988.6406,391.125 Q3987.6563,390.625 3986.9688,389.5547 Q3986.2813,388.4844 3986.2813,387.2031 L3986.2813,386.0469 Q3986.2813,384.7188 3986.8984,383.5703 Q3987.5156,382.4219 3988.6094,381.8047 Q3989.7031,381.1875 3990.9375,381.1875 Q3991.6719,381.1875 3992.3203,381.3516 Q3992.9688,381.5156 3993.5156,381.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="4011.25" y="391.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3682.5" x2="4380.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:1.0;" x1="3682.5" x2="4380.5" y1="410" y2="410"/><ellipse cx="3692.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3701.5" y="428.5332">SqlProvider(connection : string)</text><polygon fill="#FFFF44" points="3692.5,436.9141,3696.5,440.9141,3692.5,444.9141,3688.5,440.9141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="3701.5" y="446.1426">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3692.5,454.5234,3696.5,458.5234,3692.5,462.5234,3688.5,458.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3701.5" y="463.752">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="117" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3471" y="103.5"/><ellipse cx="3575.75" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3578.5156,115.375 Q3578.6719,115.1563 3578.8594,115.0469 Q3579.0469,114.9375 3579.2656,114.9375 Q3579.6406,114.9375 3579.875,115.1953 Q3580.1094,115.4531 3580.1094,116.0625 L3580.1094,117.5156 Q3580.1094,118.125 3579.875,118.3906 Q3579.6406,118.6563 3579.2656,118.6563 Q3578.9219,118.6563 3578.7188,118.4531 Q3578.5156,118.2656 3578.4063,117.75 Q3578.3594,117.3906 3578.1719,117.2031 Q3577.8438,116.8281 3577.2344,116.6094 Q3576.625,116.3906 3576,116.3906 Q3575.2344,116.3906 3574.6016,116.7188 Q3573.9688,117.0469 3573.4766,117.7969 Q3572.9844,118.5469 3572.9844,119.5781 L3572.9844,120.6719 Q3572.9844,121.9063 3573.875,122.7266 Q3574.7656,123.5469 3576.3594,123.5469 Q3577.2969,123.5469 3577.9531,123.2969 Q3578.3438,123.1406 3578.7656,122.7031 Q3579.0313,122.4375 3579.1797,122.3594 Q3579.3281,122.2813 3579.5313,122.2813 Q3579.8594,122.2813 3580.1172,122.5391 Q3580.375,122.7969 3580.375,123.1406 Q3580.375,123.4844 3580.0313,123.8906 Q3579.5313,124.4688 3578.7344,124.7969 Q3577.6563,125.25 3576.3594,125.25 Q3574.8438,125.25 3573.6406,124.625 Q3572.6563,124.125 3571.9688,123.0547 Q3571.2813,121.9844 3571.2813,120.7031 L3571.2813,119.5469 Q3571.2813,118.2188 3571.8984,117.0703 Q3572.5156,115.9219 3573.6094,115.3047 Q3574.7031,114.6875 3575.9375,114.6875 Q3576.6719,114.6875 3577.3203,114.8516 Q3577.9688,115.0156 3578.5156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="3596.25" y="125.2285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3472" x2="3849" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3472" x2="3849" y1="143.5" y2="143.5"/><ellipse cx="3482" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3491" y="162.0332">LeakedPasswordProvider(configuration : IConfiguration)</text></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="128" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="3083.5" y="95"/><ellipse cx="3188.25" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3191.0156,106.875 Q3191.1719,106.6563 3191.3594,106.5469 Q3191.5469,106.4375 3191.7656,106.4375 Q3192.1406,106.4375 3192.375,106.6953 Q3192.6094,106.9531 3192.6094,107.5625 L3192.6094,109.0156 Q3192.6094,109.625 3192.375,109.8906 Q3192.1406,110.1563 3191.7656,110.1563 Q3191.4219,110.1563 3191.2188,109.9531 Q3191.0156,109.7656 3190.9063,109.25 Q3190.8594,108.8906 3190.6719,108.7031 Q3190.3438,108.3281 3189.7344,108.1094 Q3189.125,107.8906 3188.5,107.8906 Q3187.7344,107.8906 3187.1016,108.2188 Q3186.4688,108.5469 3185.9766,109.2969 Q3185.4844,110.0469 3185.4844,111.0781 L3185.4844,112.1719 Q3185.4844,113.4063 3186.375,114.2266 Q3187.2656,115.0469 3188.8594,115.0469 Q3189.7969,115.0469 3190.4531,114.7969 Q3190.8438,114.6406 3191.2656,114.2031 Q3191.5313,113.9375 3191.6797,113.8594 Q3191.8281,113.7813 3192.0313,113.7813 Q3192.3594,113.7813 3192.6172,114.0391 Q3192.875,114.2969 3192.875,114.6406 Q3192.875,114.9844 3192.5313,115.3906 Q3192.0313,115.9688 3191.2344,116.2969 Q3190.1563,116.75 3188.8594,116.75 Q3187.3438,116.75 3186.1406,116.125 Q3185.1563,115.625 3184.4688,114.5547 Q3183.7813,113.4844 3183.7813,112.2031 L3183.7813,111.0469 Q3183.7813,109.7188 3184.3984,108.5703 Q3185.0156,107.4219 3186.1094,106.8047 Q3187.2031,106.1875 3188.4375,106.1875 Q3189.1719,106.1875 3189.8203,106.3516 Q3190.4688,106.5156 3191.0156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3208.75" y="116.7285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3084.5" x2="3382.5" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="3084.5" x2="3382.5" y1="135" y2="135"/><ellipse cx="3094.5" cy="149.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="3103.5" y="153.5332">UserProvider(configuration : IConfiguration)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3091.5" y="163.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="3103.5" y="171.1426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="186" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="1654.5" y="584"/><ellipse cx="1731.75" cy="600" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1734.5156,595.875 Q1734.6719,595.6563 1734.8594,595.5469 Q1735.0469,595.4375 1735.2656,595.4375 Q1735.6406,595.4375 1735.875,595.6953 Q1736.1094,595.9531 1736.1094,596.5625 L1736.1094,598.0156 Q1736.1094,598.625 1735.875,598.8906 Q1735.6406,599.1563 1735.2656,599.1563 Q1734.9219,599.1563 1734.7188,598.9531 Q1734.5156,598.7656 1734.4063,598.25 Q1734.3594,597.8906 1734.1719,597.7031 Q1733.8438,597.3281 1733.2344,597.1094 Q1732.625,596.8906 1732,596.8906 Q1731.2344,596.8906 1730.6016,597.2188 Q1729.9688,597.5469 1729.4766,598.2969 Q1728.9844,599.0469 1728.9844,600.0781 L1728.9844,601.1719 Q1728.9844,602.4063 1729.875,603.2266 Q1730.7656,604.0469 1732.3594,604.0469 Q1733.2969,604.0469 1733.9531,603.7969 Q1734.3438,603.6406 1734.7656,603.2031 Q1735.0313,602.9375 1735.1797,602.8594 Q1735.3281,602.7813 1735.5313,602.7813 Q1735.8594,602.7813 1736.1172,603.0391 Q1736.375,603.2969 1736.375,603.6406 Q1736.375,603.9844 1736.0313,604.3906 Q1735.5313,604.9688 1734.7344,605.2969 Q1733.6563,605.75 1732.3594,605.75 Q1730.8438,605.75 1729.6406,605.125 Q1728.6563,604.625 1727.9688,603.5547 Q1727.2813,602.4844 1727.2813,601.2031 L1727.2813,600.0469 Q1727.2813,598.7188 1727.8984,597.5703 Q1728.5156,596.4219 1729.6094,595.8047 Q1730.7031,595.1875 1731.9375,595.1875 Q1732.6719,595.1875 1733.3203,595.3516 Q1733.9688,595.5156 1734.5156,595.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1752.25" y="605.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="1655.5" x2="1863.5" y1="616" y2="616"/><ellipse cx="1665.5" cy="630.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="1674.5" y="634.5332">HashedPassword : string</text><ellipse cx="1665.5" cy="647.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1674.5" y="652.1426">Salt : string</text><ellipse cx="1665.5" cy="665.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1674.5" y="669.752">SecretKey : string</text><ellipse cx="1665.5" cy="683.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1674.5" y="687.3613">Count : long</text><ellipse cx="1665.5" cy="700.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="1674.5" y="704.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1655.5" x2="1863.5" y1="712.0469" y2="712.0469"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="211" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="2851" y="575"/><ellipse cx="2888.5" cy="591" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2891.2656,586.875 Q2891.4219,586.6563 2891.6094,586.5469 Q2891.7969,586.4375 2892.0156,586.4375 Q2892.3906,586.4375 2892.625,586.6953 Q2892.8594,586.9531 2892.8594,587.5625 L2892.8594,589.0156 Q2892.8594,589.625 2892.625,589.8906 Q2892.3906,590.1563 2892.0156,590.1563 Q2891.6719,590.1563 2891.4688,589.9531 Q2891.2656,589.7656 2891.1563,589.25 Q2891.1094,588.8906 2890.9219,588.7031 Q2890.5938,588.3281 2889.9844,588.1094 Q2889.375,587.8906 2888.75,587.8906 Q2887.9844,587.8906 2887.3516,588.2188 Q2886.7188,588.5469 2886.2266,589.2969 Q2885.7344,590.0469 2885.7344,591.0781 L2885.7344,592.1719 Q2885.7344,593.4063 2886.625,594.2266 Q2887.5156,595.0469 2889.1094,595.0469 Q2890.0469,595.0469 2890.7031,594.7969 Q2891.0938,594.6406 2891.5156,594.2031 Q2891.7813,593.9375 2891.9297,593.8594 Q2892.0781,593.7813 2892.2813,593.7813 Q2892.6094,593.7813 2892.8672,594.0391 Q2893.125,594.2969 2893.125,594.6406 Q2893.125,594.9844 2892.7813,595.3906 Q2892.2813,595.9688 2891.4844,596.2969 Q2890.4063,596.75 2889.1094,596.75 Q2887.5938,596.75 2886.3906,596.125 Q2885.4063,595.625 2884.7188,594.5547 Q2884.0313,593.4844 2884.0313,592.2031 L2884.0313,591.0469 Q2884.0313,589.7188 2884.6484,588.5703 Q2885.2656,587.4219 2886.3594,586.8047 Q2887.4531,586.1875 2888.6875,586.1875 Q2889.4219,586.1875 2890.0703,586.3516 Q2890.7188,586.5156 2891.2656,586.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="2907.5" y="596.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="2852" x2="3015" y1="607" y2="607"/><ellipse cx="2862" cy="621.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="2871" y="625.5332">ID : int</text><ellipse cx="2862" cy="638.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="2871" y="643.1426">UserID : int</text><ellipse cx="2862" cy="656.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="2871" y="660.752">IP : string</text><ellipse cx="2862" cy="674.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="2871" y="678.3613">UserAgent : string</text><ellipse cx="2862" cy="691.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="2871" y="695.9707">Successful : bool</text><ellipse cx="2862" cy="709.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2871" y="713.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="2852" x2="3015" y1="720.6563" y2="720.6563"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="149" fill="#F1F1F1" height="136.0469" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="480" x="3885.5" y="68.5"/><ellipse cx="4095.75" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4098.5156,80.375 Q4098.6719,80.1563 4098.8594,80.0469 Q4099.0469,79.9375 4099.2656,79.9375 Q4099.6406,79.9375 4099.875,80.1953 Q4100.1094,80.4531 4100.1094,81.0625 L4100.1094,82.5156 Q4100.1094,83.125 4099.875,83.3906 Q4099.6406,83.6563 4099.2656,83.6563 Q4098.9219,83.6563 4098.7188,83.4531 Q4098.5156,83.2656 4098.4063,82.75 Q4098.3594,82.3906 4098.1719,82.2031 Q4097.8438,81.8281 4097.2344,81.6094 Q4096.625,81.3906 4096,81.3906 Q4095.2344,81.3906 4094.6016,81.7188 Q4093.9688,82.0469 4093.4766,82.7969 Q4092.9844,83.5469 4092.9844,84.5781 L4092.9844,85.6719 Q4092.9844,86.9063 4093.875,87.7266 Q4094.7656,88.5469 4096.3594,88.5469 Q4097.2969,88.5469 4097.9531,88.2969 Q4098.3438,88.1406 4098.7656,87.7031 Q4099.0313,87.4375 4099.1797,87.3594 Q4099.3281,87.2813 4099.5313,87.2813 Q4099.8594,87.2813 4100.1172,87.5391 Q4100.375,87.7969 4100.375,88.1406 Q4100.375,88.4844 4100.0313,88.8906 Q4099.5313,89.4688 4098.7344,89.7969 Q4097.6563,90.25 4096.3594,90.25 Q4094.8438,90.25 4093.6406,89.625 Q4092.6563,89.125 4091.9688,88.0547 Q4091.2813,86.9844 4091.2813,85.7031 L4091.2813,84.5469 Q4091.2813,83.2188 4091.8984,82.0703 Q4092.5156,80.9219 4093.6094,80.3047 Q4094.7031,79.6875 4095.9375,79.6875 Q4096.6719,79.6875 4097.3203,79.8516 Q4097.9688,80.0156 4098.5156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="4116.25" y="90.2285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="3886.5" x2="4364.5" y1="100.5" y2="100.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3886.5" x2="4364.5" y1="108.5" y2="108.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3893.5" y="119.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="312" x="3905.5" y="127.0332">GetEncryptedPassword(password : string) : string</text><ellipse cx="3896.5" cy="140.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="3905.5" y="144.6426">GetSalt(saltLength : int) : string</text><ellipse cx="3896.5" cy="158.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="454" x="3905.5" y="162.252">GetEncryptedAndSaltedPassword(password : string, salt : string) : string</text><ellipse cx="3896.5" cy="175.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="3905.5" y="179.8613">GetHotp(key : string, counter : long) : string</text><ellipse cx="3896.5" cy="193.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="3905.5" y="197.4707">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="158" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4400.5" y="103.5"/><ellipse cx="4549.75" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4552.5156,115.375 Q4552.6719,115.1563 4552.8594,115.0469 Q4553.0469,114.9375 4553.2656,114.9375 Q4553.6406,114.9375 4553.875,115.1953 Q4554.1094,115.4531 4554.1094,116.0625 L4554.1094,117.5156 Q4554.1094,118.125 4553.875,118.3906 Q4553.6406,118.6563 4553.2656,118.6563 Q4552.9219,118.6563 4552.7188,118.4531 Q4552.5156,118.2656 4552.4063,117.75 Q4552.3594,117.3906 4552.1719,117.2031 Q4551.8438,116.8281 4551.2344,116.6094 Q4550.625,116.3906 4550,116.3906 Q4549.2344,116.3906 4548.6016,116.7188 Q4547.9688,117.0469 4547.4766,117.7969 Q4546.9844,118.5469 4546.9844,119.5781 L4546.9844,120.6719 Q4546.9844,121.9063 4547.875,122.7266 Q4548.7656,123.5469 4550.3594,123.5469 Q4551.2969,123.5469 4551.9531,123.2969 Q4552.3438,123.1406 4552.7656,122.7031 Q4553.0313,122.4375 4553.1797,122.3594 Q4553.3281,122.2813 4553.5313,122.2813 Q4553.8594,122.2813 4554.1172,122.5391 Q4554.375,122.7969 4554.375,123.1406 Q4554.375,123.4844 4554.0313,123.8906 Q4553.5313,124.4688 4552.7344,124.7969 Q4551.6563,125.25 4550.3594,125.25 Q4548.8438,125.25 4547.6406,124.625 Q4546.6563,124.125 4545.9688,123.0547 Q4545.2813,121.9844 4545.2813,120.7031 L4545.2813,119.5469 Q4545.2813,118.2188 4545.8984,117.0703 Q4546.5156,115.9219 4547.6094,115.3047 Q4548.7031,114.6875 4549.9375,114.6875 Q4550.6719,114.6875 4551.3203,114.8516 Q4551.9688,115.0156 4552.5156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="4570.25" y="125.2285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4401.5" x2="4787.5" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="4401.5" x2="4787.5" y1="143.5" y2="143.5"/><ellipse cx="4411.5" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="4420.5" y="162.0332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="178" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1598.5" y="789"/><ellipse cx="1663.75" cy="805" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1666.5156,800.875 Q1666.6719,800.6563 1666.8594,800.5469 Q1667.0469,800.4375 1667.2656,800.4375 Q1667.6406,800.4375 1667.875,800.6953 Q1668.1094,800.9531 1668.1094,801.5625 L1668.1094,803.0156 Q1668.1094,803.625 1667.875,803.8906 Q1667.6406,804.1563 1667.2656,804.1563 Q1666.9219,804.1563 1666.7188,803.9531 Q1666.5156,803.7656 1666.4063,803.25 Q1666.3594,802.8906 1666.1719,802.7031 Q1665.8438,802.3281 1665.2344,802.1094 Q1664.625,801.8906 1664,801.8906 Q1663.2344,801.8906 1662.6016,802.2188 Q1661.9688,802.5469 1661.4766,803.2969 Q1660.9844,804.0469 1660.9844,805.0781 L1660.9844,806.1719 Q1660.9844,807.4063 1661.875,808.2266 Q1662.7656,809.0469 1664.3594,809.0469 Q1665.2969,809.0469 1665.9531,808.7969 Q1666.3438,808.6406 1666.7656,808.2031 Q1667.0313,807.9375 1667.1797,807.8594 Q1667.3281,807.7813 1667.5313,807.7813 Q1667.8594,807.7813 1668.1172,808.0391 Q1668.375,808.2969 1668.375,808.6406 Q1668.375,808.9844 1668.0313,809.3906 Q1667.5313,809.9688 1666.7344,810.2969 Q1665.6563,810.75 1664.3594,810.75 Q1662.8438,810.75 1661.6406,810.125 Q1660.6563,809.625 1659.9688,808.5547 Q1659.2813,807.4844 1659.2813,806.2031 L1659.2813,805.0469 Q1659.2813,803.7188 1659.8984,802.5703 Q1660.5156,801.4219 1661.6094,800.8047 Q1662.7031,800.1875 1663.9375,800.1875 Q1664.6719,800.1875 1665.3203,800.3516 Q1665.9688,800.5156 1666.5156,800.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1684.25" y="810.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="1599.5" x2="1765.5" y1="821" y2="821"/><ellipse cx="1609.5" cy="835.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1618.5" y="839.5332">ID : int</text><ellipse cx="1609.5" cy="852.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1618.5" y="857.1426">IsVerified : bool</text><ellipse cx="1609.5" cy="870.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1618.5" y="874.752">IsLocked : bool</text><ellipse cx="1609.5" cy="888.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1618.5" y="892.3613">FailedTries : int</text><ellipse cx="1609.5" cy="905.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="1618.5" y="909.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1599.5" x2="1765.5" y1="917.0469" y2="917.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="198" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="1354" y="985"/><ellipse cx="1400.75" cy="1001" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1403.5156,996.875 Q1403.6719,996.6563 1403.8594,996.5469 Q1404.0469,996.4375 1404.2656,996.4375 Q1404.6406,996.4375 1404.875,996.6953 Q1405.1094,996.9531 1405.1094,997.5625 L1405.1094,999.0156 Q1405.1094,999.625 1404.875,999.8906 Q1404.6406,1000.1563 1404.2656,1000.1563 Q1403.9219,1000.1563 1403.7188,999.9531 Q1403.5156,999.7656 1403.4063,999.25 Q1403.3594,998.8906 1403.1719,998.7031 Q1402.8438,998.3281 1402.2344,998.1094 Q1401.625,997.8906 1401,997.8906 Q1400.2344,997.8906 1399.6016,998.2188 Q1398.9688,998.5469 1398.4766,999.2969 Q1397.9844,1000.0469 1397.9844,1001.0781 L1397.9844,1002.1719 Q1397.9844,1003.4063 1398.875,1004.2266 Q1399.7656,1005.0469 1401.3594,1005.0469 Q1402.2969,1005.0469 1402.9531,1004.7969 Q1403.3438,1004.6406 1403.7656,1004.2031 Q1404.0313,1003.9375 1404.1797,1003.8594 Q1404.3281,1003.7813 1404.5313,1003.7813 Q1404.8594,1003.7813 1405.1172,1004.0391 Q1405.375,1004.2969 1405.375,1004.6406 Q1405.375,1004.9844 1405.0313,1005.3906 Q1404.5313,1005.9688 1403.7344,1006.2969 Q1402.6563,1006.75 1401.3594,1006.75 Q1399.8438,1006.75 1398.6406,1006.125 Q1397.6563,1005.625 1396.9688,1004.5547 Q1396.2813,1003.4844 1396.2813,1002.2031 L1396.2813,1001.0469 Q1396.2813,999.7188 1396.8984,998.5703 Q1397.5156,997.4219 1398.6094,996.8047 Q1399.7031,996.1875 1400.9375,996.1875 Q1401.6719,996.1875 1402.3203,996.3516 Q1402.9688,996.5156 1403.5156,996.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1421.25" y="1006.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="1355" x2="1516" y1="1017" y2="1017"/><ellipse cx="1365" cy="1031.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1374" y="1035.5332">Email : string</text><ellipse cx="1365" cy="1048.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1374" y="1053.1426">FirstName : string</text><ellipse cx="1365" cy="1066.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1374" y="1070.752">LastName : string</text><ellipse cx="1365" cy="1084.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1374" y="1088.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1355" x2="1516" y1="1095.4375" y2="1095.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="20" d="M835.5,244.19 C835.5,280.4 835.5,319.83 835.5,352.11 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="835.5,231.01,831.5,237.01,835.5,243.01,839.5,237.01,835.5,231.01" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="21" d="M640.31,237.03 C552.03,282.05 451.62,333.26 379.68,369.95 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="652.13,231.01,644.9682,230.1683,641.4367,236.4555,648.5985,237.2972,652.13,231.01" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="77" d="M913.88,488.68 C1022.92,582.12 1216.48,748 1301.04,820.46 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1304.98,823.84,1300.7499,814.9459,1301.1837,820.586,1295.5435,821.0199,1304.98,823.84" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="78" d="M835.5,488.81 C835.5,526.22 835.5,571.8 835.5,605.1 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="835.5,610.34,839.5,601.34,835.5,605.34,831.5,601.34,835.5,610.34" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="79" d="M1312.27,266.02 C1226.75,293.55 1139.24,321.72 1062.93,346.29 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1064.96,352.99,1043.78,352.45,1060.67,339.66,1064.96,352.99" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="81" d="M2027.25,271.2 C2070.87,289.67 2114.89,308.31 2156.3,325.84 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2015.27,266.12,2019.2344,272.1436,2026.3194,270.8008,2022.355,264.7773,2015.27,266.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="82" d="M1766.55,278.64 C1779.31,311.34 1792.06,344.03 1802.07,369.68 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1761.67,266.12,1760.1283,273.1644,1766.0378,277.2969,1767.5795,270.2525,1761.67,266.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="83" d="M2193.57,225.9 C2284.68,240.74 2379.35,254.9 2468.5,266 C2801.66,307.47 2895.39,246.24 3221.5,326 C3277.75,339.76 3338.07,366.14 3381.46,387.38 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2180.74,223.81,2186.015,228.7267,2192.5824,225.7486,2187.3074,220.8318,2180.74,223.81" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[bb0f9a6a29584614f488e3bb56770cd7]
reverse link UserManager to IMessageService--><g id="link_UserManager_IMessageService"><path codeLine="84" d="M1580.46,276.04 C1564.62,292.85 1548.68,309.8 1533.5,326 C1511.06,349.94 1485.49,377.45 1467.9,396.4 " fill="none" id="UserManager-backto-IMessageService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1589.77,266.16,1582.745,267.7877,1581.5456,274.8984,1588.5706,273.2707,1589.77,266.16" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[384f0fd38da128e29f09444463ca6de7]
reverse link UserManager to IMessageProvider--><g id="link_UserManager_IMessageProvider"><path codeLine="85" d="M1437.86,272.89 C1410.64,289.63 1384.03,307.43 1359.5,326 C1332.02,346.81 1305.24,376.14 1288.14,396.38 " fill="none" id="UserManager-backto-IMessageProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1449.14,266.04,1441.9352,265.7391,1438.8863,272.2739,1446.0911,272.5749,1449.14,266.04" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="87" d="M274.8,178.2 C276.23,223.01 278.55,295.82 280.27,349.76 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="287.27,349.56,280.91,369.78,273.28,350.01,287.27,349.56" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="88" d="M282.5,484.13 C282.5,520.94 282.5,566.84 282.5,601.18 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="282.5,471.02,278.5,477.02,282.5,483.02,286.5,477.02,282.5,471.02" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="91" d="M2583.01,178.07 C2459.93,215.89 2271.62,274.1 2108.5,326 C2070.59,338.06 2029.92,351.19 1991.46,363.7 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1993.37,370.44,1972.19,369.98,1989.04,357.13,1993.37,370.44" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="92" d="M2755.12,188.75 C2794.88,240.18 2855.72,318.89 2895.06,369.78 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2746.97,178.2,2747.4713,185.3937,2754.3044,187.6977,2753.8031,180.5041,2746.97,178.2" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="138" d="M2113.78,519.44 C2025.95,552.05 1933.14,586.52 1864.55,611.99 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2126.14,514.85,2119.1224,513.1907,2114.8916,519.0302,2121.9092,520.6896,2126.14,514.85" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="139" d="M2933.5,484.3 C2933.5,512.3 2933.5,545.53 2933.5,574.93 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2933.5,471.02,2929.5,477.02,2933.5,483.02,2937.5,477.02,2933.5,471.02" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="141" d="M3635.7,169.57 C3597.51,218.98 3524.06,313.99 3479.55,371.58 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3485.04,375.91,3467.27,387.46,3473.97,367.35,3485.04,375.91" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="142" d="M3702.7,169.57 C3762.68,215.17 3873.77,299.61 3950.1,357.62 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3954.62,352.27,3966.3,369.94,3946.14,363.41,3954.62,352.27" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="144" d="M3161.12,178.08 C3107.69,206.46 3032.43,243.22 2962.5,266 C2832.02,308.5 2787.82,290.67 2648.01,325.62 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2649.7,332.41,2628.58,330.66,2646.19,318.86,2649.7,332.41" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="145" d="M3292.86,178.09 C3335.89,206.02 3396.32,242.22 3453.5,266 C3471.29,273.4 3662.77,323.82 3820.54,364.89 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3822.49,358.17,3840.09,369.98,3818.97,371.72,3822.49,358.17" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="165" d="M1598.19,921.15 C1576.03,937.74 1552,955.74 1529.38,972.69 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1533.41,978.41,1513.2,984.8,1525.01,967.21,1533.41,978.41" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="166" d="M1358.7,890.22 C1369.31,911.34 1383.66,939.87 1397.07,966.56 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1403.43,963.62,1406.16,984.63,1390.92,969.91,1403.43,963.62" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="168" d="M1734.07,720.03 C1728.03,735.97 1721.49,753.2 1715.17,769.86 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1721.67,772.47,1708.03,788.69,1708.58,767.51,1721.67,772.47" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[627747187a669cfa86212339350dc0cb]
@startuml API class diagram

top to bottom direction

'Controllers'

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +VerifyUserRegister(UserLogin : UserLogin) : Task<ActionResult>
}

'Controllers mappings' 

UserController o- - IUserManager
UserController o- - ITokenManager

'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger<UserManager>
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
        messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
    -IsUserNotVerified(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLocked(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}


'Managers mappings'

IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider
UserManager o- - IMessageService
UserManager o- - IMessageProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

'Utility'

class Security{
    - -
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction


class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +VerifyUserRegister(UserLogin : UserLogin) : Task<ActionResult>
}


UserController o- - IUserManager
UserController o- - ITokenManager


Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger<UserManager>
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
        messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
    -IsUserNotVerified(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLocked(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}



IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider
UserManager o- - IMessageService
UserManager o- - IMessageProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider


class Security{
    - -
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>