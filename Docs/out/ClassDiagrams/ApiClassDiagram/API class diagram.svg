<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="934px" preserveAspectRatio="none" style="width:3537px;height:934px;background:#FFFFFF;" version="1.1" viewBox="0 0 3537 934" width="3537px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="7" fill="#F1F1F1" height="188.875" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="736" x="575.5" y="7"/><ellipse cx="893.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M896.5156,18.875 Q896.6719,18.6563 896.8594,18.5469 Q897.0469,18.4375 897.2656,18.4375 Q897.6406,18.4375 897.875,18.6953 Q898.1094,18.9531 898.1094,19.5625 L898.1094,21.0156 Q898.1094,21.625 897.875,21.8906 Q897.6406,22.1563 897.2656,22.1563 Q896.9219,22.1563 896.7188,21.9531 Q896.5156,21.7656 896.4063,21.25 Q896.3594,20.8906 896.1719,20.7031 Q895.8438,20.3281 895.2344,20.1094 Q894.625,19.8906 894,19.8906 Q893.2344,19.8906 892.6016,20.2188 Q891.9688,20.5469 891.4766,21.2969 Q890.9844,22.0469 890.9844,23.0781 L890.9844,24.1719 Q890.9844,25.4063 891.875,26.2266 Q892.7656,27.0469 894.3594,27.0469 Q895.2969,27.0469 895.9531,26.7969 Q896.3438,26.6406 896.7656,26.2031 Q897.0313,25.9375 897.1797,25.8594 Q897.3281,25.7813 897.5313,25.7813 Q897.8594,25.7813 898.1172,26.0391 Q898.375,26.2969 898.375,26.6406 Q898.375,26.9844 898.0313,27.3906 Q897.5313,27.9688 896.7344,28.2969 Q895.6563,28.75 894.3594,28.75 Q892.8438,28.75 891.6406,28.125 Q890.6563,27.625 889.9688,26.5547 Q889.2813,25.4844 889.2813,24.2031 L889.2813,23.0469 Q889.2813,21.7188 889.8984,20.5703 Q890.5156,19.4219 891.6094,18.8047 Q892.7031,18.1875 893.9375,18.1875 Q894.6719,18.1875 895.3203,18.3516 Q895.9688,18.5156 896.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="914.25" y="28.7285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="576.5" x2="1310.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="280" x="595.5" y="57.5332">_logger{readonly} : ILogger&lt;UserController&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="595.5" y="75.1426">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="595.5" y="92.752">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="576.5" x2="1310.5" y1="99.8281" y2="99.8281"/><ellipse cx="586.5" cy="114.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="710" x="595.5" y="118.3613">UserController(logger : ILogger&lt;UserController&gt;, userManager : IUserManager, tokenManager : ITokenManager)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="595.5" y="135.9707"> </text><ellipse cx="586.5" cy="149.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="595.5" y="153.5801">Create(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586.5" cy="166.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="595.5" y="171.1895">Login(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586.5" cy="184.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="318" x="595.5" y="188.7988">GetUserFromToken() : Task&lt;ActionResult&lt;User&gt;&gt;</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="25" fill="#F1F1F1" height="100.8281" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="389" x="1033" y="273.5"/><ellipse cx="1177.75" cy="289.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1178.7031,286.1406 L1178.7031,292.7969 L1180.4219,292.7969 Q1181.0313,292.7969 1181.2969,293.0313 Q1181.5625,293.2656 1181.5625,293.6563 Q1181.5625,294.0313 1181.2969,294.2656 Q1181.0313,294.5 1180.4219,294.5 L1175.2813,294.5 Q1174.6719,294.5 1174.4063,294.2656 Q1174.1406,294.0313 1174.1406,293.6406 Q1174.1406,293.2656 1174.4063,293.0313 Q1174.6719,292.7969 1175.2813,292.7969 L1177,292.7969 L1177,286.1406 L1175.2813,286.1406 Q1174.6719,286.1406 1174.4063,285.9063 Q1174.1406,285.6719 1174.1406,285.2813 Q1174.1406,284.9063 1174.4063,284.6719 Q1174.6719,284.4375 1175.2813,284.4375 L1180.4219,284.4375 Q1181.0313,284.4375 1181.2969,284.6719 Q1181.5625,284.9063 1181.5625,285.2813 Q1181.5625,285.6719 1181.2969,285.9063 Q1181.0313,286.1406 1180.4219,286.1406 L1178.7031,286.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="1198.25" y="295.2285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1034" x2="1421" y1="305.5" y2="305.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1034" x2="1421" y1="313.5" y2="313.5"/><ellipse cx="1044" cy="327.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="363" x="1053" y="332.0332">CreateUserAsync(userCreate : UserCreate) : Task&lt;User&gt;</text><ellipse cx="1044" cy="345.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="310" x="1053" y="349.6426">LoginAsync(userLogin : UserLogin) : Task&lt;User&gt;</text><ellipse cx="1044" cy="363.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="1053" y="367.252">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="31" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="371.5" y="273.5"/><ellipse cx="498.25" cy="289.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M499.2031,286.1406 L499.2031,292.7969 L500.9219,292.7969 Q501.5313,292.7969 501.7969,293.0313 Q502.0625,293.2656 502.0625,293.6563 Q502.0625,294.0313 501.7969,294.2656 Q501.5313,294.5 500.9219,294.5 L495.7813,294.5 Q495.1719,294.5 494.9063,294.2656 Q494.6406,294.0313 494.6406,293.6406 Q494.6406,293.2656 494.9063,293.0313 Q495.1719,292.7969 495.7813,292.7969 L497.5,292.7969 L497.5,286.1406 L495.7813,286.1406 Q495.1719,286.1406 494.9063,285.9063 Q494.6406,285.6719 494.6406,285.2813 Q494.6406,284.9063 494.9063,284.6719 Q495.1719,284.4375 495.7813,284.4375 L500.9219,284.4375 Q501.5313,284.4375 501.7969,284.6719 Q502.0625,284.9063 502.0625,285.2813 Q502.0625,285.6719 501.7969,285.9063 Q501.5313,286.1406 500.9219,286.1406 L499.2031,286.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="518.75" y="295.2285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="372.5" x2="734.5" y1="305.5" y2="305.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="372.5" x2="734.5" y1="313.5" y2="313.5"/><ellipse cx="382.5" cy="327.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="391.5" y="332.0332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="382.5" cy="345.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="391.5" y="349.6426">ValidateToken(token : string) : bool</text><ellipse cx="382.5" cy="363.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="391.5" y="367.252">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="37" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="60"/><ellipse cx="221.25" cy="76" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,71.875 Q224.1719,71.6563 224.3594,71.5469 Q224.5469,71.4375 224.7656,71.4375 Q225.1406,71.4375 225.375,71.6953 Q225.6094,71.9531 225.6094,72.5625 L225.6094,74.0156 Q225.6094,74.625 225.375,74.8906 Q225.1406,75.1563 224.7656,75.1563 Q224.4219,75.1563 224.2188,74.9531 Q224.0156,74.7656 223.9063,74.25 Q223.8594,73.8906 223.6719,73.7031 Q223.3438,73.3281 222.7344,73.1094 Q222.125,72.8906 221.5,72.8906 Q220.7344,72.8906 220.1016,73.2188 Q219.4688,73.5469 218.9766,74.2969 Q218.4844,75.0469 218.4844,76.0781 L218.4844,77.1719 Q218.4844,78.4063 219.375,79.2266 Q220.2656,80.0469 221.8594,80.0469 Q222.7969,80.0469 223.4531,79.7969 Q223.8438,79.6406 224.2656,79.2031 Q224.5313,78.9375 224.6797,78.8594 Q224.8281,78.7813 225.0313,78.7813 Q225.3594,78.7813 225.6172,79.0391 Q225.875,79.2969 225.875,79.6406 Q225.875,79.9844 225.5313,80.3906 Q225.0313,80.9688 224.2344,81.2969 Q223.1563,81.75 221.8594,81.75 Q220.3438,81.75 219.1406,81.125 Q218.1563,80.625 217.4688,79.5547 Q216.7813,78.4844 216.7813,77.2031 L216.7813,76.0469 Q216.7813,74.7188 217.3984,73.5703 Q218.0156,72.4219 219.1094,71.8047 Q220.2031,71.1875 221.4375,71.1875 Q222.1719,71.1875 222.8203,71.3516 Q223.4688,71.5156 224.0156,71.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="81.7285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="92" y2="92"/><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="100" y2="100"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="111.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="118.5332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="128.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="136.1426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="42" fill="#F1F1F1" height="100.8281" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="639" x="1347" y="51"/><ellipse cx="1619.75" cy="67" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1622.5156,62.875 Q1622.6719,62.6563 1622.8594,62.5469 Q1623.0469,62.4375 1623.2656,62.4375 Q1623.6406,62.4375 1623.875,62.6953 Q1624.1094,62.9531 1624.1094,63.5625 L1624.1094,65.0156 Q1624.1094,65.625 1623.875,65.8906 Q1623.6406,66.1563 1623.2656,66.1563 Q1622.9219,66.1563 1622.7188,65.9531 Q1622.5156,65.7656 1622.4063,65.25 Q1622.3594,64.8906 1622.1719,64.7031 Q1621.8438,64.3281 1621.2344,64.1094 Q1620.625,63.8906 1620,63.8906 Q1619.2344,63.8906 1618.6016,64.2188 Q1617.9688,64.5469 1617.4766,65.2969 Q1616.9844,66.0469 1616.9844,67.0781 L1616.9844,68.1719 Q1616.9844,69.4063 1617.875,70.2266 Q1618.7656,71.0469 1620.3594,71.0469 Q1621.2969,71.0469 1621.9531,70.7969 Q1622.3438,70.6406 1622.7656,70.2031 Q1623.0313,69.9375 1623.1797,69.8594 Q1623.3281,69.7813 1623.5313,69.7813 Q1623.8594,69.7813 1624.1172,70.0391 Q1624.375,70.2969 1624.375,70.6406 Q1624.375,70.9844 1624.0313,71.3906 Q1623.5313,71.9688 1622.7344,72.2969 Q1621.6563,72.75 1620.3594,72.75 Q1618.8438,72.75 1617.6406,72.125 Q1616.6563,71.625 1615.9688,70.5547 Q1615.2813,69.4844 1615.2813,68.2031 L1615.2813,67.0469 Q1615.2813,65.7188 1615.8984,64.5703 Q1616.5156,63.4219 1617.6094,62.8047 Q1618.7031,62.1875 1619.9375,62.1875 Q1620.6719,62.1875 1621.3203,62.3516 Q1621.9688,62.5156 1622.5156,62.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1640.25" y="72.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1348" x2="1985" y1="83" y2="83"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1355" y="94.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="1367" y="101.5332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1355" y="111.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="1367" y="119.1426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1348" x2="1985" y1="126.2188" y2="126.2188"/><ellipse cx="1358" cy="140.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="613" x="1367" y="144.752">UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="143" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1250.5" y="648"/><ellipse cx="1279" cy="664" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1281.7656,659.875 Q1281.9219,659.6563 1282.1094,659.5469 Q1282.2969,659.4375 1282.5156,659.4375 Q1282.8906,659.4375 1283.125,659.6953 Q1283.3594,659.9531 1283.3594,660.5625 L1283.3594,662.0156 Q1283.3594,662.625 1283.125,662.8906 Q1282.8906,663.1563 1282.5156,663.1563 Q1282.1719,663.1563 1281.9688,662.9531 Q1281.7656,662.7656 1281.6563,662.25 Q1281.6094,661.8906 1281.4219,661.7031 Q1281.0938,661.3281 1280.4844,661.1094 Q1279.875,660.8906 1279.25,660.8906 Q1278.4844,660.8906 1277.8516,661.2188 Q1277.2188,661.5469 1276.7266,662.2969 Q1276.2344,663.0469 1276.2344,664.0781 L1276.2344,665.1719 Q1276.2344,666.4063 1277.125,667.2266 Q1278.0156,668.0469 1279.6094,668.0469 Q1280.5469,668.0469 1281.2031,667.7969 Q1281.5938,667.6406 1282.0156,667.2031 Q1282.2813,666.9375 1282.4297,666.8594 Q1282.5781,666.7813 1282.7813,666.7813 Q1283.1094,666.7813 1283.3672,667.0391 Q1283.625,667.2969 1283.625,667.6406 Q1283.625,667.9844 1283.2813,668.3906 Q1282.7813,668.9688 1281.9844,669.2969 Q1280.9063,669.75 1279.6094,669.75 Q1278.0938,669.75 1276.8906,669.125 Q1275.9063,668.625 1275.2188,667.5547 Q1274.5313,666.4844 1274.5313,665.2031 L1274.5313,664.0469 Q1274.5313,662.7188 1275.1484,661.5703 Q1275.7656,660.4219 1276.8594,659.8047 Q1277.9531,659.1875 1279.1875,659.1875 Q1279.9219,659.1875 1280.5703,659.3516 Q1281.2188,659.5156 1281.7656,659.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1296" y="669.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="1251.5" x2="1383.5" y1="680" y2="680"/><ellipse cx="1261.5" cy="694.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1270.5" y="698.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1251.5" x2="1383.5" y1="705.6094" y2="705.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="155" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1280.5" y="461"/><ellipse cx="1312.6" cy="477" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1315.3656,472.875 Q1315.5219,472.6563 1315.7094,472.5469 Q1315.8969,472.4375 1316.1156,472.4375 Q1316.4906,472.4375 1316.725,472.6953 Q1316.9594,472.9531 1316.9594,473.5625 L1316.9594,475.0156 Q1316.9594,475.625 1316.725,475.8906 Q1316.4906,476.1563 1316.1156,476.1563 Q1315.7719,476.1563 1315.5688,475.9531 Q1315.3656,475.7656 1315.2563,475.25 Q1315.2094,474.8906 1315.0219,474.7031 Q1314.6938,474.3281 1314.0844,474.1094 Q1313.475,473.8906 1312.85,473.8906 Q1312.0844,473.8906 1311.4516,474.2188 Q1310.8188,474.5469 1310.3266,475.2969 Q1309.8344,476.0469 1309.8344,477.0781 L1309.8344,478.1719 Q1309.8344,479.4063 1310.725,480.2266 Q1311.6156,481.0469 1313.2094,481.0469 Q1314.1469,481.0469 1314.8031,480.7969 Q1315.1938,480.6406 1315.6156,480.2031 Q1315.8813,479.9375 1316.0297,479.8594 Q1316.1781,479.7813 1316.3813,479.7813 Q1316.7094,479.7813 1316.9672,480.0391 Q1317.225,480.2969 1317.225,480.6406 Q1317.225,480.9844 1316.8813,481.3906 Q1316.3813,481.9688 1315.5844,482.2969 Q1314.5063,482.75 1313.2094,482.75 Q1311.6938,482.75 1310.4906,482.125 Q1309.5063,481.625 1308.8188,480.5547 Q1308.1313,479.4844 1308.1313,478.2031 L1308.1313,477.0469 Q1308.1313,475.7188 1308.7484,474.5703 Q1309.3656,473.4219 1310.4594,472.8047 Q1311.5531,472.1875 1312.7875,472.1875 Q1313.5219,472.1875 1314.1703,472.3516 Q1314.8188,472.5156 1315.3656,472.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1330.4" y="482.7285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="1281.5" x2="1413.5" y1="493" y2="493"/><ellipse cx="1291.5" cy="507.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1300.5" y="511.5332">Email : string</text><ellipse cx="1291.5" cy="524.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1300.5" y="529.1426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1281.5" x2="1413.5" y1="536.2188" y2="536.2188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="64" fill="#F1F1F1" height="136.0469" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="382" x="1457.5" y="256"/><ellipse cx="1601.25" cy="272" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1602.2031,268.6406 L1602.2031,275.2969 L1603.9219,275.2969 Q1604.5313,275.2969 1604.7969,275.5313 Q1605.0625,275.7656 1605.0625,276.1563 Q1605.0625,276.5313 1604.7969,276.7656 Q1604.5313,277 1603.9219,277 L1598.7813,277 Q1598.1719,277 1597.9063,276.7656 Q1597.6406,276.5313 1597.6406,276.1406 Q1597.6406,275.7656 1597.9063,275.5313 Q1598.1719,275.2969 1598.7813,275.2969 L1600.5,275.2969 L1600.5,268.6406 L1598.7813,268.6406 Q1598.1719,268.6406 1597.9063,268.4063 Q1597.6406,268.1719 1597.6406,267.7813 Q1597.6406,267.4063 1597.9063,267.1719 Q1598.1719,266.9375 1598.7813,266.9375 L1603.9219,266.9375 Q1604.5313,266.9375 1604.7969,267.1719 Q1605.0625,267.4063 1605.0625,267.7813 Q1605.0625,268.1719 1604.7969,268.4063 Q1604.5313,268.6406 1603.9219,268.6406 L1602.2031,268.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="1621.75" y="277.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1458.5" x2="1838.5" y1="288" y2="288"/><line style="stroke:#181818;stroke-width:0.5;" x1="1458.5" x2="1838.5" y1="296" y2="296"/><ellipse cx="1468.5" cy="310.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="1477.5" y="314.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="1468.5" cy="327.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="1477.5" y="332.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="1468.5" cy="345.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="1477.5" y="349.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="1468.5" cy="363.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="1477.5" y="367.3613">UpdateUserFailedTries(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="1468.5" cy="380.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="1477.5" y="384.9707">UpdateUserLoginSuccess(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="72" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="1874.5" y="291"/><ellipse cx="1991.75" cy="307" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1992.7031,303.6406 L1992.7031,310.2969 L1994.4219,310.2969 Q1995.0313,310.2969 1995.2969,310.5313 Q1995.5625,310.7656 1995.5625,311.1563 Q1995.5625,311.5313 1995.2969,311.7656 Q1995.0313,312 1994.4219,312 L1989.2813,312 Q1988.6719,312 1988.4063,311.7656 Q1988.1406,311.5313 1988.1406,311.1406 Q1988.1406,310.7656 1988.4063,310.5313 Q1988.6719,310.2969 1989.2813,310.2969 L1991,310.2969 L1991,303.6406 L1989.2813,303.6406 Q1988.6719,303.6406 1988.4063,303.4063 Q1988.1406,303.1719 1988.1406,302.7813 Q1988.1406,302.4063 1988.4063,302.1719 Q1988.6719,301.9375 1989.2813,301.9375 L1994.4219,301.9375 Q1995.0313,301.9375 1995.2969,302.1719 Q1995.5625,302.4063 1995.5625,302.7813 Q1995.5625,303.1719 1995.2969,303.4063 Q1995.0313,303.6406 1994.4219,303.6406 L1992.7031,303.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="2012.25" y="312.7285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1875.5" x2="2281.5" y1="323" y2="323"/><line style="stroke:#181818;stroke-width:0.5;" x1="1875.5" x2="2281.5" y1="331" y2="331"/><ellipse cx="1885.5" cy="345.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="1894.5" y="349.5332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="124" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="497" y="452"/><ellipse cx="517.4" cy="468" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M520.1656,463.875 Q520.3219,463.6563 520.5094,463.5469 Q520.6969,463.4375 520.9156,463.4375 Q521.2906,463.4375 521.525,463.6953 Q521.7594,463.9531 521.7594,464.5625 L521.7594,466.0156 Q521.7594,466.625 521.525,466.8906 Q521.2906,467.1563 520.9156,467.1563 Q520.5719,467.1563 520.3688,466.9531 Q520.1656,466.7656 520.0563,466.25 Q520.0094,465.8906 519.8219,465.7031 Q519.4938,465.3281 518.8844,465.1094 Q518.275,464.8906 517.65,464.8906 Q516.8844,464.8906 516.2516,465.2188 Q515.6188,465.5469 515.1266,466.2969 Q514.6344,467.0469 514.6344,468.0781 L514.6344,469.1719 Q514.6344,470.4063 515.525,471.2266 Q516.4156,472.0469 518.0094,472.0469 Q518.9469,472.0469 519.6031,471.7969 Q519.9938,471.6406 520.4156,471.2031 Q520.6813,470.9375 520.8297,470.8594 Q520.9781,470.7813 521.1813,470.7813 Q521.5094,470.7813 521.7672,471.0391 Q522.025,471.2969 522.025,471.6406 Q522.025,471.9844 521.6813,472.3906 Q521.1813,472.9688 520.3844,473.2969 Q519.3063,473.75 518.0094,473.75 Q516.4938,473.75 515.2906,473.125 Q514.3063,472.625 513.6188,471.5547 Q512.9313,470.4844 512.9313,469.2031 L512.9313,468.0469 Q512.9313,466.7188 513.5484,465.5703 Q514.1656,464.4219 515.2594,463.8047 Q516.3531,463.1875 517.5875,463.1875 Q518.3219,463.1875 518.9703,463.3516 Q519.6188,463.5156 520.1656,463.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="532.6" y="473.7285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="498" x2="609" y1="484" y2="484"/><ellipse cx="508" cy="498.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="517" y="502.5332">UserID : int</text><ellipse cx="508" cy="515.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="517" y="520.1426">Email : string</text><ellipse cx="508" cy="533.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="517" y="537.752">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="498" x2="609" y1="544.8281" y2="544.8281"/></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="76" fill="#F1F1F1" height="118.4375" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="2317.5" y="265"/><ellipse cx="2626.75" cy="281" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2629.5156,276.875 Q2629.6719,276.6563 2629.8594,276.5469 Q2630.0469,276.4375 2630.2656,276.4375 Q2630.6406,276.4375 2630.875,276.6953 Q2631.1094,276.9531 2631.1094,277.5625 L2631.1094,279.0156 Q2631.1094,279.625 2630.875,279.8906 Q2630.6406,280.1563 2630.2656,280.1563 Q2629.9219,280.1563 2629.7188,279.9531 Q2629.5156,279.7656 2629.4063,279.25 Q2629.3594,278.8906 2629.1719,278.7031 Q2628.8438,278.3281 2628.2344,278.1094 Q2627.625,277.8906 2627,277.8906 Q2626.2344,277.8906 2625.6016,278.2188 Q2624.9688,278.5469 2624.4766,279.2969 Q2623.9844,280.0469 2623.9844,281.0781 L2623.9844,282.1719 Q2623.9844,283.4063 2624.875,284.2266 Q2625.7656,285.0469 2627.3594,285.0469 Q2628.2969,285.0469 2628.9531,284.7969 Q2629.3438,284.6406 2629.7656,284.2031 Q2630.0313,283.9375 2630.1797,283.8594 Q2630.3281,283.7813 2630.5313,283.7813 Q2630.8594,283.7813 2631.1172,284.0391 Q2631.375,284.2969 2631.375,284.6406 Q2631.375,284.9844 2631.0313,285.3906 Q2630.5313,285.9688 2629.7344,286.2969 Q2628.6563,286.75 2627.3594,286.75 Q2625.8438,286.75 2624.6406,286.125 Q2623.6563,285.625 2622.9688,284.5547 Q2622.2813,283.4844 2622.2813,282.2031 L2622.2813,281.0469 Q2622.2813,279.7188 2622.8984,278.5703 Q2623.5156,277.4219 2624.6094,276.8047 Q2625.7031,276.1875 2626.9375,276.1875 Q2627.6719,276.1875 2628.3203,276.3516 Q2628.9688,276.5156 2629.5156,276.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="2647.25" y="286.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2318.5" x2="3016.5" y1="297" y2="297"/><line style="stroke:#181818;stroke-width:0.5;" x1="2318.5" x2="3016.5" y1="305" y2="305"/><ellipse cx="2328.5" cy="319.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="2337.5" y="323.5332">SqlProvider(connection : string)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2337.5" y="341.1426"> </text><polygon fill="#FFFF44" points="2328.5,349.5234,2332.5,353.5234,2328.5,357.5234,2324.5,353.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="2337.5" y="358.752">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="2328.5,367.1328,2332.5,371.1328,2328.5,375.1328,2324.5,371.1328" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="2337.5" y="376.3613">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="83" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="2461" y="68.5"/><ellipse cx="2565.75" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2568.5156,80.375 Q2568.6719,80.1563 2568.8594,80.0469 Q2569.0469,79.9375 2569.2656,79.9375 Q2569.6406,79.9375 2569.875,80.1953 Q2570.1094,80.4531 2570.1094,81.0625 L2570.1094,82.5156 Q2570.1094,83.125 2569.875,83.3906 Q2569.6406,83.6563 2569.2656,83.6563 Q2568.9219,83.6563 2568.7188,83.4531 Q2568.5156,83.2656 2568.4063,82.75 Q2568.3594,82.3906 2568.1719,82.2031 Q2567.8438,81.8281 2567.2344,81.6094 Q2566.625,81.3906 2566,81.3906 Q2565.2344,81.3906 2564.6016,81.7188 Q2563.9688,82.0469 2563.4766,82.7969 Q2562.9844,83.5469 2562.9844,84.5781 L2562.9844,85.6719 Q2562.9844,86.9063 2563.875,87.7266 Q2564.7656,88.5469 2566.3594,88.5469 Q2567.2969,88.5469 2567.9531,88.2969 Q2568.3438,88.1406 2568.7656,87.7031 Q2569.0313,87.4375 2569.1797,87.3594 Q2569.3281,87.2813 2569.5313,87.2813 Q2569.8594,87.2813 2570.1172,87.5391 Q2570.375,87.7969 2570.375,88.1406 Q2570.375,88.4844 2570.0313,88.8906 Q2569.5313,89.4688 2568.7344,89.7969 Q2567.6563,90.25 2566.3594,90.25 Q2564.8438,90.25 2563.6406,89.625 Q2562.6563,89.125 2561.9688,88.0547 Q2561.2813,86.9844 2561.2813,85.7031 L2561.2813,84.5469 Q2561.2813,83.2188 2561.8984,82.0703 Q2562.5156,80.9219 2563.6094,80.3047 Q2564.7031,79.6875 2565.9375,79.6875 Q2566.6719,79.6875 2567.3203,79.8516 Q2567.9688,80.0156 2568.5156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="2586.25" y="90.2285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2462" x2="2839" y1="100.5" y2="100.5"/><ellipse cx="2472" cy="114.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="2481" y="119.0332">LeakedPasswordProvider(configuration : IConfiguration)</text><line style="stroke:#181818;stroke-width:1.0;" x1="2462" x2="2839" y1="126.1094" y2="126.1094"/></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="88" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="2090.5" y="60"/><ellipse cx="2195.25" cy="76" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2198.0156,71.875 Q2198.1719,71.6563 2198.3594,71.5469 Q2198.5469,71.4375 2198.7656,71.4375 Q2199.1406,71.4375 2199.375,71.6953 Q2199.6094,71.9531 2199.6094,72.5625 L2199.6094,74.0156 Q2199.6094,74.625 2199.375,74.8906 Q2199.1406,75.1563 2198.7656,75.1563 Q2198.4219,75.1563 2198.2188,74.9531 Q2198.0156,74.7656 2197.9063,74.25 Q2197.8594,73.8906 2197.6719,73.7031 Q2197.3438,73.3281 2196.7344,73.1094 Q2196.125,72.8906 2195.5,72.8906 Q2194.7344,72.8906 2194.1016,73.2188 Q2193.4688,73.5469 2192.9766,74.2969 Q2192.4844,75.0469 2192.4844,76.0781 L2192.4844,77.1719 Q2192.4844,78.4063 2193.375,79.2266 Q2194.2656,80.0469 2195.8594,80.0469 Q2196.7969,80.0469 2197.4531,79.7969 Q2197.8438,79.6406 2198.2656,79.2031 Q2198.5313,78.9375 2198.6797,78.8594 Q2198.8281,78.7813 2199.0313,78.7813 Q2199.3594,78.7813 2199.6172,79.0391 Q2199.875,79.2969 2199.875,79.6406 Q2199.875,79.9844 2199.5313,80.3906 Q2199.0313,80.9688 2198.2344,81.2969 Q2197.1563,81.75 2195.8594,81.75 Q2194.3438,81.75 2193.1406,81.125 Q2192.1563,80.625 2191.4688,79.5547 Q2190.7813,78.4844 2190.7813,77.2031 L2190.7813,76.0469 Q2190.7813,74.7188 2191.3984,73.5703 Q2192.0156,72.4219 2193.1094,71.8047 Q2194.2031,71.1875 2195.4375,71.1875 Q2196.1719,71.1875 2196.8203,71.3516 Q2197.4688,71.5156 2198.0156,71.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="2215.75" y="81.7285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2091.5" x2="2389.5" y1="92" y2="92"/><ellipse cx="2101.5" cy="106.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="2110.5" y="110.5332">UserProvider(configuration : IConfiguration)</text><line style="stroke:#181818;stroke-width:1.0;" x1="2091.5" x2="2389.5" y1="117.6094" y2="117.6094"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2098.5" y="128.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="2110.5" y="136.1426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="138" fill="#F1F1F1" height="83.2188" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="182" x="1503.5" y="461"/><ellipse cx="1566.75" cy="477" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1569.5156,472.875 Q1569.6719,472.6563 1569.8594,472.5469 Q1570.0469,472.4375 1570.2656,472.4375 Q1570.6406,472.4375 1570.875,472.6953 Q1571.1094,472.9531 1571.1094,473.5625 L1571.1094,475.0156 Q1571.1094,475.625 1570.875,475.8906 Q1570.6406,476.1563 1570.2656,476.1563 Q1569.9219,476.1563 1569.7188,475.9531 Q1569.5156,475.7656 1569.4063,475.25 Q1569.3594,474.8906 1569.1719,474.7031 Q1568.8438,474.3281 1568.2344,474.1094 Q1567.625,473.8906 1567,473.8906 Q1566.2344,473.8906 1565.6016,474.2188 Q1564.9688,474.5469 1564.4766,475.2969 Q1563.9844,476.0469 1563.9844,477.0781 L1563.9844,478.1719 Q1563.9844,479.4063 1564.875,480.2266 Q1565.7656,481.0469 1567.3594,481.0469 Q1568.2969,481.0469 1568.9531,480.7969 Q1569.3438,480.6406 1569.7656,480.2031 Q1570.0313,479.9375 1570.1797,479.8594 Q1570.3281,479.7813 1570.5313,479.7813 Q1570.8594,479.7813 1571.1172,480.0391 Q1571.375,480.2969 1571.375,480.6406 Q1571.375,480.9844 1571.0313,481.3906 Q1570.5313,481.9688 1569.7344,482.2969 Q1568.6563,482.75 1567.3594,482.75 Q1565.8438,482.75 1564.6406,482.125 Q1563.6563,481.625 1562.9688,480.5547 Q1562.2813,479.4844 1562.2813,478.2031 L1562.2813,477.0469 Q1562.2813,475.7188 1562.8984,474.5703 Q1563.5156,473.4219 1564.6094,472.8047 Q1565.7031,472.1875 1566.9375,472.1875 Q1567.6719,472.1875 1568.3203,472.3516 Q1568.9688,472.5156 1569.5156,472.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1587.25" y="482.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="1504.5" x2="1684.5" y1="493" y2="493"/><ellipse cx="1514.5" cy="507.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="1523.5" y="511.5332">HashedPassword : string</text><ellipse cx="1514.5" cy="524.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1523.5" y="529.1426">Salt : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1504.5" x2="1684.5" y1="536.2188" y2="536.2188"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="108" fill="#F1F1F1" height="100.8281" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="480" x="2875.5" y="51"/><ellipse cx="3085.75" cy="67" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3088.5156,62.875 Q3088.6719,62.6563 3088.8594,62.5469 Q3089.0469,62.4375 3089.2656,62.4375 Q3089.6406,62.4375 3089.875,62.6953 Q3090.1094,62.9531 3090.1094,63.5625 L3090.1094,65.0156 Q3090.1094,65.625 3089.875,65.8906 Q3089.6406,66.1563 3089.2656,66.1563 Q3088.9219,66.1563 3088.7188,65.9531 Q3088.5156,65.7656 3088.4063,65.25 Q3088.3594,64.8906 3088.1719,64.7031 Q3087.8438,64.3281 3087.2344,64.1094 Q3086.625,63.8906 3086,63.8906 Q3085.2344,63.8906 3084.6016,64.2188 Q3083.9688,64.5469 3083.4766,65.2969 Q3082.9844,66.0469 3082.9844,67.0781 L3082.9844,68.1719 Q3082.9844,69.4063 3083.875,70.2266 Q3084.7656,71.0469 3086.3594,71.0469 Q3087.2969,71.0469 3087.9531,70.7969 Q3088.3438,70.6406 3088.7656,70.2031 Q3089.0313,69.9375 3089.1797,69.8594 Q3089.3281,69.7813 3089.5313,69.7813 Q3089.8594,69.7813 3090.1172,70.0391 Q3090.375,70.2969 3090.375,70.6406 Q3090.375,70.9844 3090.0313,71.3906 Q3089.5313,71.9688 3088.7344,72.2969 Q3087.6563,72.75 3086.3594,72.75 Q3084.8438,72.75 3083.6406,72.125 Q3082.6563,71.625 3081.9688,70.5547 Q3081.2813,69.4844 3081.2813,68.2031 L3081.2813,67.0469 Q3081.2813,65.7188 3081.8984,64.5703 Q3082.5156,63.4219 3083.6094,62.8047 Q3084.7031,62.1875 3085.9375,62.1875 Q3086.6719,62.1875 3087.3203,62.3516 Q3087.9688,62.5156 3088.5156,62.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="3106.25" y="72.7285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="2876.5" x2="3354.5" y1="83" y2="83"/><line style="stroke:#181818;stroke-width:0.5;" x1="2876.5" x2="3354.5" y1="91" y2="91"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2883.5" y="102.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="312" x="2895.5" y="109.5332">GetEncryptedPassword(password : string) : string</text><ellipse cx="2886.5" cy="122.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="2895.5" y="127.1426">GetSalt(saltLength : int) : string</text><ellipse cx="2886.5" cy="140.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="454" x="2895.5" y="144.752">GetEncryptedAndSaltedPassword(password : string, salt : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="130" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1464.5" y="613"/><ellipse cx="1529.75" cy="629" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1532.5156,624.875 Q1532.6719,624.6563 1532.8594,624.5469 Q1533.0469,624.4375 1533.2656,624.4375 Q1533.6406,624.4375 1533.875,624.6953 Q1534.1094,624.9531 1534.1094,625.5625 L1534.1094,627.0156 Q1534.1094,627.625 1533.875,627.8906 Q1533.6406,628.1563 1533.2656,628.1563 Q1532.9219,628.1563 1532.7188,627.9531 Q1532.5156,627.7656 1532.4063,627.25 Q1532.3594,626.8906 1532.1719,626.7031 Q1531.8438,626.3281 1531.2344,626.1094 Q1530.625,625.8906 1530,625.8906 Q1529.2344,625.8906 1528.6016,626.2188 Q1527.9688,626.5469 1527.4766,627.2969 Q1526.9844,628.0469 1526.9844,629.0781 L1526.9844,630.1719 Q1526.9844,631.4063 1527.875,632.2266 Q1528.7656,633.0469 1530.3594,633.0469 Q1531.2969,633.0469 1531.9531,632.7969 Q1532.3438,632.6406 1532.7656,632.2031 Q1533.0313,631.9375 1533.1797,631.8594 Q1533.3281,631.7813 1533.5313,631.7813 Q1533.8594,631.7813 1534.1172,632.0391 Q1534.375,632.2969 1534.375,632.6406 Q1534.375,632.9844 1534.0313,633.3906 Q1533.5313,633.9688 1532.7344,634.2969 Q1531.6563,634.75 1530.3594,634.75 Q1528.8438,634.75 1527.6406,634.125 Q1526.6563,633.625 1525.9688,632.5547 Q1525.2813,631.4844 1525.2813,630.2031 L1525.2813,629.0469 Q1525.2813,627.7188 1525.8984,626.5703 Q1526.5156,625.4219 1527.6094,624.8047 Q1528.7031,624.1875 1529.9375,624.1875 Q1530.6719,624.1875 1531.3203,624.3516 Q1531.9688,624.5156 1532.5156,624.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1550.25" y="634.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="1465.5" x2="1631.5" y1="645" y2="645"/><ellipse cx="1475.5" cy="659.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1484.5" y="663.5332">ID : int</text><ellipse cx="1475.5" cy="676.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1484.5" y="681.1426">IsVerified : bool</text><ellipse cx="1475.5" cy="694.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1484.5" y="698.752">IsLocked : bool</text><ellipse cx="1475.5" cy="712.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1484.5" y="716.3613">FailedTries : int</text><ellipse cx="1475.5" cy="729.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="1484.5" y="733.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1465.5" x2="1631.5" y1="741.0469" y2="741.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="147" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="1329" y="809"/><ellipse cx="1375.75" cy="825" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1378.5156,820.875 Q1378.6719,820.6563 1378.8594,820.5469 Q1379.0469,820.4375 1379.2656,820.4375 Q1379.6406,820.4375 1379.875,820.6953 Q1380.1094,820.9531 1380.1094,821.5625 L1380.1094,823.0156 Q1380.1094,823.625 1379.875,823.8906 Q1379.6406,824.1563 1379.2656,824.1563 Q1378.9219,824.1563 1378.7188,823.9531 Q1378.5156,823.7656 1378.4063,823.25 Q1378.3594,822.8906 1378.1719,822.7031 Q1377.8438,822.3281 1377.2344,822.1094 Q1376.625,821.8906 1376,821.8906 Q1375.2344,821.8906 1374.6016,822.2188 Q1373.9688,822.5469 1373.4766,823.2969 Q1372.9844,824.0469 1372.9844,825.0781 L1372.9844,826.1719 Q1372.9844,827.4063 1373.875,828.2266 Q1374.7656,829.0469 1376.3594,829.0469 Q1377.2969,829.0469 1377.9531,828.7969 Q1378.3438,828.6406 1378.7656,828.2031 Q1379.0313,827.9375 1379.1797,827.8594 Q1379.3281,827.7813 1379.5313,827.7813 Q1379.8594,827.7813 1380.1172,828.0391 Q1380.375,828.2969 1380.375,828.6406 Q1380.375,828.9844 1380.0313,829.3906 Q1379.5313,829.9688 1378.7344,830.2969 Q1377.6563,830.75 1376.3594,830.75 Q1374.8438,830.75 1373.6406,830.125 Q1372.6563,829.625 1371.9688,828.5547 Q1371.2813,827.4844 1371.2813,826.2031 L1371.2813,825.0469 Q1371.2813,823.7188 1371.8984,822.5703 Q1372.5156,821.4219 1373.6094,820.8047 Q1374.7031,820.1875 1375.9375,820.1875 Q1376.6719,820.1875 1377.3203,820.3516 Q1377.9688,820.5156 1378.5156,820.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1396.25" y="830.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="1330" x2="1491" y1="841" y2="841"/><ellipse cx="1340" cy="855.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1349" y="859.5332">Email : string</text><ellipse cx="1340" cy="872.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1349" y="877.1426">FirstName : string</text><ellipse cx="1340" cy="890.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1349" y="894.752">LastName : string</text><ellipse cx="1340" cy="908.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1349" y="912.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1330" x2="1491" y1="919.4375" y2="919.4375"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="160" fill="#F1F1F1" height="118.4375" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="3391" y="42.5"/><ellipse cx="3416.8" cy="58.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3419.5656,54.375 Q3419.7219,54.1563 3419.9094,54.0469 Q3420.0969,53.9375 3420.3156,53.9375 Q3420.6906,53.9375 3420.925,54.1953 Q3421.1594,54.4531 3421.1594,55.0625 L3421.1594,56.5156 Q3421.1594,57.125 3420.925,57.3906 Q3420.6906,57.6563 3420.3156,57.6563 Q3419.9719,57.6563 3419.7688,57.4531 Q3419.5656,57.2656 3419.4563,56.75 Q3419.4094,56.3906 3419.2219,56.2031 Q3418.8938,55.8281 3418.2844,55.6094 Q3417.675,55.3906 3417.05,55.3906 Q3416.2844,55.3906 3415.6516,55.7188 Q3415.0188,56.0469 3414.5266,56.7969 Q3414.0344,57.5469 3414.0344,58.5781 L3414.0344,59.6719 Q3414.0344,60.9063 3414.925,61.7266 Q3415.8156,62.5469 3417.4094,62.5469 Q3418.3469,62.5469 3419.0031,62.2969 Q3419.3938,62.1406 3419.8156,61.7031 Q3420.0813,61.4375 3420.2297,61.3594 Q3420.3781,61.2813 3420.5813,61.2813 Q3420.9094,61.2813 3421.1672,61.5391 Q3421.425,61.7969 3421.425,62.1406 Q3421.425,62.4844 3421.0813,62.8906 Q3420.5813,63.4688 3419.7844,63.7969 Q3418.7063,64.25 3417.4094,64.25 Q3415.8938,64.25 3414.6906,63.625 Q3413.7063,63.125 3413.0188,62.0547 Q3412.3313,60.9844 3412.3313,59.7031 L3412.3313,58.5469 Q3412.3313,57.2188 3412.9484,56.0703 Q3413.5656,54.9219 3414.6594,54.3047 Q3415.7531,53.6875 3416.9875,53.6875 Q3417.7219,53.6875 3418.3703,53.8516 Q3419.0188,54.0156 3419.5656,54.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="3433.2" y="64.2285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="3392" x2="3529" y1="74.5" y2="74.5"/><ellipse cx="3402" cy="88.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="3411" y="93.0332">ID : int</text><ellipse cx="3402" cy="106.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="3411" y="110.6426">UserID : int</text><ellipse cx="3402" cy="124.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="3411" y="128.252">IP : byte[]</text><ellipse cx="3402" cy="141.6328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="3411" y="145.8613">UserAgent : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="3392" x2="3529" y1="152.9375" y2="152.9375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="20" d="M1074.4,204.13 C1105.33,228.14 1136.97,252.71 1163.39,273.23 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1063.94,196.01,1066.2276,202.8486,1073.42,203.3672,1071.1324,196.5286,1063.94,196.01" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="21" d="M766.77,202.42 C723.23,227.04 678.47,252.34 641.26,273.38 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="778.1,196.01,770.9082,195.4825,767.6552,201.9182,774.847,202.4457,778.1,196.01" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="51" d="M1231.43,374.71 C1235.99,421.44 1245.2,492.97 1262.5,553 C1271.58,584.52 1286.61,618.53 1298.67,643.42 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1300.89,647.96,1300.5559,638.1168,1298.7055,643.4625,1293.3598,641.612,1300.89,647.96" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="52" d="M1261.25,374.63 C1278.74,400.37 1299.95,431.56 1316.96,456.58 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1319.87,460.85,1318.1289,451.1563,1317.0635,456.7119,1311.5079,455.6466,1319.87,460.85" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="53" d="M1567.71,152.12 C1501.56,185.35 1414.18,229.23 1344.54,264.21 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1347.34,270.64,1326.33,273.36,1341.06,258.13,1347.34,270.64" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="55" d="M1661.37,165.28 C1659.06,193.59 1656.33,227.06 1653.98,255.86 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1662.44,152.26,1657.9653,157.9149,1661.4642,164.2203,1665.9388,158.5654,1662.44,152.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="56" d="M1771.07,158.46 C1849.42,200.4 1953.85,256.29 2018.61,290.94 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1759.22,152.12,1762.6211,158.4787,1769.7987,157.7848,1766.3976,151.4262,1759.22,152.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="58" d="M325.18,143.2 C367.13,176.24 426.97,223.36 474.86,261.07 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="479.22,255.59,490.6,273.47,470.56,266.59,479.22,255.59" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="59" d="M553.5,387.77 C553.5,408.84 553.5,432.02 553.5,451.93 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="553.5,374.63,549.5,380.63,553.5,386.63,557.5,380.63,553.5,374.63" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="98" d="M1624.07,404.83 C1618.15,424.19 1612.06,444.1 1606.96,460.78 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1627.93,392.23,1622.3505,396.7983,1624.4214,403.7056,1630.0009,399.1373,1627.93,392.23" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="100" d="M2567.63,134.55 C2520.9,152.61 2461.45,175.58 2408.5,196 C2332.29,225.39 2246.16,258.53 2181,283.59 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2183.1,290.28,2161.92,290.93,2178.08,277.22,2183.1,290.28" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="101" d="M2652.97,134.56 C2655.19,163.35 2658.54,206.79 2661.46,244.72 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2668.45,244.32,2663.01,264.8,2654.5,245.39,2668.45,244.32" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="103" d="M2139.87,143.03 C2097.84,159.74 2048.42,179.11 2003.5,196 C1956.71,213.59 1906.25,231.99 1858.47,249.15 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1860.79,255.75,1839.6,255.91,1856.06,242.57,1860.79,255.75" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="104" d="M2319.32,143.2 C2380.17,174.62 2465.69,218.79 2536.74,255.48 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2540.39,249.48,2554.95,264.88,2533.96,261.92,2540.39,249.48" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="117" d="M1498.48,749.05 C1488.01,763.1 1476.89,777.99 1466.22,792.3 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1471.53,796.89,1453.96,808.74,1460.31,788.52,1471.53,796.89" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="118" d="M1333.7,714.22 C1344.31,735.34 1358.66,763.87 1372.07,790.56 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1378.43,787.62,1381.16,808.63,1365.92,793.91,1378.43,787.62" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="120" d="M1583.83,544.44 C1580.01,559.08 1575.55,576.19 1571.11,593.23 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1577.86,595.09,1566.05,612.67,1564.32,591.56,1577.86,595.09" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[85c48d3f3ea776c526ece08a27e2c34d]
@startuml API class diagram


top to bottom direction

'Controllers'

class UserController{
    -_logger{readonly} : ILogger<UserController>
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    +UserController(logger : ILogger<UserController>, userManager : IUserManager, tokenManager : ITokenManager)
    
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
}

'Controllers mappings' 

UserController o- - IUserManager
UserController o- - ITokenManager

'Managers'

interface IUserManager{
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
}

interface ITokenManager{
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}

class TokenManager{
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager{
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider)
}

'Managers mappings'

IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - ILeakedPasswordProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


'Providers'

interface IUserProvider{
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    +SqlProvider(connection : string)

    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    +LeakedPasswordProvider(configuration : IConfiguration)
    - -
}

class UserProvider {
    +UserProvider(configuration : IConfiguration)
    - -
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider *- - DbUser

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

'Utility'

class Security{
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
}


'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : byte[]
    +UserAgent : string
}


@enduml

@startuml API class diagram


top to bottom direction


class UserController{
    -_logger{readonly} : ILogger<UserController>
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    +UserController(logger : ILogger<UserController>, userManager : IUserManager, tokenManager : ITokenManager)
    
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
}


UserController o- - IUserManager
UserController o- - ITokenManager


interface IUserManager{
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
}

interface ITokenManager{
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}

class TokenManager{
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager{
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider)
}


IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - ILeakedPasswordProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken



interface IUserProvider{
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    +SqlProvider(connection : string)

    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    +LeakedPasswordProvider(configuration : IConfiguration)
    - -
}

class UserProvider {
    +UserProvider(configuration : IConfiguration)
    - -
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider *- - DbUser

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider


class Security{
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
}



User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : byte[]
    +UserAgent : string
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>