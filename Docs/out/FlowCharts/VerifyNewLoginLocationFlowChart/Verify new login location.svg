<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="569px" preserveAspectRatio="none" style="width:603px;height:569px;background:#FFFFFF;" version="1.1" viewBox="0 0 603 569" width="603px" zoomAndPan="magnify"><defs/><g><ellipse cx="117" cy="16" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="220" x="7" y="67"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="200" x="17" y="89.457">Receive email &amp; One time password</text><g id="elem_#5"><polygon fill="#90EE90" points="117,143,129,155,117,167,105,155,117,143" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="13" y="222"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="152" x="23" y="244.457">Return ip blocked message</text><g id="elem_#10"><polygon fill="#90EE90" points="217,227.5,229,239.5,217,251.5,205,239.5,217,227.5" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="91.5" y="467"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="207" x="101.5" y="489.457">Return incorrect credentials message</text><g id="elem_#15"><polygon fill="#90EE90" points="301,298,313,310,301,322,289,310,301,298" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="180" x="211" y="377"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="160" x="221" y="399.457">Return user locked message</text><g id="elem_#20"><polygon fill="#90EE90" points="423,382.5,435,394.5,423,406.5,411,394.5,423,382.5" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="364" y="467"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="98" x="374" y="489.457">Return user token</text><ellipse cx="423" cy="553" fill="none" rx="10" ry="10" style="stroke:#FF0000;stroke-width:1.0;"/><ellipse cx="423.5" cy="553.5" fill="#FF0000" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><!--MD5=[1c9e3c8fd87602a550371f2500e880ec]
link start to Receive email & One time password--><g id="link_start_Receive email &amp; One time password"><path d="M117,26.25 C117,35.43 117,49.84 117,61.9 " fill="none" id="start-to-Receive email &amp; One time password" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="117,66.91,121,57.91,117,61.91,113,57.91,117,66.91" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e173a0b0292ace8b6bd9ae307ead419c]
link Receive email & One time password to #5--><g id="link_Receive email &amp; One time password_#5"><path d="M117,102.08 C117,112.87 117,126.88 117,137.63 " fill="none" id="Receive email &amp; One time password-to-#5" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="117,142.92,121,133.92,117,137.92,113,133.92,117,142.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="59" x="43.6188" y="132.485">Ip is blocked</text></g><!--MD5=[556588b319764b122b83060284bcf201]
link #5 to Return ip blocked message--><g id="link_#5_Return ip blocked message"><path d="M115,165.14 C112.3,177.54 107.39,200.05 103.72,216.88 " fill="none" id="#5-to-Return ip blocked message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="102.62,221.91,108.4329,213.9595,103.6774,217.0231,100.6138,212.2676,102.62,221.91" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="112" y="199.4189">true</text></g><!--MD5=[46dcf2c2a445c5816f2e190415bdd366]
link #5 to #10--><g id="link_#5_#10"><path d="M123.26,161.16 C140.02,174.99 186.09,213 206.74,230.04 " fill="none" id="#5-to-#10" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="210.75,233.34,206.3386,224.5343,206.8879,230.1645,201.2577,230.7138,210.75,233.34" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="93" x="237.4156" y="223.6486">user does not exist</text></g><!--MD5=[8b50378e7ea514942e335c9d1a85cf75]
link #10 to Return incorrect credentials message--><g id="link_#10_Return incorrect credentials message"><path d="M215.49,250.06 C212.07,272.28 203.8,329.12 201,377 C200.09,392.53 200.57,396.45 201,412 C201.47,428.71 202.55,447.6 203.47,461.76 " fill="none" id="#10-to-Return incorrect credentials message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="203.8,466.75,207.1995,457.5064,203.4712,461.7608,199.2168,458.0325,203.8,466.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="205" y="354.4189">true</text></g><!--MD5=[964bdbcd74089faaa499bf5ab2d768b0]
link #10 to #15--><g id="link_#10_#15"><path d="M223.31,245.65 C237.66,257.35 272.86,286.05 290.52,300.46 " fill="none" id="#10-to-#15" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="294.61,303.79,290.1632,295.0022,290.7351,300.63,285.1073,301.202,294.61,303.79" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="67" x="213.8978" y="297.9836">Is user locked</text></g><!--MD5=[1ef02b6714ba5b3c383f1bba62f45f7d]
link #15 to Return user locked message--><g id="link_#15_Return user locked message"><path d="M301,322.13 C301,334.77 301,355.72 301,371.66 " fill="none" id="#15-to-Return user locked message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="301,376.85,305,367.85,301,371.85,297,367.85,301,376.85" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="302" y="354.4189">true</text></g><!--MD5=[354f6a9647aa1417fae839d21f2cfb02]
link #15 to #20--><g id="link_#15_#20"><path d="M307.89,315.34 C324.24,325.7 366.64,352.81 401,377 C404.82,379.69 408.93,382.73 412.55,385.46 " fill="none" id="#15-to-#20" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="416.53,388.49,411.799,379.8518,412.5542,385.4581,406.9479,386.2132,416.53,388.49" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="443.2289" y="382.2989">Does one time password match</text></g><!--MD5=[c4fdf273b225c2872b9c1e5d5f765f09]
link #20 to Return incorrect credentials message--><g id="link_#20_Return incorrect credentials message"><path d="M416.79,400.94 C412.56,404.44 406.71,408.91 401,412 C359.09,434.71 308.48,452.97 269.19,465.35 " fill="none" id="#20-to-Return incorrect credentials message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="263.96,466.98,273.7453,468.0968,268.7299,465.4805,271.3461,460.465,263.96,466.98" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="355" y="444.4189">false</text></g><!--MD5=[a3835e4f51939fa6ff93917e6dfd5e65]
link #20 to Return user token--><g id="link_#20_Return user token"><path d="M423,406.65 C423,420.39 423,444.08 423,461.54 " fill="none" id="#20-to-Return user token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="423,466.73,427,457.73,423,461.73,419,457.73,423,466.73" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0765d750cce81b097d333c7bd9ab039a]
link Return user token to end--><g id="link_Return user token_end"><path d="M423,502.28 C423,513.29 423,527.52 423,537.94 " fill="none" id="Return user token-to-end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="423,543,427,534,423,538,419,534,423,543" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7b96d2461f1b80f7b273497a645ccdcd]
@startuml Verify new login location

skinparam activity {
    BackgroundColor lightblue
    
    StartColor green
    EndColor red
    
    diamondBackgroundColor lightgreen
}


(*) - -> "Receive email & One time password"

if "Ip is blocked" then
	- ->[true] "Return ip blocked message"
else
	if "user does not exist" then
		- ->[true] "Return incorrect credentials message"
	else
		if "Is user locked" then
			- ->[true] "Return user locked message"
		else
			if "Does one time password match" then
				- ->[false] "Return incorrect credentials message"
			else
				- ->"Return user token"
			end if
		end if
	end if
end if

- ->(*)

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>