<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="687px" preserveAspectRatio="none" style="width:909px;height:687px;background:#FFFFFF;" version="1.1" viewBox="0 0 909 687" width="909px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="409" x="10" y="221.0156"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="409" x="10" y="387.7734"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="37" x2="37" y1="82.6094" y2="605.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="198" x2="198" y1="82.6094" y2="605.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="359" x2="359" y1="82.6094" y2="605.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="660.5" x2="660.5" y1="82.6094" y2="605.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="773.5" x2="773.5" y1="82.6094" y2="605.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="870.5" x2="870.5" y1="82.6094" y2="605.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="20" y="79.5332">User</text><ellipse cx="37.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M37.5,21.5 L37.5,48.5 M24.5,29.5 L50.5,29.5 M37.5,48.5 L24.5,63.5 M37.5,48.5 L50.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="20" y="618.7676">User</text><ellipse cx="37.5" cy="630.3438" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M37.5,638.3438 L37.5,665.3438 M24.5,646.3438 L50.5,646.3438 M37.5,665.3438 L24.5,680.3438 M37.5,665.3438 L50.5,680.3438 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="146" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="153" y="71.5332">UserController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="146" y="604.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="153" y="625.7676">UserController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="310" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="317" y="71.5332">UserManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="310" y="604.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="317" y="625.7676">UserManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="612.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="619.5" y="71.5332">UserProvider</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="612.5" y="604.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="619.5" y="625.7676">UserProvider</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="718.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="725.5" y="71.5332">TokenManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="718.5" y="604.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="725.5" y="625.7676">TokenManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="838.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="845.5" y="71.5332">Security</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="838.5" y="604.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="845.5" y="625.7676">Security</text><polygon fill="#181818" points="186.5,110.9609,196.5,114.9609,186.5,118.9609,190.5,114.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="37.5" x2="192.5" y1="114.9609" y2="114.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="44.5" y="110.1045">Login (email, password)</text><polygon fill="#181818" points="347.5,141.3125,357.5,145.3125,347.5,149.3125,351.5,145.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="198.5" x2="353.5" y1="145.3125" y2="145.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="205.5" y="140.4561">Login (email, password)</text><polygon fill="#181818" points="648.5,171.6641,658.5,175.6641,648.5,179.6641,652.5,175.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="359.5" x2="654.5" y1="175.6641" y2="175.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="366.5" y="170.8076">Get user by email(email)</text><polygon fill="#181818" points="370.5,202.0156,360.5,206.0156,370.5,210.0156,366.5,206.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="364.5" x2="659.5" y1="206.0156" y2="206.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="376.5" y="201.1592">Return User</text><path d="M10,221.0156 L71,221.0156 L71,229.3672 L61,239.3672 L10,239.3672 L10,221.0156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="409" x="10" y="221.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="235.5107">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="90" x="86" y="234.4346">[User not found]</text><polygon fill="#181818" points="209.5,257.7188,199.5,261.7188,209.5,265.7188,205.5,261.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="203.5" x2="358.5" y1="261.7188" y2="261.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="215.5" y="256.8623">Login failed</text><polygon fill="#181818" points="48.5,288.0703,38.5,292.0703,48.5,296.0703,44.5,292.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.5" x2="197.5" y1="292.0703" y2="292.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="54.5" y="287.2139">Login failed</text><polygon fill="#181818" points="859,325.4219,869,329.4219,859,333.4219,863,329.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="359.5" x2="865" y1="329.4219" y2="329.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="366.5" y="324.5654">Hash password (password, salt)</text><line style="stroke:#181818;stroke-width:1.0;" x1="359.5" x2="401.5" y1="359.7734" y2="359.7734"/><line style="stroke:#181818;stroke-width:1.0;" x1="401.5" x2="401.5" y1="359.7734" y2="372.7734"/><line style="stroke:#181818;stroke-width:1.0;" x1="360.5" x2="401.5" y1="372.7734" y2="372.7734"/><polygon fill="#181818" points="370.5,368.7734,360.5,372.7734,370.5,376.7734,366.5,372.7734" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="366.5" y="354.917">Check if salted password matches user password</text><path d="M10,387.7734 L71,387.7734 L71,396.125 L61,406.125 L10,406.125 L10,387.7734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="409" x="10" y="387.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="402.2686">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="153" x="86" y="401.1924">[Password does not match]</text><polygon fill="#181818" points="209.5,424.4766,199.5,428.4766,209.5,432.4766,205.5,428.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="203.5" x2="358.5" y1="428.4766" y2="428.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="215.5" y="423.6201">Login failed</text><polygon fill="#181818" points="48.5,454.8281,38.5,458.8281,48.5,462.8281,44.5,458.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.5" x2="197.5" y1="458.8281" y2="458.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="54.5" y="453.9717">Login failed</text><polygon fill="#181818" points="209.5,492.1797,199.5,496.1797,209.5,500.1797,205.5,496.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="203.5" x2="358.5" y1="496.1797" y2="496.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="215.5" y="491.3232">Returns User</text><polygon fill="#181818" points="761.5,522.5313,771.5,526.5313,761.5,530.5313,765.5,526.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="198.5" x2="767.5" y1="526.5313" y2="526.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="205.5" y="521.6748">Get token for user (User)</text><polygon fill="#181818" points="209.5,552.8828,199.5,556.8828,209.5,560.8828,205.5,556.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="203.5" x2="772.5" y1="556.8828" y2="556.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="215.5" y="552.0264">Returns Token</text><polygon fill="#181818" points="48.5,583.2344,38.5,587.2344,48.5,591.2344,44.5,587.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.5" x2="197.5" y1="587.2344" y2="587.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="54.5" y="582.3779">Return token</text><!--MD5=[7c7e05e5ae02a557dfe06f94b84fcf89]
@startuml Login SD

actor User
participant UserController
participant UserManager
participant UserProvider
participant TokenManager
participant Security

User->UserController: Login (email, password)
UserController->UserManager: Login (email, password)
UserManager->UserProvider: Get user by email(email)
UserProvider->UserManager: Return User

alt User not found

UserManager->UserController: Login failed
UserController->User: Login failed

end

UserManager->Security: Hash password (password, salt)
UserManager->UserManager: Check if salted password matches user password

alt Password does not match

UserManager->UserController: Login failed
UserController->User: Login failed

end

UserManager->UserController: Returns User
UserController->TokenManager: Get token for user (User)
TokenManager->UserController: Returns Token

UserController->User: Return token

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>