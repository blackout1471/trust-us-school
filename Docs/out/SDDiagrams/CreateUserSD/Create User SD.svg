<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1189px" preserveAspectRatio="none" style="width:1514px;height:1189px;background:#FFFFFF;" version="1.1" viewBox="0 0 1514 1189" width="1514px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="48.7031" style="stroke:#FF0000;stroke-width:1.0;" width="355" x="10" y="216.6641"/><rect fill="none" height="79.0547" style="stroke:#FF0000;stroke-width:1.0;" width="516" x="10" y="370.4219"/><rect fill="none" height="79.0547" style="stroke:#FF0000;stroke-width:1.0;" width="516" x="10" y="524.1797"/><rect fill="none" height="79.0547" style="stroke:#FF0000;stroke-width:1.0;" width="516" x="10" y="677.9375"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="37" x2="37" y1="82.6094" y2="1107.8594"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="234" x2="234" y1="82.6094" y2="1107.8594"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="466" x2="466" y1="82.6094" y2="1107.8594"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="655.5" x2="655.5" y1="82.6094" y2="1107.8594"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="800.5" x2="800.5" y1="82.6094" y2="1107.8594"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="953.5" x2="953.5" y1="82.6094" y2="1107.8594"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1094.5" x2="1094.5" y1="82.6094" y2="1107.8594"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1213.5" x2="1213.5" y1="82.6094" y2="1107.8594"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1318.5" x2="1318.5" y1="82.6094" y2="1107.8594"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1449.5" x2="1449.5" y1="82.6094" y2="1107.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="20" y="79.5332">User</text><ellipse cx="37.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M37.5,21.5 L37.5,48.5 M24.5,29.5 L50.5,29.5 M37.5,48.5 L24.5,63.5 M37.5,48.5 L50.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="20" y="1121.3926">User</text><ellipse cx="37.5" cy="1132.9688" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M37.5,1140.9688 L37.5,1167.9688 M24.5,1148.9688 L50.5,1148.9688 M37.5,1167.9688 L24.5,1182.9688 M37.5,1167.9688 L50.5,1182.9688 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="182" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="189" y="71.5332">UserController</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="182" y="1106.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="189" y="1128.3926">UserController</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="417" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="424" y="71.5332">UserManager</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="417" y="1106.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="424" y="1128.3926">UserManager</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="607.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="614.5" y="71.5332">UserProvider</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="607.5" y="1106.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="614.5" y="1128.3926">UserProvider</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="175" x="713.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="720.5" y="71.5332">LeakedPasswordProvider</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="175" x="713.5" y="1106.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="720.5" y="1128.3926">LeakedPasswordProvider</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="898.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="905.5" y="71.5332">TokenManager</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="898.5" y="1106.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="905.5" y="1128.3926">TokenManager</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="1018.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1025.5" y="71.5332">UserLocationManager</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="1018.5" y="1106.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1025.5" y="1128.3926">UserLocationManager</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="1181.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="1188.5" y="71.5332">Security</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="1181.5" y="1106.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="1188.5" y="1128.3926">Security</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="1256.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1263.5" y="71.5332">MessageProvider</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="1256.5" y="1106.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1263.5" y="1128.3926">MessageProvider</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1390.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="1397.5" y="71.5332">MessageService</text><rect fill="#ADD8E6" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1390.5" y="1106.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="1397.5" y="1128.3926">MessageService</text><polygon fill="#FF4500" points="222.5,110.9609,232.5,114.9609,222.5,118.9609,226.5,114.9609" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="37.5" x2="228.5" y1="114.9609" y2="114.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="44.5" y="110.1045">Create user (email, password)</text><line style="stroke:#FF4500;stroke-width:1.0;" x1="234.5" x2="276.5" y1="145.3125" y2="145.3125"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="276.5" x2="276.5" y1="145.3125" y2="158.3125"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="235.5" x2="276.5" y1="158.3125" y2="158.3125"/><polygon fill="#FF4500" points="245.5,154.3125,235.5,158.3125,245.5,162.3125,241.5,158.3125" style="stroke:#FF4500;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="241.5" y="140.4561">Validate password(password)</text><line style="stroke:#FF4500;stroke-width:1.0;" x1="234.5" x2="276.5" y1="188.6641" y2="188.6641"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="276.5" x2="276.5" y1="188.6641" y2="201.6641"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="235.5" x2="276.5" y1="201.6641" y2="201.6641"/><polygon fill="#FF4500" points="245.5,197.6641,235.5,201.6641,245.5,205.6641,241.5,201.6641" style="stroke:#FF4500;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="241.5" y="183.8076">Validate email(email)</text><path d="M10,216.6641 L71,216.6641 L71,225.0156 L61,235.0156 L10,235.0156 L10,216.6641 " fill="#EEEEEE" style="stroke:#FF0000;stroke-width:1.5;"/><rect fill="none" height="48.7031" style="stroke:#FF0000;stroke-width:1.0;" width="355" x="10" y="216.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="231.1592">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="274" x="86" y="230.083">[Password not complying or email not complying]</text><polygon fill="#FF4500" points="48.5,253.3672,38.5,257.3672,48.5,261.3672,44.5,257.3672" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="233.5" y1="257.3672" y2="257.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="54.5" y="252.5107">Return status badrequest</text><polygon fill="#FF4500" points="454.5,290.7188,464.5,294.7188,454.5,298.7188,458.5,294.7188" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="234.5" x2="460.5" y1="294.7188" y2="294.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="241.5" y="289.8623">Create user (email, password)</text><polygon fill="#FF4500" points="1083,321.0703,1093,325.0703,1083,329.0703,1087,325.0703" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="466.5" x2="1089" y1="325.0703" y2="325.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="473.5" y="320.2139">Check if ip is blocked (ipadress)</text><polygon fill="#FF4500" points="477.5,351.4219,467.5,355.4219,477.5,359.4219,473.5,355.4219" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="471.5" x2="1094" y1="355.4219" y2="355.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="483.5" y="350.5654">Returns whether ip is block</text><path d="M10,370.4219 L71,370.4219 L71,378.7734 L61,388.7734 L10,388.7734 L10,370.4219 " fill="#EEEEEE" style="stroke:#FF0000;stroke-width:1.5;"/><rect fill="none" height="79.0547" style="stroke:#FF0000;stroke-width:1.0;" width="516" x="10" y="370.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="384.917">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65" x="86" y="383.8408">[Ip blocked]</text><polygon fill="#FF4500" points="245.5,407.125,235.5,411.125,245.5,415.125,241.5,411.125" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="239.5" x2="465.5" y1="411.125" y2="411.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="251.5" y="406.2686">Throw IPBlocked exception</text><polygon fill="#FF4500" points="48.5,437.4766,38.5,441.4766,48.5,445.4766,44.5,441.4766" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="233.5" y1="441.4766" y2="441.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="54.5" y="436.6201">Return status forbidden</text><polygon fill="#FF4500" points="789,474.8281,799,478.8281,789,482.8281,793,478.8281" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="466.5" x2="795" y1="478.8281" y2="478.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="473.5" y="473.9717">Check is password leaked (password)</text><polygon fill="#FF4500" points="477.5,505.1797,467.5,509.1797,477.5,513.1797,473.5,509.1797" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="471.5" x2="800" y1="509.1797" y2="509.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="483.5" y="504.3232">return boolean</text><path d="M10,524.1797 L71,524.1797 L71,532.5313 L61,542.5313 L10,542.5313 L10,524.1797 " fill="#EEEEEE" style="stroke:#FF0000;stroke-width:1.5;"/><rect fill="none" height="79.0547" style="stroke:#FF0000;stroke-width:1.0;" width="516" x="10" y="524.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="538.6748">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="117" x="86" y="537.5986">[Password Is leaked]</text><polygon fill="#FF4500" points="245.5,560.8828,235.5,564.8828,245.5,568.8828,241.5,564.8828" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="239.5" x2="465.5" y1="564.8828" y2="564.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="251.5" y="560.0264">Throw password leaked exception</text><polygon fill="#FF4500" points="48.5,591.2344,38.5,595.2344,48.5,599.2344,44.5,595.2344" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="233.5" y1="595.2344" y2="595.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="54.5" y="590.3779">Return status forbidden</text><polygon fill="#FF4500" points="643.5,628.5859,653.5,632.5859,643.5,636.5859,647.5,632.5859" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="466.5" x2="649.5" y1="632.5859" y2="632.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="473.5" y="627.7295">Get user by email(email)</text><polygon fill="#FF4500" points="477.5,658.9375,467.5,662.9375,477.5,666.9375,473.5,662.9375" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="471.5" x2="654.5" y1="662.9375" y2="662.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="483.5" y="658.0811">Return User</text><path d="M10,677.9375 L71,677.9375 L71,686.2891 L61,696.2891 L10,696.2891 L10,677.9375 " fill="#EEEEEE" style="stroke:#FF0000;stroke-width:1.5;"/><rect fill="none" height="79.0547" style="stroke:#FF0000;stroke-width:1.0;" width="516" x="10" y="677.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="692.4326">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="69" x="86" y="691.3564">[User found]</text><polygon fill="#FF4500" points="245.5,714.6406,235.5,718.6406,245.5,722.6406,241.5,718.6406" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="239.5" x2="465.5" y1="718.6406" y2="718.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="251.5" y="713.7842">Throw user already exists exception</text><polygon fill="#FF4500" points="48.5,744.9922,38.5,748.9922,48.5,752.9922,44.5,748.9922" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="233.5" y1="748.9922" y2="748.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="54.5" y="744.1357">return status conflict</text><polygon fill="#FF4500" points="1202,782.3438,1212,786.3438,1202,790.3438,1206,786.3438" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="466.5" x2="1208" y1="786.3438" y2="786.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="473.5" y="781.4873">Get salt</text><polygon fill="#FF4500" points="477.5,812.6953,467.5,816.6953,477.5,820.6953,473.5,816.6953" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="471.5" x2="1213" y1="816.6953" y2="816.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="483.5" y="811.8389">Return salt</text><polygon fill="#FF4500" points="1202,843.0469,1212,847.0469,1202,851.0469,1206,847.0469" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="466.5" x2="1208" y1="847.0469" y2="847.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="473.5" y="842.1904">Salt password (password, salt)</text><polygon fill="#FF4500" points="477.5,873.3984,467.5,877.3984,477.5,881.3984,473.5,877.3984" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="471.5" x2="1213" y1="877.3984" y2="877.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="483.5" y="872.542">Return salted password</text><polygon fill="#FF4500" points="643.5,903.75,653.5,907.75,643.5,911.75,647.5,907.75" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="466.5" x2="649.5" y1="907.75" y2="907.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="473.5" y="902.8936">Save user in database (user)</text><polygon fill="#FF4500" points="477.5,934.1016,467.5,938.1016,477.5,942.1016,473.5,938.1016" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="471.5" x2="654.5" y1="938.1016" y2="938.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="483.5" y="933.2451">Return saved user</text><polygon fill="#FF4500" points="1306.5,964.4531,1316.5,968.4531,1306.5,972.4531,1310.5,968.4531" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="466.5" x2="1312.5" y1="968.4531" y2="968.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="473.5" y="963.5967">GetRegisterMessage(email, key)</text><polygon fill="#FF4500" points="477.5,994.8047,467.5,998.8047,477.5,1002.8047,473.5,998.8047" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="471.5" x2="1317.5" y1="998.8047" y2="998.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="483.5" y="993.9482">Return message</text><polygon fill="#FF4500" points="1437.5,1025.1563,1447.5,1029.1563,1437.5,1033.1563,1441.5,1029.1563" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;" x1="466.5" x2="1443.5" y1="1029.1563" y2="1029.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="473.5" y="1024.2998">Send message (message)</text><polygon fill="#FF4500" points="245.5,1055.5078,235.5,1059.5078,245.5,1063.5078,241.5,1059.5078" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="239.5" x2="465.5" y1="1059.5078" y2="1059.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="251.5" y="1054.6514">Return true</text><polygon fill="#FF4500" points="48.5,1085.8594,38.5,1089.8594,48.5,1093.8594,44.5,1089.8594" style="stroke:#FF4500;stroke-width:1.0;"/><line style="stroke:#FF4500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="233.5" y1="1089.8594" y2="1089.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="54.5" y="1085.0029">Return true</text><!--MD5=[8c8138d0b3e04f056360fb942921198b]
@startuml Create User SD

skinparam sequence {
    GroupBorderColor red
    GroupBorderThickness 1

    ArrowColor orangered

    LifeLineBorderColor blue

    ParticipantBackgroundColor lightblue
}

actor User
participant UserController
participant UserManager
participant UserProvider
participant LeakedPasswordProvider
participant TokenManager
participant UserLocationManager
participant Security
participant MessageProvider
participant MessageService



User->UserController: Create user (email, password)
UserController->UserController: Validate password(password)
UserController->UserController: Validate email(email)

alt Password not complying or email not complying
UserController- ->User: Return status badrequest
end

UserController->UserManager: Create user (email, password)
UserManager->UserLocationManager: Check if ip is blocked (ipadress)
UserLocationManager- ->UserManager: Returns whether ip is block

alt Ip blocked
UserManager- ->UserController: Throw IPBlocked exception
UserController- ->User: Return status forbidden
end


UserManager->LeakedPasswordProvider: Check is password leaked (password)
LeakedPasswordProvider- ->UserManager: return boolean

alt Password Is leaked
UserManager- ->UserController: Throw password leaked exception
UserController- ->User: Return status forbidden
end

UserManager->UserProvider: Get user by email(email)
UserProvider- ->UserManager: Return User

alt User found

UserManager- ->UserController: Throw user already exists exception
UserController- ->User: return status conflict

end


UserManager->Security: Get salt
Security- ->UserManager: Return salt

UserManager->Security: Salt password (password, salt)
Security- ->UserManager: Return salted password

UserManager->UserProvider: Save user in database (user)
UserProvider- ->UserManager: Return saved user

UserManager->MessageProvider: GetRegisterMessage(email, key)
MessageProvider- ->UserManager: Return message
UserManager->MessageService: Send message (message)

UserManager- ->UserController: Return true
UserController- ->User: Return true

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>