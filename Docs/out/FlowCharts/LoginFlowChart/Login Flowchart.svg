<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1031px" preserveAspectRatio="none" style="width:624px;height:1031px;background:#FFFFFF;" version="1.1" viewBox="0 0 624 1031" width="624px" zoomAndPan="magnify"><defs/><g><ellipse cx="473.6219" cy="16" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="413.1219" y="67"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="423.1219" y="89.457">Recieve login data</text><g id="elem_#5"><polygon fill="#90EE90" points="473.6219,143,485.6219,155,473.6219,167,461.6219,155,473.6219,143" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#8"><polygon fill="#90EE90" points="414.6219,213.5,426.6219,225.5,414.6219,237.5,402.6219,225.5,414.6219,213.5" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#11"><polygon fill="#90EE90" points="346.6219,284,358.6219,296,346.6219,308,334.6219,296,346.6219,284" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#14"><polygon fill="#90EE90" points="208.6219,368.5,220.6219,380.5,208.6219,392.5,196.6219,380.5,208.6219,368.5" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#17"><polygon fill="#90EE90" points="186.6219,458.5,198.6219,470.5,186.6219,482.5,174.6219,470.5,186.6219,458.5" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#20"><polygon fill="#90EE90" points="186.6219,529,198.6219,541,186.6219,553,174.6219,541,186.6219,529" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="106.6219" y="853"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="116.6219" y="875.457">Generate token</text><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="113.6219" y="929"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="70" x="123.6219" y="951.457">Return token</text><ellipse cx="158.6219" cy="1015" fill="none" rx="10" ry="10" style="stroke:#FF0000;stroke-width:1.0;"/><ellipse cx="159.1219" cy="1015.5" fill="#FF0000" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="183" x="156.1219" y="608"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="163" x="166.1219" y="630.457">Send verification code to User</text><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="176" x="164.6219" y="698"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="156" x="174.6219" y="720.457">User enters verification code</text><g id="elem_#33"><polygon fill="#90EE90" points="252.6219,774,264.6219,786,252.6219,798,240.6219,786,252.6219,774" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="214" x="264.6219" y="853"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="194" x="274.6219" y="875.457">Return wrong credentials message</text><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="218.6219" y="453"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="214" x="228.6219" y="475.457">Return account is not verified message</text><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="211" x="241.1219" y="363"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="191" x="251.1219" y="385.457">Return Account is locked message</text><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="446.6219" y="208"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="152" x="456.6219" y="230.457">Return Forbidden message</text><!--MD5=[0cc5c6088e8b133b764c8e39458fa7f0]
link start to Recieve login data--><g id="link_start_Recieve login data"><path d="M473.6219,26.25 C473.6219,35.43 473.6219,49.84 473.6219,61.9 " fill="none" id="start-to-Recieve login data" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="473.6219,66.91,477.6219,57.91,473.6219,61.91,469.6219,57.91,473.6219,66.91" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[66602bce3d97b17711fac82889a600fb]
link Recieve login data to #5--><g id="link_Recieve login data_#5"><path d="M473.6219,102.08 C473.6219,112.87 473.6219,126.88 473.6219,137.63 " fill="none" id="Recieve login data-to-#5" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="473.6219,142.92,477.6219,133.92,473.6219,137.92,469.6219,133.92,473.6219,142.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="391.5344" y="132.485">Ip not blocked</text></g><!--MD5=[0c0d8213b86c66ad298a167b10270357]
link #5 to #8--><g id="link_#5_#8"><path d="M468.1819,162.32 C457.9419,174.21 435.7419,199.98 423.3819,214.33 " fill="none" id="#5-to-#8" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="419.8819,218.39,428.7839,214.1764,423.1429,214.5998,422.7195,208.9588,419.8819,218.39" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="56" x="340.5734" y="203.2871">Email exists</text></g><!--MD5=[04fae5d0eb764058787a86ce8fc6a833]
link #8 to #11--><g id="link_#8_#11"><path d="M408.8219,232.34 C397.0819,244.17 370.3919,271.06 356.0919,285.46 " fill="none" id="#8-to-#11" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="352.4019,289.17,361.5799,285.5974,355.9231,285.6202,355.9003,279.9634,352.4019,289.17" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="366.4857" y="284.4416">Account is not locked</text></g><!--MD5=[c1bb20eee0439e1debf317a372abdd7f]
link #11 to #14--><g id="link_#11_#14"><path d="M339.1019,300.85 C320.3419,310.56 270.1519,337.08 230.6219,363 C226.7219,365.56 222.5919,368.57 218.9719,371.31 " fill="none" id="#11-to-#14" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="215.0119,374.37,224.5795,372.0331,218.9686,371.3132,219.6885,365.7023,215.0119,374.37" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="98.1015" y="364.6985">Account is verified</text></g><!--MD5=[7c6a42bf0a318c2b836aa9956331407b]
link #14 to #17--><g id="link_#14_#17"><path d="M206.3519,390.59 C202.5119,405.95 194.7119,437.16 190.1519,455.39 " fill="none" id="#14-to-#17" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="188.8519,460.59,194.9153,452.8289,190.0646,455.7393,187.1541,450.8886,188.8519,460.59" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="94" x="73.0265" y="451.2128">Password matches</text></g><!--MD5=[f1899af40a6688035437f6ac185ef210]
link #17 to #20--><g id="link_#17_#20"><path d="M186.6219,482.51 C186.6219,493.62 186.6219,510.93 186.6219,523.65 " fill="none" id="#17-to-#20" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="186.6219,528.79,190.6219,519.79,186.6219,523.79,182.6219,519.79,186.6219,528.79" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="161" x="6" y="522.7503">User has logged in before from ip</text></g><!--MD5=[ca79e3c1a28fa22fa8fd083c94c8184c]
link #20 to Generate token--><g id="link_#20_Generate token"><path d="M179.8819,546.28 C163.6319,557.18 123.6219,587.74 123.6219,624.5 C123.6219,624.5 123.6219,624.5 123.6219,787 C123.6219,809.33 134.6219,832.55 144.2819,848.64 " fill="none" id="#20-to-Generate token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="146.9719,852.99,145.647,843.2307,144.345,848.7356,138.84,847.4336,146.9719,852.99" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="124.6219" y="720.4189">true</text></g><!--MD5=[098c265f84ee990ea225bc2bb82fd240]
link Generate token to Return token--><g id="link_Generate token_Return token"><path d="M158.6219,888.29 C158.6219,898.79 158.6219,912.43 158.6219,923.75 " fill="none" id="Generate token-to-Return token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="158.6219,928.77,162.6219,919.77,158.6219,923.77,154.6219,919.77,158.6219,928.77" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e178f1f4068ee0e7f5aeacc8dbfee9ac]
link Return token to end--><g id="link_Return token_end"><path d="M158.6219,964.28 C158.6219,975.29 158.6219,989.52 158.6219,999.94 " fill="none" id="Return token-to-end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="158.6219,1005,162.6219,996,158.6219,1000,154.6219,996,158.6219,1005" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[9a5b62b7c6ad4f878c78cb111f8ceaaf]
link #20 to Send verification code to User--><g id="link_#20_Send verification code to User"><path d="M191.4119,548.47 C200.0519,560.17 218.6319,585.29 232.0719,603.47 " fill="none" id="#20-to-Send verification code to User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="235.3619,607.92,233.2387,598.3027,232.3939,603.8962,226.8005,603.0514,235.3619,607.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="220.6219" y="585.4189">false</text></g><!--MD5=[a0ff370cc409434c99cba3229b3f4991]
link Send verification code to User to User enters verification code--><g id="link_Send verification code to User_User enters verification code"><path d="M248.5619,643.05 C249.3619,657.1 250.5119,677.36 251.3819,692.72 " fill="none" id="Send verification code to User-to-User enters verification code" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="251.6719,697.72,255.1504,688.5059,251.3858,692.7282,247.1635,688.9636,251.6719,697.72" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0b0b6059d3e9129dd81b767b6e1a4dd7]
link User enters verification code to #33--><g id="link_User enters verification code_#33"><path d="M252.6219,733.08 C252.6219,743.87 252.6219,757.88 252.6219,768.63 " fill="none" id="User enters verification code-to-#33" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="252.6219,773.92,256.6219,764.92,252.6219,768.92,248.6219,764.92,252.6219,773.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="114" x="118.3156" y="765.8687">Verification code match</text></g><!--MD5=[f720601697b5d5aba2152f0565daacfd]
link #33 to Generate token--><g id="link_#33_Generate token"><path d="M246.7419,792.16 C233.9519,803.39 203.0219,830.53 181.4419,849.47 " fill="none" id="#33-to-Generate token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="177.5319,852.91,186.9336,849.9761,181.2886,849.6104,181.6542,843.9654,177.5319,852.91" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="218.6219" y="830.4189">true</text></g><!--MD5=[48381e1e8b2dfd58fe507ed2d82e8add]
link #33 to Return wrong credentials message--><g id="link_#33_Return wrong credentials message"><path d="M259.3619,791.67 C275.2319,802.67 315.7019,830.73 343.4519,849.97 " fill="none" id="#33-to-Return wrong credentials message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="347.7819,852.98,342.6651,844.5646,343.673,850.131,338.1066,851.1389,347.7819,852.98" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="317.6219" y="830.4189">false</text></g><!--MD5=[4658334c360f443011c623eba047028a]
link #17 to Return wrong credentials message--><g id="link_#17_Return wrong credentials message"><path d="M192.4219,476.71 C196.6619,480.29 202.6819,484.94 208.6219,488 C276.2019,522.85 371.6219,463.96 371.6219,540 C371.6219,540 371.6219,540 371.6219,787 C371.6219,807.46 371.6219,830.78 371.6219,847.39 " fill="none" id="#17-to-Return wrong credentials message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="371.6219,852.75,375.6219,843.75,371.6219,847.75,367.6219,843.75,371.6219,852.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="372.6219" y="675.4189">false</text></g><!--MD5=[5197633971203f26cab455b1b814d065]
link #14 to Return account is not verified message--><g id="link_#14_Return account is not verified message"><path d="M215.1119,386.49 C219.4619,389.8 225.3419,394.22 230.6219,398 C255.7419,415.96 284.8019,435.67 305.9719,449.84 " fill="none" id="#14-to-Return account is not verified message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="310.3619,452.77,305.112,444.437,306.2082,449.9866,300.6586,451.0828,310.3619,452.77" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="280.6219" y="430.4189">false</text></g><!--MD5=[a5f9be55c8fb30ccce1e7296549632e0]
link #11 to Return Account is locked message--><g id="link_#11_Return Account is locked message"><path d="M346.6219,308.13 C346.6219,320.77 346.6219,341.72 346.6219,357.66 " fill="none" id="#11-to-Return Account is locked message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="346.6219,362.85,350.6219,353.85,346.6219,357.85,342.6219,353.85,346.6219,362.85" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="347.6219" y="340.4189">false</text></g><!--MD5=[ab5ea17adc830f9e051bf00dcfd7ba7d]
link #8 to Return wrong credentials message--><g id="link_#8_Return wrong credentials message"><path d="M420.9919,231.9 C438.0719,246.49 483.6219,286.22 483.6219,295 C483.6219,295 483.6219,295 483.6219,787 C483.6219,817.36 456.6119,837.8 429.1119,850.74 " fill="none" id="#8-to-Return wrong credentials message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="424.3419,852.91,434.1903,852.8156,428.8913,850.8356,430.8712,845.5366,424.3419,852.91" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="484.6219" y="545.9189">false</text></g><!--MD5=[5d61326badbc11eff3abe6561ff83845]
link #5 to Return Forbidden message--><g id="link_#5_Return Forbidden message"><path d="M479.0619,162.32 C487.1519,171.71 502.6919,189.75 514.9519,203.99 " fill="none" id="#5-to-Return Forbidden message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="518.3219,207.9,515.4842,198.4688,515.0609,204.1098,509.4199,203.6864,518.3219,207.9" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[bdddcf02423c09ecc8e60d902c3e6f53]
@startuml Login Flowchart

skinparam activity {
    BackgroundColor lightblue
    
    StartColor green
    EndColor red
    
    diamondBackgroundColor lightgreen
}

(*) - -> "Recieve login data"

if "Ip not blocked" then
    if "Email exists" then
        if "Account is not locked" then
            if "Account is verified" then
                if "Password matches" then
                    if "User has logged in before from ip" then
                        - ->[true] "Generate token"
                        - -> "Return token"
                        - -> (*)
                    else
                        - ->[false] Send verification code to User
                        - -> User enters verification code
                        if "Verification code match" then
                        - ->[true] "Generate token"
                        else
                        - ->[false] "Return wrong credentials message"
                        end if
                    end if 
                else
                    - ->[false] "Return wrong credentials message"
                end if
            else
                - ->[false] "Return account is not verified message"
            end if
        else
            - ->[false] "Return Account is locked message"
        end if
    else
      - ->[false] "Return wrong credentials message"

    end if 
else 
 - -> "Return Forbidden message"
end if
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>