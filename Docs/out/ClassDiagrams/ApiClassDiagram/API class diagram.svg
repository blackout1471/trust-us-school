<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1075px" preserveAspectRatio="none" style="width:4895px;height:1075px;background:#FFFFFF;" version="1.1" viewBox="0 0 4895 1075" width="4895px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="171.2656" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="521" x="575" y="42.5"/><ellipse cx="785.75" cy="58.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M788.5156,54.375 Q788.6719,54.1563 788.8594,54.0469 Q789.0469,53.9375 789.2656,53.9375 Q789.6406,53.9375 789.875,54.1953 Q790.1094,54.4531 790.1094,55.0625 L790.1094,56.5156 Q790.1094,57.125 789.875,57.3906 Q789.6406,57.6563 789.2656,57.6563 Q788.9219,57.6563 788.7188,57.4531 Q788.5156,57.2656 788.4063,56.75 Q788.3594,56.3906 788.1719,56.2031 Q787.8438,55.8281 787.2344,55.6094 Q786.625,55.3906 786,55.3906 Q785.2344,55.3906 784.6016,55.7188 Q783.9688,56.0469 783.4766,56.7969 Q782.9844,57.5469 782.9844,58.5781 L782.9844,59.6719 Q782.9844,60.9063 783.875,61.7266 Q784.7656,62.5469 786.3594,62.5469 Q787.2969,62.5469 787.9531,62.2969 Q788.3438,62.1406 788.7656,61.7031 Q789.0313,61.4375 789.1797,61.3594 Q789.3281,61.2813 789.5313,61.2813 Q789.8594,61.2813 790.1172,61.5391 Q790.375,61.7969 790.375,62.1406 Q790.375,62.4844 790.0313,62.8906 Q789.5313,63.4688 788.7344,63.7969 Q787.6563,64.25 786.3594,64.25 Q784.8438,64.25 783.6406,63.625 Q782.6563,63.125 781.9688,62.0547 Q781.2813,60.9844 781.2813,59.7031 L781.2813,58.5469 Q781.2813,57.2188 781.8984,56.0703 Q782.5156,54.9219 783.6094,54.3047 Q784.7031,53.6875 785.9375,53.6875 Q786.6719,53.6875 787.3203,53.8516 Q787.9688,54.0156 788.5156,54.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="806.25" y="64.2285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="576" x2="1095" y1="74.5" y2="74.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583" y="85.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="595" y="93.0332">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583" y="103.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="595" y="110.6426">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:1.0;" x1="576" x2="1095" y1="117.7188" y2="117.7188"/><ellipse cx="586" cy="132.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="595" y="136.252">UserController(userManager : IUserManager, tokenManager : ITokenManager)</text><ellipse cx="586" cy="149.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="595" y="153.8613">Create(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="167.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="595" y="171.4707">Login(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="184.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="318" x="595" y="189.0801">GetUserFromToken() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="586" cy="202.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="477" x="595" y="206.6895">VerificationLogin(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="24" fill="#F1F1F1" height="118.4375" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="653" x="509" y="335.5"/><ellipse cx="785.75" cy="351.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M786.7031,348.1406 L786.7031,354.7969 L788.4219,354.7969 Q789.0313,354.7969 789.2969,355.0313 Q789.5625,355.2656 789.5625,355.6563 Q789.5625,356.0313 789.2969,356.2656 Q789.0313,356.5 788.4219,356.5 L783.2813,356.5 Q782.6719,356.5 782.4063,356.2656 Q782.1406,356.0313 782.1406,355.6406 Q782.1406,355.2656 782.4063,355.0313 Q782.6719,354.7969 783.2813,354.7969 L785,354.7969 L785,348.1406 L783.2813,348.1406 Q782.6719,348.1406 782.4063,347.9063 Q782.1406,347.6719 782.1406,347.2813 Q782.1406,346.9063 782.4063,346.6719 Q782.6719,346.4375 783.2813,346.4375 L788.4219,346.4375 Q789.0313,346.4375 789.2969,346.6719 Q789.5625,346.9063 789.5625,347.2813 Q789.5625,347.6719 789.2969,347.9063 Q789.0313,348.1406 788.4219,348.1406 L786.7031,348.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="806.25" y="357.2285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="510" x2="1161" y1="367.5" y2="367.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="510" x2="1161" y1="375.5" y2="375.5"/><ellipse cx="520" cy="389.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="363" x="529" y="394.0332">CreateUserAsync(userCreate : UserCreate) : Task&lt;User&gt;</text><ellipse cx="520" cy="407.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="529" y="411.6426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="520" cy="425.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="529" y="429.252">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="520" cy="442.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="627" x="529" y="446.8613">LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="31" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="100.5" y="344"/><ellipse cx="227.25" cy="360" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M228.2031,356.6406 L228.2031,363.2969 L229.9219,363.2969 Q230.5313,363.2969 230.7969,363.5313 Q231.0625,363.7656 231.0625,364.1563 Q231.0625,364.5313 230.7969,364.7656 Q230.5313,365 229.9219,365 L224.7813,365 Q224.1719,365 223.9063,364.7656 Q223.6406,364.5313 223.6406,364.1406 Q223.6406,363.7656 223.9063,363.5313 Q224.1719,363.2969 224.7813,363.2969 L226.5,363.2969 L226.5,356.6406 L224.7813,356.6406 Q224.1719,356.6406 223.9063,356.4063 Q223.6406,356.1719 223.6406,355.7813 Q223.6406,355.4063 223.9063,355.1719 Q224.1719,354.9375 224.7813,354.9375 L229.9219,354.9375 Q230.5313,354.9375 230.7969,355.1719 Q231.0625,355.4063 231.0625,355.7813 Q231.0625,356.1719 230.7969,356.4063 Q230.5313,356.6406 229.9219,356.6406 L228.2031,356.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="247.75" y="365.7285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="101.5" x2="463.5" y1="376" y2="376"/><line style="stroke:#181818;stroke-width:0.5;" x1="101.5" x2="463.5" y1="384" y2="384"/><ellipse cx="111.5" cy="398.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="120.5" y="402.5332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="111.5" cy="415.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="120.5" y="420.1426">ValidateToken(token : string) : bool</text><ellipse cx="111.5" cy="433.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="120.5" y="437.752">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="38" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1772.5" y="344"/><ellipse cx="1965.75" cy="360" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1966.7031,356.6406 L1966.7031,363.2969 L1968.4219,363.2969 Q1969.0313,363.2969 1969.2969,363.5313 Q1969.5625,363.7656 1969.5625,364.1563 Q1969.5625,364.5313 1969.2969,364.7656 Q1969.0313,365 1968.4219,365 L1963.2813,365 Q1962.6719,365 1962.4063,364.7656 Q1962.1406,364.5313 1962.1406,364.1406 Q1962.1406,363.7656 1962.4063,363.5313 Q1962.6719,363.2969 1963.2813,363.2969 L1965,363.2969 L1965,356.6406 L1963.2813,356.6406 Q1962.6719,356.6406 1962.4063,356.4063 Q1962.1406,356.1719 1962.1406,355.7813 Q1962.1406,355.4063 1962.4063,355.1719 Q1962.6719,354.9375 1963.2813,354.9375 L1968.4219,354.9375 Q1969.0313,354.9375 1969.2969,355.1719 Q1969.5625,355.4063 1969.5625,355.7813 Q1969.5625,356.1719 1969.2969,356.4063 Q1969.0313,356.6406 1968.4219,356.6406 L1966.7031,356.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="1986.25" y="365.7285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1773.5" x2="2311.5" y1="376" y2="376"/><line style="stroke:#181818;stroke-width:0.5;" x1="1773.5" x2="2311.5" y1="384" y2="384"/><ellipse cx="1783.5" cy="398.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1792.5" y="402.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1783.5" cy="415.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="1792.5" y="420.1426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1783.5" cy="433.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1792.5" y="437.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="44" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="86.5"/><ellipse cx="221.25" cy="102.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,98.375 Q224.1719,98.1563 224.3594,98.0469 Q224.5469,97.9375 224.7656,97.9375 Q225.1406,97.9375 225.375,98.1953 Q225.6094,98.4531 225.6094,99.0625 L225.6094,100.5156 Q225.6094,101.125 225.375,101.3906 Q225.1406,101.6563 224.7656,101.6563 Q224.4219,101.6563 224.2188,101.4531 Q224.0156,101.2656 223.9063,100.75 Q223.8594,100.3906 223.6719,100.2031 Q223.3438,99.8281 222.7344,99.6094 Q222.125,99.3906 221.5,99.3906 Q220.7344,99.3906 220.1016,99.7188 Q219.4688,100.0469 218.9766,100.7969 Q218.4844,101.5469 218.4844,102.5781 L218.4844,103.6719 Q218.4844,104.9063 219.375,105.7266 Q220.2656,106.5469 221.8594,106.5469 Q222.7969,106.5469 223.4531,106.2969 Q223.8438,106.1406 224.2656,105.7031 Q224.5313,105.4375 224.6797,105.3594 Q224.8281,105.2813 225.0313,105.2813 Q225.3594,105.2813 225.6172,105.5391 Q225.875,105.7969 225.875,106.1406 Q225.875,106.4844 225.5313,106.8906 Q225.0313,107.4688 224.2344,107.7969 Q223.1563,108.25 221.8594,108.25 Q220.3438,108.25 219.1406,107.625 Q218.1563,107.125 217.4688,106.0547 Q216.7813,104.9844 216.7813,103.7031 L216.7813,102.5469 Q216.7813,101.2188 217.3984,100.0703 Q218.0156,98.9219 219.1094,98.3047 Q220.2031,97.6875 221.4375,97.6875 Q222.1719,97.6875 222.8203,97.8516 Q223.4688,98.0156 224.0156,98.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="108.2285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="118.5" y2="118.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="539" y1="126.5" y2="126.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="137.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="145.0332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="155.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="162.6426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="50" fill="#F1F1F1" height="241.7031" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="1128" x="1876.5" y="7"/><ellipse cx="2393.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2396.5156,18.875 Q2396.6719,18.6563 2396.8594,18.5469 Q2397.0469,18.4375 2397.2656,18.4375 Q2397.6406,18.4375 2397.875,18.6953 Q2398.1094,18.9531 2398.1094,19.5625 L2398.1094,21.0156 Q2398.1094,21.625 2397.875,21.8906 Q2397.6406,22.1563 2397.2656,22.1563 Q2396.9219,22.1563 2396.7188,21.9531 Q2396.5156,21.7656 2396.4063,21.25 Q2396.3594,20.8906 2396.1719,20.7031 Q2395.8438,20.3281 2395.2344,20.1094 Q2394.625,19.8906 2394,19.8906 Q2393.2344,19.8906 2392.6016,20.2188 Q2391.9688,20.5469 2391.4766,21.2969 Q2390.9844,22.0469 2390.9844,23.0781 L2390.9844,24.1719 Q2390.9844,25.4063 2391.875,26.2266 Q2392.7656,27.0469 2394.3594,27.0469 Q2395.2969,27.0469 2395.9531,26.7969 Q2396.3438,26.6406 2396.7656,26.2031 Q2397.0313,25.9375 2397.1797,25.8594 Q2397.3281,25.7813 2397.5313,25.7813 Q2397.8594,25.7813 2398.1172,26.0391 Q2398.375,26.2969 2398.375,26.6406 Q2398.375,26.9844 2398.0313,27.3906 Q2397.5313,27.9688 2396.7344,28.2969 Q2395.6563,28.75 2394.3594,28.75 Q2392.8438,28.75 2391.6406,28.125 Q2390.6563,27.625 2389.9688,26.5547 Q2389.2813,25.4844 2389.2813,24.2031 L2389.2813,23.0469 Q2389.2813,21.7188 2389.8984,20.5703 Q2390.5156,19.4219 2391.6094,18.8047 Q2392.7031,18.1875 2393.9375,18.1875 Q2394.6719,18.1875 2395.3203,18.3516 Q2395.9688,18.5156 2396.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="2414.25" y="28.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1877.5" x2="3003.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1884.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="1896.5" y="57.5332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1884.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="1896.5" y="75.1426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1884.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="1896.5" y="92.752">_userLocationManager : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1884.5" y="103.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="1896.5" y="110.3613">_messageService : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1884.5" y="120.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="1896.5" y="127.9707">_messageProvider : IMessageProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1884.5" y="138.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="1896.5" y="145.5801">_logger : ILogger&lt;UserManager&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1884.5" y="155.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1896.5" y="163.1895">_configuration : IConfiguration</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1884.5" y="173.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438" x="1896.5" y="180.7988">IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool</text><line style="stroke:#181818;stroke-width:1.0;" x1="1877.5" x2="3003.5" y1="187.875" y2="187.875"/><ellipse cx="1887.5" cy="202.1797" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1102" x="1896.5" y="206.4082">UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="680" x="1896.5" y="224.0176">messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger&lt;UserManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1884.5" y="234.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="402" x="1896.5" y="241.627">CheckPasswordLeakedForUser(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="65" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="458" x="1254.5" y="86.5"/><ellipse cx="1409.75" cy="102.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1412.5156,98.375 Q1412.6719,98.1563 1412.8594,98.0469 Q1413.0469,97.9375 1413.2656,97.9375 Q1413.6406,97.9375 1413.875,98.1953 Q1414.1094,98.4531 1414.1094,99.0625 L1414.1094,100.5156 Q1414.1094,101.125 1413.875,101.3906 Q1413.6406,101.6563 1413.2656,101.6563 Q1412.9219,101.6563 1412.7188,101.4531 Q1412.5156,101.2656 1412.4063,100.75 Q1412.3594,100.3906 1412.1719,100.2031 Q1411.8438,99.8281 1411.2344,99.6094 Q1410.625,99.3906 1410,99.3906 Q1409.2344,99.3906 1408.6016,99.7188 Q1407.9688,100.0469 1407.4766,100.7969 Q1406.9844,101.5469 1406.9844,102.5781 L1406.9844,103.6719 Q1406.9844,104.9063 1407.875,105.7266 Q1408.7656,106.5469 1410.3594,106.5469 Q1411.2969,106.5469 1411.9531,106.2969 Q1412.3438,106.1406 1412.7656,105.7031 Q1413.0313,105.4375 1413.1797,105.3594 Q1413.3281,105.2813 1413.5313,105.2813 Q1413.8594,105.2813 1414.1172,105.5391 Q1414.375,105.7969 1414.375,106.1406 Q1414.375,106.4844 1414.0313,106.8906 Q1413.5313,107.4688 1412.7344,107.7969 Q1411.6563,108.25 1410.3594,108.25 Q1408.8438,108.25 1407.6406,107.625 Q1406.6563,107.125 1405.9688,106.0547 Q1405.2813,104.9844 1405.2813,103.7031 L1405.2813,102.5469 Q1405.2813,101.2188 1405.8984,100.0703 Q1406.5156,98.9219 1407.6094,98.3047 Q1408.7031,97.6875 1409.9375,97.6875 Q1410.6719,97.6875 1411.3203,97.8516 Q1411.9688,98.0156 1412.5156,98.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1430.25" y="108.2285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1255.5" x2="1711.5" y1="118.5" y2="118.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1262.5" y="129.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="1274.5" y="137.0332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="1255.5" x2="1711.5" y1="144.1094" y2="144.1094"/><ellipse cx="1265.5" cy="158.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="432" x="1274.5" y="162.6426">UserLocationManager(userLocationProvider : UserLocationProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="189" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1483.5" y="789"/><ellipse cx="1512" cy="805" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1514.7656,800.875 Q1514.9219,800.6563 1515.1094,800.5469 Q1515.2969,800.4375 1515.5156,800.4375 Q1515.8906,800.4375 1516.125,800.6953 Q1516.3594,800.9531 1516.3594,801.5625 L1516.3594,803.0156 Q1516.3594,803.625 1516.125,803.8906 Q1515.8906,804.1563 1515.5156,804.1563 Q1515.1719,804.1563 1514.9688,803.9531 Q1514.7656,803.7656 1514.6563,803.25 Q1514.6094,802.8906 1514.4219,802.7031 Q1514.0938,802.3281 1513.4844,802.1094 Q1512.875,801.8906 1512.25,801.8906 Q1511.4844,801.8906 1510.8516,802.2188 Q1510.2188,802.5469 1509.7266,803.2969 Q1509.2344,804.0469 1509.2344,805.0781 L1509.2344,806.1719 Q1509.2344,807.4063 1510.125,808.2266 Q1511.0156,809.0469 1512.6094,809.0469 Q1513.5469,809.0469 1514.2031,808.7969 Q1514.5938,808.6406 1515.0156,808.2031 Q1515.2813,807.9375 1515.4297,807.8594 Q1515.5781,807.7813 1515.7813,807.7813 Q1516.1094,807.7813 1516.3672,808.0391 Q1516.625,808.2969 1516.625,808.6406 Q1516.625,808.9844 1516.2813,809.3906 Q1515.7813,809.9688 1514.9844,810.2969 Q1513.9063,810.75 1512.6094,810.75 Q1511.0938,810.75 1509.8906,810.125 Q1508.9063,809.625 1508.2188,808.5547 Q1507.5313,807.4844 1507.5313,806.2031 L1507.5313,805.0469 Q1507.5313,803.7188 1508.1484,802.5703 Q1508.7656,801.4219 1509.8594,800.8047 Q1510.9531,800.1875 1512.1875,800.1875 Q1512.9219,800.1875 1513.5703,800.3516 Q1514.2188,800.5156 1514.7656,800.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1529" y="810.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="1484.5" x2="1616.5" y1="821" y2="821"/><ellipse cx="1494.5" cy="835.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1503.5" y="839.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1484.5" x2="1616.5" y1="846.6094" y2="846.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="201" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="768.5" y="575.5"/><ellipse cx="800.6" cy="591.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M803.3656,587.375 Q803.5219,587.1563 803.7094,587.0469 Q803.8969,586.9375 804.1156,586.9375 Q804.4906,586.9375 804.725,587.1953 Q804.9594,587.4531 804.9594,588.0625 L804.9594,589.5156 Q804.9594,590.125 804.725,590.3906 Q804.4906,590.6563 804.1156,590.6563 Q803.7719,590.6563 803.5688,590.4531 Q803.3656,590.2656 803.2563,589.75 Q803.2094,589.3906 803.0219,589.2031 Q802.6938,588.8281 802.0844,588.6094 Q801.475,588.3906 800.85,588.3906 Q800.0844,588.3906 799.4516,588.7188 Q798.8188,589.0469 798.3266,589.7969 Q797.8344,590.5469 797.8344,591.5781 L797.8344,592.6719 Q797.8344,593.9063 798.725,594.7266 Q799.6156,595.5469 801.2094,595.5469 Q802.1469,595.5469 802.8031,595.2969 Q803.1938,595.1406 803.6156,594.7031 Q803.8813,594.4375 804.0297,594.3594 Q804.1781,594.2813 804.3813,594.2813 Q804.7094,594.2813 804.9672,594.5391 Q805.225,594.7969 805.225,595.1406 Q805.225,595.4844 804.8813,595.8906 Q804.3813,596.4688 803.5844,596.7969 Q802.5063,597.25 801.2094,597.25 Q799.6938,597.25 798.4906,596.625 Q797.5063,596.125 796.8188,595.0547 Q796.1313,593.9844 796.1313,592.7031 L796.1313,591.5469 Q796.1313,590.2188 796.7484,589.0703 Q797.3656,587.9219 798.4594,587.3047 Q799.5531,586.6875 800.7875,586.6875 Q801.5219,586.6875 802.1703,586.8516 Q802.8188,587.0156 803.3656,587.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="818.4" y="597.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="769.5" x2="901.5" y1="607.5" y2="607.5"/><ellipse cx="779.5" cy="621.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="788.5" y="626.0332">Email : string</text><ellipse cx="779.5" cy="639.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="788.5" y="643.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="769.5" x2="901.5" y1="650.7188" y2="650.7188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="90" fill="#F1F1F1" height="171.2656" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="502" x="2347.5" y="309"/><ellipse cx="2551.25" cy="325" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2552.2031,321.6406 L2552.2031,328.2969 L2553.9219,328.2969 Q2554.5313,328.2969 2554.7969,328.5313 Q2555.0625,328.7656 2555.0625,329.1563 Q2555.0625,329.5313 2554.7969,329.7656 Q2554.5313,330 2553.9219,330 L2548.7813,330 Q2548.1719,330 2547.9063,329.7656 Q2547.6406,329.5313 2547.6406,329.1406 Q2547.6406,328.7656 2547.9063,328.5313 Q2548.1719,328.2969 2548.7813,328.2969 L2550.5,328.2969 L2550.5,321.6406 L2548.7813,321.6406 Q2548.1719,321.6406 2547.9063,321.4063 Q2547.6406,321.1719 2547.6406,320.7813 Q2547.6406,320.4063 2547.9063,320.1719 Q2548.1719,319.9375 2548.7813,319.9375 L2553.9219,319.9375 Q2554.5313,319.9375 2554.7969,320.1719 Q2555.0625,320.4063 2555.0625,320.7813 Q2555.0625,321.1719 2554.7969,321.4063 Q2554.5313,321.6406 2553.9219,321.6406 L2552.2031,321.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="2571.75" y="330.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2348.5" x2="2848.5" y1="341" y2="341"/><line style="stroke:#181818;stroke-width:0.5;" x1="2348.5" x2="2848.5" y1="349" y2="349"/><ellipse cx="2358.5" cy="363.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2367.5" y="367.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="380.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2367.5" y="385.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="398.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2367.5" y="402.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="416.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="2367.5" y="420.3613">UpdateUserFailedTries(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="433.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2367.5" y="437.9707">UpdateUserLoginSuccess(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="451.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="371" x="2367.5" y="455.5801">UpdateUserLoginNewLocation(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="468.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="476" x="2367.5" y="473.1895">UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="100" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="2884.5" y="361.5"/><ellipse cx="3001.75" cy="377.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3002.7031,374.1406 L3002.7031,380.7969 L3004.4219,380.7969 Q3005.0313,380.7969 3005.2969,381.0313 Q3005.5625,381.2656 3005.5625,381.6563 Q3005.5625,382.0313 3005.2969,382.2656 Q3005.0313,382.5 3004.4219,382.5 L2999.2813,382.5 Q2998.6719,382.5 2998.4063,382.2656 Q2998.1406,382.0313 2998.1406,381.6406 Q2998.1406,381.2656 2998.4063,381.0313 Q2998.6719,380.7969 2999.2813,380.7969 L3001,380.7969 L3001,374.1406 L2999.2813,374.1406 Q2998.6719,374.1406 2998.4063,373.9063 Q2998.1406,373.6719 2998.1406,373.2813 Q2998.1406,372.9063 2998.4063,372.6719 Q2998.6719,372.4375 2999.2813,372.4375 L3004.4219,372.4375 Q3005.0313,372.4375 3005.2969,372.6719 Q3005.5625,372.9063 3005.5625,373.2813 Q3005.5625,373.6719 3005.2969,373.9063 Q3005.0313,374.1406 3004.4219,374.1406 L3002.7031,374.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="3022.25" y="383.2285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2885.5" x2="3291.5" y1="393.5" y2="393.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="2885.5" x2="3291.5" y1="401.5" y2="401.5"/><ellipse cx="2895.5" cy="415.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="2904.5" y="420.0332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="167" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="226" y="566.5"/><ellipse cx="246.4" cy="582.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M249.1656,578.375 Q249.3219,578.1563 249.5094,578.0469 Q249.6969,577.9375 249.9156,577.9375 Q250.2906,577.9375 250.525,578.1953 Q250.7594,578.4531 250.7594,579.0625 L250.7594,580.5156 Q250.7594,581.125 250.525,581.3906 Q250.2906,581.6563 249.9156,581.6563 Q249.5719,581.6563 249.3688,581.4531 Q249.1656,581.2656 249.0563,580.75 Q249.0094,580.3906 248.8219,580.2031 Q248.4938,579.8281 247.8844,579.6094 Q247.275,579.3906 246.65,579.3906 Q245.8844,579.3906 245.2516,579.7188 Q244.6188,580.0469 244.1266,580.7969 Q243.6344,581.5469 243.6344,582.5781 L243.6344,583.6719 Q243.6344,584.9063 244.525,585.7266 Q245.4156,586.5469 247.0094,586.5469 Q247.9469,586.5469 248.6031,586.2969 Q248.9938,586.1406 249.4156,585.7031 Q249.6813,585.4375 249.8297,585.3594 Q249.9781,585.2813 250.1813,585.2813 Q250.5094,585.2813 250.7672,585.5391 Q251.025,585.7969 251.025,586.1406 Q251.025,586.4844 250.6813,586.8906 Q250.1813,587.4688 249.3844,587.7969 Q248.3063,588.25 247.0094,588.25 Q245.4938,588.25 244.2906,587.625 Q243.3063,587.125 242.6188,586.0547 Q241.9313,584.9844 241.9313,583.7031 L241.9313,582.5469 Q241.9313,581.2188 242.5484,580.0703 Q243.1656,578.9219 244.2594,578.3047 Q245.3531,577.6875 246.5875,577.6875 Q247.3219,577.6875 247.9703,577.8516 Q248.6188,578.0156 249.1656,578.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="261.6" y="588.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="227" x2="338" y1="598.5" y2="598.5"/><ellipse cx="237" cy="612.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="246" y="617.0332">UserID : int</text><ellipse cx="237" cy="630.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="246" y="634.6426">Email : string</text><ellipse cx="237" cy="648.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="246" y="652.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="227" x2="338" y1="659.3281" y2="659.3281"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="116" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1197.5" y="344"/><ellipse cx="1393.25" cy="360" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1394.2031,356.6406 L1394.2031,363.2969 L1395.9219,363.2969 Q1396.5313,363.2969 1396.7969,363.5313 Q1397.0625,363.7656 1397.0625,364.1563 Q1397.0625,364.5313 1396.7969,364.7656 Q1396.5313,365 1395.9219,365 L1390.7813,365 Q1390.1719,365 1389.9063,364.7656 Q1389.6406,364.5313 1389.6406,364.1406 Q1389.6406,363.7656 1389.9063,363.5313 Q1390.1719,363.2969 1390.7813,363.2969 L1392.5,363.2969 L1392.5,356.6406 L1390.7813,356.6406 Q1390.1719,356.6406 1389.9063,356.4063 Q1389.6406,356.1719 1389.6406,355.7813 Q1389.6406,355.4063 1389.9063,355.1719 Q1390.1719,354.9375 1390.7813,354.9375 L1395.9219,354.9375 Q1396.5313,354.9375 1396.7969,355.1719 Q1397.0625,355.4063 1397.0625,355.7813 Q1397.0625,356.1719 1396.7969,356.4063 Q1396.5313,356.6406 1395.9219,356.6406 L1394.2031,356.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="1413.75" y="365.7285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1198.5" x2="1736.5" y1="376" y2="376"/><line style="stroke:#181818;stroke-width:0.5;" x1="1198.5" x2="1736.5" y1="384" y2="384"/><ellipse cx="1208.5" cy="398.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1217.5" y="402.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1208.5" cy="415.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="1217.5" y="420.1426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1208.5" cy="433.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1217.5" y="437.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="104" fill="#F1F1F1" height="100.8281" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="3327.5" y="344"/><ellipse cx="3636.75" cy="360" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3639.5156,355.875 Q3639.6719,355.6563 3639.8594,355.5469 Q3640.0469,355.4375 3640.2656,355.4375 Q3640.6406,355.4375 3640.875,355.6953 Q3641.1094,355.9531 3641.1094,356.5625 L3641.1094,358.0156 Q3641.1094,358.625 3640.875,358.8906 Q3640.6406,359.1563 3640.2656,359.1563 Q3639.9219,359.1563 3639.7188,358.9531 Q3639.5156,358.7656 3639.4063,358.25 Q3639.3594,357.8906 3639.1719,357.7031 Q3638.8438,357.3281 3638.2344,357.1094 Q3637.625,356.8906 3637,356.8906 Q3636.2344,356.8906 3635.6016,357.2188 Q3634.9688,357.5469 3634.4766,358.2969 Q3633.9844,359.0469 3633.9844,360.0781 L3633.9844,361.1719 Q3633.9844,362.4063 3634.875,363.2266 Q3635.7656,364.0469 3637.3594,364.0469 Q3638.2969,364.0469 3638.9531,363.7969 Q3639.3438,363.6406 3639.7656,363.2031 Q3640.0313,362.9375 3640.1797,362.8594 Q3640.3281,362.7813 3640.5313,362.7813 Q3640.8594,362.7813 3641.1172,363.0391 Q3641.375,363.2969 3641.375,363.6406 Q3641.375,363.9844 3641.0313,364.3906 Q3640.5313,364.9688 3639.7344,365.2969 Q3638.6563,365.75 3637.3594,365.75 Q3635.8438,365.75 3634.6406,365.125 Q3633.6563,364.625 3632.9688,363.5547 Q3632.2813,362.4844 3632.2813,361.2031 L3632.2813,360.0469 Q3632.2813,358.7188 3632.8984,357.5703 Q3633.5156,356.4219 3634.6094,355.8047 Q3635.7031,355.1875 3636.9375,355.1875 Q3637.6719,355.1875 3638.3203,355.3516 Q3638.9688,355.5156 3639.5156,355.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="3657.25" y="365.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3328.5" x2="4026.5" y1="376" y2="376"/><line style="stroke:#181818;stroke-width:1.0;" x1="3328.5" x2="4026.5" y1="384" y2="384"/><ellipse cx="3338.5" cy="398.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3347.5" y="402.5332">SqlProvider(connection : string)</text><polygon fill="#FFFF44" points="3338.5,410.9141,3342.5,414.9141,3338.5,418.9141,3334.5,414.9141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="3347.5" y="420.1426">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3338.5,428.5234,3342.5,432.5234,3338.5,436.5234,3334.5,432.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3347.5" y="437.752">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="111" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3471" y="95"/><ellipse cx="3575.75" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3578.5156,106.875 Q3578.6719,106.6563 3578.8594,106.5469 Q3579.0469,106.4375 3579.2656,106.4375 Q3579.6406,106.4375 3579.875,106.6953 Q3580.1094,106.9531 3580.1094,107.5625 L3580.1094,109.0156 Q3580.1094,109.625 3579.875,109.8906 Q3579.6406,110.1563 3579.2656,110.1563 Q3578.9219,110.1563 3578.7188,109.9531 Q3578.5156,109.7656 3578.4063,109.25 Q3578.3594,108.8906 3578.1719,108.7031 Q3577.8438,108.3281 3577.2344,108.1094 Q3576.625,107.8906 3576,107.8906 Q3575.2344,107.8906 3574.6016,108.2188 Q3573.9688,108.5469 3573.4766,109.2969 Q3572.9844,110.0469 3572.9844,111.0781 L3572.9844,112.1719 Q3572.9844,113.4063 3573.875,114.2266 Q3574.7656,115.0469 3576.3594,115.0469 Q3577.2969,115.0469 3577.9531,114.7969 Q3578.3438,114.6406 3578.7656,114.2031 Q3579.0313,113.9375 3579.1797,113.8594 Q3579.3281,113.7813 3579.5313,113.7813 Q3579.8594,113.7813 3580.1172,114.0391 Q3580.375,114.2969 3580.375,114.6406 Q3580.375,114.9844 3580.0313,115.3906 Q3579.5313,115.9688 3578.7344,116.2969 Q3577.6563,116.75 3576.3594,116.75 Q3574.8438,116.75 3573.6406,116.125 Q3572.6563,115.625 3571.9688,114.5547 Q3571.2813,113.4844 3571.2813,112.2031 L3571.2813,111.0469 Q3571.2813,109.7188 3571.8984,108.5703 Q3572.5156,107.4219 3573.6094,106.8047 Q3574.7031,106.1875 3575.9375,106.1875 Q3576.6719,106.1875 3577.3203,106.3516 Q3577.9688,106.5156 3578.5156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="3596.25" y="116.7285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3472" x2="3849" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="3472" x2="3849" y1="135" y2="135"/><ellipse cx="3482" cy="149.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3491" y="153.5332">LeakedPasswordProvider(configuration : IConfiguration)</text></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="122" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="3103.5" y="86.5"/><ellipse cx="3208.25" cy="102.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3211.0156,98.375 Q3211.1719,98.1563 3211.3594,98.0469 Q3211.5469,97.9375 3211.7656,97.9375 Q3212.1406,97.9375 3212.375,98.1953 Q3212.6094,98.4531 3212.6094,99.0625 L3212.6094,100.5156 Q3212.6094,101.125 3212.375,101.3906 Q3212.1406,101.6563 3211.7656,101.6563 Q3211.4219,101.6563 3211.2188,101.4531 Q3211.0156,101.2656 3210.9063,100.75 Q3210.8594,100.3906 3210.6719,100.2031 Q3210.3438,99.8281 3209.7344,99.6094 Q3209.125,99.3906 3208.5,99.3906 Q3207.7344,99.3906 3207.1016,99.7188 Q3206.4688,100.0469 3205.9766,100.7969 Q3205.4844,101.5469 3205.4844,102.5781 L3205.4844,103.6719 Q3205.4844,104.9063 3206.375,105.7266 Q3207.2656,106.5469 3208.8594,106.5469 Q3209.7969,106.5469 3210.4531,106.2969 Q3210.8438,106.1406 3211.2656,105.7031 Q3211.5313,105.4375 3211.6797,105.3594 Q3211.8281,105.2813 3212.0313,105.2813 Q3212.3594,105.2813 3212.6172,105.5391 Q3212.875,105.7969 3212.875,106.1406 Q3212.875,106.4844 3212.5313,106.8906 Q3212.0313,107.4688 3211.2344,107.7969 Q3210.1563,108.25 3208.8594,108.25 Q3207.3438,108.25 3206.1406,107.625 Q3205.1563,107.125 3204.4688,106.0547 Q3203.7813,104.9844 3203.7813,103.7031 L3203.7813,102.5469 Q3203.7813,101.2188 3204.3984,100.0703 Q3205.0156,98.9219 3206.1094,98.3047 Q3207.2031,97.6875 3208.4375,97.6875 Q3209.1719,97.6875 3209.8203,97.8516 Q3210.4688,98.0156 3211.0156,98.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3228.75" y="108.2285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3104.5" x2="3402.5" y1="118.5" y2="118.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3104.5" x2="3402.5" y1="126.5" y2="126.5"/><ellipse cx="3114.5" cy="140.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="3123.5" y="145.0332">UserProvider(configuration : IConfiguration)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3111.5" y="155.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="3123.5" y="162.6426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="181" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="2039.5" y="549"/><ellipse cx="2116.75" cy="565" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2119.5156,560.875 Q2119.6719,560.6563 2119.8594,560.5469 Q2120.0469,560.4375 2120.2656,560.4375 Q2120.6406,560.4375 2120.875,560.6953 Q2121.1094,560.9531 2121.1094,561.5625 L2121.1094,563.0156 Q2121.1094,563.625 2120.875,563.8906 Q2120.6406,564.1563 2120.2656,564.1563 Q2119.9219,564.1563 2119.7188,563.9531 Q2119.5156,563.7656 2119.4063,563.25 Q2119.3594,562.8906 2119.1719,562.7031 Q2118.8438,562.3281 2118.2344,562.1094 Q2117.625,561.8906 2117,561.8906 Q2116.2344,561.8906 2115.6016,562.2188 Q2114.9688,562.5469 2114.4766,563.2969 Q2113.9844,564.0469 2113.9844,565.0781 L2113.9844,566.1719 Q2113.9844,567.4063 2114.875,568.2266 Q2115.7656,569.0469 2117.3594,569.0469 Q2118.2969,569.0469 2118.9531,568.7969 Q2119.3438,568.6406 2119.7656,568.2031 Q2120.0313,567.9375 2120.1797,567.8594 Q2120.3281,567.7813 2120.5313,567.7813 Q2120.8594,567.7813 2121.1172,568.0391 Q2121.375,568.2969 2121.375,568.6406 Q2121.375,568.9844 2121.0313,569.3906 Q2120.5313,569.9688 2119.7344,570.2969 Q2118.6563,570.75 2117.3594,570.75 Q2115.8438,570.75 2114.6406,570.125 Q2113.6563,569.625 2112.9688,568.5547 Q2112.2813,567.4844 2112.2813,566.2031 L2112.2813,565.0469 Q2112.2813,563.7188 2112.8984,562.5703 Q2113.5156,561.4219 2114.6094,560.8047 Q2115.7031,560.1875 2116.9375,560.1875 Q2117.6719,560.1875 2118.3203,560.3516 Q2118.9688,560.5156 2119.5156,560.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2137.25" y="570.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="2040.5" x2="2248.5" y1="581" y2="581"/><ellipse cx="2050.5" cy="595.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2059.5" y="599.5332">HashedPassword : string</text><ellipse cx="2050.5" cy="612.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="2059.5" y="617.1426">Salt : string</text><ellipse cx="2050.5" cy="630.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="2059.5" y="634.752">SecretKey : string</text><ellipse cx="2050.5" cy="648.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="2059.5" y="652.3613">Count : long</text><ellipse cx="2050.5" cy="665.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="2059.5" y="669.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="2040.5" x2="2248.5" y1="677.0469" y2="677.0469"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="206" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="1385" y="540"/><ellipse cx="1422.5" cy="556" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1425.2656,551.875 Q1425.4219,551.6563 1425.6094,551.5469 Q1425.7969,551.4375 1426.0156,551.4375 Q1426.3906,551.4375 1426.625,551.6953 Q1426.8594,551.9531 1426.8594,552.5625 L1426.8594,554.0156 Q1426.8594,554.625 1426.625,554.8906 Q1426.3906,555.1563 1426.0156,555.1563 Q1425.6719,555.1563 1425.4688,554.9531 Q1425.2656,554.7656 1425.1563,554.25 Q1425.1094,553.8906 1424.9219,553.7031 Q1424.5938,553.3281 1423.9844,553.1094 Q1423.375,552.8906 1422.75,552.8906 Q1421.9844,552.8906 1421.3516,553.2188 Q1420.7188,553.5469 1420.2266,554.2969 Q1419.7344,555.0469 1419.7344,556.0781 L1419.7344,557.1719 Q1419.7344,558.4063 1420.625,559.2266 Q1421.5156,560.0469 1423.1094,560.0469 Q1424.0469,560.0469 1424.7031,559.7969 Q1425.0938,559.6406 1425.5156,559.2031 Q1425.7813,558.9375 1425.9297,558.8594 Q1426.0781,558.7813 1426.2813,558.7813 Q1426.6094,558.7813 1426.8672,559.0391 Q1427.125,559.2969 1427.125,559.6406 Q1427.125,559.9844 1426.7813,560.3906 Q1426.2813,560.9688 1425.4844,561.2969 Q1424.4063,561.75 1423.1094,561.75 Q1421.5938,561.75 1420.3906,561.125 Q1419.4063,560.625 1418.7188,559.5547 Q1418.0313,558.4844 1418.0313,557.2031 L1418.0313,556.0469 Q1418.0313,554.7188 1418.6484,553.5703 Q1419.2656,552.4219 1420.3594,551.8047 Q1421.4531,551.1875 1422.6875,551.1875 Q1423.4219,551.1875 1424.0703,551.3516 Q1424.7188,551.5156 1425.2656,551.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="1441.5" y="561.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="1386" x2="1549" y1="572" y2="572"/><ellipse cx="1396" cy="586.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1405" y="590.5332">ID : int</text><ellipse cx="1396" cy="603.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="1405" y="608.1426">UserID : int</text><ellipse cx="1396" cy="621.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1405" y="625.752">IP : string</text><ellipse cx="1396" cy="639.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="1405" y="643.3613">UserAgent : string</text><ellipse cx="1396" cy="656.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1405" y="660.9707">Successful : bool</text><ellipse cx="1396" cy="674.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1405" y="678.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="1386" x2="1549" y1="685.6563" y2="685.6563"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="143" fill="#F1F1F1" height="153.6563" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="580" x="3885.5" y="51"/><ellipse cx="4145.75" cy="67" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4148.5156,62.875 Q4148.6719,62.6563 4148.8594,62.5469 Q4149.0469,62.4375 4149.2656,62.4375 Q4149.6406,62.4375 4149.875,62.6953 Q4150.1094,62.9531 4150.1094,63.5625 L4150.1094,65.0156 Q4150.1094,65.625 4149.875,65.8906 Q4149.6406,66.1563 4149.2656,66.1563 Q4148.9219,66.1563 4148.7188,65.9531 Q4148.5156,65.7656 4148.4063,65.25 Q4148.3594,64.8906 4148.1719,64.7031 Q4147.8438,64.3281 4147.2344,64.1094 Q4146.625,63.8906 4146,63.8906 Q4145.2344,63.8906 4144.6016,64.2188 Q4143.9688,64.5469 4143.4766,65.2969 Q4142.9844,66.0469 4142.9844,67.0781 L4142.9844,68.1719 Q4142.9844,69.4063 4143.875,70.2266 Q4144.7656,71.0469 4146.3594,71.0469 Q4147.2969,71.0469 4147.9531,70.7969 Q4148.3438,70.6406 4148.7656,70.2031 Q4149.0313,69.9375 4149.1797,69.8594 Q4149.3281,69.7813 4149.5313,69.7813 Q4149.8594,69.7813 4150.1172,70.0391 Q4150.375,70.2969 4150.375,70.6406 Q4150.375,70.9844 4150.0313,71.3906 Q4149.5313,71.9688 4148.7344,72.2969 Q4147.6563,72.75 4146.3594,72.75 Q4144.8438,72.75 4143.6406,72.125 Q4142.6563,71.625 4141.9688,70.5547 Q4141.2813,69.4844 4141.2813,68.2031 L4141.2813,67.0469 Q4141.2813,65.7188 4141.8984,64.5703 Q4142.5156,63.4219 4143.6094,62.8047 Q4144.7031,62.1875 4145.9375,62.1875 Q4146.6719,62.1875 4147.3203,62.3516 Q4147.9688,62.5156 4148.5156,62.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="4166.25" y="72.7285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="3886.5" x2="4464.5" y1="83" y2="83"/><line style="stroke:#181818;stroke-width:1.0;" x1="3886.5" x2="4464.5" y1="91" y2="91"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3893.5" y="102.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="253" x="3905.5" y="109.5332">ComputeHash(password : string) : string</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3893.5" y="119.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="321" x="3905.5" y="127.1426">HashPassword(password : salt, salt : string) : string</text><ellipse cx="3896.5" cy="140.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="3905.5" y="144.752">GetSalt(saltLength : int) : string</text><ellipse cx="3896.5" cy="158.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="554" x="3905.5" y="162.3613">GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string</text><ellipse cx="3896.5" cy="175.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="3905.5" y="179.9707">GetHotp(key : string, counter : long) : string</text><ellipse cx="3896.5" cy="193.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="3905.5" y="197.5801">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="153" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4500.5" y="95"/><ellipse cx="4649.75" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4652.5156,106.875 Q4652.6719,106.6563 4652.8594,106.5469 Q4653.0469,106.4375 4653.2656,106.4375 Q4653.6406,106.4375 4653.875,106.6953 Q4654.1094,106.9531 4654.1094,107.5625 L4654.1094,109.0156 Q4654.1094,109.625 4653.875,109.8906 Q4653.6406,110.1563 4653.2656,110.1563 Q4652.9219,110.1563 4652.7188,109.9531 Q4652.5156,109.7656 4652.4063,109.25 Q4652.3594,108.8906 4652.1719,108.7031 Q4651.8438,108.3281 4651.2344,108.1094 Q4650.625,107.8906 4650,107.8906 Q4649.2344,107.8906 4648.6016,108.2188 Q4647.9688,108.5469 4647.4766,109.2969 Q4646.9844,110.0469 4646.9844,111.0781 L4646.9844,112.1719 Q4646.9844,113.4063 4647.875,114.2266 Q4648.7656,115.0469 4650.3594,115.0469 Q4651.2969,115.0469 4651.9531,114.7969 Q4652.3438,114.6406 4652.7656,114.2031 Q4653.0313,113.9375 4653.1797,113.8594 Q4653.3281,113.7813 4653.5313,113.7813 Q4653.8594,113.7813 4654.1172,114.0391 Q4654.375,114.2969 4654.375,114.6406 Q4654.375,114.9844 4654.0313,115.3906 Q4653.5313,115.9688 4652.7344,116.2969 Q4651.6563,116.75 4650.3594,116.75 Q4648.8438,116.75 4647.6406,116.125 Q4646.6563,115.625 4645.9688,114.5547 Q4645.2813,113.4844 4645.2813,112.2031 L4645.2813,111.0469 Q4645.2813,109.7188 4645.8984,108.5703 Q4646.5156,107.4219 4647.6094,106.8047 Q4648.7031,106.1875 4649.9375,106.1875 Q4650.6719,106.1875 4651.3203,106.3516 Q4651.9688,106.5156 4652.5156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="4670.25" y="116.7285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4501.5" x2="4887.5" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="4501.5" x2="4887.5" y1="135" y2="135"/><ellipse cx="4511.5" cy="149.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="4520.5" y="153.5332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="173" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1856.5" y="754"/><ellipse cx="1921.75" cy="770" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1924.5156,765.875 Q1924.6719,765.6563 1924.8594,765.5469 Q1925.0469,765.4375 1925.2656,765.4375 Q1925.6406,765.4375 1925.875,765.6953 Q1926.1094,765.9531 1926.1094,766.5625 L1926.1094,768.0156 Q1926.1094,768.625 1925.875,768.8906 Q1925.6406,769.1563 1925.2656,769.1563 Q1924.9219,769.1563 1924.7188,768.9531 Q1924.5156,768.7656 1924.4063,768.25 Q1924.3594,767.8906 1924.1719,767.7031 Q1923.8438,767.3281 1923.2344,767.1094 Q1922.625,766.8906 1922,766.8906 Q1921.2344,766.8906 1920.6016,767.2188 Q1919.9688,767.5469 1919.4766,768.2969 Q1918.9844,769.0469 1918.9844,770.0781 L1918.9844,771.1719 Q1918.9844,772.4063 1919.875,773.2266 Q1920.7656,774.0469 1922.3594,774.0469 Q1923.2969,774.0469 1923.9531,773.7969 Q1924.3438,773.6406 1924.7656,773.2031 Q1925.0313,772.9375 1925.1797,772.8594 Q1925.3281,772.7813 1925.5313,772.7813 Q1925.8594,772.7813 1926.1172,773.0391 Q1926.375,773.2969 1926.375,773.6406 Q1926.375,773.9844 1926.0313,774.3906 Q1925.5313,774.9688 1924.7344,775.2969 Q1923.6563,775.75 1922.3594,775.75 Q1920.8438,775.75 1919.6406,775.125 Q1918.6563,774.625 1917.9688,773.5547 Q1917.2813,772.4844 1917.2813,771.2031 L1917.2813,770.0469 Q1917.2813,768.7188 1917.8984,767.5703 Q1918.5156,766.4219 1919.6094,765.8047 Q1920.7031,765.1875 1921.9375,765.1875 Q1922.6719,765.1875 1923.3203,765.3516 Q1923.9688,765.5156 1924.5156,765.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1942.25" y="775.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="1857.5" x2="2023.5" y1="786" y2="786"/><ellipse cx="1867.5" cy="800.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1876.5" y="804.5332">ID : int</text><ellipse cx="1867.5" cy="817.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1876.5" y="822.1426">IsVerified : bool</text><ellipse cx="1867.5" cy="835.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1876.5" y="839.752">IsLocked : bool</text><ellipse cx="1867.5" cy="853.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1876.5" y="857.3613">FailedTries : int</text><ellipse cx="1867.5" cy="870.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="1876.5" y="874.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1857.5" x2="2023.5" y1="882.0469" y2="882.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="193" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="1562" y="950"/><ellipse cx="1608.75" cy="966" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1611.5156,961.875 Q1611.6719,961.6563 1611.8594,961.5469 Q1612.0469,961.4375 1612.2656,961.4375 Q1612.6406,961.4375 1612.875,961.6953 Q1613.1094,961.9531 1613.1094,962.5625 L1613.1094,964.0156 Q1613.1094,964.625 1612.875,964.8906 Q1612.6406,965.1563 1612.2656,965.1563 Q1611.9219,965.1563 1611.7188,964.9531 Q1611.5156,964.7656 1611.4063,964.25 Q1611.3594,963.8906 1611.1719,963.7031 Q1610.8438,963.3281 1610.2344,963.1094 Q1609.625,962.8906 1609,962.8906 Q1608.2344,962.8906 1607.6016,963.2188 Q1606.9688,963.5469 1606.4766,964.2969 Q1605.9844,965.0469 1605.9844,966.0781 L1605.9844,967.1719 Q1605.9844,968.4063 1606.875,969.2266 Q1607.7656,970.0469 1609.3594,970.0469 Q1610.2969,970.0469 1610.9531,969.7969 Q1611.3438,969.6406 1611.7656,969.2031 Q1612.0313,968.9375 1612.1797,968.8594 Q1612.3281,968.7813 1612.5313,968.7813 Q1612.8594,968.7813 1613.1172,969.0391 Q1613.375,969.2969 1613.375,969.6406 Q1613.375,969.9844 1613.0313,970.3906 Q1612.5313,970.9688 1611.7344,971.2969 Q1610.6563,971.75 1609.3594,971.75 Q1607.8438,971.75 1606.6406,971.125 Q1605.6563,970.625 1604.9688,969.5547 Q1604.2813,968.4844 1604.2813,967.2031 L1604.2813,966.0469 Q1604.2813,964.7188 1604.8984,963.5703 Q1605.5156,962.4219 1606.6094,961.8047 Q1607.7031,961.1875 1608.9375,961.1875 Q1609.6719,961.1875 1610.3203,961.3516 Q1610.9688,961.5156 1611.5156,961.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1629.25" y="971.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="1563" x2="1724" y1="982" y2="982"/><ellipse cx="1573" cy="996.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1582" y="1000.5332">Email : string</text><ellipse cx="1573" cy="1013.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1582" y="1018.1426">FirstName : string</text><ellipse cx="1573" cy="1031.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1582" y="1035.752">LastName : string</text><ellipse cx="1573" cy="1049.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1582" y="1053.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1563" x2="1724" y1="1060.4375" y2="1060.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="19" d="M835.5,226.98 C835.5,263.34 835.5,303.4 835.5,335.12 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="835.5,213.78,831.5,219.78,835.5,225.78,839.5,219.78,835.5,213.78" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="20" d="M646.68,219.31 C559.45,261.03 459.23,308.97 386.04,343.98 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="658.63,213.6,651.492,212.5756,647.801,218.7705,654.939,219.7949,658.63,213.6" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="74" d="M933.05,453.55 C1083.77,543.25 1368.71,712.81 1491.62,785.96 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1496.28,788.73,1490.589,780.6918,1491.9825,786.1743,1486.5,787.5678,1496.28,788.73" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="75" d="M835.5,453.72 C835.5,490.06 835.5,536.17 835.5,569.95 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="835.5,575.26,839.5,566.26,835.5,570.26,831.5,566.26,835.5,575.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="76" d="M1876.28,227.32 C1826.7,235.03 1777.24,242.37 1729.5,249 C1485.94,282.81 1421.65,266.24 1179.5,309 C1144.75,315.14 1108.3,322.76 1072.66,330.91 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1074.02,337.78,1052.95,335.48,1070.85,324.14,1074.02,337.78" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="78" d="M2519.09,260.56 C2528.86,276.92 2538.64,293.3 2547.83,308.68 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2512.33,249.25,2511.9721,256.4522,2518.4826,259.5527,2518.8405,252.3505,2512.33,249.25" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="79" d="M2248.91,256.33 C2202.05,287.47 2154.64,318.98 2117.09,343.93 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2259.84,249.06,2252.6289,249.0446,2249.8412,255.6951,2257.0523,255.7105,2259.84,249.06" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="80" d="M2746.81,254.03 C2844.22,293.79 2943.76,334.42 3010.09,361.49 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2734.64,249.06,2738.684,255.0304,2745.7505,253.5938,2741.7066,247.6234,2734.64,249.06" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="82" d="M274.89,169.75 C276.28,210.7 278.46,274.62 280.12,323.67 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="287.12,323.45,280.8,343.68,273.13,323.93,287.12,323.45" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="83" d="M282.5,458.46 C282.5,492.72 282.5,534.5 282.5,566.42 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="282.5,445.26,278.5,451.26,282.5,457.26,286.5,451.26,282.5,445.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="86" d="M1569.31,169.6 C1662.81,213.84 1813.19,285 1919.29,335.2 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1922.49,328.97,1937.57,343.85,1916.5,341.63,1922.49,328.97" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="87" d="M1480.25,182.75 C1477.4,229.85 1473.29,297.78 1470.51,343.68 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1481.04,169.75,1476.6845,175.4972,1480.3145,181.728,1484.6699,175.9809,1481.04,169.75" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="132" d="M2412.48,485.85 C2356.95,512.82 2298.03,541.43 2249.63,564.94 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2424.27,480.12,2417.1256,479.1412,2413.4743,485.3595,2420.6186,486.3383,2424.27,480.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="133" d="M1467.5,458.45 C1467.5,483.73 1467.5,513.1 1467.5,539.58 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1467.5,445.26,1463.5,451.26,1467.5,457.26,1471.5,451.26,1467.5,445.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="135" d="M3599.06,161.03 C3551.06,185.77 3482.49,220.49 3421.5,249 C3342.35,286.01 3251.26,325.31 3184.38,353.57 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3186.91,360.1,3165.76,361.42,3181.47,347.2,3186.91,360.1" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="136" d="M3662.57,161.17 C3665.14,201.19 3669.6,270.65 3672.98,323.23 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3679.99,323.11,3674.29,343.52,3666.02,324.01,3679.99,323.11" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="138" d="M3182.28,169.55 C3137.28,194.27 3077.46,225.52 3022.5,249 C2973.46,269.95 2920.26,290.05 2868.66,308.25 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2870.92,314.87,2849.73,314.86,2866.3,301.66,2870.92,314.87" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="139" d="M3318.82,169.75 C3388.83,213.42 3500.7,283.21 3580.89,333.23 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3584.74,327.38,3598,343.91,3577.33,339.26,3584.74,327.38" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="160" d="M1856.19,875.52 C1820.73,897.61 1779.22,923.46 1742.34,946.43 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1745.88,952.47,1725.21,957.11,1738.48,940.59,1745.88,952.47" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="161" d="M1566.7,855.22 C1577.31,876.34 1591.66,904.87 1605.07,931.56 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1611.43,928.62,1614.16,949.63,1598.92,934.91,1611.43,928.62" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="163" d="M2077.14,685.03 C2059.65,702.44 2040.61,721.38 2022.46,739.44 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2027.25,744.55,2008.14,753.69,2017.38,734.62,2027.25,744.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8c1e11a5dffd961cd3239674a4bca188]
@startuml API class diagram

top to bottom direction

'Controllers'

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
}

'Controllers mappings' 

UserController o- - IUserManager
UserController o- - ITokenManager

'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger<UserManager>
    -_configuration : IConfiguration
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}


'Managers mappings'

IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

'Utility'

class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction


class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
}


UserController o- - IUserManager
UserController o- - ITokenManager


Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger<UserManager>
    -_configuration : IConfiguration
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}



IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider


class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>