<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="440px" preserveAspectRatio="none" style="width:676px;height:440px;background:#FFFFFF;" version="1.1" viewBox="0 0 676 440" width="676px" zoomAndPan="magnify"><defs/><g><!--MD5=[c440d0ec62d52438887050ab68cf2994]
class up--><g id="elem_up"><rect codeLine="2" fill="#F1F1F1" height="118.4375" id="up" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="7" y="271"/><ellipse cx="57.75" cy="287" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M56.6094,287.7969 L56.6094,290.2969 L60.9375,290.2969 L60.9375,289.375 Q60.9375,288.7656 61.1797,288.5 Q61.4219,288.2344 61.7969,288.2344 Q62.1719,288.2344 62.4063,288.5 Q62.6406,288.7656 62.6406,289.375 L62.6406,292 L54.6406,292 Q54.0156,292 53.7578,291.7656 Q53.5,291.5313 53.5,291.1406 Q53.5,290.7656 53.7656,290.5313 Q54.0313,290.2969 54.6406,290.2969 L54.9063,290.2969 L54.9063,283.6406 L54.6406,283.6406 Q54.0156,283.6406 53.7578,283.4063 Q53.5,283.1719 53.5,282.7813 Q53.5,282.4063 53.7578,282.1719 Q54.0156,281.9375 54.6406,281.9375 L62.2656,281.9375 L62.2656,284.5313 Q62.2656,285.1406 62.0391,285.3984 Q61.8125,285.6563 61.4219,285.6563 Q61.0469,285.6563 60.8125,285.3984 Q60.5781,285.1406 60.5781,284.5313 L60.5781,283.6406 L56.6094,283.6406 L56.6094,286.0938 L58.0938,286.0938 Q58.0938,285.4375 58.2188,285.25 Q58.4844,284.8438 58.9531,284.8438 Q59.3281,284.8438 59.5625,285.1016 Q59.7969,285.3594 59.7969,285.9688 L59.7969,287.9375 Q59.7969,288.4844 59.6719,288.6719 Q59.4063,289.0625 58.9531,289.0625 Q58.4844,289.0625 58.2188,288.6563 Q58.0938,288.4688 58.0938,287.7969 L56.6094,287.7969 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="78.25" y="292.7285">UserPasswords</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="213" y1="303" y2="303"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="13" y="321.5332">ID int (PK)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="13" y="339.1426">UsersID int (FK)</text><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="213" y1="346.2188" y2="346.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195" x="13" y="364.752">HashedPassword varchar(200)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="13" y="382.3613">Salt varchar(200)</text></g><!--MD5=[4d6f8c8df43efd645c0c3f3cbca1116d]
class sk--><g id="elem_sk"><rect codeLine="10" fill="#F1F1F1" height="136.0469" id="sk" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188" x="261.5" y="7"/><ellipse cx="291.35" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M290.2094,23.7969 L290.2094,26.2969 L294.5375,26.2969 L294.5375,25.375 Q294.5375,24.7656 294.7797,24.5 Q295.0219,24.2344 295.3969,24.2344 Q295.7719,24.2344 296.0063,24.5 Q296.2406,24.7656 296.2406,25.375 L296.2406,28 L288.2406,28 Q287.6156,28 287.3578,27.7656 Q287.1,27.5313 287.1,27.1406 Q287.1,26.7656 287.3656,26.5313 Q287.6313,26.2969 288.2406,26.2969 L288.5063,26.2969 L288.5063,19.6406 L288.2406,19.6406 Q287.6156,19.6406 287.3578,19.4063 Q287.1,19.1719 287.1,18.7813 Q287.1,18.4063 287.3578,18.1719 Q287.6156,17.9375 288.2406,17.9375 L295.8656,17.9375 L295.8656,20.5313 Q295.8656,21.1406 295.6391,21.3984 Q295.4125,21.6563 295.0219,21.6563 Q294.6469,21.6563 294.4125,21.3984 Q294.1781,21.1406 294.1781,20.5313 L294.1781,19.6406 L290.2094,19.6406 L290.2094,22.0938 L291.6938,22.0938 Q291.6938,21.4375 291.8188,21.25 Q292.0844,20.8438 292.5531,20.8438 Q292.9281,20.8438 293.1625,21.1016 Q293.3969,21.3594 293.3969,21.9688 L293.3969,23.9375 Q293.3969,24.4844 293.2719,24.6719 Q293.0063,25.0625 292.5531,25.0625 Q292.0844,25.0625 291.8188,24.6563 Q291.6938,24.4688 291.6938,23.7969 L290.2094,23.7969 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="308.65" y="28.7285">SecretKeyCounters</text><line style="stroke:#181818;stroke-width:0.5;" x1="262.5" x2="448.5" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="267.5" y="57.5332">ID int (PK)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="267.5" y="75.1426">UsersID int (FK)</text><line style="stroke:#181818;stroke-width:1.0;" x1="262.5" x2="448.5" y1="82.2188" y2="82.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151" x="267.5" y="100.752">SecretKey varchar(200)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="267.5" y="118.3613">Counter BIGINT</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176" x="267.5" y="135.9707">LastRequestDate : datetime</text></g><!--MD5=[09a5b4adb0ee554eafb73b413209c7bf]
class Users--><g id="elem_Users"><rect codeLine="19" fill="#F1F1F1" height="206.4844" id="Users" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="180" x="265.5" y="227"/><ellipse cx="333.25" cy="243" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M332.1094,243.7969 L332.1094,246.2969 L336.4375,246.2969 L336.4375,245.375 Q336.4375,244.7656 336.6797,244.5 Q336.9219,244.2344 337.2969,244.2344 Q337.6719,244.2344 337.9063,244.5 Q338.1406,244.7656 338.1406,245.375 L338.1406,248 L330.1406,248 Q329.5156,248 329.2578,247.7656 Q329,247.5313 329,247.1406 Q329,246.7656 329.2656,246.5313 Q329.5313,246.2969 330.1406,246.2969 L330.4063,246.2969 L330.4063,239.6406 L330.1406,239.6406 Q329.5156,239.6406 329.2578,239.4063 Q329,239.1719 329,238.7813 Q329,238.4063 329.2578,238.1719 Q329.5156,237.9375 330.1406,237.9375 L337.7656,237.9375 L337.7656,240.5313 Q337.7656,241.1406 337.5391,241.3984 Q337.3125,241.6563 336.9219,241.6563 Q336.5469,241.6563 336.3125,241.3984 Q336.0781,241.1406 336.0781,240.5313 L336.0781,239.6406 L332.1094,239.6406 L332.1094,242.0938 L333.5938,242.0938 Q333.5938,241.4375 333.7188,241.25 Q333.9844,240.8438 334.4531,240.8438 Q334.8281,240.8438 335.0625,241.1016 Q335.2969,241.3594 335.2969,241.9688 L335.2969,243.9375 Q335.2969,244.4844 335.1719,244.6719 Q334.9063,245.0625 334.4531,245.0625 Q333.9844,245.0625 333.7188,244.6563 Q333.5938,244.4688 333.5938,243.7969 L332.1094,243.7969 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="353.75" y="248.7285">Users</text><line style="stroke:#181818;stroke-width:0.5;" x1="266.5" x2="444.5" y1="259" y2="259"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="271.5" y="277.5332">ID int (PK)</text><line style="stroke:#181818;stroke-width:1.0;" x1="266.5" x2="444.5" y1="284.6094" y2="284.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="271.5" y="303.1426">Email varchar(100)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="271.5" y="320.752">IsVerified bit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="271.5" y="338.3613">FirstName varchar(50)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="271.5" y="355.9707">LastName varchar(50)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="271.5" y="373.5801">PhoneNumber varcher(20)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="271.5" y="391.1895">FailedTries int</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="271.5" y="408.7988">IsLocked bit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="271.5" y="426.4082">LockedDate datetime</text></g><!--MD5=[07e4f24bf6e57ed64741ef994efa961d]
class vul--><g id="elem_vul"><rect codeLine="31" fill="#F1F1F1" height="153.6563" id="vul" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="505.5" y="253.5"/><ellipse cx="539.4" cy="269.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M538.2594,270.2969 L538.2594,272.7969 L542.5875,272.7969 L542.5875,271.875 Q542.5875,271.2656 542.8297,271 Q543.0719,270.7344 543.4469,270.7344 Q543.8219,270.7344 544.0563,271 Q544.2906,271.2656 544.2906,271.875 L544.2906,274.5 L536.2906,274.5 Q535.6656,274.5 535.4078,274.2656 Q535.15,274.0313 535.15,273.6406 Q535.15,273.2656 535.4156,273.0313 Q535.6813,272.7969 536.2906,272.7969 L536.5563,272.7969 L536.5563,266.1406 L536.2906,266.1406 Q535.6656,266.1406 535.4078,265.9063 Q535.15,265.6719 535.15,265.2813 Q535.15,264.9063 535.4078,264.6719 Q535.6656,264.4375 536.2906,264.4375 L543.9156,264.4375 L543.9156,267.0313 Q543.9156,267.6406 543.6891,267.8984 Q543.4625,268.1563 543.0719,268.1563 Q542.6969,268.1563 542.4625,267.8984 Q542.2281,267.6406 542.2281,267.0313 L542.2281,266.1406 L538.2594,266.1406 L538.2594,268.5938 L539.7438,268.5938 Q539.7438,267.9375 539.8688,267.75 Q540.1344,267.3438 540.6031,267.3438 Q540.9781,267.3438 541.2125,267.6016 Q541.4469,267.8594 541.4469,268.4688 L541.4469,270.4375 Q541.4469,270.9844 541.3219,271.1719 Q541.0563,271.5625 540.6031,271.5625 Q540.1344,271.5625 539.8688,271.1563 Q539.7438,270.9688 539.7438,270.2969 L538.2594,270.2969 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="557.6" y="275.2285">UserLocations</text><line style="stroke:#181818;stroke-width:0.5;" x1="506.5" x2="668.5" y1="285.5" y2="285.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="511.5" y="304.0332">ID int (PK)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="511.5" y="321.6426">UsersID int</text><line style="stroke:#181818;stroke-width:1.0;" x1="506.5" x2="668.5" y1="328.7188" y2="328.7188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="511.5" y="347.252">IP string(50)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="511.5" y="364.8613">UserAgent varchar(256)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="511.5" y="382.4707">Successful bit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="511.5" y="400.0801">CreateDate datetime</text></g><!--MD5=[7580b634bffd886b36ac37643de085ea]
link Users to vul--><g id="link_Users_vul"><path codeLine="41" d="M446.5,271.5 C478.59,271.5 472.41,314.5 504.5,314.5 " fill="none" id="Users-vul" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="472" y="283.9951">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="492.4195" y="310.0364">*</text></g><!--MD5=[c7190fd7402f7f6abf89e286247c61d6]
link up to Users--><g id="link_up_Users"><path codeLine="43" d="M215.5,333.5 C250.62,333.5 229.38,271.5 264.5,271.5 " fill="none" id="up-Users" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="222.1117" y="330.7183">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="250.5602" y="264.1066">1</text></g><!--MD5=[227279f656e4e91deb38d012ba9812b7]
link sk to Users--><g id="link_sk_Users"><path codeLine="44" d="M450.5,68 C495.73,68 491.73,271.5 446.5,271.5 " fill="none" id="sk-Users" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="482.5" y="189.4951">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="457.5109" y="63.2216">1</text></g><!--MD5=[af12ad2da7df145068857caae315ef88]
@startuml ERD

entity "UserPasswords" as up{
    ID int (PK)
    UsersID int (FK)
    - -
    HashedPassword varchar(200)
    Salt varchar(200)
}

entity "SecretKeyCounters" as sk {
    ID int (PK)
    UsersID int (FK)
    - -
    SecretKey varchar(200)
    Counter BIGINT
    LastRequestDate : datetime
}

entity Users {
    ID int (PK)
    - -
    Email varchar(100)
    IsVerified bit
    FirstName varchar(50)
    LastName varchar(50)
    PhoneNumber varcher(20)
    FailedTries int
    IsLocked bit
    LockedDate datetime
}
entity "UserLocations" as vul {
    ID int (PK)
    UsersID int
    - -
    IP string(50)
    UserAgent varchar(256)
    Successful bit
    CreateDate datetime
}

Users::ID -r- "*"vul::UsersID : 1

up::UsersID "1" -r- "1"Users::ID
sk::UsersID "1" -d- Users::ID : 1


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>