<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1057px" preserveAspectRatio="none" style="width:4780px;height:1057px;background:#FFFFFF;" version="1.1" viewBox="0 0 4780 1057" width="4780px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="171.2656" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="521" x="575" y="33.5"/><ellipse cx="785.75" cy="49.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M788.5156,45.375 Q788.6719,45.1563 788.8594,45.0469 Q789.0469,44.9375 789.2656,44.9375 Q789.6406,44.9375 789.875,45.1953 Q790.1094,45.4531 790.1094,46.0625 L790.1094,47.5156 Q790.1094,48.125 789.875,48.3906 Q789.6406,48.6563 789.2656,48.6563 Q788.9219,48.6563 788.7188,48.4531 Q788.5156,48.2656 788.4063,47.75 Q788.3594,47.3906 788.1719,47.2031 Q787.8438,46.8281 787.2344,46.6094 Q786.625,46.3906 786,46.3906 Q785.2344,46.3906 784.6016,46.7188 Q783.9688,47.0469 783.4766,47.7969 Q782.9844,48.5469 782.9844,49.5781 L782.9844,50.6719 Q782.9844,51.9063 783.875,52.7266 Q784.7656,53.5469 786.3594,53.5469 Q787.2969,53.5469 787.9531,53.2969 Q788.3438,53.1406 788.7656,52.7031 Q789.0313,52.4375 789.1797,52.3594 Q789.3281,52.2813 789.5313,52.2813 Q789.8594,52.2813 790.1172,52.5391 Q790.375,52.7969 790.375,53.1406 Q790.375,53.4844 790.0313,53.8906 Q789.5313,54.4688 788.7344,54.7969 Q787.6563,55.25 786.3594,55.25 Q784.8438,55.25 783.6406,54.625 Q782.6563,54.125 781.9688,53.0547 Q781.2813,51.9844 781.2813,50.7031 L781.2813,49.5469 Q781.2813,48.2188 781.8984,47.0703 Q782.5156,45.9219 783.6094,45.3047 Q784.7031,44.6875 785.9375,44.6875 Q786.6719,44.6875 787.3203,44.8516 Q787.9688,45.0156 788.5156,45.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="806.25" y="55.2285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="576" x2="1095" y1="65.5" y2="65.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583" y="76.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="595" y="84.0332">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583" y="94.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="595" y="101.6426">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:1.0;" x1="576" x2="1095" y1="108.7188" y2="108.7188"/><ellipse cx="586" cy="123.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="595" y="127.252">UserController(userManager : IUserManager, tokenManager : ITokenManager)</text><ellipse cx="586" cy="140.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="595" y="144.8613">Create(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="158.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="595" y="162.4707">Login(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="175.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="318" x="595" y="180.0801">GetUserFromToken() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="586" cy="193.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="477" x="595" y="197.6895">VerificationLogin(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="24" fill="#F1F1F1" height="118.4375" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="653" x="509" y="317.5"/><ellipse cx="785.75" cy="333.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M786.7031,330.1406 L786.7031,336.7969 L788.4219,336.7969 Q789.0313,336.7969 789.2969,337.0313 Q789.5625,337.2656 789.5625,337.6563 Q789.5625,338.0313 789.2969,338.2656 Q789.0313,338.5 788.4219,338.5 L783.2813,338.5 Q782.6719,338.5 782.4063,338.2656 Q782.1406,338.0313 782.1406,337.6406 Q782.1406,337.2656 782.4063,337.0313 Q782.6719,336.7969 783.2813,336.7969 L785,336.7969 L785,330.1406 L783.2813,330.1406 Q782.6719,330.1406 782.4063,329.9063 Q782.1406,329.6719 782.1406,329.2813 Q782.1406,328.9063 782.4063,328.6719 Q782.6719,328.4375 783.2813,328.4375 L788.4219,328.4375 Q789.0313,328.4375 789.2969,328.6719 Q789.5625,328.9063 789.5625,329.2813 Q789.5625,329.6719 789.2969,329.9063 Q789.0313,330.1406 788.4219,330.1406 L786.7031,330.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="806.25" y="339.2285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="510" x2="1161" y1="349.5" y2="349.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="510" x2="1161" y1="357.5" y2="357.5"/><ellipse cx="520" cy="371.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="363" x="529" y="376.0332">CreateUserAsync(userCreate : UserCreate) : Task&lt;User&gt;</text><ellipse cx="520" cy="389.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="529" y="393.6426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="520" cy="407.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="529" y="411.252">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="520" cy="424.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="627" x="529" y="428.8613">LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="31" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="100.5" y="326"/><ellipse cx="227.25" cy="342" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M228.2031,338.6406 L228.2031,345.2969 L229.9219,345.2969 Q230.5313,345.2969 230.7969,345.5313 Q231.0625,345.7656 231.0625,346.1563 Q231.0625,346.5313 230.7969,346.7656 Q230.5313,347 229.9219,347 L224.7813,347 Q224.1719,347 223.9063,346.7656 Q223.6406,346.5313 223.6406,346.1406 Q223.6406,345.7656 223.9063,345.5313 Q224.1719,345.2969 224.7813,345.2969 L226.5,345.2969 L226.5,338.6406 L224.7813,338.6406 Q224.1719,338.6406 223.9063,338.4063 Q223.6406,338.1719 223.6406,337.7813 Q223.6406,337.4063 223.9063,337.1719 Q224.1719,336.9375 224.7813,336.9375 L229.9219,336.9375 Q230.5313,336.9375 230.7969,337.1719 Q231.0625,337.4063 231.0625,337.7813 Q231.0625,338.1719 230.7969,338.4063 Q230.5313,338.6406 229.9219,338.6406 L228.2031,338.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="247.75" y="347.7285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="101.5" x2="463.5" y1="358" y2="358"/><line style="stroke:#181818;stroke-width:0.5;" x1="101.5" x2="463.5" y1="366" y2="366"/><ellipse cx="111.5" cy="380.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="120.5" y="384.5332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="111.5" cy="397.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="120.5" y="402.1426">ValidateToken(token : string) : bool</text><ellipse cx="111.5" cy="415.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="120.5" y="419.752">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="38" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1772.5" y="326"/><ellipse cx="1965.75" cy="342" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1966.7031,338.6406 L1966.7031,345.2969 L1968.4219,345.2969 Q1969.0313,345.2969 1969.2969,345.5313 Q1969.5625,345.7656 1969.5625,346.1563 Q1969.5625,346.5313 1969.2969,346.7656 Q1969.0313,347 1968.4219,347 L1963.2813,347 Q1962.6719,347 1962.4063,346.7656 Q1962.1406,346.5313 1962.1406,346.1406 Q1962.1406,345.7656 1962.4063,345.5313 Q1962.6719,345.2969 1963.2813,345.2969 L1965,345.2969 L1965,338.6406 L1963.2813,338.6406 Q1962.6719,338.6406 1962.4063,338.4063 Q1962.1406,338.1719 1962.1406,337.7813 Q1962.1406,337.4063 1962.4063,337.1719 Q1962.6719,336.9375 1963.2813,336.9375 L1968.4219,336.9375 Q1969.0313,336.9375 1969.2969,337.1719 Q1969.5625,337.4063 1969.5625,337.7813 Q1969.5625,338.1719 1969.2969,338.4063 Q1969.0313,338.6406 1968.4219,338.6406 L1966.7031,338.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="1986.25" y="347.7285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1773.5" x2="2311.5" y1="358" y2="358"/><line style="stroke:#181818;stroke-width:0.5;" x1="1773.5" x2="2311.5" y1="366" y2="366"/><ellipse cx="1783.5" cy="380.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1792.5" y="384.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1783.5" cy="397.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="1792.5" y="402.1426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1783.5" cy="415.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1792.5" y="419.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="44" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="77.5"/><ellipse cx="221.25" cy="93.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,89.375 Q224.1719,89.1563 224.3594,89.0469 Q224.5469,88.9375 224.7656,88.9375 Q225.1406,88.9375 225.375,89.1953 Q225.6094,89.4531 225.6094,90.0625 L225.6094,91.5156 Q225.6094,92.125 225.375,92.3906 Q225.1406,92.6563 224.7656,92.6563 Q224.4219,92.6563 224.2188,92.4531 Q224.0156,92.2656 223.9063,91.75 Q223.8594,91.3906 223.6719,91.2031 Q223.3438,90.8281 222.7344,90.6094 Q222.125,90.3906 221.5,90.3906 Q220.7344,90.3906 220.1016,90.7188 Q219.4688,91.0469 218.9766,91.7969 Q218.4844,92.5469 218.4844,93.5781 L218.4844,94.6719 Q218.4844,95.9063 219.375,96.7266 Q220.2656,97.5469 221.8594,97.5469 Q222.7969,97.5469 223.4531,97.2969 Q223.8438,97.1406 224.2656,96.7031 Q224.5313,96.4375 224.6797,96.3594 Q224.8281,96.2813 225.0313,96.2813 Q225.3594,96.2813 225.6172,96.5391 Q225.875,96.7969 225.875,97.1406 Q225.875,97.4844 225.5313,97.8906 Q225.0313,98.4688 224.2344,98.7969 Q223.1563,99.25 221.8594,99.25 Q220.3438,99.25 219.1406,98.625 Q218.1563,98.125 217.4688,97.0547 Q216.7813,95.9844 216.7813,94.7031 L216.7813,93.5469 Q216.7813,92.2188 217.3984,91.0703 Q218.0156,89.9219 219.1094,89.3047 Q220.2031,88.6875 221.4375,88.6875 Q222.1719,88.6875 222.8203,88.8516 Q223.4688,89.0156 224.0156,89.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="99.2285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="109.5" y2="109.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="539" y1="117.5" y2="117.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="128.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="136.0332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="146.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="153.6426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="50" fill="#F1F1F1" height="224.0938" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="938" x="1961.5" y="7"/><ellipse cx="2383.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2386.5156,18.875 Q2386.6719,18.6563 2386.8594,18.5469 Q2387.0469,18.4375 2387.2656,18.4375 Q2387.6406,18.4375 2387.875,18.6953 Q2388.1094,18.9531 2388.1094,19.5625 L2388.1094,21.0156 Q2388.1094,21.625 2387.875,21.8906 Q2387.6406,22.1563 2387.2656,22.1563 Q2386.9219,22.1563 2386.7188,21.9531 Q2386.5156,21.7656 2386.4063,21.25 Q2386.3594,20.8906 2386.1719,20.7031 Q2385.8438,20.3281 2385.2344,20.1094 Q2384.625,19.8906 2384,19.8906 Q2383.2344,19.8906 2382.6016,20.2188 Q2381.9688,20.5469 2381.4766,21.2969 Q2380.9844,22.0469 2380.9844,23.0781 L2380.9844,24.1719 Q2380.9844,25.4063 2381.875,26.2266 Q2382.7656,27.0469 2384.3594,27.0469 Q2385.2969,27.0469 2385.9531,26.7969 Q2386.3438,26.6406 2386.7656,26.2031 Q2387.0313,25.9375 2387.1797,25.8594 Q2387.3281,25.7813 2387.5313,25.7813 Q2387.8594,25.7813 2388.1172,26.0391 Q2388.375,26.2969 2388.375,26.6406 Q2388.375,26.9844 2388.0313,27.3906 Q2387.5313,27.9688 2386.7344,28.2969 Q2385.6563,28.75 2384.3594,28.75 Q2382.8438,28.75 2381.6406,28.125 Q2380.6563,27.625 2379.9688,26.5547 Q2379.2813,25.4844 2379.2813,24.2031 L2379.2813,23.0469 Q2379.2813,21.7188 2379.8984,20.5703 Q2380.5156,19.4219 2381.6094,18.8047 Q2382.7031,18.1875 2383.9375,18.1875 Q2384.6719,18.1875 2385.3203,18.3516 Q2385.9688,18.5156 2386.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="2404.25" y="28.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1962.5" x2="2898.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1969.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="1981.5" y="57.5332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1969.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="1981.5" y="75.1426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1969.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="1981.5" y="92.752">_userLocationManager : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1969.5" y="103.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="1981.5" y="110.3613">_messageService : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1969.5" y="120.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="1981.5" y="127.9707">_messageProvider : IMessageProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1969.5" y="138.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="1981.5" y="145.5801">_logger : ILogger&lt;UserManager&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1969.5" y="155.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438" x="1981.5" y="163.1895">IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool</text><line style="stroke:#181818;stroke-width:1.0;" x1="1962.5" x2="2898.5" y1="170.2656" y2="170.2656"/><ellipse cx="1972.5" cy="184.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="912" x="1981.5" y="188.7988">UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="680" x="1981.5" y="206.4082">messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger&lt;UserManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1969.5" y="216.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="402" x="1981.5" y="224.0176">CheckPasswordLeakedForUser(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="64" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="458" x="1269.5" y="77.5"/><ellipse cx="1424.75" cy="93.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1427.5156,89.375 Q1427.6719,89.1563 1427.8594,89.0469 Q1428.0469,88.9375 1428.2656,88.9375 Q1428.6406,88.9375 1428.875,89.1953 Q1429.1094,89.4531 1429.1094,90.0625 L1429.1094,91.5156 Q1429.1094,92.125 1428.875,92.3906 Q1428.6406,92.6563 1428.2656,92.6563 Q1427.9219,92.6563 1427.7188,92.4531 Q1427.5156,92.2656 1427.4063,91.75 Q1427.3594,91.3906 1427.1719,91.2031 Q1426.8438,90.8281 1426.2344,90.6094 Q1425.625,90.3906 1425,90.3906 Q1424.2344,90.3906 1423.6016,90.7188 Q1422.9688,91.0469 1422.4766,91.7969 Q1421.9844,92.5469 1421.9844,93.5781 L1421.9844,94.6719 Q1421.9844,95.9063 1422.875,96.7266 Q1423.7656,97.5469 1425.3594,97.5469 Q1426.2969,97.5469 1426.9531,97.2969 Q1427.3438,97.1406 1427.7656,96.7031 Q1428.0313,96.4375 1428.1797,96.3594 Q1428.3281,96.2813 1428.5313,96.2813 Q1428.8594,96.2813 1429.1172,96.5391 Q1429.375,96.7969 1429.375,97.1406 Q1429.375,97.4844 1429.0313,97.8906 Q1428.5313,98.4688 1427.7344,98.7969 Q1426.6563,99.25 1425.3594,99.25 Q1423.8438,99.25 1422.6406,98.625 Q1421.6563,98.125 1420.9688,97.0547 Q1420.2813,95.9844 1420.2813,94.7031 L1420.2813,93.5469 Q1420.2813,92.2188 1420.8984,91.0703 Q1421.5156,89.9219 1422.6094,89.3047 Q1423.7031,88.6875 1424.9375,88.6875 Q1425.6719,88.6875 1426.3203,88.8516 Q1426.9688,89.0156 1427.5156,89.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1445.25" y="99.2285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1270.5" x2="1726.5" y1="109.5" y2="109.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1277.5" y="120.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="1289.5" y="128.0332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="1270.5" x2="1726.5" y1="135.1094" y2="135.1094"/><ellipse cx="1280.5" cy="149.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="432" x="1289.5" y="153.6426">UserLocationManager(userLocationProvider : UserLocationProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="187" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1483.5" y="771"/><ellipse cx="1512" cy="787" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1514.7656,782.875 Q1514.9219,782.6563 1515.1094,782.5469 Q1515.2969,782.4375 1515.5156,782.4375 Q1515.8906,782.4375 1516.125,782.6953 Q1516.3594,782.9531 1516.3594,783.5625 L1516.3594,785.0156 Q1516.3594,785.625 1516.125,785.8906 Q1515.8906,786.1563 1515.5156,786.1563 Q1515.1719,786.1563 1514.9688,785.9531 Q1514.7656,785.7656 1514.6563,785.25 Q1514.6094,784.8906 1514.4219,784.7031 Q1514.0938,784.3281 1513.4844,784.1094 Q1512.875,783.8906 1512.25,783.8906 Q1511.4844,783.8906 1510.8516,784.2188 Q1510.2188,784.5469 1509.7266,785.2969 Q1509.2344,786.0469 1509.2344,787.0781 L1509.2344,788.1719 Q1509.2344,789.4063 1510.125,790.2266 Q1511.0156,791.0469 1512.6094,791.0469 Q1513.5469,791.0469 1514.2031,790.7969 Q1514.5938,790.6406 1515.0156,790.2031 Q1515.2813,789.9375 1515.4297,789.8594 Q1515.5781,789.7813 1515.7813,789.7813 Q1516.1094,789.7813 1516.3672,790.0391 Q1516.625,790.2969 1516.625,790.6406 Q1516.625,790.9844 1516.2813,791.3906 Q1515.7813,791.9688 1514.9844,792.2969 Q1513.9063,792.75 1512.6094,792.75 Q1511.0938,792.75 1509.8906,792.125 Q1508.9063,791.625 1508.2188,790.5547 Q1507.5313,789.4844 1507.5313,788.2031 L1507.5313,787.0469 Q1507.5313,785.7188 1508.1484,784.5703 Q1508.7656,783.4219 1509.8594,782.8047 Q1510.9531,782.1875 1512.1875,782.1875 Q1512.9219,782.1875 1513.5703,782.3516 Q1514.2188,782.5156 1514.7656,782.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1529" y="792.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="1484.5" x2="1616.5" y1="803" y2="803"/><ellipse cx="1494.5" cy="817.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1503.5" y="821.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1484.5" x2="1616.5" y1="828.6094" y2="828.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="199" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="768.5" y="557.5"/><ellipse cx="800.6" cy="573.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M803.3656,569.375 Q803.5219,569.1563 803.7094,569.0469 Q803.8969,568.9375 804.1156,568.9375 Q804.4906,568.9375 804.725,569.1953 Q804.9594,569.4531 804.9594,570.0625 L804.9594,571.5156 Q804.9594,572.125 804.725,572.3906 Q804.4906,572.6563 804.1156,572.6563 Q803.7719,572.6563 803.5688,572.4531 Q803.3656,572.2656 803.2563,571.75 Q803.2094,571.3906 803.0219,571.2031 Q802.6938,570.8281 802.0844,570.6094 Q801.475,570.3906 800.85,570.3906 Q800.0844,570.3906 799.4516,570.7188 Q798.8188,571.0469 798.3266,571.7969 Q797.8344,572.5469 797.8344,573.5781 L797.8344,574.6719 Q797.8344,575.9063 798.725,576.7266 Q799.6156,577.5469 801.2094,577.5469 Q802.1469,577.5469 802.8031,577.2969 Q803.1938,577.1406 803.6156,576.7031 Q803.8813,576.4375 804.0297,576.3594 Q804.1781,576.2813 804.3813,576.2813 Q804.7094,576.2813 804.9672,576.5391 Q805.225,576.7969 805.225,577.1406 Q805.225,577.4844 804.8813,577.8906 Q804.3813,578.4688 803.5844,578.7969 Q802.5063,579.25 801.2094,579.25 Q799.6938,579.25 798.4906,578.625 Q797.5063,578.125 796.8188,577.0547 Q796.1313,575.9844 796.1313,574.7031 L796.1313,573.5469 Q796.1313,572.2188 796.7484,571.0703 Q797.3656,569.9219 798.4594,569.3047 Q799.5531,568.6875 800.7875,568.6875 Q801.5219,568.6875 802.1703,568.8516 Q802.8188,569.0156 803.3656,569.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="818.4" y="579.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="769.5" x2="901.5" y1="589.5" y2="589.5"/><ellipse cx="779.5" cy="603.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="788.5" y="608.0332">Email : string</text><ellipse cx="779.5" cy="621.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="788.5" y="625.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="769.5" x2="901.5" y1="632.7188" y2="632.7188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="89" fill="#F1F1F1" height="171.2656" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="502" x="2347.5" y="291"/><ellipse cx="2551.25" cy="307" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2552.2031,303.6406 L2552.2031,310.2969 L2553.9219,310.2969 Q2554.5313,310.2969 2554.7969,310.5313 Q2555.0625,310.7656 2555.0625,311.1563 Q2555.0625,311.5313 2554.7969,311.7656 Q2554.5313,312 2553.9219,312 L2548.7813,312 Q2548.1719,312 2547.9063,311.7656 Q2547.6406,311.5313 2547.6406,311.1406 Q2547.6406,310.7656 2547.9063,310.5313 Q2548.1719,310.2969 2548.7813,310.2969 L2550.5,310.2969 L2550.5,303.6406 L2548.7813,303.6406 Q2548.1719,303.6406 2547.9063,303.4063 Q2547.6406,303.1719 2547.6406,302.7813 Q2547.6406,302.4063 2547.9063,302.1719 Q2548.1719,301.9375 2548.7813,301.9375 L2553.9219,301.9375 Q2554.5313,301.9375 2554.7969,302.1719 Q2555.0625,302.4063 2555.0625,302.7813 Q2555.0625,303.1719 2554.7969,303.4063 Q2554.5313,303.6406 2553.9219,303.6406 L2552.2031,303.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="2571.75" y="312.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2348.5" x2="2848.5" y1="323" y2="323"/><line style="stroke:#181818;stroke-width:0.5;" x1="2348.5" x2="2848.5" y1="331" y2="331"/><ellipse cx="2358.5" cy="345.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2367.5" y="349.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="362.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2367.5" y="367.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="380.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2367.5" y="384.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="398.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="2367.5" y="402.3613">UpdateUserFailedTries(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="415.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2367.5" y="419.9707">UpdateUserLoginSuccess(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="433.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="371" x="2367.5" y="437.5801">UpdateUserLoginNewLocation(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2358.5" cy="450.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="476" x="2367.5" y="455.1895">UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="99" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="2884.5" y="343.5"/><ellipse cx="3001.75" cy="359.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3002.7031,356.1406 L3002.7031,362.7969 L3004.4219,362.7969 Q3005.0313,362.7969 3005.2969,363.0313 Q3005.5625,363.2656 3005.5625,363.6563 Q3005.5625,364.0313 3005.2969,364.2656 Q3005.0313,364.5 3004.4219,364.5 L2999.2813,364.5 Q2998.6719,364.5 2998.4063,364.2656 Q2998.1406,364.0313 2998.1406,363.6406 Q2998.1406,363.2656 2998.4063,363.0313 Q2998.6719,362.7969 2999.2813,362.7969 L3001,362.7969 L3001,356.1406 L2999.2813,356.1406 Q2998.6719,356.1406 2998.4063,355.9063 Q2998.1406,355.6719 2998.1406,355.2813 Q2998.1406,354.9063 2998.4063,354.6719 Q2998.6719,354.4375 2999.2813,354.4375 L3004.4219,354.4375 Q3005.0313,354.4375 3005.2969,354.6719 Q3005.5625,354.9063 3005.5625,355.2813 Q3005.5625,355.6719 3005.2969,355.9063 Q3005.0313,356.1406 3004.4219,356.1406 L3002.7031,356.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="3022.25" y="365.2285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2885.5" x2="3291.5" y1="375.5" y2="375.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="2885.5" x2="3291.5" y1="383.5" y2="383.5"/><ellipse cx="2895.5" cy="397.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="2904.5" y="402.0332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="165" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="226" y="548.5"/><ellipse cx="246.4" cy="564.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M249.1656,560.375 Q249.3219,560.1563 249.5094,560.0469 Q249.6969,559.9375 249.9156,559.9375 Q250.2906,559.9375 250.525,560.1953 Q250.7594,560.4531 250.7594,561.0625 L250.7594,562.5156 Q250.7594,563.125 250.525,563.3906 Q250.2906,563.6563 249.9156,563.6563 Q249.5719,563.6563 249.3688,563.4531 Q249.1656,563.2656 249.0563,562.75 Q249.0094,562.3906 248.8219,562.2031 Q248.4938,561.8281 247.8844,561.6094 Q247.275,561.3906 246.65,561.3906 Q245.8844,561.3906 245.2516,561.7188 Q244.6188,562.0469 244.1266,562.7969 Q243.6344,563.5469 243.6344,564.5781 L243.6344,565.6719 Q243.6344,566.9063 244.525,567.7266 Q245.4156,568.5469 247.0094,568.5469 Q247.9469,568.5469 248.6031,568.2969 Q248.9938,568.1406 249.4156,567.7031 Q249.6813,567.4375 249.8297,567.3594 Q249.9781,567.2813 250.1813,567.2813 Q250.5094,567.2813 250.7672,567.5391 Q251.025,567.7969 251.025,568.1406 Q251.025,568.4844 250.6813,568.8906 Q250.1813,569.4688 249.3844,569.7969 Q248.3063,570.25 247.0094,570.25 Q245.4938,570.25 244.2906,569.625 Q243.3063,569.125 242.6188,568.0547 Q241.9313,566.9844 241.9313,565.7031 L241.9313,564.5469 Q241.9313,563.2188 242.5484,562.0703 Q243.1656,560.9219 244.2594,560.3047 Q245.3531,559.6875 246.5875,559.6875 Q247.3219,559.6875 247.9703,559.8516 Q248.6188,560.0156 249.1656,560.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="261.6" y="570.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="227" x2="338" y1="580.5" y2="580.5"/><ellipse cx="237" cy="594.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="246" y="599.0332">UserID : int</text><ellipse cx="237" cy="612.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="246" y="616.6426">Email : string</text><ellipse cx="237" cy="630.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="246" y="634.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="227" x2="338" y1="641.3281" y2="641.3281"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="115" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1197.5" y="326"/><ellipse cx="1393.25" cy="342" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1394.2031,338.6406 L1394.2031,345.2969 L1395.9219,345.2969 Q1396.5313,345.2969 1396.7969,345.5313 Q1397.0625,345.7656 1397.0625,346.1563 Q1397.0625,346.5313 1396.7969,346.7656 Q1396.5313,347 1395.9219,347 L1390.7813,347 Q1390.1719,347 1389.9063,346.7656 Q1389.6406,346.5313 1389.6406,346.1406 Q1389.6406,345.7656 1389.9063,345.5313 Q1390.1719,345.2969 1390.7813,345.2969 L1392.5,345.2969 L1392.5,338.6406 L1390.7813,338.6406 Q1390.1719,338.6406 1389.9063,338.4063 Q1389.6406,338.1719 1389.6406,337.7813 Q1389.6406,337.4063 1389.9063,337.1719 Q1390.1719,336.9375 1390.7813,336.9375 L1395.9219,336.9375 Q1396.5313,336.9375 1396.7969,337.1719 Q1397.0625,337.4063 1397.0625,337.7813 Q1397.0625,338.1719 1396.7969,338.4063 Q1396.5313,338.6406 1395.9219,338.6406 L1394.2031,338.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="1413.75" y="347.7285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1198.5" x2="1736.5" y1="358" y2="358"/><line style="stroke:#181818;stroke-width:0.5;" x1="1198.5" x2="1736.5" y1="366" y2="366"/><ellipse cx="1208.5" cy="380.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1217.5" y="384.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1208.5" cy="397.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="1217.5" y="402.1426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1208.5" cy="415.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1217.5" y="419.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="103" fill="#F1F1F1" height="100.8281" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="3327.5" y="326"/><ellipse cx="3636.75" cy="342" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3639.5156,337.875 Q3639.6719,337.6563 3639.8594,337.5469 Q3640.0469,337.4375 3640.2656,337.4375 Q3640.6406,337.4375 3640.875,337.6953 Q3641.1094,337.9531 3641.1094,338.5625 L3641.1094,340.0156 Q3641.1094,340.625 3640.875,340.8906 Q3640.6406,341.1563 3640.2656,341.1563 Q3639.9219,341.1563 3639.7188,340.9531 Q3639.5156,340.7656 3639.4063,340.25 Q3639.3594,339.8906 3639.1719,339.7031 Q3638.8438,339.3281 3638.2344,339.1094 Q3637.625,338.8906 3637,338.8906 Q3636.2344,338.8906 3635.6016,339.2188 Q3634.9688,339.5469 3634.4766,340.2969 Q3633.9844,341.0469 3633.9844,342.0781 L3633.9844,343.1719 Q3633.9844,344.4063 3634.875,345.2266 Q3635.7656,346.0469 3637.3594,346.0469 Q3638.2969,346.0469 3638.9531,345.7969 Q3639.3438,345.6406 3639.7656,345.2031 Q3640.0313,344.9375 3640.1797,344.8594 Q3640.3281,344.7813 3640.5313,344.7813 Q3640.8594,344.7813 3641.1172,345.0391 Q3641.375,345.2969 3641.375,345.6406 Q3641.375,345.9844 3641.0313,346.3906 Q3640.5313,346.9688 3639.7344,347.2969 Q3638.6563,347.75 3637.3594,347.75 Q3635.8438,347.75 3634.6406,347.125 Q3633.6563,346.625 3632.9688,345.5547 Q3632.2813,344.4844 3632.2813,343.2031 L3632.2813,342.0469 Q3632.2813,340.7188 3632.8984,339.5703 Q3633.5156,338.4219 3634.6094,337.8047 Q3635.7031,337.1875 3636.9375,337.1875 Q3637.6719,337.1875 3638.3203,337.3516 Q3638.9688,337.5156 3639.5156,337.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="3657.25" y="347.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3328.5" x2="4026.5" y1="358" y2="358"/><line style="stroke:#181818;stroke-width:1.0;" x1="3328.5" x2="4026.5" y1="366" y2="366"/><ellipse cx="3338.5" cy="380.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3347.5" y="384.5332">SqlProvider(connection : string)</text><polygon fill="#FFFF44" points="3338.5,392.9141,3342.5,396.9141,3338.5,400.9141,3334.5,396.9141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="3347.5" y="402.1426">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3338.5,410.5234,3342.5,414.5234,3338.5,418.5234,3334.5,414.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3347.5" y="419.752">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="110" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3456" y="86"/><ellipse cx="3560.75" cy="102" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3563.5156,97.875 Q3563.6719,97.6563 3563.8594,97.5469 Q3564.0469,97.4375 3564.2656,97.4375 Q3564.6406,97.4375 3564.875,97.6953 Q3565.1094,97.9531 3565.1094,98.5625 L3565.1094,100.0156 Q3565.1094,100.625 3564.875,100.8906 Q3564.6406,101.1563 3564.2656,101.1563 Q3563.9219,101.1563 3563.7188,100.9531 Q3563.5156,100.7656 3563.4063,100.25 Q3563.3594,99.8906 3563.1719,99.7031 Q3562.8438,99.3281 3562.2344,99.1094 Q3561.625,98.8906 3561,98.8906 Q3560.2344,98.8906 3559.6016,99.2188 Q3558.9688,99.5469 3558.4766,100.2969 Q3557.9844,101.0469 3557.9844,102.0781 L3557.9844,103.1719 Q3557.9844,104.4063 3558.875,105.2266 Q3559.7656,106.0469 3561.3594,106.0469 Q3562.2969,106.0469 3562.9531,105.7969 Q3563.3438,105.6406 3563.7656,105.2031 Q3564.0313,104.9375 3564.1797,104.8594 Q3564.3281,104.7813 3564.5313,104.7813 Q3564.8594,104.7813 3565.1172,105.0391 Q3565.375,105.2969 3565.375,105.6406 Q3565.375,105.9844 3565.0313,106.3906 Q3564.5313,106.9688 3563.7344,107.2969 Q3562.6563,107.75 3561.3594,107.75 Q3559.8438,107.75 3558.6406,107.125 Q3557.6563,106.625 3556.9688,105.5547 Q3556.2813,104.4844 3556.2813,103.2031 L3556.2813,102.0469 Q3556.2813,100.7188 3556.8984,99.5703 Q3557.5156,98.4219 3558.6094,97.8047 Q3559.7031,97.1875 3560.9375,97.1875 Q3561.6719,97.1875 3562.3203,97.3516 Q3562.9688,97.5156 3563.5156,97.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="3581.25" y="107.7285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3457" x2="3834" y1="118" y2="118"/><line style="stroke:#181818;stroke-width:1.0;" x1="3457" x2="3834" y1="126" y2="126"/><ellipse cx="3467" cy="140.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3476" y="144.5332">LeakedPasswordProvider(configuration : IConfiguration)</text></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="121" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="3058.5" y="77.5"/><ellipse cx="3163.25" cy="93.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3166.0156,89.375 Q3166.1719,89.1563 3166.3594,89.0469 Q3166.5469,88.9375 3166.7656,88.9375 Q3167.1406,88.9375 3167.375,89.1953 Q3167.6094,89.4531 3167.6094,90.0625 L3167.6094,91.5156 Q3167.6094,92.125 3167.375,92.3906 Q3167.1406,92.6563 3166.7656,92.6563 Q3166.4219,92.6563 3166.2188,92.4531 Q3166.0156,92.2656 3165.9063,91.75 Q3165.8594,91.3906 3165.6719,91.2031 Q3165.3438,90.8281 3164.7344,90.6094 Q3164.125,90.3906 3163.5,90.3906 Q3162.7344,90.3906 3162.1016,90.7188 Q3161.4688,91.0469 3160.9766,91.7969 Q3160.4844,92.5469 3160.4844,93.5781 L3160.4844,94.6719 Q3160.4844,95.9063 3161.375,96.7266 Q3162.2656,97.5469 3163.8594,97.5469 Q3164.7969,97.5469 3165.4531,97.2969 Q3165.8438,97.1406 3166.2656,96.7031 Q3166.5313,96.4375 3166.6797,96.3594 Q3166.8281,96.2813 3167.0313,96.2813 Q3167.3594,96.2813 3167.6172,96.5391 Q3167.875,96.7969 3167.875,97.1406 Q3167.875,97.4844 3167.5313,97.8906 Q3167.0313,98.4688 3166.2344,98.7969 Q3165.1563,99.25 3163.8594,99.25 Q3162.3438,99.25 3161.1406,98.625 Q3160.1563,98.125 3159.4688,97.0547 Q3158.7813,95.9844 3158.7813,94.7031 L3158.7813,93.5469 Q3158.7813,92.2188 3159.3984,91.0703 Q3160.0156,89.9219 3161.1094,89.3047 Q3162.2031,88.6875 3163.4375,88.6875 Q3164.1719,88.6875 3164.8203,88.8516 Q3165.4688,89.0156 3166.0156,89.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3183.75" y="99.2285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3059.5" x2="3357.5" y1="109.5" y2="109.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3059.5" x2="3357.5" y1="117.5" y2="117.5"/><ellipse cx="3069.5" cy="131.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="3078.5" y="136.0332">UserProvider(configuration : IConfiguration)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3066.5" y="146.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="3078.5" y="153.6426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="179" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="2039.5" y="531"/><ellipse cx="2116.75" cy="547" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2119.5156,542.875 Q2119.6719,542.6563 2119.8594,542.5469 Q2120.0469,542.4375 2120.2656,542.4375 Q2120.6406,542.4375 2120.875,542.6953 Q2121.1094,542.9531 2121.1094,543.5625 L2121.1094,545.0156 Q2121.1094,545.625 2120.875,545.8906 Q2120.6406,546.1563 2120.2656,546.1563 Q2119.9219,546.1563 2119.7188,545.9531 Q2119.5156,545.7656 2119.4063,545.25 Q2119.3594,544.8906 2119.1719,544.7031 Q2118.8438,544.3281 2118.2344,544.1094 Q2117.625,543.8906 2117,543.8906 Q2116.2344,543.8906 2115.6016,544.2188 Q2114.9688,544.5469 2114.4766,545.2969 Q2113.9844,546.0469 2113.9844,547.0781 L2113.9844,548.1719 Q2113.9844,549.4063 2114.875,550.2266 Q2115.7656,551.0469 2117.3594,551.0469 Q2118.2969,551.0469 2118.9531,550.7969 Q2119.3438,550.6406 2119.7656,550.2031 Q2120.0313,549.9375 2120.1797,549.8594 Q2120.3281,549.7813 2120.5313,549.7813 Q2120.8594,549.7813 2121.1172,550.0391 Q2121.375,550.2969 2121.375,550.6406 Q2121.375,550.9844 2121.0313,551.3906 Q2120.5313,551.9688 2119.7344,552.2969 Q2118.6563,552.75 2117.3594,552.75 Q2115.8438,552.75 2114.6406,552.125 Q2113.6563,551.625 2112.9688,550.5547 Q2112.2813,549.4844 2112.2813,548.2031 L2112.2813,547.0469 Q2112.2813,545.7188 2112.8984,544.5703 Q2113.5156,543.4219 2114.6094,542.8047 Q2115.7031,542.1875 2116.9375,542.1875 Q2117.6719,542.1875 2118.3203,542.3516 Q2118.9688,542.5156 2119.5156,542.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2137.25" y="552.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="2040.5" x2="2248.5" y1="563" y2="563"/><ellipse cx="2050.5" cy="577.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2059.5" y="581.5332">HashedPassword : string</text><ellipse cx="2050.5" cy="594.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="2059.5" y="599.1426">Salt : string</text><ellipse cx="2050.5" cy="612.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="2059.5" y="616.752">SecretKey : string</text><ellipse cx="2050.5" cy="630.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="2059.5" y="634.3613">Count : long</text><ellipse cx="2050.5" cy="647.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="2059.5" y="651.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="2040.5" x2="2248.5" y1="659.0469" y2="659.0469"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="204" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="1385" y="522"/><ellipse cx="1422.5" cy="538" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1425.2656,533.875 Q1425.4219,533.6563 1425.6094,533.5469 Q1425.7969,533.4375 1426.0156,533.4375 Q1426.3906,533.4375 1426.625,533.6953 Q1426.8594,533.9531 1426.8594,534.5625 L1426.8594,536.0156 Q1426.8594,536.625 1426.625,536.8906 Q1426.3906,537.1563 1426.0156,537.1563 Q1425.6719,537.1563 1425.4688,536.9531 Q1425.2656,536.7656 1425.1563,536.25 Q1425.1094,535.8906 1424.9219,535.7031 Q1424.5938,535.3281 1423.9844,535.1094 Q1423.375,534.8906 1422.75,534.8906 Q1421.9844,534.8906 1421.3516,535.2188 Q1420.7188,535.5469 1420.2266,536.2969 Q1419.7344,537.0469 1419.7344,538.0781 L1419.7344,539.1719 Q1419.7344,540.4063 1420.625,541.2266 Q1421.5156,542.0469 1423.1094,542.0469 Q1424.0469,542.0469 1424.7031,541.7969 Q1425.0938,541.6406 1425.5156,541.2031 Q1425.7813,540.9375 1425.9297,540.8594 Q1426.0781,540.7813 1426.2813,540.7813 Q1426.6094,540.7813 1426.8672,541.0391 Q1427.125,541.2969 1427.125,541.6406 Q1427.125,541.9844 1426.7813,542.3906 Q1426.2813,542.9688 1425.4844,543.2969 Q1424.4063,543.75 1423.1094,543.75 Q1421.5938,543.75 1420.3906,543.125 Q1419.4063,542.625 1418.7188,541.5547 Q1418.0313,540.4844 1418.0313,539.2031 L1418.0313,538.0469 Q1418.0313,536.7188 1418.6484,535.5703 Q1419.2656,534.4219 1420.3594,533.8047 Q1421.4531,533.1875 1422.6875,533.1875 Q1423.4219,533.1875 1424.0703,533.3516 Q1424.7188,533.5156 1425.2656,533.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="1441.5" y="543.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="1386" x2="1549" y1="554" y2="554"/><ellipse cx="1396" cy="568.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1405" y="572.5332">ID : int</text><ellipse cx="1396" cy="585.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="1405" y="590.1426">UserID : int</text><ellipse cx="1396" cy="603.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1405" y="607.752">IP : string</text><ellipse cx="1396" cy="621.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="1405" y="625.3613">UserAgent : string</text><ellipse cx="1396" cy="638.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1405" y="642.9707">Successful : bool</text><ellipse cx="1396" cy="656.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1405" y="660.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="1386" x2="1549" y1="667.6563" y2="667.6563"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="142" fill="#F1F1F1" height="136.0469" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="480" x="3870.5" y="51"/><ellipse cx="4080.75" cy="67" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4083.5156,62.875 Q4083.6719,62.6563 4083.8594,62.5469 Q4084.0469,62.4375 4084.2656,62.4375 Q4084.6406,62.4375 4084.875,62.6953 Q4085.1094,62.9531 4085.1094,63.5625 L4085.1094,65.0156 Q4085.1094,65.625 4084.875,65.8906 Q4084.6406,66.1563 4084.2656,66.1563 Q4083.9219,66.1563 4083.7188,65.9531 Q4083.5156,65.7656 4083.4063,65.25 Q4083.3594,64.8906 4083.1719,64.7031 Q4082.8438,64.3281 4082.2344,64.1094 Q4081.625,63.8906 4081,63.8906 Q4080.2344,63.8906 4079.6016,64.2188 Q4078.9688,64.5469 4078.4766,65.2969 Q4077.9844,66.0469 4077.9844,67.0781 L4077.9844,68.1719 Q4077.9844,69.4063 4078.875,70.2266 Q4079.7656,71.0469 4081.3594,71.0469 Q4082.2969,71.0469 4082.9531,70.7969 Q4083.3438,70.6406 4083.7656,70.2031 Q4084.0313,69.9375 4084.1797,69.8594 Q4084.3281,69.7813 4084.5313,69.7813 Q4084.8594,69.7813 4085.1172,70.0391 Q4085.375,70.2969 4085.375,70.6406 Q4085.375,70.9844 4085.0313,71.3906 Q4084.5313,71.9688 4083.7344,72.2969 Q4082.6563,72.75 4081.3594,72.75 Q4079.8438,72.75 4078.6406,72.125 Q4077.6563,71.625 4076.9688,70.5547 Q4076.2813,69.4844 4076.2813,68.2031 L4076.2813,67.0469 Q4076.2813,65.7188 4076.8984,64.5703 Q4077.5156,63.4219 4078.6094,62.8047 Q4079.7031,62.1875 4080.9375,62.1875 Q4081.6719,62.1875 4082.3203,62.3516 Q4082.9688,62.5156 4083.5156,62.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="4101.25" y="72.7285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="3871.5" x2="4349.5" y1="83" y2="83"/><line style="stroke:#181818;stroke-width:1.0;" x1="3871.5" x2="4349.5" y1="91" y2="91"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3878.5" y="102.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="312" x="3890.5" y="109.5332">GetEncryptedPassword(password : string) : string</text><ellipse cx="3881.5" cy="122.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="3890.5" y="127.1426">GetSalt(saltLength : int) : string</text><ellipse cx="3881.5" cy="140.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="454" x="3890.5" y="144.752">GetEncryptedAndSaltedPassword(password : string, salt : string) : string</text><ellipse cx="3881.5" cy="158.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="3890.5" y="162.3613">GetHotp(key : string, counter : long) : string</text><ellipse cx="3881.5" cy="175.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="3890.5" y="179.9707">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="151" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4385.5" y="86"/><ellipse cx="4534.75" cy="102" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4537.5156,97.875 Q4537.6719,97.6563 4537.8594,97.5469 Q4538.0469,97.4375 4538.2656,97.4375 Q4538.6406,97.4375 4538.875,97.6953 Q4539.1094,97.9531 4539.1094,98.5625 L4539.1094,100.0156 Q4539.1094,100.625 4538.875,100.8906 Q4538.6406,101.1563 4538.2656,101.1563 Q4537.9219,101.1563 4537.7188,100.9531 Q4537.5156,100.7656 4537.4063,100.25 Q4537.3594,99.8906 4537.1719,99.7031 Q4536.8438,99.3281 4536.2344,99.1094 Q4535.625,98.8906 4535,98.8906 Q4534.2344,98.8906 4533.6016,99.2188 Q4532.9688,99.5469 4532.4766,100.2969 Q4531.9844,101.0469 4531.9844,102.0781 L4531.9844,103.1719 Q4531.9844,104.4063 4532.875,105.2266 Q4533.7656,106.0469 4535.3594,106.0469 Q4536.2969,106.0469 4536.9531,105.7969 Q4537.3438,105.6406 4537.7656,105.2031 Q4538.0313,104.9375 4538.1797,104.8594 Q4538.3281,104.7813 4538.5313,104.7813 Q4538.8594,104.7813 4539.1172,105.0391 Q4539.375,105.2969 4539.375,105.6406 Q4539.375,105.9844 4539.0313,106.3906 Q4538.5313,106.9688 4537.7344,107.2969 Q4536.6563,107.75 4535.3594,107.75 Q4533.8438,107.75 4532.6406,107.125 Q4531.6563,106.625 4530.9688,105.5547 Q4530.2813,104.4844 4530.2813,103.2031 L4530.2813,102.0469 Q4530.2813,100.7188 4530.8984,99.5703 Q4531.5156,98.4219 4532.6094,97.8047 Q4533.7031,97.1875 4534.9375,97.1875 Q4535.6719,97.1875 4536.3203,97.3516 Q4536.9688,97.5156 4537.5156,97.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="4555.25" y="107.7285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4386.5" x2="4772.5" y1="118" y2="118"/><line style="stroke:#181818;stroke-width:1.0;" x1="4386.5" x2="4772.5" y1="126" y2="126"/><ellipse cx="4396.5" cy="140.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="4405.5" y="144.5332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="171" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1856.5" y="736"/><ellipse cx="1921.75" cy="752" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1924.5156,747.875 Q1924.6719,747.6563 1924.8594,747.5469 Q1925.0469,747.4375 1925.2656,747.4375 Q1925.6406,747.4375 1925.875,747.6953 Q1926.1094,747.9531 1926.1094,748.5625 L1926.1094,750.0156 Q1926.1094,750.625 1925.875,750.8906 Q1925.6406,751.1563 1925.2656,751.1563 Q1924.9219,751.1563 1924.7188,750.9531 Q1924.5156,750.7656 1924.4063,750.25 Q1924.3594,749.8906 1924.1719,749.7031 Q1923.8438,749.3281 1923.2344,749.1094 Q1922.625,748.8906 1922,748.8906 Q1921.2344,748.8906 1920.6016,749.2188 Q1919.9688,749.5469 1919.4766,750.2969 Q1918.9844,751.0469 1918.9844,752.0781 L1918.9844,753.1719 Q1918.9844,754.4063 1919.875,755.2266 Q1920.7656,756.0469 1922.3594,756.0469 Q1923.2969,756.0469 1923.9531,755.7969 Q1924.3438,755.6406 1924.7656,755.2031 Q1925.0313,754.9375 1925.1797,754.8594 Q1925.3281,754.7813 1925.5313,754.7813 Q1925.8594,754.7813 1926.1172,755.0391 Q1926.375,755.2969 1926.375,755.6406 Q1926.375,755.9844 1926.0313,756.3906 Q1925.5313,756.9688 1924.7344,757.2969 Q1923.6563,757.75 1922.3594,757.75 Q1920.8438,757.75 1919.6406,757.125 Q1918.6563,756.625 1917.9688,755.5547 Q1917.2813,754.4844 1917.2813,753.2031 L1917.2813,752.0469 Q1917.2813,750.7188 1917.8984,749.5703 Q1918.5156,748.4219 1919.6094,747.8047 Q1920.7031,747.1875 1921.9375,747.1875 Q1922.6719,747.1875 1923.3203,747.3516 Q1923.9688,747.5156 1924.5156,747.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1942.25" y="757.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="1857.5" x2="2023.5" y1="768" y2="768"/><ellipse cx="1867.5" cy="782.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1876.5" y="786.5332">ID : int</text><ellipse cx="1867.5" cy="799.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1876.5" y="804.1426">IsVerified : bool</text><ellipse cx="1867.5" cy="817.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1876.5" y="821.752">IsLocked : bool</text><ellipse cx="1867.5" cy="835.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1876.5" y="839.3613">FailedTries : int</text><ellipse cx="1867.5" cy="852.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="1876.5" y="856.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1857.5" x2="2023.5" y1="864.0469" y2="864.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="191" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="1562" y="932"/><ellipse cx="1608.75" cy="948" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1611.5156,943.875 Q1611.6719,943.6563 1611.8594,943.5469 Q1612.0469,943.4375 1612.2656,943.4375 Q1612.6406,943.4375 1612.875,943.6953 Q1613.1094,943.9531 1613.1094,944.5625 L1613.1094,946.0156 Q1613.1094,946.625 1612.875,946.8906 Q1612.6406,947.1563 1612.2656,947.1563 Q1611.9219,947.1563 1611.7188,946.9531 Q1611.5156,946.7656 1611.4063,946.25 Q1611.3594,945.8906 1611.1719,945.7031 Q1610.8438,945.3281 1610.2344,945.1094 Q1609.625,944.8906 1609,944.8906 Q1608.2344,944.8906 1607.6016,945.2188 Q1606.9688,945.5469 1606.4766,946.2969 Q1605.9844,947.0469 1605.9844,948.0781 L1605.9844,949.1719 Q1605.9844,950.4063 1606.875,951.2266 Q1607.7656,952.0469 1609.3594,952.0469 Q1610.2969,952.0469 1610.9531,951.7969 Q1611.3438,951.6406 1611.7656,951.2031 Q1612.0313,950.9375 1612.1797,950.8594 Q1612.3281,950.7813 1612.5313,950.7813 Q1612.8594,950.7813 1613.1172,951.0391 Q1613.375,951.2969 1613.375,951.6406 Q1613.375,951.9844 1613.0313,952.3906 Q1612.5313,952.9688 1611.7344,953.2969 Q1610.6563,953.75 1609.3594,953.75 Q1607.8438,953.75 1606.6406,953.125 Q1605.6563,952.625 1604.9688,951.5547 Q1604.2813,950.4844 1604.2813,949.2031 L1604.2813,948.0469 Q1604.2813,946.7188 1604.8984,945.5703 Q1605.5156,944.4219 1606.6094,943.8047 Q1607.7031,943.1875 1608.9375,943.1875 Q1609.6719,943.1875 1610.3203,943.3516 Q1610.9688,943.5156 1611.5156,943.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1629.25" y="953.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="1563" x2="1724" y1="964" y2="964"/><ellipse cx="1573" cy="978.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1582" y="982.5332">Email : string</text><ellipse cx="1573" cy="995.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1582" y="1000.1426">FirstName : string</text><ellipse cx="1573" cy="1013.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1582" y="1017.752">LastName : string</text><ellipse cx="1573" cy="1031.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1582" y="1035.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1563" x2="1724" y1="1042.4375" y2="1042.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="19" d="M835.5,217.89 C835.5,251.41 835.5,287.84 835.5,317.22 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="835.5,204.72,831.5,210.72,835.5,216.72,839.5,210.72,835.5,204.72" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="20" d="M640.69,210.01 C556.36,248.97 460.89,293.08 389.73,325.96 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="652.51,204.55,645.3852,203.438,641.6183,209.5871,648.7432,210.6991,652.51,204.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="73" d="M933.05,435.55 C1083.77,525.25 1368.71,694.81 1491.62,767.96 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1496.28,770.73,1490.589,762.6918,1491.9825,768.1743,1486.5,769.5678,1496.28,770.73" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="74" d="M835.5,435.72 C835.5,472.06 835.5,518.17 835.5,551.95 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="835.5,557.26,839.5,548.26,835.5,552.26,831.5,548.26,835.5,557.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="75" d="M1961.43,199.39 C1888.89,210.66 1814.75,221.59 1744.5,231 C1494.21,264.51 1428.24,247.45 1179.5,291 C1144.62,297.11 1108.02,304.74 1072.25,312.91 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1073.54,319.8,1052.47,317.5,1070.38,306.16,1073.54,319.8" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="77" d="M2511.09,242.56 C2521.79,258.84 2532.57,275.23 2542.73,290.68 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2503.7,231.32,2503.6494,238.5309,2510.2862,241.3511,2510.3368,234.1401,2503.7,231.32" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="78" d="M2250.8,238.33 C2203.92,269.21 2155.92,300.82 2117.83,325.9 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2261.73,231.14,2254.519,231.096,2251.705,237.7354,2258.916,237.7794,2261.73,231.14" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="79" d="M2729.07,235.93 C2830.52,275.33 2935.88,316.24 3006.08,343.5 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2716.72,231.14,2720.8669,237.0394,2727.9075,235.4804,2723.7606,229.581,2716.72,231.14" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="81" d="M274.94,160.77 C276.31,199.71 278.4,259.18 280.04,305.67 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="287.04,305.44,280.74,325.67,273.04,305.93,287.04,305.44" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="82" d="M282.5,440.46 C282.5,474.72 282.5,516.5 282.5,548.42 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="282.5,427.26,278.5,433.26,282.5,439.26,286.5,433.26,282.5,427.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="85" d="M1585,160.63 C1674.98,202.89 1816.69,269.44 1918.55,317.29 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1921.64,311,1936.77,325.84,1915.69,323.68,1921.64,311" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="86" d="M1491.98,173.75 C1486.54,218.58 1478.85,281.97 1473.55,325.67 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1493.55,160.77,1488.8538,166.2423,1492.0989,172.6819,1496.7951,167.2097,1493.55,160.77" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="131" d="M2412.48,467.85 C2356.95,494.82 2298.03,523.43 2249.63,546.94 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2424.27,462.12,2417.1256,461.1412,2413.4743,467.3595,2420.6186,468.3383,2424.27,462.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="132" d="M1467.5,440.45 C1467.5,465.73 1467.5,495.1 1467.5,521.58 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1467.5,427.26,1463.5,433.26,1467.5,439.26,1471.5,433.26,1467.5,427.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="134" d="M3575.52,152.1 C3474.43,198.47 3287.57,284.19 3177.02,334.89 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3179.73,341.35,3158.63,343.33,3173.89,328.63,3179.73,341.35" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="135" d="M3649.52,152.1 C3654.32,190.42 3662.48,255.6 3668.76,305.69 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3675.73,305.06,3671.27,325.77,3661.84,306.8,3675.73,305.06" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="137" d="M3111.51,160.63 C3033.02,193.5 2919.45,241.07 2819.1,283.1 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2821.68,289.61,2800.53,290.88,2816.27,276.7,2821.68,289.61" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="138" d="M3283.07,160.63 C3360.09,202.58 3481.05,268.48 3568.72,316.24 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3572.13,310.13,3586.35,325.84,3565.43,322.42,3572.13,310.13" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="158" d="M1856.19,857.52 C1820.73,879.61 1779.22,905.46 1742.34,928.43 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1745.88,934.47,1725.21,939.11,1738.48,922.59,1745.88,934.47" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="159" d="M1566.7,837.22 C1577.31,858.34 1591.66,886.87 1605.07,913.56 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1611.43,910.62,1614.16,931.63,1598.92,916.91,1611.43,910.62" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="161" d="M2077.14,667.03 C2059.65,684.44 2040.61,703.38 2022.46,721.44 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2027.25,726.55,2008.14,735.69,2017.38,716.62,2027.25,726.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[73fd1ba55681aa00e7870a654fa45b13]
@startuml API class diagram

top to bottom direction

'Controllers'

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
}

'Controllers mappings' 

UserController o- - IUserManager
UserController o- - ITokenManager

'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger<UserManager>
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}


'Managers mappings'

IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

'Utility'

class Security{
    - -
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction


class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
}


UserController o- - IUserManager
UserController o- - ITokenManager


Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger<UserManager>
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}



IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider


class Security{
    - -
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: da
Country: DK
--></g></svg>