<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1110px" preserveAspectRatio="none" style="width:5458px;height:1110px;background:#FFFFFF;" version="1.1" viewBox="0 0 5458 1110" width="5458px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="206.4844" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="541" x="672" y="33.5"/><ellipse cx="892.75" cy="49.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M895.5156,45.375 Q895.6719,45.1563 895.8594,45.0469 Q896.0469,44.9375 896.2656,44.9375 Q896.6406,44.9375 896.875,45.2031 Q897.1094,45.4531 897.1094,46.0625 L897.1094,47.5156 Q897.1094,48.125 896.875,48.3906 Q896.6406,48.6563 896.2656,48.6563 Q895.9219,48.6563 895.7188,48.4531 Q895.5156,48.2656 895.4063,47.75 Q895.3594,47.3906 895.1719,47.2031 Q894.8438,46.8281 894.2344,46.6094 Q893.625,46.3906 893,46.3906 Q892.2344,46.3906 891.5938,46.7188 Q890.9688,47.0469 890.4688,47.7969 Q889.9844,48.5469 889.9844,49.5781 L889.9844,50.6719 Q889.9844,51.9063 890.875,52.7344 Q891.7656,53.5469 893.3594,53.5469 Q894.2969,53.5469 894.9531,53.2969 Q895.3438,53.1406 895.7656,52.7031 Q896.0313,52.4375 896.1719,52.3594 Q896.3281,52.2813 896.5313,52.2813 Q896.8594,52.2813 897.1094,52.5469 Q897.375,52.7969 897.375,53.1406 Q897.375,53.4844 897.0313,53.8906 Q896.5313,54.4688 895.7344,54.7969 Q894.6563,55.25 893.3594,55.25 Q891.8438,55.25 890.6406,54.625 Q889.6563,54.125 888.9688,53.0625 Q888.2813,51.9844 888.2813,50.7031 L888.2813,49.5469 Q888.2813,48.2188 888.8906,47.0781 Q889.5156,45.9219 890.6094,45.3125 Q891.7031,44.6875 892.9375,44.6875 Q893.6719,44.6875 894.3125,44.8594 Q894.9688,45.0156 895.5156,45.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="913.25" y="55.2285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="673" x2="1212" y1="65.5" y2="65.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="680" y="76.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="692" y="84.0332">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="680" y="94.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="692" y="101.6426">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:1.0;" x1="673" x2="1212" y1="108.7188" y2="108.7188"/><ellipse cx="683" cy="123.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="692" y="127.252">UserController(userManager : IUserManager, tokenManager : ITokenManager)</text><ellipse cx="683" cy="140.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="469" x="692" y="144.8613">CreateAsync(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="683" cy="158.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="692" y="162.4707">LoginAsync(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="683" cy="175.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="692" y="180.0801">GetUserFromTokenAsync() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="683" cy="193.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="515" x="692" y="197.6895">VerificationLoginAsync(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="683" cy="211.0703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="444" x="692" y="215.2988">VerifyUserRegisterAsync(UserLogin : UserLogin) : Task&lt;ActionResult&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="680" y="225.6797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="211" x="692" y="232.9082">GetUserLocation() : UserLocation</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="26" fill="#F1F1F1" height="136.0469" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="653" x="1066" y="352.5"/><ellipse cx="1342.75" cy="368.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1343.7031,365.1406 L1343.7031,371.7969 L1345.4219,371.7969 Q1346.0313,371.7969 1346.2969,372.0313 Q1346.5625,372.2656 1346.5625,372.6563 Q1346.5625,373.0313 1346.2969,373.2656 Q1346.0313,373.5 1345.4219,373.5 L1340.2813,373.5 Q1339.6719,373.5 1339.4063,373.2656 Q1339.1406,373.0313 1339.1406,372.6406 Q1339.1406,372.2656 1339.4063,372.0313 Q1339.6719,371.7969 1340.2813,371.7969 L1342,371.7969 L1342,365.1406 L1340.2813,365.1406 Q1339.6719,365.1406 1339.4063,364.9063 Q1339.1406,364.6719 1339.1406,364.2813 Q1339.1406,363.9063 1339.4063,363.6719 Q1339.6719,363.4375 1340.2813,363.4375 L1345.4219,363.4375 Q1346.0313,363.4375 1346.2969,363.6719 Q1346.5625,363.9063 1346.5625,364.2813 Q1346.5625,364.6719 1346.2969,364.9063 Q1346.0313,365.1406 1345.4219,365.1406 L1343.7031,365.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="1363.25" y="374.2285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1067" x2="1718" y1="384.5" y2="384.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1067" x2="1718" y1="392.5" y2="392.5"/><ellipse cx="1077" cy="406.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="361" x="1086" y="411.0332">CreateUserAsync(userCreate : UserCreate) : Task&lt;bool&gt;</text><ellipse cx="1077" cy="424.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="1086" y="428.6426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="1077" cy="442.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="1086" y="446.252">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="1077" cy="459.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="627" x="1086" y="463.8613">LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="1077" cy="477.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="595" x="1086" y="481.4707">VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="34" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="91.5" y="370"/><ellipse cx="218.25" cy="386" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M219.2031,382.6406 L219.2031,389.2969 L220.9219,389.2969 Q221.5313,389.2969 221.7969,389.5313 Q222.0625,389.7656 222.0625,390.1563 Q222.0625,390.5313 221.7969,390.7656 Q221.5313,391 220.9219,391 L215.7813,391 Q215.1719,391 214.9063,390.7656 Q214.6406,390.5313 214.6406,390.1406 Q214.6406,389.7656 214.9063,389.5313 Q215.1719,389.2969 215.7813,389.2969 L217.5,389.2969 L217.5,382.6406 L215.7813,382.6406 Q215.1719,382.6406 214.9063,382.4063 Q214.6406,382.1719 214.6406,381.7813 Q214.6406,381.4063 214.9063,381.1719 Q215.1719,380.9375 215.7813,380.9375 L220.9219,380.9375 Q221.5313,380.9375 221.7969,381.1719 Q222.0625,381.4063 222.0625,381.7813 Q222.0625,382.1719 221.7969,382.4063 Q221.5313,382.6406 220.9219,382.6406 L219.2031,382.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="238.75" y="391.7285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="92.5" x2="454.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:0.5;" x1="92.5" x2="454.5" y1="410" y2="410"/><ellipse cx="102.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="111.5" y="428.5332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="102.5" cy="441.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="111.5" y="446.1426">ValidateToken(token : string) : bool</text><ellipse cx="102.5" cy="459.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="111.5" y="463.752">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="41" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1754.5" y="370"/><ellipse cx="1947.75" cy="386" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1948.7031,382.6406 L1948.7031,389.2969 L1950.4219,389.2969 Q1951.0313,389.2969 1951.2969,389.5313 Q1951.5625,389.7656 1951.5625,390.1563 Q1951.5625,390.5313 1951.2969,390.7656 Q1951.0313,391 1950.4219,391 L1945.2813,391 Q1944.6719,391 1944.4063,390.7656 Q1944.1406,390.5313 1944.1406,390.1406 Q1944.1406,389.7656 1944.4063,389.5313 Q1944.6719,389.2969 1945.2813,389.2969 L1947,389.2969 L1947,382.6406 L1945.2813,382.6406 Q1944.6719,382.6406 1944.4063,382.4063 Q1944.1406,382.1719 1944.1406,381.7813 Q1944.1406,381.4063 1944.4063,381.1719 Q1944.6719,380.9375 1945.2813,380.9375 L1950.4219,380.9375 Q1951.0313,380.9375 1951.2969,381.1719 Q1951.5625,381.4063 1951.5625,381.7813 Q1951.5625,382.1719 1951.2969,382.4063 Q1951.0313,382.6406 1950.4219,382.6406 L1948.7031,382.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="1968.25" y="391.7285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1755.5" x2="2293.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:0.5;" x1="1755.5" x2="2293.5" y1="410" y2="410"/><ellipse cx="1765.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1774.5" y="428.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1765.5" cy="441.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="1774.5" y="446.1426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1765.5" cy="459.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1774.5" y="463.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[5bbb8fec178e848d13dc3ca00e0fbd40]
class IMessageManager--><g id="elem_IMessageManager"><rect codeLine="47" fill="#F1F1F1" height="83.2188" id="IMessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="497" x="2330" y="379"/><ellipse cx="2514.75" cy="395" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2515.7031,391.6406 L2515.7031,398.2969 L2517.4219,398.2969 Q2518.0313,398.2969 2518.2969,398.5313 Q2518.5625,398.7656 2518.5625,399.1563 Q2518.5625,399.5313 2518.2969,399.7656 Q2518.0313,400 2517.4219,400 L2512.2813,400 Q2511.6719,400 2511.4063,399.7656 Q2511.1406,399.5313 2511.1406,399.1406 Q2511.1406,398.7656 2511.4063,398.5313 Q2511.6719,398.2969 2512.2813,398.2969 L2514,398.2969 L2514,391.6406 L2512.2813,391.6406 Q2511.6719,391.6406 2511.4063,391.4063 Q2511.1406,391.1719 2511.1406,390.7813 Q2511.1406,390.4063 2511.4063,390.1719 Q2511.6719,389.9375 2512.2813,389.9375 L2517.4219,389.9375 Q2518.0313,389.9375 2518.2969,390.1719 Q2518.5625,390.4063 2518.5625,390.7813 Q2518.5625,391.1719 2518.2969,391.4063 Q2518.0313,391.6406 2517.4219,391.6406 L2515.7031,391.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="119" x="2535.25" y="400.7285">IMessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2331" x2="2826" y1="411" y2="411"/><line style="stroke:#181818;stroke-width:0.5;" x1="2331" x2="2826" y1="419" y2="419"/><ellipse cx="2341" cy="433.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="2350" y="437.5332">SendLoginAttemptMessageAsync(to : string, otp : string) : Task&lt;bool&gt;</text><ellipse cx="2341" cy="450.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="471" x="2350" y="455.1426">SendLoginRegistrationMessageAsync(to : string, key : string) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="52" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="95"/><ellipse cx="221.25" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,106.875 Q224.1719,106.6563 224.3594,106.5469 Q224.5469,106.4375 224.7656,106.4375 Q225.1406,106.4375 225.375,106.7031 Q225.6094,106.9531 225.6094,107.5625 L225.6094,109.0156 Q225.6094,109.625 225.375,109.8906 Q225.1406,110.1563 224.7656,110.1563 Q224.4219,110.1563 224.2188,109.9531 Q224.0156,109.7656 223.9063,109.25 Q223.8594,108.8906 223.6719,108.7031 Q223.3438,108.3281 222.7344,108.1094 Q222.125,107.8906 221.5,107.8906 Q220.7344,107.8906 220.0938,108.2188 Q219.4688,108.5469 218.9688,109.2969 Q218.4844,110.0469 218.4844,111.0781 L218.4844,112.1719 Q218.4844,113.4063 219.375,114.2344 Q220.2656,115.0469 221.8594,115.0469 Q222.7969,115.0469 223.4531,114.7969 Q223.8438,114.6406 224.2656,114.2031 Q224.5313,113.9375 224.6719,113.8594 Q224.8281,113.7813 225.0313,113.7813 Q225.3594,113.7813 225.6094,114.0469 Q225.875,114.2969 225.875,114.6406 Q225.875,114.9844 225.5313,115.3906 Q225.0313,115.9688 224.2344,116.2969 Q223.1563,116.75 221.8594,116.75 Q220.3438,116.75 219.1406,116.125 Q218.1563,115.625 217.4688,114.5625 Q216.7813,113.4844 216.7813,112.2031 L216.7813,111.0469 Q216.7813,109.7188 217.3906,108.5781 Q218.0156,107.4219 219.1094,106.8125 Q220.2031,106.1875 221.4375,106.1875 Q222.1719,106.1875 222.8125,106.3594 Q223.4688,106.5156 224.0156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="116.7285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="539" y1="135" y2="135"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="146.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="153.5332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="163.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="171.1426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="58" fill="#F1F1F1" height="259.3125" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="1128" x="2517.5" y="7"/><ellipse cx="3034.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3037.5156,18.875 Q3037.6719,18.6563 3037.8594,18.5469 Q3038.0469,18.4375 3038.2656,18.4375 Q3038.6406,18.4375 3038.875,18.7031 Q3039.1094,18.9531 3039.1094,19.5625 L3039.1094,21.0156 Q3039.1094,21.625 3038.875,21.8906 Q3038.6406,22.1563 3038.2656,22.1563 Q3037.9219,22.1563 3037.7188,21.9531 Q3037.5156,21.7656 3037.4063,21.25 Q3037.3594,20.8906 3037.1719,20.7031 Q3036.8438,20.3281 3036.2344,20.1094 Q3035.625,19.8906 3035,19.8906 Q3034.2344,19.8906 3033.5938,20.2188 Q3032.9688,20.5469 3032.4688,21.2969 Q3031.9844,22.0469 3031.9844,23.0781 L3031.9844,24.1719 Q3031.9844,25.4063 3032.875,26.2344 Q3033.7656,27.0469 3035.3594,27.0469 Q3036.2969,27.0469 3036.9531,26.7969 Q3037.3438,26.6406 3037.7656,26.2031 Q3038.0313,25.9375 3038.1719,25.8594 Q3038.3281,25.7813 3038.5313,25.7813 Q3038.8594,25.7813 3039.1094,26.0469 Q3039.375,26.2969 3039.375,26.6406 Q3039.375,26.9844 3039.0313,27.3906 Q3038.5313,27.9688 3037.7344,28.2969 Q3036.6563,28.75 3035.3594,28.75 Q3033.8438,28.75 3032.6406,28.125 Q3031.6563,27.625 3030.9688,26.5625 Q3030.2813,25.4844 3030.2813,24.2031 L3030.2813,23.0469 Q3030.2813,21.7188 3030.8906,20.5781 Q3031.5156,19.4219 3032.6094,18.8125 Q3033.7031,18.1875 3034.9375,18.1875 Q3035.6719,18.1875 3036.3125,18.3594 Q3036.9688,18.5156 3037.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="3055.25" y="28.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2518.5" x2="3644.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="2537.5" y="57.5332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2537.5" y="75.1426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="2537.5" y="92.752">_userLocationManager : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="103.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="249" x="2537.5" y="110.3613">_messageManager : IMessageManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="120.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="2537.5" y="127.9707">_logger : ILogger&lt;UserManager&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="138.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="2537.5" y="145.5801">_configuration : IConfiguration</text><line style="stroke:#181818;stroke-width:1.0;" x1="2518.5" x2="3644.5" y1="152.6563" y2="152.6563"/><ellipse cx="2528.5" cy="166.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1102" x="2537.5" y="171.1895">UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="455" x="2537.5" y="188.7988">messageManager : IMessageManager, logger : ILogger&lt;UserManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="199.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438" x="2537.5" y="206.4082">IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="216.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="440" x="2537.5" y="224.0176">CheckPasswordLeakedForUserAsync(password : string) : Task&lt;bool&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="234.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="471" x="2537.5" y="241.627">IsUserNotVerifiedAsync(userLocation : UserLocation, user : DbUser) : Task</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2525.5" y="252.0078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="448" x="2537.5" y="259.2363">IsUserLockedAsync(userLocation : UserLocation, user : DbUser) : Task</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="74" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="458" x="1297.5" y="95"/><ellipse cx="1452.75" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1455.5156,106.875 Q1455.6719,106.6563 1455.8594,106.5469 Q1456.0469,106.4375 1456.2656,106.4375 Q1456.6406,106.4375 1456.875,106.7031 Q1457.1094,106.9531 1457.1094,107.5625 L1457.1094,109.0156 Q1457.1094,109.625 1456.875,109.8906 Q1456.6406,110.1563 1456.2656,110.1563 Q1455.9219,110.1563 1455.7188,109.9531 Q1455.5156,109.7656 1455.4063,109.25 Q1455.3594,108.8906 1455.1719,108.7031 Q1454.8438,108.3281 1454.2344,108.1094 Q1453.625,107.8906 1453,107.8906 Q1452.2344,107.8906 1451.5938,108.2188 Q1450.9688,108.5469 1450.4688,109.2969 Q1449.9844,110.0469 1449.9844,111.0781 L1449.9844,112.1719 Q1449.9844,113.4063 1450.875,114.2344 Q1451.7656,115.0469 1453.3594,115.0469 Q1454.2969,115.0469 1454.9531,114.7969 Q1455.3438,114.6406 1455.7656,114.2031 Q1456.0313,113.9375 1456.1719,113.8594 Q1456.3281,113.7813 1456.5313,113.7813 Q1456.8594,113.7813 1457.1094,114.0469 Q1457.375,114.2969 1457.375,114.6406 Q1457.375,114.9844 1457.0313,115.3906 Q1456.5313,115.9688 1455.7344,116.2969 Q1454.6563,116.75 1453.3594,116.75 Q1451.8438,116.75 1450.6406,116.125 Q1449.6563,115.625 1448.9688,114.5625 Q1448.2813,113.4844 1448.2813,112.2031 L1448.2813,111.0469 Q1448.2813,109.7188 1448.8906,108.5781 Q1449.5156,107.4219 1450.6094,106.8125 Q1451.7031,106.1875 1452.9375,106.1875 Q1453.6719,106.1875 1454.3125,106.3594 Q1454.9688,106.5156 1455.5156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1473.25" y="116.7285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1298.5" x2="1754.5" y1="127" y2="127"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1305.5" y="138.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="1317.5" y="145.5332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="1298.5" x2="1754.5" y1="152.6094" y2="152.6094"/><ellipse cx="1308.5" cy="166.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="432" x="1317.5" y="171.1426">UserLocationManager(userLocationProvider : UserLocationProvider)</text></g><!--MD5=[20fcb2fa68efbd583f0fa2981cab489f]
class MessageManager--><g id="elem_MessageManager"><rect codeLine="79" fill="#F1F1F1" height="100.8281" id="MessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="668" x="1814.5" y="86"/><ellipse cx="2087.75" cy="102" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2090.5156,97.875 Q2090.6719,97.6563 2090.8594,97.5469 Q2091.0469,97.4375 2091.2656,97.4375 Q2091.6406,97.4375 2091.875,97.7031 Q2092.1094,97.9531 2092.1094,98.5625 L2092.1094,100.0156 Q2092.1094,100.625 2091.875,100.8906 Q2091.6406,101.1563 2091.2656,101.1563 Q2090.9219,101.1563 2090.7188,100.9531 Q2090.5156,100.7656 2090.4063,100.25 Q2090.3594,99.8906 2090.1719,99.7031 Q2089.8438,99.3281 2089.2344,99.1094 Q2088.625,98.8906 2088,98.8906 Q2087.2344,98.8906 2086.5938,99.2188 Q2085.9688,99.5469 2085.4688,100.2969 Q2084.9844,101.0469 2084.9844,102.0781 L2084.9844,103.1719 Q2084.9844,104.4063 2085.875,105.2344 Q2086.7656,106.0469 2088.3594,106.0469 Q2089.2969,106.0469 2089.9531,105.7969 Q2090.3438,105.6406 2090.7656,105.2031 Q2091.0313,104.9375 2091.1719,104.8594 Q2091.3281,104.7813 2091.5313,104.7813 Q2091.8594,104.7813 2092.1094,105.0469 Q2092.375,105.2969 2092.375,105.6406 Q2092.375,105.9844 2092.0313,106.3906 Q2091.5313,106.9688 2090.7344,107.2969 Q2089.6563,107.75 2088.3594,107.75 Q2086.8438,107.75 2085.6406,107.125 Q2084.6563,106.625 2083.9688,105.5625 Q2083.2813,104.4844 2083.2813,103.2031 L2083.2813,102.0469 Q2083.2813,100.7188 2083.8906,99.5781 Q2084.5156,98.4219 2085.6094,97.8125 Q2086.7031,97.1875 2087.9375,97.1875 Q2088.6719,97.1875 2089.3125,97.3594 Q2089.9688,97.5156 2090.5156,97.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="2108.25" y="107.7285">MessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1815.5" x2="2481.5" y1="118" y2="118"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1822.5" y="129.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="1834.5" y="136.5332">_messageService : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1822.5" y="146.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="1834.5" y="154.1426">_messageProvider : IMessageProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="1815.5" x2="2481.5" y1="161.2188" y2="161.2188"/><ellipse cx="1825.5" cy="175.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="642" x="1834.5" y="179.752">MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="207" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="2520.5" y="824"/><ellipse cx="2549" cy="840" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2551.7656,835.875 Q2551.9219,835.6563 2552.1094,835.5469 Q2552.2969,835.4375 2552.5156,835.4375 Q2552.8906,835.4375 2553.125,835.7031 Q2553.3594,835.9531 2553.3594,836.5625 L2553.3594,838.0156 Q2553.3594,838.625 2553.125,838.8906 Q2552.8906,839.1563 2552.5156,839.1563 Q2552.1719,839.1563 2551.9688,838.9531 Q2551.7656,838.7656 2551.6563,838.25 Q2551.6094,837.8906 2551.4219,837.7031 Q2551.0938,837.3281 2550.4844,837.1094 Q2549.875,836.8906 2549.25,836.8906 Q2548.4844,836.8906 2547.8438,837.2188 Q2547.2188,837.5469 2546.7188,838.2969 Q2546.2344,839.0469 2546.2344,840.0781 L2546.2344,841.1719 Q2546.2344,842.4063 2547.125,843.2344 Q2548.0156,844.0469 2549.6094,844.0469 Q2550.5469,844.0469 2551.2031,843.7969 Q2551.5938,843.6406 2552.0156,843.2031 Q2552.2813,842.9375 2552.4219,842.8594 Q2552.5781,842.7813 2552.7813,842.7813 Q2553.1094,842.7813 2553.3594,843.0469 Q2553.625,843.2969 2553.625,843.6406 Q2553.625,843.9844 2553.2813,844.3906 Q2552.7813,844.9688 2551.9844,845.2969 Q2550.9063,845.75 2549.6094,845.75 Q2548.0938,845.75 2546.8906,845.125 Q2545.9063,844.625 2545.2188,843.5625 Q2544.5313,842.4844 2544.5313,841.2031 L2544.5313,840.0469 Q2544.5313,838.7188 2545.1406,837.5781 Q2545.7656,836.4219 2546.8594,835.8125 Q2547.9531,835.1875 2549.1875,835.1875 Q2549.9219,835.1875 2550.5625,835.3594 Q2551.2188,835.5156 2551.7656,835.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="2566" y="845.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="2521.5" x2="2653.5" y1="856" y2="856"/><ellipse cx="2531.5" cy="870.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="2540.5" y="874.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="2521.5" x2="2653.5" y1="881.6094" y2="881.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="219" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1325.5" y="610.5"/><ellipse cx="1357.6" cy="626.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1360.3656,622.375 Q1360.5219,622.1563 1360.7094,622.0469 Q1360.8969,621.9375 1361.1156,621.9375 Q1361.4906,621.9375 1361.725,622.2031 Q1361.9594,622.4531 1361.9594,623.0625 L1361.9594,624.5156 Q1361.9594,625.125 1361.725,625.3906 Q1361.4906,625.6563 1361.1156,625.6563 Q1360.7719,625.6563 1360.5688,625.4531 Q1360.3656,625.2656 1360.2563,624.75 Q1360.2094,624.3906 1360.0219,624.2031 Q1359.6938,623.8281 1359.0844,623.6094 Q1358.475,623.3906 1357.85,623.3906 Q1357.0844,623.3906 1356.4438,623.7188 Q1355.8188,624.0469 1355.3188,624.7969 Q1354.8344,625.5469 1354.8344,626.5781 L1354.8344,627.6719 Q1354.8344,628.9063 1355.725,629.7344 Q1356.6156,630.5469 1358.2094,630.5469 Q1359.1469,630.5469 1359.8031,630.2969 Q1360.1938,630.1406 1360.6156,629.7031 Q1360.8813,629.4375 1361.0219,629.3594 Q1361.1781,629.2813 1361.3813,629.2813 Q1361.7094,629.2813 1361.9594,629.5469 Q1362.225,629.7969 1362.225,630.1406 Q1362.225,630.4844 1361.8813,630.8906 Q1361.3813,631.4688 1360.5844,631.7969 Q1359.5063,632.25 1358.2094,632.25 Q1356.6938,632.25 1355.4906,631.625 Q1354.5063,631.125 1353.8188,630.0625 Q1353.1313,628.9844 1353.1313,627.7031 L1353.1313,626.5469 Q1353.1313,625.2188 1353.7406,624.0781 Q1354.3656,622.9219 1355.4594,622.3125 Q1356.5531,621.6875 1357.7875,621.6875 Q1358.5219,621.6875 1359.1625,621.8594 Q1359.8188,622.0156 1360.3656,622.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1375.4" y="632.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="1326.5" x2="1458.5" y1="642.5" y2="642.5"/><ellipse cx="1336.5" cy="656.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1345.5" y="661.0332">Email : string</text><ellipse cx="1336.5" cy="674.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1345.5" y="678.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1326.5" x2="1458.5" y1="685.7188" y2="685.7188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="107" fill="#F1F1F1" height="188.875" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="2862.5" y="326"/><ellipse cx="3085.25" cy="342" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3086.2031,338.6406 L3086.2031,345.2969 L3087.9219,345.2969 Q3088.5313,345.2969 3088.7969,345.5313 Q3089.0625,345.7656 3089.0625,346.1563 Q3089.0625,346.5313 3088.7969,346.7656 Q3088.5313,347 3087.9219,347 L3082.7813,347 Q3082.1719,347 3081.9063,346.7656 Q3081.6406,346.5313 3081.6406,346.1406 Q3081.6406,345.7656 3081.9063,345.5313 Q3082.1719,345.2969 3082.7813,345.2969 L3084.5,345.2969 L3084.5,338.6406 L3082.7813,338.6406 Q3082.1719,338.6406 3081.9063,338.4063 Q3081.6406,338.1719 3081.6406,337.7813 Q3081.6406,337.4063 3081.9063,337.1719 Q3082.1719,336.9375 3082.7813,336.9375 L3087.9219,336.9375 Q3088.5313,336.9375 3088.7969,337.1719 Q3089.0625,337.4063 3089.0625,337.7813 Q3089.0625,338.1719 3088.7969,338.4063 Q3088.5313,338.6406 3087.9219,338.6406 L3086.2031,338.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="3105.75" y="347.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2863.5" x2="3401.5" y1="358" y2="358"/><line style="stroke:#181818;stroke-width:0.5;" x1="2863.5" x2="3401.5" y1="366" y2="366"/><ellipse cx="2873.5" cy="380.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2882.5" y="384.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2873.5" cy="397.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2882.5" y="402.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2873.5" cy="415.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2882.5" y="419.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2873.5" cy="433.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="365" x="2882.5" y="437.3613">UpdateUserFailedTriesAsync(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2873.5" cy="450.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="2882.5" y="454.9707">UpdateUserLoginSuccessAsync(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2873.5" cy="468.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="409" x="2882.5" y="472.5801">UpdateUserLoginNewLocationAsync(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2873.5" cy="485.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="298" x="2882.5" y="490.1895">UpdateUserToVerifiedAsync(userID : int) : Task</text><ellipse cx="2873.5" cy="503.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="2882.5" y="507.7988">UpdateUserLoginSuccessWithVerificationCodeAsync(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="118" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="3437.5" y="387.5"/><ellipse cx="3554.75" cy="403.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3555.7031,400.1406 L3555.7031,406.7969 L3557.4219,406.7969 Q3558.0313,406.7969 3558.2969,407.0313 Q3558.5625,407.2656 3558.5625,407.6563 Q3558.5625,408.0313 3558.2969,408.2656 Q3558.0313,408.5 3557.4219,408.5 L3552.2813,408.5 Q3551.6719,408.5 3551.4063,408.2656 Q3551.1406,408.0313 3551.1406,407.6406 Q3551.1406,407.2656 3551.4063,407.0313 Q3551.6719,406.7969 3552.2813,406.7969 L3554,406.7969 L3554,400.1406 L3552.2813,400.1406 Q3551.6719,400.1406 3551.4063,399.9063 Q3551.1406,399.6719 3551.1406,399.2813 Q3551.1406,398.9063 3551.4063,398.6719 Q3551.6719,398.4375 3552.2813,398.4375 L3557.4219,398.4375 Q3558.0313,398.4375 3558.2969,398.6719 Q3558.5625,398.9063 3558.5625,399.2813 Q3558.5625,399.6719 3558.2969,399.9063 Q3558.0313,400.1406 3557.4219,400.1406 L3555.7031,400.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="3575.25" y="409.2285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3438.5" x2="3844.5" y1="419.5" y2="419.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="3438.5" x2="3844.5" y1="427.5" y2="427.5"/><ellipse cx="3448.5" cy="441.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="3457.5" y="446.0332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="185" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="217" y="601.5"/><ellipse cx="237.4" cy="617.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M240.1656,613.375 Q240.3219,613.1563 240.5094,613.0469 Q240.6969,612.9375 240.9156,612.9375 Q241.2906,612.9375 241.525,613.2031 Q241.7594,613.4531 241.7594,614.0625 L241.7594,615.5156 Q241.7594,616.125 241.525,616.3906 Q241.2906,616.6563 240.9156,616.6563 Q240.5719,616.6563 240.3688,616.4531 Q240.1656,616.2656 240.0563,615.75 Q240.0094,615.3906 239.8219,615.2031 Q239.4938,614.8281 238.8844,614.6094 Q238.275,614.3906 237.65,614.3906 Q236.8844,614.3906 236.2438,614.7188 Q235.6188,615.0469 235.1188,615.7969 Q234.6344,616.5469 234.6344,617.5781 L234.6344,618.6719 Q234.6344,619.9063 235.525,620.7344 Q236.4156,621.5469 238.0094,621.5469 Q238.9469,621.5469 239.6031,621.2969 Q239.9938,621.1406 240.4156,620.7031 Q240.6813,620.4375 240.8219,620.3594 Q240.9781,620.2813 241.1813,620.2813 Q241.5094,620.2813 241.7594,620.5469 Q242.025,620.7969 242.025,621.1406 Q242.025,621.4844 241.6813,621.8906 Q241.1813,622.4688 240.3844,622.7969 Q239.3063,623.25 238.0094,623.25 Q236.4938,623.25 235.2906,622.625 Q234.3063,622.125 233.6188,621.0625 Q232.9313,619.9844 232.9313,618.7031 L232.9313,617.5469 Q232.9313,616.2188 233.5406,615.0781 Q234.1656,613.9219 235.2594,613.3125 Q236.3531,612.6875 237.5875,612.6875 Q238.3219,612.6875 238.9625,612.8594 Q239.6188,613.0156 240.1656,613.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="252.6" y="623.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="218" x2="329" y1="633.5" y2="633.5"/><ellipse cx="228" cy="647.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="237" y="652.0332">UserID : int</text><ellipse cx="228" cy="665.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="237" y="669.6426">Email : string</text><ellipse cx="228" cy="683.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="237" y="687.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="218" x2="329" y1="694.3281" y2="694.3281"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="134" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="490.5" y="370"/><ellipse cx="686.25" cy="386" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M687.2031,382.6406 L687.2031,389.2969 L688.9219,389.2969 Q689.5313,389.2969 689.7969,389.5313 Q690.0625,389.7656 690.0625,390.1563 Q690.0625,390.5313 689.7969,390.7656 Q689.5313,391 688.9219,391 L683.7813,391 Q683.1719,391 682.9063,390.7656 Q682.6406,390.5313 682.6406,390.1406 Q682.6406,389.7656 682.9063,389.5313 Q683.1719,389.2969 683.7813,389.2969 L685.5,389.2969 L685.5,382.6406 L683.7813,382.6406 Q683.1719,382.6406 682.9063,382.4063 Q682.6406,382.1719 682.6406,381.7813 Q682.6406,381.4063 682.9063,381.1719 Q683.1719,380.9375 683.7813,380.9375 L688.9219,380.9375 Q689.5313,380.9375 689.7969,381.1719 Q690.0625,381.4063 690.0625,381.7813 Q690.0625,382.1719 689.7969,382.4063 Q689.5313,382.6406 688.9219,382.6406 L687.2031,382.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="706.75" y="391.7285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="491.5" x2="1029.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:0.5;" x1="491.5" x2="1029.5" y1="410" y2="410"/><ellipse cx="501.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="510.5" y="428.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="501.5" cy="441.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="510.5" y="446.1426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="501.5" cy="459.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="510.5" y="463.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="122" fill="#F1F1F1" height="100.8281" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="3880.5" y="370"/><ellipse cx="4189.75" cy="386" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4192.5156,381.875 Q4192.6719,381.6563 4192.8594,381.5469 Q4193.0469,381.4375 4193.2656,381.4375 Q4193.6406,381.4375 4193.875,381.7031 Q4194.1094,381.9531 4194.1094,382.5625 L4194.1094,384.0156 Q4194.1094,384.625 4193.875,384.8906 Q4193.6406,385.1563 4193.2656,385.1563 Q4192.9219,385.1563 4192.7188,384.9531 Q4192.5156,384.7656 4192.4063,384.25 Q4192.3594,383.8906 4192.1719,383.7031 Q4191.8438,383.3281 4191.2344,383.1094 Q4190.625,382.8906 4190,382.8906 Q4189.2344,382.8906 4188.5938,383.2188 Q4187.9688,383.5469 4187.4688,384.2969 Q4186.9844,385.0469 4186.9844,386.0781 L4186.9844,387.1719 Q4186.9844,388.4063 4187.875,389.2344 Q4188.7656,390.0469 4190.3594,390.0469 Q4191.2969,390.0469 4191.9531,389.7969 Q4192.3438,389.6406 4192.7656,389.2031 Q4193.0313,388.9375 4193.1719,388.8594 Q4193.3281,388.7813 4193.5313,388.7813 Q4193.8594,388.7813 4194.1094,389.0469 Q4194.375,389.2969 4194.375,389.6406 Q4194.375,389.9844 4194.0313,390.3906 Q4193.5313,390.9688 4192.7344,391.2969 Q4191.6563,391.75 4190.3594,391.75 Q4188.8438,391.75 4187.6406,391.125 Q4186.6563,390.625 4185.9688,389.5625 Q4185.2813,388.4844 4185.2813,387.2031 L4185.2813,386.0469 Q4185.2813,384.7188 4185.8906,383.5781 Q4186.5156,382.4219 4187.6094,381.8125 Q4188.7031,381.1875 4189.9375,381.1875 Q4190.6719,381.1875 4191.3125,381.3594 Q4191.9688,381.5156 4192.5156,381.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="4210.25" y="391.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3881.5" x2="4579.5" y1="402" y2="402"/><line style="stroke:#181818;stroke-width:1.0;" x1="3881.5" x2="4579.5" y1="410" y2="410"/><ellipse cx="3891.5" cy="424.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3900.5" y="428.5332">SqlProvider(connection : string)</text><polygon fill="#FFFF44" points="3891.5,436.9141,3895.5,440.9141,3891.5,444.9141,3887.5,440.9141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="3900.5" y="446.1426">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3891.5,454.5234,3895.5,458.5234,3891.5,462.5234,3887.5,458.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3900.5" y="463.752">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="129" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="4034" y="103.5"/><ellipse cx="4138.75" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4141.5156,115.375 Q4141.6719,115.1563 4141.8594,115.0469 Q4142.0469,114.9375 4142.2656,114.9375 Q4142.6406,114.9375 4142.875,115.2031 Q4143.1094,115.4531 4143.1094,116.0625 L4143.1094,117.5156 Q4143.1094,118.125 4142.875,118.3906 Q4142.6406,118.6563 4142.2656,118.6563 Q4141.9219,118.6563 4141.7188,118.4531 Q4141.5156,118.2656 4141.4063,117.75 Q4141.3594,117.3906 4141.1719,117.2031 Q4140.8438,116.8281 4140.2344,116.6094 Q4139.625,116.3906 4139,116.3906 Q4138.2344,116.3906 4137.5938,116.7188 Q4136.9688,117.0469 4136.4688,117.7969 Q4135.9844,118.5469 4135.9844,119.5781 L4135.9844,120.6719 Q4135.9844,121.9063 4136.875,122.7344 Q4137.7656,123.5469 4139.3594,123.5469 Q4140.2969,123.5469 4140.9531,123.2969 Q4141.3438,123.1406 4141.7656,122.7031 Q4142.0313,122.4375 4142.1719,122.3594 Q4142.3281,122.2813 4142.5313,122.2813 Q4142.8594,122.2813 4143.1094,122.5469 Q4143.375,122.7969 4143.375,123.1406 Q4143.375,123.4844 4143.0313,123.8906 Q4142.5313,124.4688 4141.7344,124.7969 Q4140.6563,125.25 4139.3594,125.25 Q4137.8438,125.25 4136.6406,124.625 Q4135.6563,124.125 4134.9688,123.0625 Q4134.2813,121.9844 4134.2813,120.7031 L4134.2813,119.5469 Q4134.2813,118.2188 4134.8906,117.0781 Q4135.5156,115.9219 4136.6094,115.3125 Q4137.7031,114.6875 4138.9375,114.6875 Q4139.6719,114.6875 4140.3125,114.8594 Q4140.9688,115.0156 4141.5156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="4159.25" y="125.2285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="4035" x2="4412" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="4035" x2="4412" y1="143.5" y2="143.5"/><ellipse cx="4045" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="4054" y="162.0332">LeakedPasswordProvider(configuration : IConfiguration)</text></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="140" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="3692.5" y="95"/><ellipse cx="3797.25" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3800.0156,106.875 Q3800.1719,106.6563 3800.3594,106.5469 Q3800.5469,106.4375 3800.7656,106.4375 Q3801.1406,106.4375 3801.375,106.7031 Q3801.6094,106.9531 3801.6094,107.5625 L3801.6094,109.0156 Q3801.6094,109.625 3801.375,109.8906 Q3801.1406,110.1563 3800.7656,110.1563 Q3800.4219,110.1563 3800.2188,109.9531 Q3800.0156,109.7656 3799.9063,109.25 Q3799.8594,108.8906 3799.6719,108.7031 Q3799.3438,108.3281 3798.7344,108.1094 Q3798.125,107.8906 3797.5,107.8906 Q3796.7344,107.8906 3796.0938,108.2188 Q3795.4688,108.5469 3794.9688,109.2969 Q3794.4844,110.0469 3794.4844,111.0781 L3794.4844,112.1719 Q3794.4844,113.4063 3795.375,114.2344 Q3796.2656,115.0469 3797.8594,115.0469 Q3798.7969,115.0469 3799.4531,114.7969 Q3799.8438,114.6406 3800.2656,114.2031 Q3800.5313,113.9375 3800.6719,113.8594 Q3800.8281,113.7813 3801.0313,113.7813 Q3801.3594,113.7813 3801.6094,114.0469 Q3801.875,114.2969 3801.875,114.6406 Q3801.875,114.9844 3801.5313,115.3906 Q3801.0313,115.9688 3800.2344,116.2969 Q3799.1563,116.75 3797.8594,116.75 Q3796.3438,116.75 3795.1406,116.125 Q3794.1563,115.625 3793.4688,114.5625 Q3792.7813,113.4844 3792.7813,112.2031 L3792.7813,111.0469 Q3792.7813,109.7188 3793.3906,108.5781 Q3794.0156,107.4219 3795.1094,106.8125 Q3796.2031,106.1875 3797.4375,106.1875 Q3798.1719,106.1875 3798.8125,106.3594 Q3799.4688,106.5156 3800.0156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3817.75" y="116.7285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3693.5" x2="3991.5" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="3693.5" x2="3991.5" y1="135" y2="135"/><ellipse cx="3703.5" cy="149.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="3712.5" y="153.5332">UserProvider(configuration : IConfiguration)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3700.5" y="163.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="3712.5" y="171.1426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="199" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="2937.5" y="584"/><ellipse cx="3014.75" cy="600" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3017.5156,595.875 Q3017.6719,595.6563 3017.8594,595.5469 Q3018.0469,595.4375 3018.2656,595.4375 Q3018.6406,595.4375 3018.875,595.7031 Q3019.1094,595.9531 3019.1094,596.5625 L3019.1094,598.0156 Q3019.1094,598.625 3018.875,598.8906 Q3018.6406,599.1563 3018.2656,599.1563 Q3017.9219,599.1563 3017.7188,598.9531 Q3017.5156,598.7656 3017.4063,598.25 Q3017.3594,597.8906 3017.1719,597.7031 Q3016.8438,597.3281 3016.2344,597.1094 Q3015.625,596.8906 3015,596.8906 Q3014.2344,596.8906 3013.5938,597.2188 Q3012.9688,597.5469 3012.4688,598.2969 Q3011.9844,599.0469 3011.9844,600.0781 L3011.9844,601.1719 Q3011.9844,602.4063 3012.875,603.2344 Q3013.7656,604.0469 3015.3594,604.0469 Q3016.2969,604.0469 3016.9531,603.7969 Q3017.3438,603.6406 3017.7656,603.2031 Q3018.0313,602.9375 3018.1719,602.8594 Q3018.3281,602.7813 3018.5313,602.7813 Q3018.8594,602.7813 3019.1094,603.0469 Q3019.375,603.2969 3019.375,603.6406 Q3019.375,603.9844 3019.0313,604.3906 Q3018.5313,604.9688 3017.7344,605.2969 Q3016.6563,605.75 3015.3594,605.75 Q3013.8438,605.75 3012.6406,605.125 Q3011.6563,604.625 3010.9688,603.5625 Q3010.2813,602.4844 3010.2813,601.2031 L3010.2813,600.0469 Q3010.2813,598.7188 3010.8906,597.5781 Q3011.5156,596.4219 3012.6094,595.8125 Q3013.7031,595.1875 3014.9375,595.1875 Q3015.6719,595.1875 3016.3125,595.3594 Q3016.9688,595.5156 3017.5156,595.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="3035.25" y="605.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="2938.5" x2="3146.5" y1="616" y2="616"/><ellipse cx="2948.5" cy="630.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2957.5" y="634.5332">HashedPassword : string</text><ellipse cx="2948.5" cy="647.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="2957.5" y="652.1426">Salt : string</text><ellipse cx="2948.5" cy="665.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="2957.5" y="669.752">SecretKey : string</text><ellipse cx="2948.5" cy="683.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="2957.5" y="687.3613">Count : long</text><ellipse cx="2948.5" cy="700.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="2957.5" y="704.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="2938.5" x2="3146.5" y1="712.0469" y2="712.0469"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="224" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="678" y="575"/><ellipse cx="715.5" cy="591" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M718.2656,586.875 Q718.4219,586.6563 718.6094,586.5469 Q718.7969,586.4375 719.0156,586.4375 Q719.3906,586.4375 719.625,586.7031 Q719.8594,586.9531 719.8594,587.5625 L719.8594,589.0156 Q719.8594,589.625 719.625,589.8906 Q719.3906,590.1563 719.0156,590.1563 Q718.6719,590.1563 718.4688,589.9531 Q718.2656,589.7656 718.1563,589.25 Q718.1094,588.8906 717.9219,588.7031 Q717.5938,588.3281 716.9844,588.1094 Q716.375,587.8906 715.75,587.8906 Q714.9844,587.8906 714.3438,588.2188 Q713.7188,588.5469 713.2188,589.2969 Q712.7344,590.0469 712.7344,591.0781 L712.7344,592.1719 Q712.7344,593.4063 713.625,594.2344 Q714.5156,595.0469 716.1094,595.0469 Q717.0469,595.0469 717.7031,594.7969 Q718.0938,594.6406 718.5156,594.2031 Q718.7813,593.9375 718.9219,593.8594 Q719.0781,593.7813 719.2813,593.7813 Q719.6094,593.7813 719.8594,594.0469 Q720.125,594.2969 720.125,594.6406 Q720.125,594.9844 719.7813,595.3906 Q719.2813,595.9688 718.4844,596.2969 Q717.4063,596.75 716.1094,596.75 Q714.5938,596.75 713.3906,596.125 Q712.4063,595.625 711.7188,594.5625 Q711.0313,593.4844 711.0313,592.2031 L711.0313,591.0469 Q711.0313,589.7188 711.6406,588.5781 Q712.2656,587.4219 713.3594,586.8125 Q714.4531,586.1875 715.6875,586.1875 Q716.4219,586.1875 717.0625,586.3594 Q717.7188,586.5156 718.2656,586.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="734.5" y="596.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="679" x2="842" y1="607" y2="607"/><ellipse cx="689" cy="621.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="698" y="625.5332">ID : int</text><ellipse cx="689" cy="638.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="698" y="643.1426">UserID : int</text><ellipse cx="689" cy="656.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="698" y="660.752">IP : string</text><ellipse cx="689" cy="674.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="698" y="678.3613">UserAgent : string</text><ellipse cx="689" cy="691.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="698" y="695.9707">Successful : bool</text><ellipse cx="689" cy="709.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="698" y="713.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="679" x2="842" y1="720.6563" y2="720.6563"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="161" fill="#F1F1F1" height="153.6563" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="580" x="4448.5" y="59.5"/><ellipse cx="4708.75" cy="75.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4711.5156,71.375 Q4711.6719,71.1563 4711.8594,71.0469 Q4712.0469,70.9375 4712.2656,70.9375 Q4712.6406,70.9375 4712.875,71.2031 Q4713.1094,71.4531 4713.1094,72.0625 L4713.1094,73.5156 Q4713.1094,74.125 4712.875,74.3906 Q4712.6406,74.6563 4712.2656,74.6563 Q4711.9219,74.6563 4711.7188,74.4531 Q4711.5156,74.2656 4711.4063,73.75 Q4711.3594,73.3906 4711.1719,73.2031 Q4710.8438,72.8281 4710.2344,72.6094 Q4709.625,72.3906 4709,72.3906 Q4708.2344,72.3906 4707.5938,72.7188 Q4706.9688,73.0469 4706.4688,73.7969 Q4705.9844,74.5469 4705.9844,75.5781 L4705.9844,76.6719 Q4705.9844,77.9063 4706.875,78.7344 Q4707.7656,79.5469 4709.3594,79.5469 Q4710.2969,79.5469 4710.9531,79.2969 Q4711.3438,79.1406 4711.7656,78.7031 Q4712.0313,78.4375 4712.1719,78.3594 Q4712.3281,78.2813 4712.5313,78.2813 Q4712.8594,78.2813 4713.1094,78.5469 Q4713.375,78.7969 4713.375,79.1406 Q4713.375,79.4844 4713.0313,79.8906 Q4712.5313,80.4688 4711.7344,80.7969 Q4710.6563,81.25 4709.3594,81.25 Q4707.8438,81.25 4706.6406,80.625 Q4705.6563,80.125 4704.9688,79.0625 Q4704.2813,77.9844 4704.2813,76.7031 L4704.2813,75.5469 Q4704.2813,74.2188 4704.8906,73.0781 Q4705.5156,71.9219 4706.6094,71.3125 Q4707.7031,70.6875 4708.9375,70.6875 Q4709.6719,70.6875 4710.3125,70.8594 Q4710.9688,71.0156 4711.5156,71.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="4729.25" y="81.2285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="4449.5" x2="5027.5" y1="91.5" y2="91.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="4449.5" x2="5027.5" y1="99.5" y2="99.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="4456.5" y="110.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="253" x="4468.5" y="118.0332">ComputeHash(password : string) : string</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="4456.5" y="128.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="321" x="4468.5" y="135.6426">HashPassword(password : salt, salt : string) : string</text><ellipse cx="4459.5" cy="149.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="4468.5" y="153.252">GetSalt(saltLength : int) : string</text><ellipse cx="4459.5" cy="166.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="554" x="4468.5" y="170.8613">GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string</text><ellipse cx="4459.5" cy="184.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="4468.5" y="188.4707">GetHotp(key : string, counter : long) : string</text><ellipse cx="4459.5" cy="201.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="4468.5" y="206.0801">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="171" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="5063.5" y="103.5"/><ellipse cx="5212.75" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M5215.5156,115.375 Q5215.6719,115.1563 5215.8594,115.0469 Q5216.0469,114.9375 5216.2656,114.9375 Q5216.6406,114.9375 5216.875,115.2031 Q5217.1094,115.4531 5217.1094,116.0625 L5217.1094,117.5156 Q5217.1094,118.125 5216.875,118.3906 Q5216.6406,118.6563 5216.2656,118.6563 Q5215.9219,118.6563 5215.7188,118.4531 Q5215.5156,118.2656 5215.4063,117.75 Q5215.3594,117.3906 5215.1719,117.2031 Q5214.8438,116.8281 5214.2344,116.6094 Q5213.625,116.3906 5213,116.3906 Q5212.2344,116.3906 5211.5938,116.7188 Q5210.9688,117.0469 5210.4688,117.7969 Q5209.9844,118.5469 5209.9844,119.5781 L5209.9844,120.6719 Q5209.9844,121.9063 5210.875,122.7344 Q5211.7656,123.5469 5213.3594,123.5469 Q5214.2969,123.5469 5214.9531,123.2969 Q5215.3438,123.1406 5215.7656,122.7031 Q5216.0313,122.4375 5216.1719,122.3594 Q5216.3281,122.2813 5216.5313,122.2813 Q5216.8594,122.2813 5217.1094,122.5469 Q5217.375,122.7969 5217.375,123.1406 Q5217.375,123.4844 5217.0313,123.8906 Q5216.5313,124.4688 5215.7344,124.7969 Q5214.6563,125.25 5213.3594,125.25 Q5211.8438,125.25 5210.6406,124.625 Q5209.6563,124.125 5208.9688,123.0625 Q5208.2813,121.9844 5208.2813,120.7031 L5208.2813,119.5469 Q5208.2813,118.2188 5208.8906,117.0781 Q5209.5156,115.9219 5210.6094,115.3125 Q5211.7031,114.6875 5212.9375,114.6875 Q5213.6719,114.6875 5214.3125,114.8594 Q5214.9688,115.0156 5215.5156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="5233.25" y="125.2285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="5064.5" x2="5450.5" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="5064.5" x2="5450.5" y1="143.5" y2="143.5"/><ellipse cx="5074.5" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="5083.5" y="162.0332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="191" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="2868.5" y="789"/><ellipse cx="2933.75" cy="805" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2936.5156,800.875 Q2936.6719,800.6563 2936.8594,800.5469 Q2937.0469,800.4375 2937.2656,800.4375 Q2937.6406,800.4375 2937.875,800.7031 Q2938.1094,800.9531 2938.1094,801.5625 L2938.1094,803.0156 Q2938.1094,803.625 2937.875,803.8906 Q2937.6406,804.1563 2937.2656,804.1563 Q2936.9219,804.1563 2936.7188,803.9531 Q2936.5156,803.7656 2936.4063,803.25 Q2936.3594,802.8906 2936.1719,802.7031 Q2935.8438,802.3281 2935.2344,802.1094 Q2934.625,801.8906 2934,801.8906 Q2933.2344,801.8906 2932.5938,802.2188 Q2931.9688,802.5469 2931.4688,803.2969 Q2930.9844,804.0469 2930.9844,805.0781 L2930.9844,806.1719 Q2930.9844,807.4063 2931.875,808.2344 Q2932.7656,809.0469 2934.3594,809.0469 Q2935.2969,809.0469 2935.9531,808.7969 Q2936.3438,808.6406 2936.7656,808.2031 Q2937.0313,807.9375 2937.1719,807.8594 Q2937.3281,807.7813 2937.5313,807.7813 Q2937.8594,807.7813 2938.1094,808.0469 Q2938.375,808.2969 2938.375,808.6406 Q2938.375,808.9844 2938.0313,809.3906 Q2937.5313,809.9688 2936.7344,810.2969 Q2935.6563,810.75 2934.3594,810.75 Q2932.8438,810.75 2931.6406,810.125 Q2930.6563,809.625 2929.9688,808.5625 Q2929.2813,807.4844 2929.2813,806.2031 L2929.2813,805.0469 Q2929.2813,803.7188 2929.8906,802.5781 Q2930.5156,801.4219 2931.6094,800.8125 Q2932.7031,800.1875 2933.9375,800.1875 Q2934.6719,800.1875 2935.3125,800.3594 Q2935.9688,800.5156 2936.5156,800.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="2954.25" y="810.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="2869.5" x2="3035.5" y1="821" y2="821"/><ellipse cx="2879.5" cy="835.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="2888.5" y="839.5332">ID : int</text><ellipse cx="2879.5" cy="852.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="2888.5" y="857.1426">IsVerified : bool</text><ellipse cx="2879.5" cy="870.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="2888.5" y="874.752">IsLocked : bool</text><ellipse cx="2879.5" cy="888.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="2888.5" y="892.3613">FailedTries : int</text><ellipse cx="2879.5" cy="905.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="2888.5" y="909.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="2869.5" x2="3035.5" y1="917.0469" y2="917.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="211" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="2599" y="985"/><ellipse cx="2645.75" cy="1001" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2648.5156,996.875 Q2648.6719,996.6563 2648.8594,996.5469 Q2649.0469,996.4375 2649.2656,996.4375 Q2649.6406,996.4375 2649.875,996.7031 Q2650.1094,996.9531 2650.1094,997.5625 L2650.1094,999.0156 Q2650.1094,999.625 2649.875,999.8906 Q2649.6406,1000.1563 2649.2656,1000.1563 Q2648.9219,1000.1563 2648.7188,999.9531 Q2648.5156,999.7656 2648.4063,999.25 Q2648.3594,998.8906 2648.1719,998.7031 Q2647.8438,998.3281 2647.2344,998.1094 Q2646.625,997.8906 2646,997.8906 Q2645.2344,997.8906 2644.5938,998.2188 Q2643.9688,998.5469 2643.4688,999.2969 Q2642.9844,1000.0469 2642.9844,1001.0781 L2642.9844,1002.1719 Q2642.9844,1003.4063 2643.875,1004.2344 Q2644.7656,1005.0469 2646.3594,1005.0469 Q2647.2969,1005.0469 2647.9531,1004.7969 Q2648.3438,1004.6406 2648.7656,1004.2031 Q2649.0313,1003.9375 2649.1719,1003.8594 Q2649.3281,1003.7813 2649.5313,1003.7813 Q2649.8594,1003.7813 2650.1094,1004.0469 Q2650.375,1004.2969 2650.375,1004.6406 Q2650.375,1004.9844 2650.0313,1005.3906 Q2649.5313,1005.9688 2648.7344,1006.2969 Q2647.6563,1006.75 2646.3594,1006.75 Q2644.8438,1006.75 2643.6406,1006.125 Q2642.6563,1005.625 2641.9688,1004.5625 Q2641.2813,1003.4844 2641.2813,1002.2031 L2641.2813,1001.0469 Q2641.2813,999.7188 2641.8906,998.5781 Q2642.5156,997.4219 2643.6094,996.8125 Q2644.7031,996.1875 2645.9375,996.1875 Q2646.6719,996.1875 2647.3125,996.3594 Q2647.9688,996.5156 2648.5156,996.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="2666.25" y="1006.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="2600" x2="2761" y1="1017" y2="1017"/><ellipse cx="2610" cy="1031.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="2619" y="1035.5332">Email : string</text><ellipse cx="2610" cy="1048.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="2619" y="1053.1426">FirstName : string</text><ellipse cx="2610" cy="1066.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="2619" y="1070.752">LastName : string</text><ellipse cx="2610" cy="1084.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="2619" y="1088.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="2600" x2="2761" y1="1095.4375" y2="1095.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="21" d="M1139.5,252.83 C1139.5,252.83 1139.5,352.23 1139.5,352.23 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1139.5,239.83,1135.5,245.83,1139.5,251.83,1143.5,245.83,1139.5,239.83" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1146.7102" y="261.496">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1106.0484" y="341.8755">1</text></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="22" d="M658.69,209 C658.69,209 334.17,209 334.17,209 C334.17,209 334.17,307.27 334.17,369.84 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="671.69,209,665.69,205,659.69,209,665.69,213,671.69,209" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="657.4036" y="208.2066">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="335.2095" y="359.1229">1</text></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="89" d="M1719.04,480 C2072.86,480 2587.5,480 2587.5,480 C2587.5,480 2587.5,818.87 2587.5,818.87 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2587.5,823.87,2591.5,814.87,2587.5,818.87,2583.5,814.87,2587.5,823.87" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1726.7753" y="478.7057">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2579.7781" y="812.9586">1</text></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="90" d="M1392.5,488.71 C1392.5,488.71 1392.5,605.41 1392.5,605.41 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1392.5,610.41,1396.5,601.41,1392.5,605.41,1388.5,601.41,1392.5,610.41" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1385.1391" y="510.08">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1384.9203" y="599.7028">1</text></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="91" d="M2594.88,266.04 C2594.88,316.3 2594.88,362 2594.88,362 C2594.88,362 1739.07,362 1739.07,362 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1739.07,369,1719.07,362,1739.07,355,1739.07,369" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d484ee4b213f86a79b7b13bd52fde3a]
link MessageManager to IMessageManager--><g id="link_MessageManager_IMessageManager"><path codeLine="92" d="M2406.25,187.27 C2406.25,187.27 2406.25,358.93 2406.25,358.93 " fill="none" id="MessageManager-to-IMessageManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2413.25,358.93,2406.25,378.93,2399.25,358.93,2413.25,358.93" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="94" d="M3132.5,279.03 C3132.5,279.03 3132.5,325.97 3132.5,325.97 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3132.5,266.03,3128.5,272.03,3132.5,278.03,3136.5,272.03,3132.5,266.03" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3128.3945" y="287.907">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3125.2102" y="314.9941">1</text></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="95" d="M2672.25,279.22 C2672.25,279.22 2672.25,375 2672.25,375 C2672.25,375 2472.25,375 2294.51,375 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2672.25,266.22,2668.25,272.22,2672.25,278.22,2676.25,272.22,2672.25,266.22" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2641.3879" y="287.6782">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2302.6298" y="370.9146">1</text></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="96" d="M3541.5,279.03 C3541.5,279.03 3541.5,387.35 3541.5,387.35 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3541.5,266.03,3537.5,272.03,3541.5,278.03,3545.5,272.03,3541.5,266.03" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3562.318" y="287.907">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3513.1531" y="376.4345">1</text></g><!--MD5=[f1b914c86bbf4264254e7be00f738a27]
reverse link UserManager to IMessageManager--><g id="link_UserManager_IMessageManager"><path codeLine="97" d="M2749.62,279.03 C2749.62,279.03 2749.62,378.68 2749.62,378.68 " fill="none" id="UserManager-backto-IMessageManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2749.62,266.03,2745.62,272.03,2749.62,278.03,2753.62,272.03,2749.62,266.03" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2722.1828" y="287.907">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2769.3344" y="368.2456">1</text></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="99" d="M212.83,178.1 C212.83,178.1 212.83,349.66 212.83,349.66 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="219.83,349.66,212.83,369.66,205.83,349.66,219.83,349.66" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="100" d="M273.5,484.02 C273.5,484.02 273.5,601.19 273.5,601.19 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="273.5,471.02,269.5,477.02,273.5,483.02,277.5,477.02,273.5,471.02" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="266.0297" y="492.4139">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="266.0297" y="590.8177">1</text></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="103" d="M1736.75,178.17 C1736.75,257.2 1736.75,421 1736.75,421 C1736.75,421 1738.51,421 1738.51,421 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1734.32,414,1754.32,421,1734.32,428,1734.32,414" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="104" d="M1508.25,191.41 C1508.25,191.41 1508.25,296 1508.25,296 C1508.25,296 851.25,296 851.25,296 C851.25,296 851.25,335.39 851.25,369.86 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1508.25,178.41,1504.25,184.41,1508.25,190.41,1512.25,184.41,1508.25,178.41" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1497.9195" y="199.5578">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="856.5195" y="359.1457">1</text></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="150" d="M3042.5,528.33 C3042.5,528.33 3042.5,583.88 3042.5,583.88 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="3042.5,515.33,3038.5,521.33,3042.5,527.33,3046.5,521.33,3042.5,515.33" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3028.6336" y="536.3942">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3035.1172" y="573.0662">1</text></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="151" d="M760.5,484.02 C760.5,484.02 760.5,574.72 760.5,574.72 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="760.5,471.02,756.5,477.02,760.5,483.02,764.5,477.02,760.5,471.02" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="753.0297" y="492.4139">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="753.1664" y="564.12">1</text></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="153" d="M4160.33,169.53 C4160.33,199.82 4160.33,240 4160.33,240 C4160.33,240 3794.5,240 3794.5,240 C3794.5,240 3794.5,367.39 3794.5,367.39 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3801.5,367.39,3794.5,387.39,3787.5,367.39,3801.5,367.39" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="154" d="M4286.67,169.63 C4286.67,169.63 4286.67,349.89 4286.67,349.89 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="4293.67,349.89,4286.67,369.89,4279.67,349.89,4293.67,349.89" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="156" d="M3743.5,178.03 C3743.5,239.63 3743.5,348 3743.5,348 C3743.5,348 3422.72,348 3422.72,348 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3422.72,355,3402.72,348,3422.72,341,3422.72,355" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="157" d="M3936.5,178.1 C3936.5,178.1 3936.5,349.66 3936.5,349.66 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3943.5,349.66,3936.5,369.66,3929.5,349.66,3943.5,349.66" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="178" d="M2868.44,908 C2797.79,908 2708.25,908 2708.25,908 C2708.25,908 2708.25,964.74 2708.25,964.74 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2715.25,964.74,2708.25,984.74,2701.25,964.74,2715.25,964.74" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="179" d="M2626.75,890 C2626.75,890 2626.75,964.89 2626.75,964.89 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2633.75,964.89,2626.75,984.89,2619.75,964.89,2633.75,964.89" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="181" d="M2987,720.26 C2987,720.26 2987,768.69 2987,768.69 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2994,768.69,2987,788.69,2980,768.69,2994,768.69" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4c6707709efd0fcaf38070165f1c8116]
@startuml API class diagram

top to bottom direction
skinparam linetype ortho
'Controllers'

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +CreateAsync(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +LoginAsync(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromTokenAsync() : Task<ActionResult<User>>
    +VerificationLoginAsync(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +VerifyUserRegisterAsync(UserLogin : UserLogin) : Task<ActionResult>
    -GetUserLocation() : UserLocation
}

'Controllers mappings' 

UserController "1" o- - "1" IUserManager
UserController "1" o- - "1" ITokenManager

'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessageAsync(to : string, otp : string) : Task<bool>
    +SendLoginRegistrationMessageAsync(to : string, key : string) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageManager : IMessageManager
    -_logger : ILogger<UserManager>
    -_configuration : IConfiguration
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    -CheckPasswordLeakedForUserAsync(password : string) : Task<bool>
    -IsUserNotVerifiedAsync(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLockedAsync(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}
class MessageManager {
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    - -
    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)
}


'Managers mappings'

IUserManager "1" - -> "1" UserCreate
IUserManager "1" - -> "1" UserLogin
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager "1" o- - "1" IUserProvider
UserManager "1" o- - "1" IUserLocationManager
UserManager "1" o- - "1" ILeakedPasswordProvider
UserManager "1" o- - "1" IMessageManager

TokenManager .-|> ITokenManager
ITokenManager "1" *- - "1" UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTriesAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocationAsync(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCodeAsync(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider "1" *- - "1" DbUser
IUserLocationProvider "1" *- - "1" UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

'Utility'

class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction
skinparam linetype ortho

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +CreateAsync(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +LoginAsync(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromTokenAsync() : Task<ActionResult<User>>
    +VerificationLoginAsync(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +VerifyUserRegisterAsync(UserLogin : UserLogin) : Task<ActionResult>
    -GetUserLocation() : UserLocation
}


UserController "1" o- - "1" IUserManager
UserController "1" o- - "1" ITokenManager


Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessageAsync(to : string, otp : string) : Task<bool>
    +SendLoginRegistrationMessageAsync(to : string, key : string) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageManager : IMessageManager
    -_logger : ILogger<UserManager>
    -_configuration : IConfiguration
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    -CheckPasswordLeakedForUserAsync(password : string) : Task<bool>
    -IsUserNotVerifiedAsync(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLockedAsync(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}
class MessageManager {
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    - -
    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)
}



IUserManager "1" - -> "1" UserCreate
IUserManager "1" - -> "1" UserLogin
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager "1" o- - "1" IUserProvider
UserManager "1" o- - "1" IUserLocationManager
UserManager "1" o- - "1" ILeakedPasswordProvider
UserManager "1" o- - "1" IMessageManager

TokenManager .-|> ITokenManager
ITokenManager "1" *- - "1" UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTriesAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocationAsync(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCodeAsync(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider "1" *- - "1" DbUser
IUserLocationProvider "1" *- - "1" UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider


class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>