<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="962px" preserveAspectRatio="none" style="width:1032px;height:962px;background:#FFFFFF;" version="1.1" viewBox="0 0 1032 962" width="1032px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="287" x="10" y="173.3125"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="481" x="10" y="327.0703"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="481" x="10" y="480.8281"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="37" x2="37" y1="82.6094" y2="880.3984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="234" x2="234" y1="82.6094" y2="880.3984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="431" x2="431" y1="82.6094" y2="880.3984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="620.5" x2="620.5" y1="82.6094" y2="880.3984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="733.5" x2="733.5" y1="82.6094" y2="880.3984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="874.5" x2="874.5" y1="82.6094" y2="880.3984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="993.5" x2="993.5" y1="82.6094" y2="880.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="20" y="79.5332">User</text><ellipse cx="37.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M37.5,21.5 L37.5,48.5 M24.5,29.5 L50.5,29.5 M37.5,48.5 L24.5,63.5 M37.5,48.5 L50.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="20" y="893.9316">User</text><ellipse cx="37.5" cy="905.5078" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M37.5,913.5078 L37.5,940.5078 M24.5,921.5078 L50.5,921.5078 M37.5,940.5078 L24.5,955.5078 M37.5,940.5078 L50.5,955.5078 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="182" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="189" y="71.5332">UserController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="182" y="879.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="189" y="900.9316">UserController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="382" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="389" y="71.5332">UserManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="382" y="879.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="389" y="900.9316">UserManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="572.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="579.5" y="71.5332">UserProvider</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="572.5" y="879.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="579.5" y="900.9316">UserProvider</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="678.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="685.5" y="71.5332">TokenManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="678.5" y="879.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="685.5" y="900.9316">TokenManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="798.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="805.5" y="71.5332">UserLocationManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="798.5" y="879.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="805.5" y="900.9316">UserLocationManager</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="961.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="968.5" y="71.5332">Security</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="961.5" y="879.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="968.5" y="900.9316">Security</text><polygon fill="#181818" points="222.5,110.9609,232.5,114.9609,222.5,118.9609,226.5,114.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="37.5" x2="228.5" y1="114.9609" y2="114.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="44.5" y="110.1045">Create user (email, password)</text><line style="stroke:#181818;stroke-width:1.0;" x1="234.5" x2="276.5" y1="145.3125" y2="145.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="276.5" x2="276.5" y1="145.3125" y2="158.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="235.5" x2="276.5" y1="158.3125" y2="158.3125"/><polygon fill="#181818" points="245.5,154.3125,235.5,158.3125,245.5,162.3125,241.5,158.3125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="241.5" y="140.4561">Validate password(password)</text><path d="M10,173.3125 L71,173.3125 L71,181.6641 L61,191.6641 L10,191.6641 L10,173.3125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:1.5;" width="287" x="10" y="173.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="187.8076">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="145" x="86" y="186.7314">[Password not complying]</text><polygon fill="#181818" points="48.5,210.0156,38.5,214.0156,48.5,218.0156,44.5,214.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="233.5" y1="214.0156" y2="214.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="54.5" y="209.1592">Return status badrequest</text><polygon fill="#181818" points="419.5,247.3672,429.5,251.3672,419.5,255.3672,423.5,251.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="234.5" x2="425.5" y1="251.3672" y2="251.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="241.5" y="246.5107">Create user (email, password)</text><polygon fill="#181818" points="863,277.7188,873,281.7188,863,285.7188,867,281.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="431.5" x2="869" y1="281.7188" y2="281.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="438.5" y="276.8623">Check if ip is blocked (ipadress)</text><polygon fill="#181818" points="442.5,308.0703,432.5,312.0703,442.5,316.0703,438.5,312.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="436.5" x2="874" y1="312.0703" y2="312.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="448.5" y="307.2139">Returns whether ip is block</text><path d="M10,327.0703 L71,327.0703 L71,335.4219 L61,345.4219 L10,345.4219 L10,327.0703 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="481" x="10" y="327.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="341.5654">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65" x="86" y="340.4893">[Ip blocked]</text><polygon fill="#181818" points="245.5,363.7734,235.5,367.7734,245.5,371.7734,241.5,367.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="239.5" x2="430.5" y1="367.7734" y2="367.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="251.5" y="362.917">Throw IPBlocked exception</text><polygon fill="#181818" points="48.5,394.125,38.5,398.125,48.5,402.125,44.5,398.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="233.5" y1="398.125" y2="398.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="54.5" y="393.2686">Return status forbidden</text><polygon fill="#181818" points="608.5,431.4766,618.5,435.4766,608.5,439.4766,612.5,435.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="431.5" x2="614.5" y1="435.4766" y2="435.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="438.5" y="430.6201">Get user by email(email)</text><polygon fill="#181818" points="442.5,461.8281,432.5,465.8281,442.5,469.8281,438.5,465.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="436.5" x2="619.5" y1="465.8281" y2="465.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="448.5" y="460.9717">Return User</text><path d="M10,480.8281 L71,480.8281 L71,489.1797 L61,499.1797 L10,499.1797 L10,480.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="481" x="10" y="480.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="495.3232">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="69" x="86" y="494.2471">[User found]</text><polygon fill="#181818" points="245.5,517.5313,235.5,521.5313,245.5,525.5313,241.5,521.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="239.5" x2="430.5" y1="521.5313" y2="521.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="251.5" y="516.6748">User already exists</text><polygon fill="#181818" points="48.5,547.8828,38.5,551.8828,48.5,555.8828,44.5,551.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.5" x2="233.5" y1="551.8828" y2="551.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="54.5" y="547.0264">User already exists</text><polygon fill="#181818" points="982,585.2344,992,589.2344,982,593.2344,986,589.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="431.5" x2="988" y1="589.2344" y2="589.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="438.5" y="584.3779">Get salt</text><polygon fill="#181818" points="442.5,615.5859,432.5,619.5859,442.5,623.5859,438.5,619.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="436.5" x2="993" y1="619.5859" y2="619.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="448.5" y="614.7295">Return salt</text><polygon fill="#181818" points="982,645.9375,992,649.9375,982,653.9375,986,649.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="431.5" x2="988" y1="649.9375" y2="649.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="438.5" y="645.0811">Salt password (password, salt)</text><polygon fill="#181818" points="442.5,676.2891,432.5,680.2891,442.5,684.2891,438.5,680.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="436.5" x2="993" y1="680.2891" y2="680.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="448.5" y="675.4326">Return salted password</text><polygon fill="#181818" points="608.5,706.6406,618.5,710.6406,608.5,714.6406,612.5,710.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="431.5" x2="614.5" y1="710.6406" y2="710.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="438.5" y="705.7842">Save user in database (user)</text><polygon fill="#181818" points="442.5,736.9922,432.5,740.9922,442.5,744.9922,438.5,740.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="436.5" x2="619.5" y1="740.9922" y2="740.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="448.5" y="736.1357">Return saved user</text><polygon fill="#181818" points="245.5,767.3438,235.5,771.3438,245.5,775.3438,241.5,771.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="239.5" x2="430.5" y1="771.3438" y2="771.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="251.5" y="766.4873">Returns User</text><polygon fill="#181818" points="721.5,797.6953,731.5,801.6953,721.5,805.6953,725.5,801.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="234.5" x2="727.5" y1="801.6953" y2="801.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="241.5" y="796.8389">Get token for user (User)</text><polygon fill="#181818" points="245.5,828.0469,235.5,832.0469,245.5,836.0469,241.5,832.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="239.5" x2="732.5" y1="832.0469" y2="832.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="251.5" y="827.1904">Returns Token</text><polygon fill="#181818" points="48.5,858.3984,38.5,862.3984,48.5,866.3984,44.5,862.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.5" x2="233.5" y1="862.3984" y2="862.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="54.5" y="857.542">Return token</text><!--MD5=[dfae800007f9b03e06b3b5111d1f0047]
@startuml Create User SD


actor User
participant UserController
participant UserManager
participant UserProvider
participant TokenManager
participant UserLocationManager
participant Security



User->UserController: Create user (email, password)
UserController->UserController: Validate password(password)

alt Password not complying
UserController- ->User: Return status badrequest
end

UserController->UserManager: Create user (email, password)
UserManager->UserLocationManager: Check if ip is blocked (ipadress)
UserLocationManager- ->UserManager: Returns whether ip is block

alt Ip blocked
UserManager- ->UserController: Throw IPBlocked exception
UserController- ->User: Return status forbidden
end

UserManager->UserProvider: Get user by email(email)
UserProvider->UserManager: Return User

alt User found

UserManager->UserController: User already exists
UserController->User: User already exists

end


UserManager->Security: Get salt
Security->UserManager: Return salt

UserManager->Security: Salt password (password, salt)
Security->UserManager: Return salted password

UserManager->UserProvider: Save user in database (user)
UserProvider->UserManager: Return saved user


UserManager->UserController: Returns User
UserController->TokenManager: Get token for user (User)
TokenManager->UserController: Returns Token

UserController->User: Return token

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>