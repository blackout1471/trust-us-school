<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="865px" preserveAspectRatio="none" style="width:435px;height:865px;background:#FFFFFF;" version="1.1" viewBox="0 0 435 865" width="435px" zoomAndPan="magnify"><defs/><g><ellipse cx="329.3063" cy="16" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="268.8063" y="67"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="278.8063" y="89.457">Recieve login data</text><g id="elem_#5"><polygon fill="#90EE90" points="329.3063,143,341.3063,155,329.3063,167,317.3063,155,329.3063,143" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#8"><polygon fill="#90EE90" points="284.3063,227.5,296.3063,239.5,284.3063,251.5,272.3063,239.5,284.3063,227.5" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#11"><polygon fill="#90EE90" points="259.3063,298,271.3063,310,259.3063,322,247.3063,310,259.3063,298" style="stroke:#181818;stroke-width:0.5;"/></g><g id="elem_#14"><polygon fill="#90EE90" points="136.3063,363,148.3063,375,136.3063,387,124.3063,375,136.3063,363" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="17.3063" y="687"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="27.3063" y="709.457">Generate token</text><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="24.3063" y="763"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="70" x="34.3063" y="785.457">Return token</text><ellipse cx="69.3063" cy="849" fill="none" rx="10" ry="10" style="stroke:#FF0000;stroke-width:1.0;"/><ellipse cx="69.8063" cy="849.5" fill="#FF0000" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="183" x="44.8063" y="442"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="163" x="54.8063" y="464.457">Send verification code to User</text><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="176" x="52.3063" y="532"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="156" x="62.3063" y="554.457">User enters verification code</text><g id="elem_#27"><polygon fill="#90EE90" points="140.3063,608,152.3063,620,140.3063,632,128.3063,620,140.3063,608" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="198.8063" y="687"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="208.8063" y="709.457">Throw Login failed</text><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="316.8063" y="222"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="93" x="326.8063" y="244.457">Throw Forbidden</text><!--MD5=[0cc5c6088e8b133b764c8e39458fa7f0]
link start to Recieve login data--><g id="link_start_Recieve login data"><path d="M329.3063,26.25 C329.3063,35.43 329.3063,49.84 329.3063,61.9 " fill="none" id="start-to-Recieve login data" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="329.3063,66.91,333.3063,57.91,329.3063,61.91,325.3063,57.91,329.3063,66.91" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[66602bce3d97b17711fac82889a600fb]
link Recieve login data to #5--><g id="link_Recieve login data_#5"><path d="M329.3063,102.08 C329.3063,112.87 329.3063,126.88 329.3063,137.63 " fill="none" id="Recieve login data-to-#5" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="329.3063,142.92,333.3063,133.92,329.3063,137.92,325.3063,133.92,329.3063,142.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="247.2188" y="132.485">Ip not blocked</text></g><!--MD5=[0c0d8213b86c66ad298a167b10270357]
link #5 to #8--><g id="link_#5_#8"><path d="M325.3162,163.32 C317.5263,177.6 300.2562,209.26 290.7963,226.59 " fill="none" id="#5-to-#8" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="288.3563,231.08,296.1857,225.1051,290.7565,226.6938,289.1678,221.2646,288.3563,231.08" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="56" x="211.4" y="216.8097">Email exists</text></g><!--MD5=[04fae5d0eb764058787a86ce8fc6a833]
link #8 to #11--><g id="link_#8_#11"><path d="M281.3362,248.63 C277.0563,260.37 269.0862,282.19 263.9963,296.14 " fill="none" id="#8-to-#11" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="262.2663,300.88,269.108,293.7955,263.9795,296.1827,261.5924,291.0542,262.2663,300.88" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="94" x="279.44" y="294.0732">Password matches</text></g><!--MD5=[c1bb20eee0439e1debf317a372abdd7f]
link #11 to #14--><g id="link_#11_#14"><path d="M251.9763,314.75 C231.5163,325.23 173.6163,354.89 148.3463,367.83 " fill="none" id="#11-to-#14" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="143.7463,370.19,153.5812,369.6674,148.2011,367.9197,149.9488,362.5396,143.7463,370.19" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="161" x="156.1128" y="367.0773">User has logged in before from ip</text></g><!--MD5=[4f7b89c734b9effb4ad342c99e1677ae]
link #14 to Generate token--><g id="link_#14_Generate token"><path d="M126.4963,377.59 C97.0263,382.97 11.3063,403.38 11.3063,458.5 C11.3063,458.5 11.3063,458.5 11.3063,621 C11.3063,645.53 28.6863,667.93 44.4163,683.17 " fill="none" id="#14-to-Generate token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="48.3663,686.89,44.5539,677.8089,44.7253,683.4632,39.071,683.6345,48.3663,686.89" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="12.3063" y="554.4189">true</text></g><!--MD5=[098c265f84ee990ea225bc2bb82fd240]
link Generate token to Return token--><g id="link_Generate token_Return token"><path d="M69.3063,722.29 C69.3063,732.79 69.3063,746.43 69.3063,757.75 " fill="none" id="Generate token-to-Return token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="69.3063,762.77,73.3063,753.77,69.3063,757.77,65.3063,753.77,69.3063,762.77" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e178f1f4068ee0e7f5aeacc8dbfee9ac]
link Return token to end--><g id="link_Return token_end"><path d="M69.3063,798.28 C69.3063,809.29 69.3063,823.52 69.3063,833.94 " fill="none" id="Return token-to-end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="69.3063,839,73.3063,830,69.3063,834,65.3063,830,69.3063,839" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4450b92500a75d4f6c512929bd8a9280]
link #14 to Send verification code to User--><g id="link_#14_Send verification code to User"><path d="M136.3063,387.13 C136.3063,399.77 136.3063,420.72 136.3063,436.66 " fill="none" id="#14-to-Send verification code to User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="136.3063,441.85,140.3063,432.85,136.3063,436.85,132.3063,432.85,136.3063,441.85" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="137.3063" y="419.4189">false</text></g><!--MD5=[a0ff370cc409434c99cba3229b3f4991]
link Send verification code to User to User enters verification code--><g id="link_Send verification code to User_User enters verification code"><path d="M137.0563,477.05 C137.6963,491.1 138.6163,511.36 139.3163,526.72 " fill="none" id="Send verification code to User-to-User enters verification code" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="139.5463,531.72,143.1311,522.5467,139.3179,526.7252,135.1394,522.9121,139.5463,531.72" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[cbc7cf35062c99b4cdd6e9a7f331ec59]
link User enters verification code to #27--><g id="link_User enters verification code_#27"><path d="M140.3063,567.08 C140.3063,577.87 140.3063,591.88 140.3063,602.63 " fill="none" id="User enters verification code-to-#27" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="140.3063,607.92,144.3063,598.92,140.3063,602.92,136.3063,598.92,140.3063,607.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="114" x="6" y="599.8687">Verification code match</text></g><!--MD5=[15fde578ec644e3e9b1d4c28a8e23d6d]
link #27 to Generate token--><g id="link_#27_Generate token"><path d="M135.1963,626.93 C125.2663,638.47 102.9263,664.43 87.0163,682.92 " fill="none" id="#27-to-Generate token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="83.5263,686.98,92.4204,682.7499,86.7802,683.1837,86.3463,677.5435,83.5263,686.98" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="114.3063" y="664.4189">true</text></g><!--MD5=[2a91e9072930953d142dbf529973e86f]
link #27 to Throw Login failed--><g id="link_#27_Throw Login failed"><path d="M147.0463,625.67 C162.9163,636.67 203.3863,664.73 231.1363,683.97 " fill="none" id="#27-to-Throw Login failed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="235.4663,686.98,230.3495,678.5646,231.3574,684.131,225.791,685.1389,235.4663,686.98" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="205.3063" y="664.4189">false</text></g><!--MD5=[01f1a6d198c9986ab862bd0e2b9d7c33]
link #11 to Throw Login failed--><g id="link_#11_Throw Login failed"><path d="M259.3063,322.15 C259.3063,334.74 259.3063,355.84 259.3063,374 C259.3063,374 259.3063,374 259.3063,621 C259.3063,641.46 259.3063,664.78 259.3063,681.39 " fill="none" id="#11-to-Throw Login failed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="259.3063,686.75,263.3063,677.75,259.3063,681.75,255.3063,677.75,259.3063,686.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="260.3063" y="509.4189">false</text></g><!--MD5=[9665a20f1985d8d609772a5d2be6703e]
link #8 to Throw Login failed--><g id="link_#8_Throw Login failed"><path d="M288.8362,247.37 C296.2863,259.35 310.3063,285.09 310.3063,309 C310.3063,309 310.3063,309 310.3063,621 C310.3063,644.91 294.6262,667.67 280.6462,683.21 " fill="none" id="#8-to-Throw Login failed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="277.1462,687,286.1881,683.0955,280.5359,683.3243,280.307,677.6721,277.1462,687" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="311.3063" y="464.4189">false</text></g><!--MD5=[289bd9f7143d1c97131a8b56bece89fe]
link #5 to Throw Forbidden--><g id="link_#5_Throw Forbidden"><path d="M333.2062,163.32 C339.5563,175.22 352.3362,199.19 361.7763,216.88 " fill="none" id="#5-to-Throw Forbidden" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="364.3362,221.69,363.6122,211.8678,361.9751,217.2826,356.5603,215.6456,364.3362,221.69" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="354.3063" y="199.4189">false</text></g><!--MD5=[509de9e63fd57d890f10a847716388dc]
@startuml Login Flowchart

skinparam activity {
    BackgroundColor lightblue
    
    StartColor green
    EndColor red
    
    diamondBackgroundColor lightgreen
}

(*) - -> "Recieve login data"

if "Ip not blocked" then
    if "Email exists" then
        if "Password matches" then
            if "User has logged in before from ip" then
                - ->[true] "Generate token"
                - -> "Return token"
                - -> (*)
            else
                - ->[false] Send verification code to User
                - -> User enters verification code
                if "Verification code match" then
                - ->[true] "Generate token"
                else
                - ->[false] "Throw Login failed"
                end if
            end if 
        else
            - ->[false] "Throw Login failed"
        end if
    else
      - ->[false] "Throw Login failed"

    end if 
else 
 - ->[false] "Throw Forbidden"
end if
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>