<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1039px" preserveAspectRatio="none" style="width:5221px;height:1039px;background:#FFFFFF;" version="1.1" viewBox="0 0 5221 1039" width="5221px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="171.2656" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="521" x="690" y="24.5"/><ellipse cx="900.75" cy="40.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M903.5156,36.375 Q903.6719,36.1563 903.8594,36.0469 Q904.0469,35.9375 904.2656,35.9375 Q904.6406,35.9375 904.875,36.1953 Q905.1094,36.4531 905.1094,37.0625 L905.1094,38.5156 Q905.1094,39.125 904.875,39.3906 Q904.6406,39.6563 904.2656,39.6563 Q903.9219,39.6563 903.7188,39.4531 Q903.5156,39.2656 903.4063,38.75 Q903.3594,38.3906 903.1719,38.2031 Q902.8438,37.8281 902.2344,37.6094 Q901.625,37.3906 901,37.3906 Q900.2344,37.3906 899.6016,37.7188 Q898.9688,38.0469 898.4766,38.7969 Q897.9844,39.5469 897.9844,40.5781 L897.9844,41.6719 Q897.9844,42.9063 898.875,43.7266 Q899.7656,44.5469 901.3594,44.5469 Q902.2969,44.5469 902.9531,44.2969 Q903.3438,44.1406 903.7656,43.7031 Q904.0313,43.4375 904.1797,43.3594 Q904.3281,43.2813 904.5313,43.2813 Q904.8594,43.2813 905.1172,43.5391 Q905.375,43.7969 905.375,44.1406 Q905.375,44.4844 905.0313,44.8906 Q904.5313,45.4688 903.7344,45.7969 Q902.6563,46.25 901.3594,46.25 Q899.8438,46.25 898.6406,45.625 Q897.6563,45.125 896.9688,44.0547 Q896.2813,42.9844 896.2813,41.7031 L896.2813,40.5469 Q896.2813,39.2188 896.8984,38.0703 Q897.5156,36.9219 898.6094,36.3047 Q899.7031,35.6875 900.9375,35.6875 Q901.6719,35.6875 902.3203,35.8516 Q902.9688,36.0156 903.5156,36.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="921.25" y="46.2285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="691" x2="1210" y1="56.5" y2="56.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="698" y="67.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="710" y="75.0332">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="698" y="85.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="710" y="92.6426">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:1.0;" x1="691" x2="1210" y1="99.7188" y2="99.7188"/><ellipse cx="701" cy="114.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="710" y="118.252">UserController(userManager : IUserManager, tokenManager : ITokenManager)</text><ellipse cx="701" cy="131.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="710" y="135.8613">Create(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="701" cy="149.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="710" y="153.4707">Login(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="701" cy="166.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="318" x="710" y="171.0801">GetUserFromToken() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="701" cy="184.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="477" x="710" y="188.6895">VerificationLogin(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="24" fill="#F1F1F1" height="118.4375" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="653" x="1066" y="299.5"/><ellipse cx="1342.75" cy="315.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1343.7031,312.1406 L1343.7031,318.7969 L1345.4219,318.7969 Q1346.0313,318.7969 1346.2969,319.0313 Q1346.5625,319.2656 1346.5625,319.6563 Q1346.5625,320.0313 1346.2969,320.2656 Q1346.0313,320.5 1345.4219,320.5 L1340.2813,320.5 Q1339.6719,320.5 1339.4063,320.2656 Q1339.1406,320.0313 1339.1406,319.6406 Q1339.1406,319.2656 1339.4063,319.0313 Q1339.6719,318.7969 1340.2813,318.7969 L1342,318.7969 L1342,312.1406 L1340.2813,312.1406 Q1339.6719,312.1406 1339.4063,311.9063 Q1339.1406,311.6719 1339.1406,311.2813 Q1339.1406,310.9063 1339.4063,310.6719 Q1339.6719,310.4375 1340.2813,310.4375 L1345.4219,310.4375 Q1346.0313,310.4375 1346.2969,310.6719 Q1346.5625,310.9063 1346.5625,311.2813 Q1346.5625,311.6719 1346.2969,311.9063 Q1346.0313,312.1406 1345.4219,312.1406 L1343.7031,312.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="1363.25" y="321.2285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1067" x2="1718" y1="331.5" y2="331.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1067" x2="1718" y1="339.5" y2="339.5"/><ellipse cx="1077" cy="353.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="363" x="1086" y="358.0332">CreateUserAsync(userCreate : UserCreate) : Task&lt;User&gt;</text><ellipse cx="1077" cy="371.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="1086" y="375.6426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="1077" cy="389.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="1086" y="393.252">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="1077" cy="406.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="627" x="1086" y="410.8613">LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="31" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="91.5" y="308"/><ellipse cx="218.25" cy="324" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M219.2031,320.6406 L219.2031,327.2969 L220.9219,327.2969 Q221.5313,327.2969 221.7969,327.5313 Q222.0625,327.7656 222.0625,328.1563 Q222.0625,328.5313 221.7969,328.7656 Q221.5313,329 220.9219,329 L215.7813,329 Q215.1719,329 214.9063,328.7656 Q214.6406,328.5313 214.6406,328.1406 Q214.6406,327.7656 214.9063,327.5313 Q215.1719,327.2969 215.7813,327.2969 L217.5,327.2969 L217.5,320.6406 L215.7813,320.6406 Q215.1719,320.6406 214.9063,320.4063 Q214.6406,320.1719 214.6406,319.7813 Q214.6406,319.4063 214.9063,319.1719 Q215.1719,318.9375 215.7813,318.9375 L220.9219,318.9375 Q221.5313,318.9375 221.7969,319.1719 Q222.0625,319.4063 222.0625,319.7813 Q222.0625,320.1719 221.7969,320.4063 Q221.5313,320.6406 220.9219,320.6406 L219.2031,320.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="238.75" y="329.7285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="92.5" x2="454.5" y1="340" y2="340"/><line style="stroke:#181818;stroke-width:0.5;" x1="92.5" x2="454.5" y1="348" y2="348"/><ellipse cx="102.5" cy="362.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="111.5" y="366.5332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="102.5" cy="379.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="111.5" y="384.1426">ValidateToken(token : string) : bool</text><ellipse cx="102.5" cy="397.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="111.5" y="401.752">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="38" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1754.5" y="308"/><ellipse cx="1947.75" cy="324" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1948.7031,320.6406 L1948.7031,327.2969 L1950.4219,327.2969 Q1951.0313,327.2969 1951.2969,327.5313 Q1951.5625,327.7656 1951.5625,328.1563 Q1951.5625,328.5313 1951.2969,328.7656 Q1951.0313,329 1950.4219,329 L1945.2813,329 Q1944.6719,329 1944.4063,328.7656 Q1944.1406,328.5313 1944.1406,328.1406 Q1944.1406,327.7656 1944.4063,327.5313 Q1944.6719,327.2969 1945.2813,327.2969 L1947,327.2969 L1947,320.6406 L1945.2813,320.6406 Q1944.6719,320.6406 1944.4063,320.4063 Q1944.1406,320.1719 1944.1406,319.7813 Q1944.1406,319.4063 1944.4063,319.1719 Q1944.6719,318.9375 1945.2813,318.9375 L1950.4219,318.9375 Q1951.0313,318.9375 1951.2969,319.1719 Q1951.5625,319.4063 1951.5625,319.7813 Q1951.5625,320.1719 1951.2969,320.4063 Q1951.0313,320.6406 1950.4219,320.6406 L1948.7031,320.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="1968.25" y="329.7285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1755.5" x2="2293.5" y1="340" y2="340"/><line style="stroke:#181818;stroke-width:0.5;" x1="1755.5" x2="2293.5" y1="348" y2="348"/><ellipse cx="1765.5" cy="362.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1774.5" y="366.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1765.5" cy="379.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="1774.5" y="384.1426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1765.5" cy="397.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1774.5" y="401.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[5bbb8fec178e848d13dc3ca00e0fbd40]
class IMessageManager--><g id="elem_IMessageManager"><rect codeLine="44" fill="#F1F1F1" height="83.2188" id="IMessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="411" x="2330" y="317"/><ellipse cx="2471.75" cy="333" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2472.7031,329.6406 L2472.7031,336.2969 L2474.4219,336.2969 Q2475.0313,336.2969 2475.2969,336.5313 Q2475.5625,336.7656 2475.5625,337.1563 Q2475.5625,337.5313 2475.2969,337.7656 Q2475.0313,338 2474.4219,338 L2469.2813,338 Q2468.6719,338 2468.4063,337.7656 Q2468.1406,337.5313 2468.1406,337.1406 Q2468.1406,336.7656 2468.4063,336.5313 Q2468.6719,336.2969 2469.2813,336.2969 L2471,336.2969 L2471,329.6406 L2469.2813,329.6406 Q2468.6719,329.6406 2468.4063,329.4063 Q2468.1406,329.1719 2468.1406,328.7813 Q2468.1406,328.4063 2468.4063,328.1719 Q2468.6719,327.9375 2469.2813,327.9375 L2474.4219,327.9375 Q2475.0313,327.9375 2475.2969,328.1719 Q2475.5625,328.4063 2475.5625,328.7813 Q2475.5625,329.1719 2475.2969,329.4063 Q2475.0313,329.6406 2474.4219,329.6406 L2472.7031,329.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="119" x="2492.25" y="338.7285">IMessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2331" x2="2740" y1="349" y2="349"/><line style="stroke:#181818;stroke-width:0.5;" x1="2331" x2="2740" y1="357" y2="357"/><ellipse cx="2341" cy="371.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="355" x="2350" y="375.5332">SendLoginAttemptMessage(to : string, otp : string) : void</text><ellipse cx="2341" cy="388.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="385" x="2350" y="393.1426">SendLoginRegistrationMessage(to : string, key : string) : void</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="49" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="68.5"/><ellipse cx="221.25" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,80.375 Q224.1719,80.1563 224.3594,80.0469 Q224.5469,79.9375 224.7656,79.9375 Q225.1406,79.9375 225.375,80.1953 Q225.6094,80.4531 225.6094,81.0625 L225.6094,82.5156 Q225.6094,83.125 225.375,83.3906 Q225.1406,83.6563 224.7656,83.6563 Q224.4219,83.6563 224.2188,83.4531 Q224.0156,83.2656 223.9063,82.75 Q223.8594,82.3906 223.6719,82.2031 Q223.3438,81.8281 222.7344,81.6094 Q222.125,81.3906 221.5,81.3906 Q220.7344,81.3906 220.1016,81.7188 Q219.4688,82.0469 218.9766,82.7969 Q218.4844,83.5469 218.4844,84.5781 L218.4844,85.6719 Q218.4844,86.9063 219.375,87.7266 Q220.2656,88.5469 221.8594,88.5469 Q222.7969,88.5469 223.4531,88.2969 Q223.8438,88.1406 224.2656,87.7031 Q224.5313,87.4375 224.6797,87.3594 Q224.8281,87.2813 225.0313,87.2813 Q225.3594,87.2813 225.6172,87.5391 Q225.875,87.7969 225.875,88.1406 Q225.875,88.4844 225.5313,88.8906 Q225.0313,89.4688 224.2344,89.7969 Q223.1563,90.25 221.8594,90.25 Q220.3438,90.25 219.1406,89.625 Q218.1563,89.125 217.4688,88.0547 Q216.7813,86.9844 216.7813,85.7031 L216.7813,84.5469 Q216.7813,83.2188 217.3984,82.0703 Q218.0156,80.9219 219.1094,80.3047 Q220.2031,79.6875 221.4375,79.6875 Q222.1719,79.6875 222.8203,79.8516 Q223.4688,80.0156 224.0156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="90.2285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="100.5" y2="100.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="539" y1="108.5" y2="108.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="119.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="127.0332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="137.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="144.6426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="55" fill="#F1F1F1" height="206.4844" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="938" x="2529.5" y="7"/><ellipse cx="2951.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2954.5156,18.875 Q2954.6719,18.6563 2954.8594,18.5469 Q2955.0469,18.4375 2955.2656,18.4375 Q2955.6406,18.4375 2955.875,18.6953 Q2956.1094,18.9531 2956.1094,19.5625 L2956.1094,21.0156 Q2956.1094,21.625 2955.875,21.8906 Q2955.6406,22.1563 2955.2656,22.1563 Q2954.9219,22.1563 2954.7188,21.9531 Q2954.5156,21.7656 2954.4063,21.25 Q2954.3594,20.8906 2954.1719,20.7031 Q2953.8438,20.3281 2953.2344,20.1094 Q2952.625,19.8906 2952,19.8906 Q2951.2344,19.8906 2950.6016,20.2188 Q2949.9688,20.5469 2949.4766,21.2969 Q2948.9844,22.0469 2948.9844,23.0781 L2948.9844,24.1719 Q2948.9844,25.4063 2949.875,26.2266 Q2950.7656,27.0469 2952.3594,27.0469 Q2953.2969,27.0469 2953.9531,26.7969 Q2954.3438,26.6406 2954.7656,26.2031 Q2955.0313,25.9375 2955.1797,25.8594 Q2955.3281,25.7813 2955.5313,25.7813 Q2955.8594,25.7813 2956.1172,26.0391 Q2956.375,26.2969 2956.375,26.6406 Q2956.375,26.9844 2956.0313,27.3906 Q2955.5313,27.9688 2954.7344,28.2969 Q2953.6563,28.75 2952.3594,28.75 Q2950.8438,28.75 2949.6406,28.125 Q2948.6563,27.625 2947.9688,26.5547 Q2947.2813,25.4844 2947.2813,24.2031 L2947.2813,23.0469 Q2947.2813,21.7188 2947.8984,20.5703 Q2948.5156,19.4219 2949.6094,18.8047 Q2950.7031,18.1875 2951.9375,18.1875 Q2952.6719,18.1875 2953.3203,18.3516 Q2953.9688,18.5156 2954.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="2972.25" y="28.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2530.5" x2="3466.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2537.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="2549.5" y="57.5332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2537.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2549.5" y="75.1426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2537.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="2549.5" y="92.752">_userLocationManager : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2537.5" y="103.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="249" x="2549.5" y="110.3613">_messageManager : IMessageManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2537.5" y="120.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="2549.5" y="127.9707">_logger : ILogger&lt;UserManager&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2537.5" y="138.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438" x="2549.5" y="145.5801">IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool</text><line style="stroke:#181818;stroke-width:1.0;" x1="2530.5" x2="3466.5" y1="152.6563" y2="152.6563"/><ellipse cx="2540.5" cy="166.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="912" x="2549.5" y="171.1895">UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="455" x="2549.5" y="188.7988">messageManager : IMessageManager, logger : ILogger&lt;UserManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2537.5" y="199.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="402" x="2549.5" y="206.4082">CheckPasswordLeakedForUser(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="68" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="458" x="1304.5" y="68.5"/><ellipse cx="1459.75" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1462.5156,80.375 Q1462.6719,80.1563 1462.8594,80.0469 Q1463.0469,79.9375 1463.2656,79.9375 Q1463.6406,79.9375 1463.875,80.1953 Q1464.1094,80.4531 1464.1094,81.0625 L1464.1094,82.5156 Q1464.1094,83.125 1463.875,83.3906 Q1463.6406,83.6563 1463.2656,83.6563 Q1462.9219,83.6563 1462.7188,83.4531 Q1462.5156,83.2656 1462.4063,82.75 Q1462.3594,82.3906 1462.1719,82.2031 Q1461.8438,81.8281 1461.2344,81.6094 Q1460.625,81.3906 1460,81.3906 Q1459.2344,81.3906 1458.6016,81.7188 Q1457.9688,82.0469 1457.4766,82.7969 Q1456.9844,83.5469 1456.9844,84.5781 L1456.9844,85.6719 Q1456.9844,86.9063 1457.875,87.7266 Q1458.7656,88.5469 1460.3594,88.5469 Q1461.2969,88.5469 1461.9531,88.2969 Q1462.3438,88.1406 1462.7656,87.7031 Q1463.0313,87.4375 1463.1797,87.3594 Q1463.3281,87.2813 1463.5313,87.2813 Q1463.8594,87.2813 1464.1172,87.5391 Q1464.375,87.7969 1464.375,88.1406 Q1464.375,88.4844 1464.0313,88.8906 Q1463.5313,89.4688 1462.7344,89.7969 Q1461.6563,90.25 1460.3594,90.25 Q1458.8438,90.25 1457.6406,89.625 Q1456.6563,89.125 1455.9688,88.0547 Q1455.2813,86.9844 1455.2813,85.7031 L1455.2813,84.5469 Q1455.2813,83.2188 1455.8984,82.0703 Q1456.5156,80.9219 1457.6094,80.3047 Q1458.7031,79.6875 1459.9375,79.6875 Q1460.6719,79.6875 1461.3203,79.8516 Q1461.9688,80.0156 1462.5156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="1480.25" y="90.2285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1305.5" x2="1761.5" y1="100.5" y2="100.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1312.5" y="111.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="1324.5" y="119.0332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="1305.5" x2="1761.5" y1="126.1094" y2="126.1094"/><ellipse cx="1315.5" cy="140.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="432" x="1324.5" y="144.6426">UserLocationManager(userLocationProvider : UserLocationProvider)</text></g><!--MD5=[20fcb2fa68efbd583f0fa2981cab489f]
class MessageManager--><g id="elem_MessageManager"><rect codeLine="73" fill="#F1F1F1" height="100.8281" id="MessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="668" x="1826.5" y="59.5"/><ellipse cx="2099.75" cy="75.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2102.5156,71.375 Q2102.6719,71.1563 2102.8594,71.0469 Q2103.0469,70.9375 2103.2656,70.9375 Q2103.6406,70.9375 2103.875,71.1953 Q2104.1094,71.4531 2104.1094,72.0625 L2104.1094,73.5156 Q2104.1094,74.125 2103.875,74.3906 Q2103.6406,74.6563 2103.2656,74.6563 Q2102.9219,74.6563 2102.7188,74.4531 Q2102.5156,74.2656 2102.4063,73.75 Q2102.3594,73.3906 2102.1719,73.2031 Q2101.8438,72.8281 2101.2344,72.6094 Q2100.625,72.3906 2100,72.3906 Q2099.2344,72.3906 2098.6016,72.7188 Q2097.9688,73.0469 2097.4766,73.7969 Q2096.9844,74.5469 2096.9844,75.5781 L2096.9844,76.6719 Q2096.9844,77.9063 2097.875,78.7266 Q2098.7656,79.5469 2100.3594,79.5469 Q2101.2969,79.5469 2101.9531,79.2969 Q2102.3438,79.1406 2102.7656,78.7031 Q2103.0313,78.4375 2103.1797,78.3594 Q2103.3281,78.2813 2103.5313,78.2813 Q2103.8594,78.2813 2104.1172,78.5391 Q2104.375,78.7969 2104.375,79.1406 Q2104.375,79.4844 2104.0313,79.8906 Q2103.5313,80.4688 2102.7344,80.7969 Q2101.6563,81.25 2100.3594,81.25 Q2098.8438,81.25 2097.6406,80.625 Q2096.6563,80.125 2095.9688,79.0547 Q2095.2813,77.9844 2095.2813,76.7031 L2095.2813,75.5469 Q2095.2813,74.2188 2095.8984,73.0703 Q2096.5156,71.9219 2097.6094,71.3047 Q2098.7031,70.6875 2099.9375,70.6875 Q2100.6719,70.6875 2101.3203,70.8516 Q2101.9688,71.0156 2102.5156,71.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="2120.25" y="81.2285">MessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1827.5" x2="2493.5" y1="91.5" y2="91.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1834.5" y="102.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="1846.5" y="110.0332">_messageService : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1834.5" y="120.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="1846.5" y="127.6426">_messageProvider : IMessageProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1827.5" x2="2493.5" y1="134.7188" y2="134.7188"/><ellipse cx="1837.5" cy="149.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="642" x="1846.5" y="153.252">MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="199" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="2441.5" y="753"/><ellipse cx="2470" cy="769" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2472.7656,764.875 Q2472.9219,764.6563 2473.1094,764.5469 Q2473.2969,764.4375 2473.5156,764.4375 Q2473.8906,764.4375 2474.125,764.6953 Q2474.3594,764.9531 2474.3594,765.5625 L2474.3594,767.0156 Q2474.3594,767.625 2474.125,767.8906 Q2473.8906,768.1563 2473.5156,768.1563 Q2473.1719,768.1563 2472.9688,767.9531 Q2472.7656,767.7656 2472.6563,767.25 Q2472.6094,766.8906 2472.4219,766.7031 Q2472.0938,766.3281 2471.4844,766.1094 Q2470.875,765.8906 2470.25,765.8906 Q2469.4844,765.8906 2468.8516,766.2188 Q2468.2188,766.5469 2467.7266,767.2969 Q2467.2344,768.0469 2467.2344,769.0781 L2467.2344,770.1719 Q2467.2344,771.4063 2468.125,772.2266 Q2469.0156,773.0469 2470.6094,773.0469 Q2471.5469,773.0469 2472.2031,772.7969 Q2472.5938,772.6406 2473.0156,772.2031 Q2473.2813,771.9375 2473.4297,771.8594 Q2473.5781,771.7813 2473.7813,771.7813 Q2474.1094,771.7813 2474.3672,772.0391 Q2474.625,772.2969 2474.625,772.6406 Q2474.625,772.9844 2474.2813,773.3906 Q2473.7813,773.9688 2472.9844,774.2969 Q2471.9063,774.75 2470.6094,774.75 Q2469.0938,774.75 2467.8906,774.125 Q2466.9063,773.625 2466.2188,772.5547 Q2465.5313,771.4844 2465.5313,770.2031 L2465.5313,769.0469 Q2465.5313,767.7188 2466.1484,766.5703 Q2466.7656,765.4219 2467.8594,764.8047 Q2468.9531,764.1875 2470.1875,764.1875 Q2470.9219,764.1875 2471.5703,764.3516 Q2472.2188,764.5156 2472.7656,764.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="2487" y="774.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="2442.5" x2="2574.5" y1="785" y2="785"/><ellipse cx="2452.5" cy="799.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="2461.5" y="803.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="2442.5" x2="2574.5" y1="810.6094" y2="810.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="211" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1325.5" y="539.5"/><ellipse cx="1357.6" cy="555.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1360.3656,551.375 Q1360.5219,551.1563 1360.7094,551.0469 Q1360.8969,550.9375 1361.1156,550.9375 Q1361.4906,550.9375 1361.725,551.1953 Q1361.9594,551.4531 1361.9594,552.0625 L1361.9594,553.5156 Q1361.9594,554.125 1361.725,554.3906 Q1361.4906,554.6563 1361.1156,554.6563 Q1360.7719,554.6563 1360.5688,554.4531 Q1360.3656,554.2656 1360.2563,553.75 Q1360.2094,553.3906 1360.0219,553.2031 Q1359.6938,552.8281 1359.0844,552.6094 Q1358.475,552.3906 1357.85,552.3906 Q1357.0844,552.3906 1356.4516,552.7188 Q1355.8188,553.0469 1355.3266,553.7969 Q1354.8344,554.5469 1354.8344,555.5781 L1354.8344,556.6719 Q1354.8344,557.9063 1355.725,558.7266 Q1356.6156,559.5469 1358.2094,559.5469 Q1359.1469,559.5469 1359.8031,559.2969 Q1360.1938,559.1406 1360.6156,558.7031 Q1360.8813,558.4375 1361.0297,558.3594 Q1361.1781,558.2813 1361.3813,558.2813 Q1361.7094,558.2813 1361.9672,558.5391 Q1362.225,558.7969 1362.225,559.1406 Q1362.225,559.4844 1361.8813,559.8906 Q1361.3813,560.4688 1360.5844,560.7969 Q1359.5063,561.25 1358.2094,561.25 Q1356.6938,561.25 1355.4906,560.625 Q1354.5063,560.125 1353.8188,559.0547 Q1353.1313,557.9844 1353.1313,556.7031 L1353.1313,555.5469 Q1353.1313,554.2188 1353.7484,553.0703 Q1354.3656,551.9219 1355.4594,551.3047 Q1356.5531,550.6875 1357.7875,550.6875 Q1358.5219,550.6875 1359.1703,550.8516 Q1359.8188,551.0156 1360.3656,551.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1375.4" y="561.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="1326.5" x2="1458.5" y1="571.5" y2="571.5"/><ellipse cx="1336.5" cy="585.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1345.5" y="590.0332">Email : string</text><ellipse cx="1336.5" cy="603.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1345.5" y="607.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1326.5" x2="1458.5" y1="614.7188" y2="614.7188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="101" fill="#F1F1F1" height="171.2656" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="502" x="2776.5" y="273"/><ellipse cx="2980.25" cy="289" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2981.2031,285.6406 L2981.2031,292.2969 L2982.9219,292.2969 Q2983.5313,292.2969 2983.7969,292.5313 Q2984.0625,292.7656 2984.0625,293.1563 Q2984.0625,293.5313 2983.7969,293.7656 Q2983.5313,294 2982.9219,294 L2977.7813,294 Q2977.1719,294 2976.9063,293.7656 Q2976.6406,293.5313 2976.6406,293.1406 Q2976.6406,292.7656 2976.9063,292.5313 Q2977.1719,292.2969 2977.7813,292.2969 L2979.5,292.2969 L2979.5,285.6406 L2977.7813,285.6406 Q2977.1719,285.6406 2976.9063,285.4063 Q2976.6406,285.1719 2976.6406,284.7813 Q2976.6406,284.4063 2976.9063,284.1719 Q2977.1719,283.9375 2977.7813,283.9375 L2982.9219,283.9375 Q2983.5313,283.9375 2983.7969,284.1719 Q2984.0625,284.4063 2984.0625,284.7813 Q2984.0625,285.1719 2983.7969,285.4063 Q2983.5313,285.6406 2982.9219,285.6406 L2981.2031,285.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="3000.75" y="294.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2777.5" x2="3277.5" y1="305" y2="305"/><line style="stroke:#181818;stroke-width:0.5;" x1="2777.5" x2="3277.5" y1="313" y2="313"/><ellipse cx="2787.5" cy="327.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2796.5" y="331.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2787.5" cy="344.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2796.5" y="349.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2787.5" cy="362.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2796.5" y="366.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2787.5" cy="380.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="2796.5" y="384.3613">UpdateUserFailedTries(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2787.5" cy="397.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2796.5" y="401.9707">UpdateUserLoginSuccess(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2787.5" cy="415.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="371" x="2796.5" y="419.5801">UpdateUserLoginNewLocation(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2787.5" cy="432.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="476" x="2796.5" y="437.1895">UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="111" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="3313.5" y="325.5"/><ellipse cx="3430.75" cy="341.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3431.7031,338.1406 L3431.7031,344.7969 L3433.4219,344.7969 Q3434.0313,344.7969 3434.2969,345.0313 Q3434.5625,345.2656 3434.5625,345.6563 Q3434.5625,346.0313 3434.2969,346.2656 Q3434.0313,346.5 3433.4219,346.5 L3428.2813,346.5 Q3427.6719,346.5 3427.4063,346.2656 Q3427.1406,346.0313 3427.1406,345.6406 Q3427.1406,345.2656 3427.4063,345.0313 Q3427.6719,344.7969 3428.2813,344.7969 L3430,344.7969 L3430,338.1406 L3428.2813,338.1406 Q3427.6719,338.1406 3427.4063,337.9063 Q3427.1406,337.6719 3427.1406,337.2813 Q3427.1406,336.9063 3427.4063,336.6719 Q3427.6719,336.4375 3428.2813,336.4375 L3433.4219,336.4375 Q3434.0313,336.4375 3434.2969,336.6719 Q3434.5625,336.9063 3434.5625,337.2813 Q3434.5625,337.6719 3434.2969,337.9063 Q3434.0313,338.1406 3433.4219,338.1406 L3431.7031,338.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="3451.25" y="347.2285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3314.5" x2="3720.5" y1="357.5" y2="357.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="3314.5" x2="3720.5" y1="365.5" y2="365.5"/><ellipse cx="3324.5" cy="379.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="3333.5" y="384.0332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="177" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="217" y="530.5"/><ellipse cx="237.4" cy="546.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M240.1656,542.375 Q240.3219,542.1563 240.5094,542.0469 Q240.6969,541.9375 240.9156,541.9375 Q241.2906,541.9375 241.525,542.1953 Q241.7594,542.4531 241.7594,543.0625 L241.7594,544.5156 Q241.7594,545.125 241.525,545.3906 Q241.2906,545.6563 240.9156,545.6563 Q240.5719,545.6563 240.3688,545.4531 Q240.1656,545.2656 240.0563,544.75 Q240.0094,544.3906 239.8219,544.2031 Q239.4938,543.8281 238.8844,543.6094 Q238.275,543.3906 237.65,543.3906 Q236.8844,543.3906 236.2516,543.7188 Q235.6188,544.0469 235.1266,544.7969 Q234.6344,545.5469 234.6344,546.5781 L234.6344,547.6719 Q234.6344,548.9063 235.525,549.7266 Q236.4156,550.5469 238.0094,550.5469 Q238.9469,550.5469 239.6031,550.2969 Q239.9938,550.1406 240.4156,549.7031 Q240.6813,549.4375 240.8297,549.3594 Q240.9781,549.2813 241.1813,549.2813 Q241.5094,549.2813 241.7672,549.5391 Q242.025,549.7969 242.025,550.1406 Q242.025,550.4844 241.6813,550.8906 Q241.1813,551.4688 240.3844,551.7969 Q239.3063,552.25 238.0094,552.25 Q236.4938,552.25 235.2906,551.625 Q234.3063,551.125 233.6188,550.0547 Q232.9313,548.9844 232.9313,547.7031 L232.9313,546.5469 Q232.9313,545.2188 233.5484,544.0703 Q234.1656,542.9219 235.2594,542.3047 Q236.3531,541.6875 237.5875,541.6875 Q238.3219,541.6875 238.9703,541.8516 Q239.6188,542.0156 240.1656,542.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="252.6" y="552.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="218" x2="329" y1="562.5" y2="562.5"/><ellipse cx="228" cy="576.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="237" y="581.0332">UserID : int</text><ellipse cx="228" cy="594.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="237" y="598.6426">Email : string</text><ellipse cx="228" cy="612.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="237" y="616.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="218" x2="329" y1="623.3281" y2="623.3281"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="127" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="490.5" y="308"/><ellipse cx="686.25" cy="324" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M687.2031,320.6406 L687.2031,327.2969 L688.9219,327.2969 Q689.5313,327.2969 689.7969,327.5313 Q690.0625,327.7656 690.0625,328.1563 Q690.0625,328.5313 689.7969,328.7656 Q689.5313,329 688.9219,329 L683.7813,329 Q683.1719,329 682.9063,328.7656 Q682.6406,328.5313 682.6406,328.1406 Q682.6406,327.7656 682.9063,327.5313 Q683.1719,327.2969 683.7813,327.2969 L685.5,327.2969 L685.5,320.6406 L683.7813,320.6406 Q683.1719,320.6406 682.9063,320.4063 Q682.6406,320.1719 682.6406,319.7813 Q682.6406,319.4063 682.9063,319.1719 Q683.1719,318.9375 683.7813,318.9375 L688.9219,318.9375 Q689.5313,318.9375 689.7969,319.1719 Q690.0625,319.4063 690.0625,319.7813 Q690.0625,320.1719 689.7969,320.4063 Q689.5313,320.6406 688.9219,320.6406 L687.2031,320.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="706.75" y="329.7285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="491.5" x2="1029.5" y1="340" y2="340"/><line style="stroke:#181818;stroke-width:0.5;" x1="491.5" x2="1029.5" y1="348" y2="348"/><ellipse cx="501.5" cy="362.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="510.5" y="366.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="501.5" cy="379.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="510.5" y="384.1426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="501.5" cy="397.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="510.5" y="401.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="115" fill="#F1F1F1" height="100.8281" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="3756.5" y="308"/><ellipse cx="4065.75" cy="324" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4068.5156,319.875 Q4068.6719,319.6563 4068.8594,319.5469 Q4069.0469,319.4375 4069.2656,319.4375 Q4069.6406,319.4375 4069.875,319.6953 Q4070.1094,319.9531 4070.1094,320.5625 L4070.1094,322.0156 Q4070.1094,322.625 4069.875,322.8906 Q4069.6406,323.1563 4069.2656,323.1563 Q4068.9219,323.1563 4068.7188,322.9531 Q4068.5156,322.7656 4068.4063,322.25 Q4068.3594,321.8906 4068.1719,321.7031 Q4067.8438,321.3281 4067.2344,321.1094 Q4066.625,320.8906 4066,320.8906 Q4065.2344,320.8906 4064.6016,321.2188 Q4063.9688,321.5469 4063.4766,322.2969 Q4062.9844,323.0469 4062.9844,324.0781 L4062.9844,325.1719 Q4062.9844,326.4063 4063.875,327.2266 Q4064.7656,328.0469 4066.3594,328.0469 Q4067.2969,328.0469 4067.9531,327.7969 Q4068.3438,327.6406 4068.7656,327.2031 Q4069.0313,326.9375 4069.1797,326.8594 Q4069.3281,326.7813 4069.5313,326.7813 Q4069.8594,326.7813 4070.1172,327.0391 Q4070.375,327.2969 4070.375,327.6406 Q4070.375,327.9844 4070.0313,328.3906 Q4069.5313,328.9688 4068.7344,329.2969 Q4067.6563,329.75 4066.3594,329.75 Q4064.8438,329.75 4063.6406,329.125 Q4062.6563,328.625 4061.9688,327.5547 Q4061.2813,326.4844 4061.2813,325.2031 L4061.2813,324.0469 Q4061.2813,322.7188 4061.8984,321.5703 Q4062.5156,320.4219 4063.6094,319.8047 Q4064.7031,319.1875 4065.9375,319.1875 Q4066.6719,319.1875 4067.3203,319.3516 Q4067.9688,319.5156 4068.5156,319.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="4086.25" y="329.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3757.5" x2="4455.5" y1="340" y2="340"/><line style="stroke:#181818;stroke-width:1.0;" x1="3757.5" x2="4455.5" y1="348" y2="348"/><ellipse cx="3767.5" cy="362.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3776.5" y="366.5332">SqlProvider(connection : string)</text><polygon fill="#FFFF44" points="3767.5,374.9141,3771.5,378.9141,3767.5,382.9141,3763.5,378.9141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="3776.5" y="384.1426">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3767.5,392.5234,3771.5,396.5234,3767.5,400.5234,3763.5,396.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3776.5" y="401.752">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="122" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3897" y="77"/><ellipse cx="4001.75" cy="93" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4004.5156,88.875 Q4004.6719,88.6563 4004.8594,88.5469 Q4005.0469,88.4375 4005.2656,88.4375 Q4005.6406,88.4375 4005.875,88.6953 Q4006.1094,88.9531 4006.1094,89.5625 L4006.1094,91.0156 Q4006.1094,91.625 4005.875,91.8906 Q4005.6406,92.1563 4005.2656,92.1563 Q4004.9219,92.1563 4004.7188,91.9531 Q4004.5156,91.7656 4004.4063,91.25 Q4004.3594,90.8906 4004.1719,90.7031 Q4003.8438,90.3281 4003.2344,90.1094 Q4002.625,89.8906 4002,89.8906 Q4001.2344,89.8906 4000.6016,90.2188 Q3999.9688,90.5469 3999.4766,91.2969 Q3998.9844,92.0469 3998.9844,93.0781 L3998.9844,94.1719 Q3998.9844,95.4063 3999.875,96.2266 Q4000.7656,97.0469 4002.3594,97.0469 Q4003.2969,97.0469 4003.9531,96.7969 Q4004.3438,96.6406 4004.7656,96.2031 Q4005.0313,95.9375 4005.1797,95.8594 Q4005.3281,95.7813 4005.5313,95.7813 Q4005.8594,95.7813 4006.1172,96.0391 Q4006.375,96.2969 4006.375,96.6406 Q4006.375,96.9844 4006.0313,97.3906 Q4005.5313,97.9688 4004.7344,98.2969 Q4003.6563,98.75 4002.3594,98.75 Q4000.8438,98.75 3999.6406,98.125 Q3998.6563,97.625 3997.9688,96.5547 Q3997.2813,95.4844 3997.2813,94.2031 L3997.2813,93.0469 Q3997.2813,91.7188 3997.8984,90.5703 Q3998.5156,89.4219 3999.6094,88.8047 Q4000.7031,88.1875 4001.9375,88.1875 Q4002.6719,88.1875 4003.3203,88.3516 Q4003.9688,88.5156 4004.5156,88.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="4022.25" y="98.7285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3898" x2="4275" y1="109" y2="109"/><line style="stroke:#181818;stroke-width:1.0;" x1="3898" x2="4275" y1="117" y2="117"/><ellipse cx="3908" cy="131.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3917" y="135.5332">LeakedPasswordProvider(configuration : IConfiguration)</text></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="133" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="3541.5" y="68.5"/><ellipse cx="3646.25" cy="84.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3649.0156,80.375 Q3649.1719,80.1563 3649.3594,80.0469 Q3649.5469,79.9375 3649.7656,79.9375 Q3650.1406,79.9375 3650.375,80.1953 Q3650.6094,80.4531 3650.6094,81.0625 L3650.6094,82.5156 Q3650.6094,83.125 3650.375,83.3906 Q3650.1406,83.6563 3649.7656,83.6563 Q3649.4219,83.6563 3649.2188,83.4531 Q3649.0156,83.2656 3648.9063,82.75 Q3648.8594,82.3906 3648.6719,82.2031 Q3648.3438,81.8281 3647.7344,81.6094 Q3647.125,81.3906 3646.5,81.3906 Q3645.7344,81.3906 3645.1016,81.7188 Q3644.4688,82.0469 3643.9766,82.7969 Q3643.4844,83.5469 3643.4844,84.5781 L3643.4844,85.6719 Q3643.4844,86.9063 3644.375,87.7266 Q3645.2656,88.5469 3646.8594,88.5469 Q3647.7969,88.5469 3648.4531,88.2969 Q3648.8438,88.1406 3649.2656,87.7031 Q3649.5313,87.4375 3649.6797,87.3594 Q3649.8281,87.2813 3650.0313,87.2813 Q3650.3594,87.2813 3650.6172,87.5391 Q3650.875,87.7969 3650.875,88.1406 Q3650.875,88.4844 3650.5313,88.8906 Q3650.0313,89.4688 3649.2344,89.7969 Q3648.1563,90.25 3646.8594,90.25 Q3645.3438,90.25 3644.1406,89.625 Q3643.1563,89.125 3642.4688,88.0547 Q3641.7813,86.9844 3641.7813,85.7031 L3641.7813,84.5469 Q3641.7813,83.2188 3642.3984,82.0703 Q3643.0156,80.9219 3644.1094,80.3047 Q3645.2031,79.6875 3646.4375,79.6875 Q3647.1719,79.6875 3647.8203,79.8516 Q3648.4688,80.0156 3649.0156,80.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3666.75" y="90.2285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3542.5" x2="3840.5" y1="100.5" y2="100.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3542.5" x2="3840.5" y1="108.5" y2="108.5"/><ellipse cx="3552.5" cy="122.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="3561.5" y="127.0332">UserProvider(configuration : IConfiguration)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3549.5" y="137.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="3561.5" y="144.6426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="191" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="2838.5" y="513"/><ellipse cx="2915.75" cy="529" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2918.5156,524.875 Q2918.6719,524.6563 2918.8594,524.5469 Q2919.0469,524.4375 2919.2656,524.4375 Q2919.6406,524.4375 2919.875,524.6953 Q2920.1094,524.9531 2920.1094,525.5625 L2920.1094,527.0156 Q2920.1094,527.625 2919.875,527.8906 Q2919.6406,528.1563 2919.2656,528.1563 Q2918.9219,528.1563 2918.7188,527.9531 Q2918.5156,527.7656 2918.4063,527.25 Q2918.3594,526.8906 2918.1719,526.7031 Q2917.8438,526.3281 2917.2344,526.1094 Q2916.625,525.8906 2916,525.8906 Q2915.2344,525.8906 2914.6016,526.2188 Q2913.9688,526.5469 2913.4766,527.2969 Q2912.9844,528.0469 2912.9844,529.0781 L2912.9844,530.1719 Q2912.9844,531.4063 2913.875,532.2266 Q2914.7656,533.0469 2916.3594,533.0469 Q2917.2969,533.0469 2917.9531,532.7969 Q2918.3438,532.6406 2918.7656,532.2031 Q2919.0313,531.9375 2919.1797,531.8594 Q2919.3281,531.7813 2919.5313,531.7813 Q2919.8594,531.7813 2920.1172,532.0391 Q2920.375,532.2969 2920.375,532.6406 Q2920.375,532.9844 2920.0313,533.3906 Q2919.5313,533.9688 2918.7344,534.2969 Q2917.6563,534.75 2916.3594,534.75 Q2914.8438,534.75 2913.6406,534.125 Q2912.6563,533.625 2911.9688,532.5547 Q2911.2813,531.4844 2911.2813,530.2031 L2911.2813,529.0469 Q2911.2813,527.7188 2911.8984,526.5703 Q2912.5156,525.4219 2913.6094,524.8047 Q2914.7031,524.1875 2915.9375,524.1875 Q2916.6719,524.1875 2917.3203,524.3516 Q2917.9688,524.5156 2918.5156,524.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2936.25" y="534.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="2839.5" x2="3047.5" y1="545" y2="545"/><ellipse cx="2849.5" cy="559.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2858.5" y="563.5332">HashedPassword : string</text><ellipse cx="2849.5" cy="576.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="2858.5" y="581.1426">Salt : string</text><ellipse cx="2849.5" cy="594.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="2858.5" y="598.752">SecretKey : string</text><ellipse cx="2849.5" cy="612.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="2858.5" y="616.3613">Count : long</text><ellipse cx="2849.5" cy="629.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="2858.5" y="633.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="2839.5" x2="3047.5" y1="641.0469" y2="641.0469"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="216" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="678" y="504"/><ellipse cx="715.5" cy="520" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M718.2656,515.875 Q718.4219,515.6563 718.6094,515.5469 Q718.7969,515.4375 719.0156,515.4375 Q719.3906,515.4375 719.625,515.6953 Q719.8594,515.9531 719.8594,516.5625 L719.8594,518.0156 Q719.8594,518.625 719.625,518.8906 Q719.3906,519.1563 719.0156,519.1563 Q718.6719,519.1563 718.4688,518.9531 Q718.2656,518.7656 718.1563,518.25 Q718.1094,517.8906 717.9219,517.7031 Q717.5938,517.3281 716.9844,517.1094 Q716.375,516.8906 715.75,516.8906 Q714.9844,516.8906 714.3516,517.2188 Q713.7188,517.5469 713.2266,518.2969 Q712.7344,519.0469 712.7344,520.0781 L712.7344,521.1719 Q712.7344,522.4063 713.625,523.2266 Q714.5156,524.0469 716.1094,524.0469 Q717.0469,524.0469 717.7031,523.7969 Q718.0938,523.6406 718.5156,523.2031 Q718.7813,522.9375 718.9297,522.8594 Q719.0781,522.7813 719.2813,522.7813 Q719.6094,522.7813 719.8672,523.0391 Q720.125,523.2969 720.125,523.6406 Q720.125,523.9844 719.7813,524.3906 Q719.2813,524.9688 718.4844,525.2969 Q717.4063,525.75 716.1094,525.75 Q714.5938,525.75 713.3906,525.125 Q712.4063,524.625 711.7188,523.5547 Q711.0313,522.4844 711.0313,521.2031 L711.0313,520.0469 Q711.0313,518.7188 711.6484,517.5703 Q712.2656,516.4219 713.3594,515.8047 Q714.4531,515.1875 715.6875,515.1875 Q716.4219,515.1875 717.0703,515.3516 Q717.7188,515.5156 718.2656,515.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="734.5" y="525.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="679" x2="842" y1="536" y2="536"/><ellipse cx="689" cy="550.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="698" y="554.5332">ID : int</text><ellipse cx="689" cy="567.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="698" y="572.1426">UserID : int</text><ellipse cx="689" cy="585.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="698" y="589.752">IP : string</text><ellipse cx="689" cy="603.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="698" y="607.3613">UserAgent : string</text><ellipse cx="689" cy="620.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="698" y="624.9707">Successful : bool</text><ellipse cx="689" cy="638.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="698" y="642.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="679" x2="842" y1="649.6563" y2="649.6563"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="154" fill="#F1F1F1" height="136.0469" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="480" x="4311.5" y="42"/><ellipse cx="4521.75" cy="58" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4524.5156,53.875 Q4524.6719,53.6563 4524.8594,53.5469 Q4525.0469,53.4375 4525.2656,53.4375 Q4525.6406,53.4375 4525.875,53.6953 Q4526.1094,53.9531 4526.1094,54.5625 L4526.1094,56.0156 Q4526.1094,56.625 4525.875,56.8906 Q4525.6406,57.1563 4525.2656,57.1563 Q4524.9219,57.1563 4524.7188,56.9531 Q4524.5156,56.7656 4524.4063,56.25 Q4524.3594,55.8906 4524.1719,55.7031 Q4523.8438,55.3281 4523.2344,55.1094 Q4522.625,54.8906 4522,54.8906 Q4521.2344,54.8906 4520.6016,55.2188 Q4519.9688,55.5469 4519.4766,56.2969 Q4518.9844,57.0469 4518.9844,58.0781 L4518.9844,59.1719 Q4518.9844,60.4063 4519.875,61.2266 Q4520.7656,62.0469 4522.3594,62.0469 Q4523.2969,62.0469 4523.9531,61.7969 Q4524.3438,61.6406 4524.7656,61.2031 Q4525.0313,60.9375 4525.1797,60.8594 Q4525.3281,60.7813 4525.5313,60.7813 Q4525.8594,60.7813 4526.1172,61.0391 Q4526.375,61.2969 4526.375,61.6406 Q4526.375,61.9844 4526.0313,62.3906 Q4525.5313,62.9688 4524.7344,63.2969 Q4523.6563,63.75 4522.3594,63.75 Q4520.8438,63.75 4519.6406,63.125 Q4518.6563,62.625 4517.9688,61.5547 Q4517.2813,60.4844 4517.2813,59.2031 L4517.2813,58.0469 Q4517.2813,56.7188 4517.8984,55.5703 Q4518.5156,54.4219 4519.6094,53.8047 Q4520.7031,53.1875 4521.9375,53.1875 Q4522.6719,53.1875 4523.3203,53.3516 Q4523.9688,53.5156 4524.5156,53.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="4542.25" y="63.7285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="4312.5" x2="4790.5" y1="74" y2="74"/><line style="stroke:#181818;stroke-width:1.0;" x1="4312.5" x2="4790.5" y1="82" y2="82"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="4319.5" y="93.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="312" x="4331.5" y="100.5332">GetEncryptedPassword(password : string) : string</text><ellipse cx="4322.5" cy="113.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="4331.5" y="118.1426">GetSalt(saltLength : int) : string</text><ellipse cx="4322.5" cy="131.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="454" x="4331.5" y="135.752">GetEncryptedAndSaltedPassword(password : string, salt : string) : string</text><ellipse cx="4322.5" cy="149.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="4331.5" y="153.3613">GetHotp(key : string, counter : long) : string</text><ellipse cx="4322.5" cy="166.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="4331.5" y="170.9707">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="163" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4826.5" y="77"/><ellipse cx="4975.75" cy="93" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4978.5156,88.875 Q4978.6719,88.6563 4978.8594,88.5469 Q4979.0469,88.4375 4979.2656,88.4375 Q4979.6406,88.4375 4979.875,88.6953 Q4980.1094,88.9531 4980.1094,89.5625 L4980.1094,91.0156 Q4980.1094,91.625 4979.875,91.8906 Q4979.6406,92.1563 4979.2656,92.1563 Q4978.9219,92.1563 4978.7188,91.9531 Q4978.5156,91.7656 4978.4063,91.25 Q4978.3594,90.8906 4978.1719,90.7031 Q4977.8438,90.3281 4977.2344,90.1094 Q4976.625,89.8906 4976,89.8906 Q4975.2344,89.8906 4974.6016,90.2188 Q4973.9688,90.5469 4973.4766,91.2969 Q4972.9844,92.0469 4972.9844,93.0781 L4972.9844,94.1719 Q4972.9844,95.4063 4973.875,96.2266 Q4974.7656,97.0469 4976.3594,97.0469 Q4977.2969,97.0469 4977.9531,96.7969 Q4978.3438,96.6406 4978.7656,96.2031 Q4979.0313,95.9375 4979.1797,95.8594 Q4979.3281,95.7813 4979.5313,95.7813 Q4979.8594,95.7813 4980.1172,96.0391 Q4980.375,96.2969 4980.375,96.6406 Q4980.375,96.9844 4980.0313,97.3906 Q4979.5313,97.9688 4978.7344,98.2969 Q4977.6563,98.75 4976.3594,98.75 Q4974.8438,98.75 4973.6406,98.125 Q4972.6563,97.625 4971.9688,96.5547 Q4971.2813,95.4844 4971.2813,94.2031 L4971.2813,93.0469 Q4971.2813,91.7188 4971.8984,90.5703 Q4972.5156,89.4219 4973.6094,88.8047 Q4974.7031,88.1875 4975.9375,88.1875 Q4976.6719,88.1875 4977.3203,88.3516 Q4977.9688,88.5156 4978.5156,88.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="4996.25" y="98.7285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4827.5" x2="5213.5" y1="109" y2="109"/><line style="stroke:#181818;stroke-width:1.0;" x1="4827.5" x2="5213.5" y1="117" y2="117"/><ellipse cx="4837.5" cy="131.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="4846.5" y="135.5332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="183" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="2776.5" y="718"/><ellipse cx="2841.75" cy="734" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2844.5156,729.875 Q2844.6719,729.6563 2844.8594,729.5469 Q2845.0469,729.4375 2845.2656,729.4375 Q2845.6406,729.4375 2845.875,729.6953 Q2846.1094,729.9531 2846.1094,730.5625 L2846.1094,732.0156 Q2846.1094,732.625 2845.875,732.8906 Q2845.6406,733.1563 2845.2656,733.1563 Q2844.9219,733.1563 2844.7188,732.9531 Q2844.5156,732.7656 2844.4063,732.25 Q2844.3594,731.8906 2844.1719,731.7031 Q2843.8438,731.3281 2843.2344,731.1094 Q2842.625,730.8906 2842,730.8906 Q2841.2344,730.8906 2840.6016,731.2188 Q2839.9688,731.5469 2839.4766,732.2969 Q2838.9844,733.0469 2838.9844,734.0781 L2838.9844,735.1719 Q2838.9844,736.4063 2839.875,737.2266 Q2840.7656,738.0469 2842.3594,738.0469 Q2843.2969,738.0469 2843.9531,737.7969 Q2844.3438,737.6406 2844.7656,737.2031 Q2845.0313,736.9375 2845.1797,736.8594 Q2845.3281,736.7813 2845.5313,736.7813 Q2845.8594,736.7813 2846.1172,737.0391 Q2846.375,737.2969 2846.375,737.6406 Q2846.375,737.9844 2846.0313,738.3906 Q2845.5313,738.9688 2844.7344,739.2969 Q2843.6563,739.75 2842.3594,739.75 Q2840.8438,739.75 2839.6406,739.125 Q2838.6563,738.625 2837.9688,737.5547 Q2837.2813,736.4844 2837.2813,735.2031 L2837.2813,734.0469 Q2837.2813,732.7188 2837.8984,731.5703 Q2838.5156,730.4219 2839.6094,729.8047 Q2840.7031,729.1875 2841.9375,729.1875 Q2842.6719,729.1875 2843.3203,729.3516 Q2843.9688,729.5156 2844.5156,729.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="2862.25" y="739.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="2777.5" x2="2943.5" y1="750" y2="750"/><ellipse cx="2787.5" cy="764.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="2796.5" y="768.5332">ID : int</text><ellipse cx="2787.5" cy="781.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="2796.5" y="786.1426">IsVerified : bool</text><ellipse cx="2787.5" cy="799.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="2796.5" y="803.752">IsLocked : bool</text><ellipse cx="2787.5" cy="817.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="2796.5" y="821.3613">FailedTries : int</text><ellipse cx="2787.5" cy="834.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="2796.5" y="838.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="2777.5" x2="2943.5" y1="846.0469" y2="846.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="203" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="2520" y="914"/><ellipse cx="2566.75" cy="930" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2569.5156,925.875 Q2569.6719,925.6563 2569.8594,925.5469 Q2570.0469,925.4375 2570.2656,925.4375 Q2570.6406,925.4375 2570.875,925.6953 Q2571.1094,925.9531 2571.1094,926.5625 L2571.1094,928.0156 Q2571.1094,928.625 2570.875,928.8906 Q2570.6406,929.1563 2570.2656,929.1563 Q2569.9219,929.1563 2569.7188,928.9531 Q2569.5156,928.7656 2569.4063,928.25 Q2569.3594,927.8906 2569.1719,927.7031 Q2568.8438,927.3281 2568.2344,927.1094 Q2567.625,926.8906 2567,926.8906 Q2566.2344,926.8906 2565.6016,927.2188 Q2564.9688,927.5469 2564.4766,928.2969 Q2563.9844,929.0469 2563.9844,930.0781 L2563.9844,931.1719 Q2563.9844,932.4063 2564.875,933.2266 Q2565.7656,934.0469 2567.3594,934.0469 Q2568.2969,934.0469 2568.9531,933.7969 Q2569.3438,933.6406 2569.7656,933.2031 Q2570.0313,932.9375 2570.1797,932.8594 Q2570.3281,932.7813 2570.5313,932.7813 Q2570.8594,932.7813 2571.1172,933.0391 Q2571.375,933.2969 2571.375,933.6406 Q2571.375,933.9844 2571.0313,934.3906 Q2570.5313,934.9688 2569.7344,935.2969 Q2568.6563,935.75 2567.3594,935.75 Q2565.8438,935.75 2564.6406,935.125 Q2563.6563,934.625 2562.9688,933.5547 Q2562.2813,932.4844 2562.2813,931.2031 L2562.2813,930.0469 Q2562.2813,928.7188 2562.8984,927.5703 Q2563.5156,926.4219 2564.6094,925.8047 Q2565.7031,925.1875 2566.9375,925.1875 Q2567.6719,925.1875 2568.3203,925.3516 Q2568.9688,925.5156 2569.5156,925.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="2587.25" y="935.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="2521" x2="2682" y1="946" y2="946"/><ellipse cx="2531" cy="960.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="2540" y="964.5332">Email : string</text><ellipse cx="2531" cy="977.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="2540" y="982.1426">FirstName : string</text><ellipse cx="2531" cy="995.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="2540" y="999.752">LastName : string</text><ellipse cx="2531" cy="1013.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="2540" y="1017.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="2521" x2="2682" y1="1024.4375" y2="1024.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="19" d="M1113.89,202.12 C1172.23,234.66 1236.33,270.41 1288.33,299.4 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1102.3,195.66,1105.5907,202.0765,1112.7793,201.5068,1109.4886,195.0903,1102.3,195.66" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="20" d="M677.47,199.61 C610.12,222.54 538.4,247.88 472.5,273 C444.27,283.76 414.11,296.11 386.04,307.98 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="690,195.35,683.0338,193.4865,678.6344,199.2001,685.6006,201.0636,690,195.35" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="83" d="M1544.75,417.55 C1788.63,510.53 2257.61,689.34 2436.64,757.6 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2441.33,759.39,2434.333,752.4588,2436.6548,757.6172,2431.4965,759.939,2441.33,759.39" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="84" d="M1392.5,417.72 C1392.5,454.06 1392.5,500.17 1392.5,533.95 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1392.5,539.26,1396.5,530.26,1392.5,534.26,1388.5,530.26,1392.5,539.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="85" d="M2529.24,210.4 C2523.29,211.29 2517.38,212.16 2511.5,213 C2169.5,261.85 2077.61,218.28 1736.5,273 C1700.26,278.81 1662.22,286.51 1625.19,294.89 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1626.69,301.73,1605.63,299.41,1623.55,288.09,1626.69,301.73" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d484ee4b213f86a79b7b13bd52fde3a]
link MessageManager to IMessageManager--><g id="link_MessageManager_IMessageManager"><path codeLine="86" d="M2235.94,160.59 C2300.14,202.79 2392.03,263.19 2457.07,305.95 " fill="none" id="MessageManager-to-IMessageManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2460.96,300.12,2473.83,316.96,2453.27,311.82,2460.96,300.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="88" d="M3012.05,226.16 C3013.9,241.86 3015.76,257.74 3017.53,272.77 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3010.5,213.04,3007.226,219.465,3011.8975,224.9583,3015.1715,218.5333,3010.5,213.04" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="89" d="M2537.61,216.26 C2462.21,234.51 2385.05,253.8 2312.5,273 C2271.95,283.73 2228.42,296.07 2187.8,307.94 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2550.67,213.11,2543.9,210.6268,2539.0039,215.921,2545.7739,218.4042,2550.67,213.11" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="90" d="M3225.32,218.73 C3306.77,257.41 3392.57,298.17 3449.96,325.42 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3213.34,213.04,3217.0401,219.2295,3224.1765,218.1946,3220.4765,212.0051,3213.34,213.04" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f1b914c86bbf4264254e7be00f738a27]
reverse link UserManager to IMessageManager--><g id="link_UserManager_IMessageManager"><path codeLine="91" d="M2795.15,219.26 C2730.06,253.92 2661.95,290.18 2611.83,316.86 " fill="none" id="UserManager-backto-IMessageManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2806.84,213.04,2799.6641,212.3286,2796.2474,218.6789,2803.4233,219.3903,2806.84,213.04" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="93" d="M273.5,151.7 C273.5,188.57 273.5,243.67 273.5,287.58 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="280.5,287.8,273.5,307.8,266.5,287.8,280.5,287.8" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="94" d="M273.5,422.46 C273.5,456.72 273.5,498.5 273.5,530.42 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="273.5,409.26,269.5,415.26,273.5,421.26,277.5,415.26,273.5,409.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="97" d="M1614.3,151.57 C1694.23,191.69 1817.37,253.52 1907.89,298.96 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1911.09,292.73,1925.82,307.96,1904.81,305.24,1911.09,292.73" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="98" d="M1401.84,155.78 C1348.17,173.83 1285.46,194.69 1228.5,213 C1127.71,245.41 1014.27,280.47 924.32,307.94 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1414.21,151.61,1407.2477,149.732,1402.8364,155.4364,1409.7987,157.3144,1414.21,151.61" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="143" d="M2990.55,456.49 C2983.32,475.46 2975.89,494.97 2969.13,512.71 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2995.26,444.12,2989.3869,448.3041,2990.9902,455.3347,2996.8634,451.1506,2995.26,444.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="144" d="M760.5,422.45 C760.5,447.73 760.5,477.1 760.5,503.58 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="760.5,409.26,756.5,415.26,760.5,421.26,764.5,415.26,760.5,409.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="146" d="M4016.13,143.11 C3971.39,163.41 3912.18,190.04 3859.5,213 C3776.73,249.08 3682.14,288.94 3613.45,317.64 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3615.95,324.18,3594.79,325.43,3610.55,311.26,3615.95,324.18" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="147" d="M4089.11,143.23 C4092.08,179.72 4096.99,240.26 4100.84,287.7 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="4107.83,287.28,4102.47,307.78,4093.87,288.41,4107.83,287.28" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="149" d="M3616.47,151.63 C3577.97,171.59 3529.93,195.12 3485.5,213 C3484.82,213.27 3396.66,241.1 3297.87,272.25 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3299.84,278.97,3278.66,278.31,3295.63,265.62,3299.84,278.97" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="150" d="M3760.03,151.7 C3826.88,191.41 3929.35,252.28 4005.53,297.53 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="4009.2,291.57,4022.82,307.8,4002.05,303.6,4009.2,291.57" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="170" d="M2776.41,847.06 C2751.81,864.63 2724.71,883.99 2699.34,902.11 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2703.31,907.88,2682.96,913.81,2695.17,896.49,2703.31,907.88" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="171" d="M2524.7,819.22 C2535.31,840.34 2549.66,868.87 2563.07,895.56 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2569.43,892.62,2572.16,913.63,2556.92,898.91,2569.43,892.62" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="173" d="M2916.09,649.03 C2909.54,665.06 2902.46,682.39 2895.61,699.13 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2902.07,701.83,2888.02,717.69,2889.11,696.53,2902.07,701.83" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b3fa0587f04388aba49b5866b798fb2f]
@startuml API class diagram

top to bottom direction

'Controllers'

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
}

'Controllers mappings' 

UserController o- - IUserManager
UserController o- - ITokenManager

'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessage(to : string, otp : string) : void
    +SendLoginRegistrationMessage(to : string, key : string) : void
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageManager : IMessageManager
    -_logger : ILogger<UserManager>
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}
class MessageManager {
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider

    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)
}


'Managers mappings'

IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider
UserManager o- - IMessageManager

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

'Utility'

class Security{
    - -
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction


class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
}


UserController o- - IUserManager
UserController o- - ITokenManager


Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<User>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessage(to : string, otp : string) : void
    +SendLoginRegistrationMessage(to : string, key : string) : void
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageManager : IMessageManager
    -_logger : ILogger<UserManager>
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}
class MessageManager {
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider

    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)
}



IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider
UserManager o- - IMessageManager

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessWithVerificationCode(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider


class Security{
    - -
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: da
Country: DK
--></g></svg>