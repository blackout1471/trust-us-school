<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1127px" preserveAspectRatio="none" style="width:5295px;height:1127px;background:#FFFFFF;" version="1.1" viewBox="0 0 5295 1127" width="5295px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="206.4844" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="628" x="575.5" y="326"/><ellipse cx="839.75" cy="342" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M842.5156,337.875 Q842.6719,337.6563 842.8594,337.5469 Q843.0469,337.4375 843.2656,337.4375 Q843.6406,337.4375 843.875,337.7031 Q844.1094,337.9531 844.1094,338.5625 L844.1094,340.0156 Q844.1094,340.625 843.875,340.8906 Q843.6406,341.1563 843.2656,341.1563 Q842.9219,341.1563 842.7188,340.9531 Q842.5156,340.7656 842.4063,340.25 Q842.3594,339.8906 842.1719,339.7031 Q841.8438,339.3281 841.2344,339.1094 Q840.625,338.8906 840,338.8906 Q839.2344,338.8906 838.5938,339.2188 Q837.9688,339.5469 837.4688,340.2969 Q836.9844,341.0469 836.9844,342.0781 L836.9844,343.1719 Q836.9844,344.4063 837.875,345.2344 Q838.7656,346.0469 840.3594,346.0469 Q841.2969,346.0469 841.9531,345.7969 Q842.3438,345.6406 842.7656,345.2031 Q843.0313,344.9375 843.1719,344.8594 Q843.3281,344.7813 843.5313,344.7813 Q843.8594,344.7813 844.1094,345.0469 Q844.375,345.2969 844.375,345.6406 Q844.375,345.9844 844.0313,346.3906 Q843.5313,346.9688 842.7344,347.2969 Q841.6563,347.75 840.3594,347.75 Q838.8438,347.75 837.6406,347.125 Q836.6563,346.625 835.9688,345.5625 Q835.2813,344.4844 835.2813,343.2031 L835.2813,342.0469 Q835.2813,340.7188 835.8906,339.5781 Q836.5156,338.4219 837.6094,337.8125 Q838.7031,337.1875 839.9375,337.1875 Q840.6719,337.1875 841.3125,337.3594 Q841.9688,337.5156 842.5156,337.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="860.25" y="347.7285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="576.5" x2="1202.5" y1="358" y2="358"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="369.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="595.5" y="376.5332">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="386.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="595.5" y="394.1426">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:1.0;" x1="576.5" x2="1202.5" y1="401.2188" y2="401.2188"/><ellipse cx="586.5" cy="415.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="595.5" y="419.752">UserController(userManager : IUserManager, tokenManager : ITokenManager)</text><ellipse cx="586.5" cy="433.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="384" x="595.5" y="437.3613">CreateAsync(userCreate : UserCreate) : Task&lt;ActionResult&gt;</text><ellipse cx="586.5" cy="450.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="595.5" y="454.9707">LoginAsync(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586.5" cy="468.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="595.5" y="472.5801">GetUserFromTokenAsync() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="586.5" cy="485.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="602" x="595.5" y="490.1895">VerificationLoginAsync(verifyCredentials : VerifyCredentials) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586.5" cy="503.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="530" x="595.5" y="507.7988">VerifyUserRegisterAsync(verifyCredentials : VerifyCredentials) : Task&lt;ActionResult&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583.5" y="518.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="211" x="595.5" y="525.4082">GetUserLocation() : UserLocation</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="34" fill="#F1F1F1" height="136.0469" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="740" x="1048.5" y="592"/><ellipse cx="1368.75" cy="608" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1369.7031,604.6406 L1369.7031,611.2969 L1371.4219,611.2969 Q1372.0313,611.2969 1372.2969,611.5313 Q1372.5625,611.7656 1372.5625,612.1563 Q1372.5625,612.5313 1372.2969,612.7656 Q1372.0313,613 1371.4219,613 L1366.2813,613 Q1365.6719,613 1365.4063,612.7656 Q1365.1406,612.5313 1365.1406,612.1406 Q1365.1406,611.7656 1365.4063,611.5313 Q1365.6719,611.2969 1366.2813,611.2969 L1368,611.2969 L1368,604.6406 L1366.2813,604.6406 Q1365.6719,604.6406 1365.4063,604.4063 Q1365.1406,604.1719 1365.1406,603.7813 Q1365.1406,603.4063 1365.4063,603.1719 Q1365.6719,602.9375 1366.2813,602.9375 L1371.4219,602.9375 Q1372.0313,602.9375 1372.2969,603.1719 Q1372.5625,603.4063 1372.5625,603.7813 Q1372.5625,604.1719 1372.2969,604.4063 Q1372.0313,604.6406 1371.4219,604.6406 L1369.7031,604.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="1389.25" y="613.7285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1049.5" x2="1787.5" y1="624" y2="624"/><line style="stroke:#181818;stroke-width:0.5;" x1="1049.5" x2="1787.5" y1="632" y2="632"/><ellipse cx="1059.5" cy="646.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="361" x="1068.5" y="650.5332">CreateUserAsync(userCreate : UserCreate) : Task&lt;bool&gt;</text><ellipse cx="1059.5" cy="663.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="1068.5" y="668.1426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="1059.5" cy="681.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="1068.5" y="685.752">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="1059.5" cy="699.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="714" x="1068.5" y="703.3613">LoginWithVerificationCodeAsync(verifyCredentials : VerifyCredentials, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="1059.5" cy="716.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="682" x="1068.5" y="720.9707">VerifyUserRegistrationAsync(verifyCredentials : VerifyCredentials, userLocation: UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="42" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="365.5" y="609.5"/><ellipse cx="492.25" cy="625.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M493.2031,622.1406 L493.2031,628.7969 L494.9219,628.7969 Q495.5313,628.7969 495.7969,629.0313 Q496.0625,629.2656 496.0625,629.6563 Q496.0625,630.0313 495.7969,630.2656 Q495.5313,630.5 494.9219,630.5 L489.7813,630.5 Q489.1719,630.5 488.9063,630.2656 Q488.6406,630.0313 488.6406,629.6406 Q488.6406,629.2656 488.9063,629.0313 Q489.1719,628.7969 489.7813,628.7969 L491.5,628.7969 L491.5,622.1406 L489.7813,622.1406 Q489.1719,622.1406 488.9063,621.9063 Q488.6406,621.6719 488.6406,621.2813 Q488.6406,620.9063 488.9063,620.6719 Q489.1719,620.4375 489.7813,620.4375 L494.9219,620.4375 Q495.5313,620.4375 495.7969,620.6719 Q496.0625,620.9063 496.0625,621.2813 Q496.0625,621.6719 495.7969,621.9063 Q495.5313,622.1406 494.9219,622.1406 L493.2031,622.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="512.75" y="631.2285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="366.5" x2="728.5" y1="641.5" y2="641.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="366.5" x2="728.5" y1="649.5" y2="649.5"/><ellipse cx="376.5" cy="663.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="385.5" y="668.0332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="376.5" cy="681.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="385.5" y="685.6426">ValidateToken(token : string) : bool</text><ellipse cx="376.5" cy="699.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="385.5" y="703.252">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="237" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="893.5" y="832"/><ellipse cx="922" cy="848" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M924.7656,843.875 Q924.9219,843.6563 925.1094,843.5469 Q925.2969,843.4375 925.5156,843.4375 Q925.8906,843.4375 926.125,843.7031 Q926.3594,843.9531 926.3594,844.5625 L926.3594,846.0156 Q926.3594,846.625 926.125,846.8906 Q925.8906,847.1563 925.5156,847.1563 Q925.1719,847.1563 924.9688,846.9531 Q924.7656,846.7656 924.6563,846.25 Q924.6094,845.8906 924.4219,845.7031 Q924.0938,845.3281 923.4844,845.1094 Q922.875,844.8906 922.25,844.8906 Q921.4844,844.8906 920.8438,845.2188 Q920.2188,845.5469 919.7188,846.2969 Q919.2344,847.0469 919.2344,848.0781 L919.2344,849.1719 Q919.2344,850.4063 920.125,851.2344 Q921.0156,852.0469 922.6094,852.0469 Q923.5469,852.0469 924.2031,851.7969 Q924.5938,851.6406 925.0156,851.2031 Q925.2813,850.9375 925.4219,850.8594 Q925.5781,850.7813 925.7813,850.7813 Q926.1094,850.7813 926.3594,851.0469 Q926.625,851.2969 926.625,851.6406 Q926.625,851.9844 926.2813,852.3906 Q925.7813,852.9688 924.9844,853.2969 Q923.9063,853.75 922.6094,853.75 Q921.0938,853.75 919.8906,853.125 Q918.9063,852.625 918.2188,851.5625 Q917.5313,850.4844 917.5313,849.2031 L917.5313,848.0469 Q917.5313,846.7188 918.1406,845.5781 Q918.7656,844.4219 919.8594,843.8125 Q920.9531,843.1875 922.1875,843.1875 Q922.9219,843.1875 923.5625,843.3594 Q924.2188,843.5156 924.7656,843.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="939" y="853.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="894.5" x2="1026.5" y1="864" y2="864"/><ellipse cx="904.5" cy="878.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="913.5" y="882.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="894.5" x2="1026.5" y1="889.6094" y2="889.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="249" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1062.5" y="823.5"/><ellipse cx="1094.6" cy="839.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1097.3656,835.375 Q1097.5219,835.1563 1097.7094,835.0469 Q1097.8969,834.9375 1098.1156,834.9375 Q1098.4906,834.9375 1098.725,835.2031 Q1098.9594,835.4531 1098.9594,836.0625 L1098.9594,837.5156 Q1098.9594,838.125 1098.725,838.3906 Q1098.4906,838.6563 1098.1156,838.6563 Q1097.7719,838.6563 1097.5688,838.4531 Q1097.3656,838.2656 1097.2563,837.75 Q1097.2094,837.3906 1097.0219,837.2031 Q1096.6938,836.8281 1096.0844,836.6094 Q1095.475,836.3906 1094.85,836.3906 Q1094.0844,836.3906 1093.4438,836.7188 Q1092.8188,837.0469 1092.3188,837.7969 Q1091.8344,838.5469 1091.8344,839.5781 L1091.8344,840.6719 Q1091.8344,841.9063 1092.725,842.7344 Q1093.6156,843.5469 1095.2094,843.5469 Q1096.1469,843.5469 1096.8031,843.2969 Q1097.1938,843.1406 1097.6156,842.7031 Q1097.8813,842.4375 1098.0219,842.3594 Q1098.1781,842.2813 1098.3813,842.2813 Q1098.7094,842.2813 1098.9594,842.5469 Q1099.225,842.7969 1099.225,843.1406 Q1099.225,843.4844 1098.8813,843.8906 Q1098.3813,844.4688 1097.5844,844.7969 Q1096.5063,845.25 1095.2094,845.25 Q1093.6938,845.25 1092.4906,844.625 Q1091.5063,844.125 1090.8188,843.0625 Q1090.1313,841.9844 1090.1313,840.7031 L1090.1313,839.5469 Q1090.1313,838.2188 1090.7406,837.0781 Q1091.3656,835.9219 1092.4594,835.3125 Q1093.5531,834.6875 1094.7875,834.6875 Q1095.5219,834.6875 1096.1625,834.8594 Q1096.8188,835.0156 1097.3656,835.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1112.4" y="845.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="1063.5" x2="1195.5" y1="855.5" y2="855.5"/><ellipse cx="1073.5" cy="869.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1082.5" y="874.0332">Email : string</text><ellipse cx="1073.5" cy="887.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1082.5" y="891.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1063.5" x2="1195.5" y1="898.7188" y2="898.7188"/></g><!--MD5=[7e38db3769ab3d4a7934dc4e6ba3ae24]
class VerifyCredentials--><g id="elem_VerifyCredentials"><rect codeLine="254" fill="#F1F1F1" height="83.2188" id="VerifyCredentials" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="1231.5" y="823.5"/><ellipse cx="1246.5" cy="839.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1249.2656,835.375 Q1249.4219,835.1563 1249.6094,835.0469 Q1249.7969,834.9375 1250.0156,834.9375 Q1250.3906,834.9375 1250.625,835.2031 Q1250.8594,835.4531 1250.8594,836.0625 L1250.8594,837.5156 Q1250.8594,838.125 1250.625,838.3906 Q1250.3906,838.6563 1250.0156,838.6563 Q1249.6719,838.6563 1249.4688,838.4531 Q1249.2656,838.2656 1249.1563,837.75 Q1249.1094,837.3906 1248.9219,837.2031 Q1248.5938,836.8281 1247.9844,836.6094 Q1247.375,836.3906 1246.75,836.3906 Q1245.9844,836.3906 1245.3438,836.7188 Q1244.7188,837.0469 1244.2188,837.7969 Q1243.7344,838.5469 1243.7344,839.5781 L1243.7344,840.6719 Q1243.7344,841.9063 1244.625,842.7344 Q1245.5156,843.5469 1247.1094,843.5469 Q1248.0469,843.5469 1248.7031,843.2969 Q1249.0938,843.1406 1249.5156,842.7031 Q1249.7813,842.4375 1249.9219,842.3594 Q1250.0781,842.2813 1250.2813,842.2813 Q1250.6094,842.2813 1250.8594,842.5469 Q1251.125,842.7969 1251.125,843.1406 Q1251.125,843.4844 1250.7813,843.8906 Q1250.2813,844.4688 1249.4844,844.7969 Q1248.4063,845.25 1247.1094,845.25 Q1245.5938,845.25 1244.3906,844.625 Q1243.4063,844.125 1242.7188,843.0625 Q1242.0313,841.9844 1242.0313,840.7031 L1242.0313,839.5469 Q1242.0313,838.2188 1242.6406,837.0781 Q1243.2656,835.9219 1244.3594,835.3125 Q1245.4531,834.6875 1246.6875,834.6875 Q1247.4219,834.6875 1248.0625,834.8594 Q1248.7188,835.0156 1249.2656,835.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1260.5" y="845.2285">VerifyCredentials</text><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1370.5" y1="855.5" y2="855.5"/><ellipse cx="1242.5" cy="869.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1251.5" y="874.0332">Email : string</text><ellipse cx="1242.5" cy="887.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1251.5" y="891.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1370.5" y1="898.7188" y2="898.7188"/></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="221" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1406.5" y="797"/><ellipse cx="1471.75" cy="813" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1474.5156,808.875 Q1474.6719,808.6563 1474.8594,808.5469 Q1475.0469,808.4375 1475.2656,808.4375 Q1475.6406,808.4375 1475.875,808.7031 Q1476.1094,808.9531 1476.1094,809.5625 L1476.1094,811.0156 Q1476.1094,811.625 1475.875,811.8906 Q1475.6406,812.1563 1475.2656,812.1563 Q1474.9219,812.1563 1474.7188,811.9531 Q1474.5156,811.7656 1474.4063,811.25 Q1474.3594,810.8906 1474.1719,810.7031 Q1473.8438,810.3281 1473.2344,810.1094 Q1472.625,809.8906 1472,809.8906 Q1471.2344,809.8906 1470.5938,810.2188 Q1469.9688,810.5469 1469.4688,811.2969 Q1468.9844,812.0469 1468.9844,813.0781 L1468.9844,814.1719 Q1468.9844,815.4063 1469.875,816.2344 Q1470.7656,817.0469 1472.3594,817.0469 Q1473.2969,817.0469 1473.9531,816.7969 Q1474.3438,816.6406 1474.7656,816.2031 Q1475.0313,815.9375 1475.1719,815.8594 Q1475.3281,815.7813 1475.5313,815.7813 Q1475.8594,815.7813 1476.1094,816.0469 Q1476.375,816.2969 1476.375,816.6406 Q1476.375,816.9844 1476.0313,817.3906 Q1475.5313,817.9688 1474.7344,818.2969 Q1473.6563,818.75 1472.3594,818.75 Q1470.8438,818.75 1469.6406,818.125 Q1468.6563,817.625 1467.9688,816.5625 Q1467.2813,815.4844 1467.2813,814.2031 L1467.2813,813.0469 Q1467.2813,811.7188 1467.8906,810.5781 Q1468.5156,809.4219 1469.6094,808.8125 Q1470.7031,808.1875 1471.9375,808.1875 Q1472.6719,808.1875 1473.3125,808.3594 Q1473.9688,808.5156 1474.5156,808.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1492.25" y="818.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="1407.5" x2="1573.5" y1="829" y2="829"/><ellipse cx="1417.5" cy="843.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1426.5" y="847.5332">ID : int</text><ellipse cx="1417.5" cy="860.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1426.5" y="865.1426">IsVerified : bool</text><ellipse cx="1417.5" cy="878.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1426.5" y="882.752">IsLocked : bool</text><ellipse cx="1417.5" cy="896.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1426.5" y="900.3613">FailedTries : int</text><ellipse cx="1417.5" cy="913.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="1426.5" y="917.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1407.5" x2="1573.5" y1="925.0469" y2="925.0469"/></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="215" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="654" y="814.5"/><ellipse cx="674.4" cy="830.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M677.1656,826.375 Q677.3219,826.1563 677.5094,826.0469 Q677.6969,825.9375 677.9156,825.9375 Q678.2906,825.9375 678.525,826.2031 Q678.7594,826.4531 678.7594,827.0625 L678.7594,828.5156 Q678.7594,829.125 678.525,829.3906 Q678.2906,829.6563 677.9156,829.6563 Q677.5719,829.6563 677.3688,829.4531 Q677.1656,829.2656 677.0563,828.75 Q677.0094,828.3906 676.8219,828.2031 Q676.4938,827.8281 675.8844,827.6094 Q675.275,827.3906 674.65,827.3906 Q673.8844,827.3906 673.2438,827.7188 Q672.6188,828.0469 672.1188,828.7969 Q671.6344,829.5469 671.6344,830.5781 L671.6344,831.6719 Q671.6344,832.9063 672.525,833.7344 Q673.4156,834.5469 675.0094,834.5469 Q675.9469,834.5469 676.6031,834.2969 Q676.9938,834.1406 677.4156,833.7031 Q677.6813,833.4375 677.8219,833.3594 Q677.9781,833.2813 678.1813,833.2813 Q678.5094,833.2813 678.7594,833.5469 Q679.025,833.7969 679.025,834.1406 Q679.025,834.4844 678.6813,834.8906 Q678.1813,835.4688 677.3844,835.7969 Q676.3063,836.25 675.0094,836.25 Q673.4938,836.25 672.2906,835.625 Q671.3063,835.125 670.6188,834.0625 Q669.9313,832.9844 669.9313,831.7031 L669.9313,830.5469 Q669.9313,829.2188 670.5406,828.0781 Q671.1656,826.9219 672.2594,826.3125 Q673.3531,825.6875 674.5875,825.6875 Q675.3219,825.6875 675.9625,825.8594 Q676.6188,826.0156 677.1656,826.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="689.6" y="836.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="655" x2="766" y1="846.5" y2="846.5"/><ellipse cx="665" cy="860.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="674" y="865.0332">UserID : int</text><ellipse cx="665" cy="878.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="674" y="882.6426">Email : string</text><ellipse cx="665" cy="896.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="674" y="900.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="655" x2="766" y1="907.3281" y2="907.3281"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="259" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="2244" y="788"/><ellipse cx="2281.5" cy="804" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2284.2656,799.875 Q2284.4219,799.6563 2284.6094,799.5469 Q2284.7969,799.4375 2285.0156,799.4375 Q2285.3906,799.4375 2285.625,799.7031 Q2285.8594,799.9531 2285.8594,800.5625 L2285.8594,802.0156 Q2285.8594,802.625 2285.625,802.8906 Q2285.3906,803.1563 2285.0156,803.1563 Q2284.6719,803.1563 2284.4688,802.9531 Q2284.2656,802.7656 2284.1563,802.25 Q2284.1094,801.8906 2283.9219,801.7031 Q2283.5938,801.3281 2282.9844,801.1094 Q2282.375,800.8906 2281.75,800.8906 Q2280.9844,800.8906 2280.3438,801.2188 Q2279.7188,801.5469 2279.2188,802.2969 Q2278.7344,803.0469 2278.7344,804.0781 L2278.7344,805.1719 Q2278.7344,806.4063 2279.625,807.2344 Q2280.5156,808.0469 2282.1094,808.0469 Q2283.0469,808.0469 2283.7031,807.7969 Q2284.0938,807.6406 2284.5156,807.2031 Q2284.7813,806.9375 2284.9219,806.8594 Q2285.0781,806.7813 2285.2813,806.7813 Q2285.6094,806.7813 2285.8594,807.0469 Q2286.125,807.2969 2286.125,807.6406 Q2286.125,807.9844 2285.7813,808.3906 Q2285.2813,808.9688 2284.4844,809.2969 Q2283.4063,809.75 2282.1094,809.75 Q2280.5938,809.75 2279.3906,809.125 Q2278.4063,808.625 2277.7188,807.5625 Q2277.0313,806.4844 2277.0313,805.2031 L2277.0313,804.0469 Q2277.0313,802.7188 2277.6406,801.5781 Q2278.2656,800.4219 2279.3594,799.8125 Q2280.4531,799.1875 2281.6875,799.1875 Q2282.4219,799.1875 2283.0625,799.3594 Q2283.7188,799.5156 2284.2656,799.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="2300.5" y="809.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="2245" x2="2408" y1="820" y2="820"/><ellipse cx="2255" cy="834.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="2264" y="838.5332">ID : int</text><ellipse cx="2255" cy="851.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="2264" y="856.1426">UserID : int</text><ellipse cx="2255" cy="869.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="2264" y="873.752">IP : string</text><ellipse cx="2255" cy="887.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="2264" y="891.3613">UserAgent : string</text><ellipse cx="2255" cy="904.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="2264" y="908.9707">Successful : bool</text><ellipse cx="2255" cy="922.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2264" y="926.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="2245" x2="2408" y1="933.6563" y2="933.6563"/></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="49" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="2471.5" y="609.5"/><ellipse cx="2664.75" cy="625.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2665.7031,622.1406 L2665.7031,628.7969 L2667.4219,628.7969 Q2668.0313,628.7969 2668.2969,629.0313 Q2668.5625,629.2656 2668.5625,629.6563 Q2668.5625,630.0313 2668.2969,630.2656 Q2668.0313,630.5 2667.4219,630.5 L2662.2813,630.5 Q2661.6719,630.5 2661.4063,630.2656 Q2661.1406,630.0313 2661.1406,629.6406 Q2661.1406,629.2656 2661.4063,629.0313 Q2661.6719,628.7969 2662.2813,628.7969 L2664,628.7969 L2664,622.1406 L2662.2813,622.1406 Q2661.6719,622.1406 2661.4063,621.9063 Q2661.1406,621.6719 2661.1406,621.2813 Q2661.1406,620.9063 2661.4063,620.6719 Q2661.6719,620.4375 2662.2813,620.4375 L2667.4219,620.4375 Q2668.0313,620.4375 2668.2969,620.6719 Q2668.5625,620.9063 2668.5625,621.2813 Q2668.5625,621.6719 2668.2969,621.9063 Q2668.0313,622.1406 2667.4219,622.1406 L2665.7031,622.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="2685.25" y="631.2285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2472.5" x2="3010.5" y1="641.5" y2="641.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="2472.5" x2="3010.5" y1="649.5" y2="649.5"/><ellipse cx="2482.5" cy="663.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="2491.5" y="668.0332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="2482.5" cy="681.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="2491.5" y="685.6426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="2482.5" cy="699.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="2491.5" y="703.252">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[5bbb8fec178e848d13dc3ca00e0fbd40]
class IMessageManager--><g id="elem_IMessageManager"><rect codeLine="55" fill="#F1F1F1" height="83.2188" id="IMessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="497" x="1239" y="387.5"/><ellipse cx="1423.75" cy="403.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1424.7031,400.1406 L1424.7031,406.7969 L1426.4219,406.7969 Q1427.0313,406.7969 1427.2969,407.0313 Q1427.5625,407.2656 1427.5625,407.6563 Q1427.5625,408.0313 1427.2969,408.2656 Q1427.0313,408.5 1426.4219,408.5 L1421.2813,408.5 Q1420.6719,408.5 1420.4063,408.2656 Q1420.1406,408.0313 1420.1406,407.6406 Q1420.1406,407.2656 1420.4063,407.0313 Q1420.6719,406.7969 1421.2813,406.7969 L1423,406.7969 L1423,400.1406 L1421.2813,400.1406 Q1420.6719,400.1406 1420.4063,399.9063 Q1420.1406,399.6719 1420.1406,399.2813 Q1420.1406,398.9063 1420.4063,398.6719 Q1420.6719,398.4375 1421.2813,398.4375 L1426.4219,398.4375 Q1427.0313,398.4375 1427.2969,398.6719 Q1427.5625,398.9063 1427.5625,399.2813 Q1427.5625,399.6719 1427.2969,399.9063 Q1427.0313,400.1406 1426.4219,400.1406 L1424.7031,400.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="119" x="1444.25" y="409.2285">IMessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1240" x2="1735" y1="419.5" y2="419.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1240" x2="1735" y1="427.5" y2="427.5"/><ellipse cx="1250" cy="441.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="1259" y="446.0332">SendLoginAttemptMessageAsync(to : string, otp : string) : Task&lt;bool&gt;</text><ellipse cx="1250" cy="459.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="471" x="1259" y="463.6426">SendLoginRegistrationMessageAsync(to : string, key : string) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="60" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="387.5"/><ellipse cx="221.25" cy="403.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,399.375 Q224.1719,399.1563 224.3594,399.0469 Q224.5469,398.9375 224.7656,398.9375 Q225.1406,398.9375 225.375,399.2031 Q225.6094,399.4531 225.6094,400.0625 L225.6094,401.5156 Q225.6094,402.125 225.375,402.3906 Q225.1406,402.6563 224.7656,402.6563 Q224.4219,402.6563 224.2188,402.4531 Q224.0156,402.2656 223.9063,401.75 Q223.8594,401.3906 223.6719,401.2031 Q223.3438,400.8281 222.7344,400.6094 Q222.125,400.3906 221.5,400.3906 Q220.7344,400.3906 220.0938,400.7188 Q219.4688,401.0469 218.9688,401.7969 Q218.4844,402.5469 218.4844,403.5781 L218.4844,404.6719 Q218.4844,405.9063 219.375,406.7344 Q220.2656,407.5469 221.8594,407.5469 Q222.7969,407.5469 223.4531,407.2969 Q223.8438,407.1406 224.2656,406.7031 Q224.5313,406.4375 224.6719,406.3594 Q224.8281,406.2813 225.0313,406.2813 Q225.3594,406.2813 225.6094,406.5469 Q225.875,406.7969 225.875,407.1406 Q225.875,407.4844 225.5313,407.8906 Q225.0313,408.4688 224.2344,408.7969 Q223.1563,409.25 221.8594,409.25 Q220.3438,409.25 219.1406,408.625 Q218.1563,408.125 217.4688,407.0625 Q216.7813,405.9844 216.7813,404.7031 L216.7813,403.5469 Q216.7813,402.2188 217.3906,401.0781 Q218.0156,399.9219 219.1094,399.3125 Q220.2031,398.6875 221.4375,398.6875 Q222.1719,398.6875 222.8125,398.8594 Q223.4688,399.0156 224.0156,399.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="409.2285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="419.5" y2="419.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="539" y1="427.5" y2="427.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="438.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="446.0332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="456.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="463.6426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="66" fill="#F1F1F1" height="259.3125" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="1128" x="1367.5" y="7"/><ellipse cx="1884.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1887.5156,18.875 Q1887.6719,18.6563 1887.8594,18.5469 Q1888.0469,18.4375 1888.2656,18.4375 Q1888.6406,18.4375 1888.875,18.7031 Q1889.1094,18.9531 1889.1094,19.5625 L1889.1094,21.0156 Q1889.1094,21.625 1888.875,21.8906 Q1888.6406,22.1563 1888.2656,22.1563 Q1887.9219,22.1563 1887.7188,21.9531 Q1887.5156,21.7656 1887.4063,21.25 Q1887.3594,20.8906 1887.1719,20.7031 Q1886.8438,20.3281 1886.2344,20.1094 Q1885.625,19.8906 1885,19.8906 Q1884.2344,19.8906 1883.5938,20.2188 Q1882.9688,20.5469 1882.4688,21.2969 Q1881.9844,22.0469 1881.9844,23.0781 L1881.9844,24.1719 Q1881.9844,25.4063 1882.875,26.2344 Q1883.7656,27.0469 1885.3594,27.0469 Q1886.2969,27.0469 1886.9531,26.7969 Q1887.3438,26.6406 1887.7656,26.2031 Q1888.0313,25.9375 1888.1719,25.8594 Q1888.3281,25.7813 1888.5313,25.7813 Q1888.8594,25.7813 1889.1094,26.0469 Q1889.375,26.2969 1889.375,26.6406 Q1889.375,26.9844 1889.0313,27.3906 Q1888.5313,27.9688 1887.7344,28.2969 Q1886.6563,28.75 1885.3594,28.75 Q1883.8438,28.75 1882.6406,28.125 Q1881.6563,27.625 1880.9688,26.5625 Q1880.2813,25.4844 1880.2813,24.2031 L1880.2813,23.0469 Q1880.2813,21.7188 1880.8906,20.5781 Q1881.5156,19.4219 1882.6094,18.8125 Q1883.7031,18.1875 1884.9375,18.1875 Q1885.6719,18.1875 1886.3125,18.3594 Q1886.9688,18.5156 1887.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1905.25" y="28.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1368.5" x2="2494.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="1387.5" y="57.5332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="1387.5" y="75.1426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="1387.5" y="92.752">_userLocationManager : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="103.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="249" x="1387.5" y="110.3613">_messageManager : IMessageManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="120.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="1387.5" y="127.9707">_logger : ILogger&lt;UserManager&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="138.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1387.5" y="145.5801">_configuration : IConfiguration</text><line style="stroke:#181818;stroke-width:1.0;" x1="1368.5" x2="2494.5" y1="152.6563" y2="152.6563"/><ellipse cx="1378.5" cy="166.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1102" x="1387.5" y="171.1895">UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="455" x="1387.5" y="188.7988">messageManager : IMessageManager, logger : ILogger&lt;UserManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="199.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438" x="1387.5" y="206.4082">IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="216.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="440" x="1387.5" y="224.0176">CheckPasswordLeakedForUserAsync(password : string) : Task&lt;bool&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="234.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="471" x="1387.5" y="241.627">IsUserNotVerifiedAsync(userLocation : UserLocation, user : DbUser) : Task</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1375.5" y="252.0078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="448" x="1387.5" y="259.2363">IsUserLockedAsync(userLocation : UserLocation, user : DbUser) : Task</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="82" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="461" x="2911" y="95"/><ellipse cx="3067.75" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3070.5156,106.875 Q3070.6719,106.6563 3070.8594,106.5469 Q3071.0469,106.4375 3071.2656,106.4375 Q3071.6406,106.4375 3071.875,106.7031 Q3072.1094,106.9531 3072.1094,107.5625 L3072.1094,109.0156 Q3072.1094,109.625 3071.875,109.8906 Q3071.6406,110.1563 3071.2656,110.1563 Q3070.9219,110.1563 3070.7188,109.9531 Q3070.5156,109.7656 3070.4063,109.25 Q3070.3594,108.8906 3070.1719,108.7031 Q3069.8438,108.3281 3069.2344,108.1094 Q3068.625,107.8906 3068,107.8906 Q3067.2344,107.8906 3066.5938,108.2188 Q3065.9688,108.5469 3065.4688,109.2969 Q3064.9844,110.0469 3064.9844,111.0781 L3064.9844,112.1719 Q3064.9844,113.4063 3065.875,114.2344 Q3066.7656,115.0469 3068.3594,115.0469 Q3069.2969,115.0469 3069.9531,114.7969 Q3070.3438,114.6406 3070.7656,114.2031 Q3071.0313,113.9375 3071.1719,113.8594 Q3071.3281,113.7813 3071.5313,113.7813 Q3071.8594,113.7813 3072.1094,114.0469 Q3072.375,114.2969 3072.375,114.6406 Q3072.375,114.9844 3072.0313,115.3906 Q3071.5313,115.9688 3070.7344,116.2969 Q3069.6563,116.75 3068.3594,116.75 Q3066.8438,116.75 3065.6406,116.125 Q3064.6563,115.625 3063.9688,114.5625 Q3063.2813,113.4844 3063.2813,112.2031 L3063.2813,111.0469 Q3063.2813,109.7188 3063.8906,108.5781 Q3064.5156,107.4219 3065.6094,106.8125 Q3066.7031,106.1875 3067.9375,106.1875 Q3068.6719,106.1875 3069.3125,106.3594 Q3069.9688,106.5156 3070.5156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="3088.25" y="116.7285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2912" x2="3371" y1="127" y2="127"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2919" y="138.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="2931" y="145.5332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="2912" x2="3371" y1="152.6094" y2="152.6094"/><ellipse cx="2922" cy="166.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="435" x="2931" y="171.1426">UserLocationManager(userLocationProvider : IUserLocationProvider)</text></g><!--MD5=[20fcb2fa68efbd583f0fa2981cab489f]
class MessageManager--><g id="elem_MessageManager"><rect codeLine="88" fill="#F1F1F1" height="100.8281" id="MessageManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="668" x="664.5" y="86"/><ellipse cx="937.75" cy="102" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M940.5156,97.875 Q940.6719,97.6563 940.8594,97.5469 Q941.0469,97.4375 941.2656,97.4375 Q941.6406,97.4375 941.875,97.7031 Q942.1094,97.9531 942.1094,98.5625 L942.1094,100.0156 Q942.1094,100.625 941.875,100.8906 Q941.6406,101.1563 941.2656,101.1563 Q940.9219,101.1563 940.7188,100.9531 Q940.5156,100.7656 940.4063,100.25 Q940.3594,99.8906 940.1719,99.7031 Q939.8438,99.3281 939.2344,99.1094 Q938.625,98.8906 938,98.8906 Q937.2344,98.8906 936.5938,99.2188 Q935.9688,99.5469 935.4688,100.2969 Q934.9844,101.0469 934.9844,102.0781 L934.9844,103.1719 Q934.9844,104.4063 935.875,105.2344 Q936.7656,106.0469 938.3594,106.0469 Q939.2969,106.0469 939.9531,105.7969 Q940.3438,105.6406 940.7656,105.2031 Q941.0313,104.9375 941.1719,104.8594 Q941.3281,104.7813 941.5313,104.7813 Q941.8594,104.7813 942.1094,105.0469 Q942.375,105.2969 942.375,105.6406 Q942.375,105.9844 942.0313,106.3906 Q941.5313,106.9688 940.7344,107.2969 Q939.6563,107.75 938.3594,107.75 Q936.8438,107.75 935.6406,107.125 Q934.6563,106.625 933.9688,105.5625 Q933.2813,104.4844 933.2813,103.2031 L933.2813,102.0469 Q933.2813,100.7188 933.8906,99.5781 Q934.5156,98.4219 935.6094,97.8125 Q936.7031,97.1875 937.9375,97.1875 Q938.6719,97.1875 939.3125,97.3594 Q939.9688,97.5156 940.5156,97.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="958.25" y="107.7285">MessageManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="665.5" x2="1331.5" y1="118" y2="118"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="672.5" y="129.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="684.5" y="136.5332">_messageService : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="672.5" y="146.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="684.5" y="154.1426">_messageProvider : IMessageProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="665.5" x2="1331.5" y1="161.2188" y2="161.2188"/><ellipse cx="675.5" cy="175.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="642" x="684.5" y="179.752">MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)</text></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="125" fill="#F1F1F1" height="188.875" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="2427.5" y="334.5"/><ellipse cx="2650.25" cy="350.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2651.2031,347.1406 L2651.2031,353.7969 L2652.9219,353.7969 Q2653.5313,353.7969 2653.7969,354.0313 Q2654.0625,354.2656 2654.0625,354.6563 Q2654.0625,355.0313 2653.7969,355.2656 Q2653.5313,355.5 2652.9219,355.5 L2647.7813,355.5 Q2647.1719,355.5 2646.9063,355.2656 Q2646.6406,355.0313 2646.6406,354.6406 Q2646.6406,354.2656 2646.9063,354.0313 Q2647.1719,353.7969 2647.7813,353.7969 L2649.5,353.7969 L2649.5,347.1406 L2647.7813,347.1406 Q2647.1719,347.1406 2646.9063,346.9063 Q2646.6406,346.6719 2646.6406,346.2813 Q2646.6406,345.9063 2646.9063,345.6719 Q2647.1719,345.4375 2647.7813,345.4375 L2652.9219,345.4375 Q2653.5313,345.4375 2653.7969,345.6719 Q2654.0625,345.9063 2654.0625,346.2813 Q2654.0625,346.6719 2653.7969,346.9063 Q2653.5313,347.1406 2652.9219,347.1406 L2651.2031,347.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="2670.75" y="356.2285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2428.5" x2="2966.5" y1="366.5" y2="366.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="2428.5" x2="2966.5" y1="374.5" y2="374.5"/><ellipse cx="2438.5" cy="388.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2447.5" y="393.0332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2438.5" cy="406.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2447.5" y="410.6426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2438.5" cy="424.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2447.5" y="428.252">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2438.5" cy="441.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="365" x="2447.5" y="445.8613">UpdateUserFailedTriesAsync(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2438.5" cy="459.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="2447.5" y="463.4707">UpdateUserLoginSuccessAsync(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2438.5" cy="476.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="409" x="2447.5" y="481.0801">UpdateUserLoginNewLocationAsync(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2438.5" cy="494.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="298" x="2447.5" y="498.6895">UpdateUserToVerifiedAsync(userID : int) : Task</text><ellipse cx="2438.5" cy="512.0703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="2447.5" y="516.2988">UpdateUserLoginSuccessWithVerificationCodeAsync(userId : int) : Task&lt;DbUser&gt;</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="136" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="1984.5" y="396"/><ellipse cx="2101.75" cy="412" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2102.7031,408.6406 L2102.7031,415.2969 L2104.4219,415.2969 Q2105.0313,415.2969 2105.2969,415.5313 Q2105.5625,415.7656 2105.5625,416.1563 Q2105.5625,416.5313 2105.2969,416.7656 Q2105.0313,417 2104.4219,417 L2099.2813,417 Q2098.6719,417 2098.4063,416.7656 Q2098.1406,416.5313 2098.1406,416.1406 Q2098.1406,415.7656 2098.4063,415.5313 Q2098.6719,415.2969 2099.2813,415.2969 L2101,415.2969 L2101,408.6406 L2099.2813,408.6406 Q2098.6719,408.6406 2098.4063,408.4063 Q2098.1406,408.1719 2098.1406,407.7813 Q2098.1406,407.4063 2098.4063,407.1719 Q2098.6719,406.9375 2099.2813,406.9375 L2104.4219,406.9375 Q2105.0313,406.9375 2105.2969,407.1719 Q2105.5625,407.4063 2105.5625,407.7813 Q2105.5625,408.1719 2105.2969,408.4063 Q2105.0313,408.6406 2104.4219,408.6406 L2102.7031,408.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="2122.25" y="417.7285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1985.5" x2="2391.5" y1="428" y2="428"/><line style="stroke:#181818;stroke-width:0.5;" x1="1985.5" x2="2391.5" y1="436" y2="436"/><ellipse cx="1995.5" cy="450.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="2004.5" y="454.5332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="229" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="1965.5" y="592"/><ellipse cx="2042.75" cy="608" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2045.5156,603.875 Q2045.6719,603.6563 2045.8594,603.5469 Q2046.0469,603.4375 2046.2656,603.4375 Q2046.6406,603.4375 2046.875,603.7031 Q2047.1094,603.9531 2047.1094,604.5625 L2047.1094,606.0156 Q2047.1094,606.625 2046.875,606.8906 Q2046.6406,607.1563 2046.2656,607.1563 Q2045.9219,607.1563 2045.7188,606.9531 Q2045.5156,606.7656 2045.4063,606.25 Q2045.3594,605.8906 2045.1719,605.7031 Q2044.8438,605.3281 2044.2344,605.1094 Q2043.625,604.8906 2043,604.8906 Q2042.2344,604.8906 2041.5938,605.2188 Q2040.9688,605.5469 2040.4688,606.2969 Q2039.9844,607.0469 2039.9844,608.0781 L2039.9844,609.1719 Q2039.9844,610.4063 2040.875,611.2344 Q2041.7656,612.0469 2043.3594,612.0469 Q2044.2969,612.0469 2044.9531,611.7969 Q2045.3438,611.6406 2045.7656,611.2031 Q2046.0313,610.9375 2046.1719,610.8594 Q2046.3281,610.7813 2046.5313,610.7813 Q2046.8594,610.7813 2047.1094,611.0469 Q2047.375,611.2969 2047.375,611.6406 Q2047.375,611.9844 2047.0313,612.3906 Q2046.5313,612.9688 2045.7344,613.2969 Q2044.6563,613.75 2043.3594,613.75 Q2041.8438,613.75 2040.6406,613.125 Q2039.6563,612.625 2038.9688,611.5625 Q2038.2813,610.4844 2038.2813,609.2031 L2038.2813,608.0469 Q2038.2813,606.7188 2038.8906,605.5781 Q2039.5156,604.4219 2040.6094,603.8125 Q2041.7031,603.1875 2042.9375,603.1875 Q2043.6719,603.1875 2044.3125,603.3594 Q2044.9688,603.5156 2045.5156,603.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2063.25" y="613.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="1966.5" x2="2174.5" y1="624" y2="624"/><ellipse cx="1976.5" cy="638.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="1985.5" y="642.5332">HashedPassword : string</text><ellipse cx="1976.5" cy="655.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1985.5" y="660.1426">Salt : string</text><ellipse cx="1976.5" cy="673.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1985.5" y="677.752">SecretKey : string</text><ellipse cx="1976.5" cy="691.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1985.5" y="695.3613">Count : long</text><ellipse cx="1976.5" cy="708.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="1985.5" y="712.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1966.5" x2="2174.5" y1="720.0469" y2="720.0469"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="152" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="3107.5" y="378.5"/><ellipse cx="3303.25" cy="394.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3304.2031,391.1406 L3304.2031,397.7969 L3305.9219,397.7969 Q3306.5313,397.7969 3306.7969,398.0313 Q3307.0625,398.2656 3307.0625,398.6563 Q3307.0625,399.0313 3306.7969,399.2656 Q3306.5313,399.5 3305.9219,399.5 L3300.7813,399.5 Q3300.1719,399.5 3299.9063,399.2656 Q3299.6406,399.0313 3299.6406,398.6406 Q3299.6406,398.2656 3299.9063,398.0313 Q3300.1719,397.7969 3300.7813,397.7969 L3302.5,397.7969 L3302.5,391.1406 L3300.7813,391.1406 Q3300.1719,391.1406 3299.9063,390.9063 Q3299.6406,390.6719 3299.6406,390.2813 Q3299.6406,389.9063 3299.9063,389.6719 Q3300.1719,389.4375 3300.7813,389.4375 L3305.9219,389.4375 Q3306.5313,389.4375 3306.7969,389.6719 Q3307.0625,389.9063 3307.0625,390.2813 Q3307.0625,390.6719 3306.7969,390.9063 Q3306.5313,391.1406 3305.9219,391.1406 L3304.2031,391.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="3323.75" y="400.2285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3108.5" x2="3646.5" y1="410.5" y2="410.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="3108.5" x2="3646.5" y1="418.5" y2="418.5"/><ellipse cx="3118.5" cy="432.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="3127.5" y="437.0332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="3118.5" cy="450.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="3127.5" y="454.6426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="3118.5" cy="468.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="3127.5" y="472.252">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="140" fill="#F1F1F1" height="100.8281" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="693" x="3754" y="378.5"/><ellipse cx="4059.75" cy="394.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4062.5156,390.375 Q4062.6719,390.1563 4062.8594,390.0469 Q4063.0469,389.9375 4063.2656,389.9375 Q4063.6406,389.9375 4063.875,390.2031 Q4064.1094,390.4531 4064.1094,391.0625 L4064.1094,392.5156 Q4064.1094,393.125 4063.875,393.3906 Q4063.6406,393.6563 4063.2656,393.6563 Q4062.9219,393.6563 4062.7188,393.4531 Q4062.5156,393.2656 4062.4063,392.75 Q4062.3594,392.3906 4062.1719,392.2031 Q4061.8438,391.8281 4061.2344,391.6094 Q4060.625,391.3906 4060,391.3906 Q4059.2344,391.3906 4058.5938,391.7188 Q4057.9688,392.0469 4057.4688,392.7969 Q4056.9844,393.5469 4056.9844,394.5781 L4056.9844,395.6719 Q4056.9844,396.9063 4057.875,397.7344 Q4058.7656,398.5469 4060.3594,398.5469 Q4061.2969,398.5469 4061.9531,398.2969 Q4062.3438,398.1406 4062.7656,397.7031 Q4063.0313,397.4375 4063.1719,397.3594 Q4063.3281,397.2813 4063.5313,397.2813 Q4063.8594,397.2813 4064.1094,397.5469 Q4064.375,397.7969 4064.375,398.1406 Q4064.375,398.4844 4064.0313,398.8906 Q4063.5313,399.4688 4062.7344,399.7969 Q4061.6563,400.25 4060.3594,400.25 Q4058.8438,400.25 4057.6406,399.625 Q4056.6563,399.125 4055.9688,398.0625 Q4055.2813,396.9844 4055.2813,395.7031 L4055.2813,394.5469 Q4055.2813,393.2188 4055.8906,392.0781 Q4056.5156,390.9219 4057.6094,390.3125 Q4058.7031,389.6875 4059.9375,389.6875 Q4060.6719,389.6875 4061.3125,389.8594 Q4061.9688,390.0156 4062.5156,390.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="4080.25" y="400.2285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3755" x2="4446" y1="410.5" y2="410.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3755" x2="4446" y1="418.5" y2="418.5"/><ellipse cx="3765" cy="432.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3774" y="437.0332">SqlProvider(connection : string)</text><polygon fill="#FFFF44" points="3765,445.4141,3769,449.4141,3765,453.4141,3761,449.4141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="667" x="3774" y="454.6426">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElement[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3765,463.0234,3769,467.0234,3765,471.0234,3761,467.0234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3774" y="472.252">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="147" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3511" y="103.5"/><ellipse cx="3615.75" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3618.5156,115.375 Q3618.6719,115.1563 3618.8594,115.0469 Q3619.0469,114.9375 3619.2656,114.9375 Q3619.6406,114.9375 3619.875,115.2031 Q3620.1094,115.4531 3620.1094,116.0625 L3620.1094,117.5156 Q3620.1094,118.125 3619.875,118.3906 Q3619.6406,118.6563 3619.2656,118.6563 Q3618.9219,118.6563 3618.7188,118.4531 Q3618.5156,118.2656 3618.4063,117.75 Q3618.3594,117.3906 3618.1719,117.2031 Q3617.8438,116.8281 3617.2344,116.6094 Q3616.625,116.3906 3616,116.3906 Q3615.2344,116.3906 3614.5938,116.7188 Q3613.9688,117.0469 3613.4688,117.7969 Q3612.9844,118.5469 3612.9844,119.5781 L3612.9844,120.6719 Q3612.9844,121.9063 3613.875,122.7344 Q3614.7656,123.5469 3616.3594,123.5469 Q3617.2969,123.5469 3617.9531,123.2969 Q3618.3438,123.1406 3618.7656,122.7031 Q3619.0313,122.4375 3619.1719,122.3594 Q3619.3281,122.2813 3619.5313,122.2813 Q3619.8594,122.2813 3620.1094,122.5469 Q3620.375,122.7969 3620.375,123.1406 Q3620.375,123.4844 3620.0313,123.8906 Q3619.5313,124.4688 3618.7344,124.7969 Q3617.6563,125.25 3616.3594,125.25 Q3614.8438,125.25 3613.6406,124.625 Q3612.6563,124.125 3611.9688,123.0625 Q3611.2813,121.9844 3611.2813,120.7031 L3611.2813,119.5469 Q3611.2813,118.2188 3611.8906,117.0781 Q3612.5156,115.9219 3613.6094,115.3125 Q3614.7031,114.6875 3615.9375,114.6875 Q3616.6719,114.6875 3617.3125,114.8594 Q3617.9688,115.0156 3618.5156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="3636.25" y="125.2285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3512" x2="3889" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="3512" x2="3889" y1="143.5" y2="143.5"/><ellipse cx="3522" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3531" y="162.0332">LeakedPasswordProvider(configuration : IConfiguration)</text></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="158" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="3950.5" y="95"/><ellipse cx="4055.25" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4058.0156,106.875 Q4058.1719,106.6563 4058.3594,106.5469 Q4058.5469,106.4375 4058.7656,106.4375 Q4059.1406,106.4375 4059.375,106.7031 Q4059.6094,106.9531 4059.6094,107.5625 L4059.6094,109.0156 Q4059.6094,109.625 4059.375,109.8906 Q4059.1406,110.1563 4058.7656,110.1563 Q4058.4219,110.1563 4058.2188,109.9531 Q4058.0156,109.7656 4057.9063,109.25 Q4057.8594,108.8906 4057.6719,108.7031 Q4057.3438,108.3281 4056.7344,108.1094 Q4056.125,107.8906 4055.5,107.8906 Q4054.7344,107.8906 4054.0938,108.2188 Q4053.4688,108.5469 4052.9688,109.2969 Q4052.4844,110.0469 4052.4844,111.0781 L4052.4844,112.1719 Q4052.4844,113.4063 4053.375,114.2344 Q4054.2656,115.0469 4055.8594,115.0469 Q4056.7969,115.0469 4057.4531,114.7969 Q4057.8438,114.6406 4058.2656,114.2031 Q4058.5313,113.9375 4058.6719,113.8594 Q4058.8281,113.7813 4059.0313,113.7813 Q4059.3594,113.7813 4059.6094,114.0469 Q4059.875,114.2969 4059.875,114.6406 Q4059.875,114.9844 4059.5313,115.3906 Q4059.0313,115.9688 4058.2344,116.2969 Q4057.1563,116.75 4055.8594,116.75 Q4054.3438,116.75 4053.1406,116.125 Q4052.1563,115.625 4051.4688,114.5625 Q4050.7813,113.4844 4050.7813,112.2031 L4050.7813,111.0469 Q4050.7813,109.7188 4051.3906,108.5781 Q4052.0156,107.4219 4053.1094,106.8125 Q4054.2031,106.1875 4055.4375,106.1875 Q4056.1719,106.1875 4056.8125,106.3594 Q4057.4688,106.5156 4058.0156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="4075.75" y="116.7285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3951.5" x2="4249.5" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="3951.5" x2="4249.5" y1="135" y2="135"/><ellipse cx="3961.5" cy="149.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="3970.5" y="153.5332">UserProvider(configuration : IConfiguration)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3958.5" y="163.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="3970.5" y="171.1426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[ff7ab1418574995e2d663e91c2a7d400]
class SpElement--><g id="elem_SpElement"><rect codeLine="200" fill="#F1F1F1" height="100.8281" id="SpElement" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="176" x="4012.5" y="609.5"/><ellipse cx="4062.25" cy="625.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4065.0156,621.375 Q4065.1719,621.1563 4065.3594,621.0469 Q4065.5469,620.9375 4065.7656,620.9375 Q4066.1406,620.9375 4066.375,621.2031 Q4066.6094,621.4531 4066.6094,622.0625 L4066.6094,623.5156 Q4066.6094,624.125 4066.375,624.3906 Q4066.1406,624.6563 4065.7656,624.6563 Q4065.4219,624.6563 4065.2188,624.4531 Q4065.0156,624.2656 4064.9063,623.75 Q4064.8594,623.3906 4064.6719,623.2031 Q4064.3438,622.8281 4063.7344,622.6094 Q4063.125,622.3906 4062.5,622.3906 Q4061.7344,622.3906 4061.0938,622.7188 Q4060.4688,623.0469 4059.9688,623.7969 Q4059.4844,624.5469 4059.4844,625.5781 L4059.4844,626.6719 Q4059.4844,627.9063 4060.375,628.7344 Q4061.2656,629.5469 4062.8594,629.5469 Q4063.7969,629.5469 4064.4531,629.2969 Q4064.8438,629.1406 4065.2656,628.7031 Q4065.5313,628.4375 4065.6719,628.3594 Q4065.8281,628.2813 4066.0313,628.2813 Q4066.3594,628.2813 4066.6094,628.5469 Q4066.875,628.7969 4066.875,629.1406 Q4066.875,629.4844 4066.5313,629.8906 Q4066.0313,630.4688 4065.2344,630.7969 Q4064.1563,631.25 4062.8594,631.25 Q4061.3438,631.25 4060.1406,630.625 Q4059.1563,630.125 4058.4688,629.0625 Q4057.7813,627.9844 4057.7813,626.7031 L4057.7813,625.5469 Q4057.7813,624.2188 4058.3906,623.0781 Q4059.0156,621.9219 4060.1094,621.3125 Q4061.2031,620.6875 4062.4375,620.6875 Q4063.1719,620.6875 4063.8125,620.8594 Q4064.4688,621.0156 4065.0156,621.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="4082.75" y="631.2285">SpElement</text><line style="stroke:#181818;stroke-width:0.5;" x1="4013.5" x2="4187.5" y1="641.5" y2="641.5"/><ellipse cx="4023.5" cy="655.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="4032.5" y="660.0332">Key : string,</text><ellipse cx="4023.5" cy="673.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="4032.5" y="677.6426">Value : object,</text><ellipse cx="4023.5" cy="691.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="4032.5" y="695.252">ValueType : SqlDbType</text><line style="stroke:#181818;stroke-width:0.5;" x1="4013.5" x2="4187.5" y1="702.3281" y2="702.3281"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="183" fill="#F1F1F1" height="153.6563" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="580" x="4285.5" y="59.5"/><ellipse cx="4545.75" cy="75.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4548.5156,71.375 Q4548.6719,71.1563 4548.8594,71.0469 Q4549.0469,70.9375 4549.2656,70.9375 Q4549.6406,70.9375 4549.875,71.2031 Q4550.1094,71.4531 4550.1094,72.0625 L4550.1094,73.5156 Q4550.1094,74.125 4549.875,74.3906 Q4549.6406,74.6563 4549.2656,74.6563 Q4548.9219,74.6563 4548.7188,74.4531 Q4548.5156,74.2656 4548.4063,73.75 Q4548.3594,73.3906 4548.1719,73.2031 Q4547.8438,72.8281 4547.2344,72.6094 Q4546.625,72.3906 4546,72.3906 Q4545.2344,72.3906 4544.5938,72.7188 Q4543.9688,73.0469 4543.4688,73.7969 Q4542.9844,74.5469 4542.9844,75.5781 L4542.9844,76.6719 Q4542.9844,77.9063 4543.875,78.7344 Q4544.7656,79.5469 4546.3594,79.5469 Q4547.2969,79.5469 4547.9531,79.2969 Q4548.3438,79.1406 4548.7656,78.7031 Q4549.0313,78.4375 4549.1719,78.3594 Q4549.3281,78.2813 4549.5313,78.2813 Q4549.8594,78.2813 4550.1094,78.5469 Q4550.375,78.7969 4550.375,79.1406 Q4550.375,79.4844 4550.0313,79.8906 Q4549.5313,80.4688 4548.7344,80.7969 Q4547.6563,81.25 4546.3594,81.25 Q4544.8438,81.25 4543.6406,80.625 Q4542.6563,80.125 4541.9688,79.0625 Q4541.2813,77.9844 4541.2813,76.7031 L4541.2813,75.5469 Q4541.2813,74.2188 4541.8906,73.0781 Q4542.5156,71.9219 4543.6094,71.3125 Q4544.7031,70.6875 4545.9375,70.6875 Q4546.6719,70.6875 4547.3125,70.8594 Q4547.9688,71.0156 4548.5156,71.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="4566.25" y="81.2285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="4286.5" x2="4864.5" y1="91.5" y2="91.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="4286.5" x2="4864.5" y1="99.5" y2="99.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="4293.5" y="110.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="253" x="4305.5" y="118.0332">ComputeHash(password : string) : string</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="4293.5" y="128.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="321" x="4305.5" y="135.6426">HashPassword(password : salt, salt : string) : string</text><ellipse cx="4296.5" cy="149.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="4305.5" y="153.252">GetSalt(saltLength : int) : string</text><ellipse cx="4296.5" cy="166.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="554" x="4305.5" y="170.8613">GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string</text><ellipse cx="4296.5" cy="184.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="4305.5" y="188.4707">GetHotp(key : string, counter : long) : string</text><ellipse cx="4296.5" cy="201.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="4305.5" y="206.0801">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="193" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4900.5" y="103.5"/><ellipse cx="5049.75" cy="119.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M5052.5156,115.375 Q5052.6719,115.1563 5052.8594,115.0469 Q5053.0469,114.9375 5053.2656,114.9375 Q5053.6406,114.9375 5053.875,115.2031 Q5054.1094,115.4531 5054.1094,116.0625 L5054.1094,117.5156 Q5054.1094,118.125 5053.875,118.3906 Q5053.6406,118.6563 5053.2656,118.6563 Q5052.9219,118.6563 5052.7188,118.4531 Q5052.5156,118.2656 5052.4063,117.75 Q5052.3594,117.3906 5052.1719,117.2031 Q5051.8438,116.8281 5051.2344,116.6094 Q5050.625,116.3906 5050,116.3906 Q5049.2344,116.3906 5048.5938,116.7188 Q5047.9688,117.0469 5047.4688,117.7969 Q5046.9844,118.5469 5046.9844,119.5781 L5046.9844,120.6719 Q5046.9844,121.9063 5047.875,122.7344 Q5048.7656,123.5469 5050.3594,123.5469 Q5051.2969,123.5469 5051.9531,123.2969 Q5052.3438,123.1406 5052.7656,122.7031 Q5053.0313,122.4375 5053.1719,122.3594 Q5053.3281,122.2813 5053.5313,122.2813 Q5053.8594,122.2813 5054.1094,122.5469 Q5054.375,122.7969 5054.375,123.1406 Q5054.375,123.4844 5054.0313,123.8906 Q5053.5313,124.4688 5052.7344,124.7969 Q5051.6563,125.25 5050.3594,125.25 Q5048.8438,125.25 5047.6406,124.625 Q5046.6563,124.125 5045.9688,123.0625 Q5045.2813,121.9844 5045.2813,120.7031 L5045.2813,119.5469 Q5045.2813,118.2188 5045.8906,117.0781 Q5046.5156,115.9219 5047.6094,115.3125 Q5048.7031,114.6875 5049.9375,114.6875 Q5050.6719,114.6875 5051.3125,114.8594 Q5051.9688,115.0156 5052.5156,115.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="5070.25" y="125.2285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4901.5" x2="5287.5" y1="135.5" y2="135.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="4901.5" x2="5287.5" y1="143.5" y2="143.5"/><ellipse cx="4911.5" cy="157.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="4920.5" y="162.0332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="241" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="1144" y="1002"/><ellipse cx="1190.75" cy="1018" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1193.5156,1013.875 Q1193.6719,1013.6563 1193.8594,1013.5469 Q1194.0469,1013.4375 1194.2656,1013.4375 Q1194.6406,1013.4375 1194.875,1013.7031 Q1195.1094,1013.9531 1195.1094,1014.5625 L1195.1094,1016.0156 Q1195.1094,1016.625 1194.875,1016.8906 Q1194.6406,1017.1563 1194.2656,1017.1563 Q1193.9219,1017.1563 1193.7188,1016.9531 Q1193.5156,1016.7656 1193.4063,1016.25 Q1193.3594,1015.8906 1193.1719,1015.7031 Q1192.8438,1015.3281 1192.2344,1015.1094 Q1191.625,1014.8906 1191,1014.8906 Q1190.2344,1014.8906 1189.5938,1015.2188 Q1188.9688,1015.5469 1188.4688,1016.2969 Q1187.9844,1017.0469 1187.9844,1018.0781 L1187.9844,1019.1719 Q1187.9844,1020.4063 1188.875,1021.2344 Q1189.7656,1022.0469 1191.3594,1022.0469 Q1192.2969,1022.0469 1192.9531,1021.7969 Q1193.3438,1021.6406 1193.7656,1021.2031 Q1194.0313,1020.9375 1194.1719,1020.8594 Q1194.3281,1020.7813 1194.5313,1020.7813 Q1194.8594,1020.7813 1195.1094,1021.0469 Q1195.375,1021.2969 1195.375,1021.6406 Q1195.375,1021.9844 1195.0313,1022.3906 Q1194.5313,1022.9688 1193.7344,1023.2969 Q1192.6563,1023.75 1191.3594,1023.75 Q1189.8438,1023.75 1188.6406,1023.125 Q1187.6563,1022.625 1186.9688,1021.5625 Q1186.2813,1020.4844 1186.2813,1019.2031 L1186.2813,1018.0469 Q1186.2813,1016.7188 1186.8906,1015.5781 Q1187.5156,1014.4219 1188.6094,1013.8125 Q1189.7031,1013.1875 1190.9375,1013.1875 Q1191.6719,1013.1875 1192.3125,1013.3594 Q1192.9688,1013.5156 1193.5156,1013.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1211.25" y="1023.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="1145" x2="1306" y1="1034" y2="1034"/><ellipse cx="1155" cy="1048.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1164" y="1052.5332">Email : string</text><ellipse cx="1155" cy="1065.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1164" y="1070.1426">FirstName : string</text><ellipse cx="1155" cy="1083.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1164" y="1087.752">LastName : string</text><ellipse cx="1155" cy="1101.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1164" y="1105.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1145" x2="1306" y1="1112.4375" y2="1112.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="21" d="M1126,545 C1126,545 1126,591.67 1126,591.67 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1126,532,1122,538,1126,544,1130,538,1126,532" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1136.8391" y="553.9885">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1088.475" y="581.3093">1</text></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="22" d="M652.5,545 C652.5,545 652.5,609.34 652.5,609.34 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="652.5,532,648.5,538,652.5,544,656.5,538,652.5,532" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="627.0867" y="553.9885">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="659.7734" y="598.6229">1</text></g><!--MD5=[f6beab00d15f8b13a3171d7a5aeb0bdd]
link UserController to UserCreate--><g id="link_UserController_UserCreate"><path codeLine="24" d="M960.5,532.05 C960.5,532.05 960.5,826.6 960.5,826.6 " fill="none" id="UserController-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="960.5,831.6,964.5,822.6,960.5,826.6,956.5,822.6,960.5,831.6" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="958.668" y="554.0423">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="952.8109" y="821.0176">1</text></g><!--MD5=[b99f2b93b0ba1d8f77d1dff39826eaa1]
link UserController to UserLogin--><g id="link_UserController_UserLogin"><path codeLine="25" d="M1032.75,532.01 C1032.75,650.23 1032.75,828 1032.75,828 C1032.75,828 1057.3,828 1057.3,828 " fill="none" id="UserController-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1062.3,828,1053.3,824,1057.3,828,1053.3,832,1062.3,828" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1036.4496" y="553.9992">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1047.5672" y="820.5805">1</text></g><!--MD5=[fc4d4c58227c704dd75699b2989cdd99]
link UserController to VerifyCredentials--><g id="link_UserController_VerifyCredentials"><path codeLine="26" d="M1043.25,532.19 C1043.25,628.68 1043.25,758 1043.25,758 C1043.25,758 1278.17,758 1278.17,758 C1278.17,758 1278.17,818.32 1278.17,818.32 " fill="none" id="UserController-to-VerifyCredentials" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1278.17,823.32,1282.17,814.32,1278.17,818.32,1274.17,814.32,1278.17,823.32" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1047.284" y="553.8458">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1266.7263" y="812.5979">1</text></g><!--MD5=[11e5b9a9bd37746b63b8fb5dbd005d0d]
link UserController to User--><g id="link_UserController_User"><path codeLine="27" d="M1038,532.19 C1038,642.89 1038,803 1038,803 C1038,803 1401.45,803 1401.45,803 " fill="none" id="UserController-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1406.45,803,1397.45,799,1401.45,803,1397.45,807,1406.45,803" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1041.6484" y="553.8458">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1391.379" y="794.056">1</text></g><!--MD5=[75cbc5dcd27fd661cabdc1d644f8c2e7]
link UserController to UserToken--><g id="link_UserController_UserToken"><path codeLine="28" d="M748.25,532.05 C748.25,532.05 748.25,809.33 748.25,809.33 " fill="none" id="UserController-to-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="748.25,814.33,752.25,805.33,748.25,809.33,744.25,805.33,748.25,814.33" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="730.1676" y="554.0423">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="746.0664" y="803.6115">1</text></g><!--MD5=[058fbdb5b39b0d43ca4065519acd5c0f]
link UserController to UserLocation--><g id="link_UserController_UserLocation"><path codeLine="29" d="M1203.93,528 C1624.59,528 2318.25,528 2318.25,528 C2318.25,528 2318.25,782.69 2318.25,782.69 " fill="none" id="UserController-to-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2318.25,787.69,2322.25,778.69,2318.25,782.69,2314.25,778.69,2318.25,787.69" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1211.3815" y="527.6264">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2310.1301" y="777.0871">1</text></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="98" d="M1055.5,728.26 C1055.5,787.9 1055.5,865 1055.5,865 C1055.5,865 1032.51,865 1032.51,865 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1027.51,865,1036.51,869,1032.51,865,1036.51,861,1027.51,865" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1033.0383" y="744.9788">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1035.6627" y="861.613">1</text></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="99" d="M1129.5,728.26 C1129.5,728.26 1129.5,818.31 1129.5,818.31 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1129.5,823.31,1133.5,814.31,1129.5,818.31,1125.5,814.31,1129.5,823.31" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1092.3359" y="749.6351">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1121.9203" y="812.5862">1</text></g><!--MD5=[dded4780050378040eec2375ee9f8cef]
link IUserManager to UserLocation--><g id="link_IUserManager_UserLocation"><path codeLine="100" d="M1681.5,728.06 C1681.5,760.78 1681.5,793 1681.5,793 C1681.5,793 2238.83,793 2238.83,793 " fill="none" id="IUserManager-to-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2243.83,793,2234.83,789,2238.83,793,2234.83,797,2243.83,793" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1701.2609" y="749.4145">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2228.8862" y="783.1522">1</text></g><!--MD5=[bda616a4ec88bb93f38d43595a1d9abc]
link IUserManager to VerifyCredentials--><g id="link_IUserManager_VerifyCredentials"><path codeLine="101" d="M1324.83,728.26 C1324.83,728.26 1324.83,818.31 1324.83,818.31 " fill="none" id="IUserManager-to-VerifyCredentials" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1324.83,823.31,1328.83,814.31,1324.83,818.31,1320.83,814.31,1324.83,823.31" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1307.8093" y="749.6351">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1321.1143" y="812.5862">1</text></g><!--MD5=[9ee9fe879b30b50d6d040f556cdccece]
link IUserManager to User--><g id="link_IUserManager_User"><path codeLine="102" d="M1490.5,728.26 C1490.5,728.26 1490.5,791.69 1490.5,791.69 " fill="none" id="IUserManager-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1490.5,796.69,1494.5,787.69,1490.5,791.69,1486.5,787.69,1490.5,796.69" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1490.5641" y="749.6351">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1483.1391" y="786.3314">1</text></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="103" d="M1762.25,266.24 C1762.25,266.24 1762.25,571.76 1762.25,571.76 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1769.25,571.76,1762.25,591.76,1755.25,571.76,1769.25,571.76" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d484ee4b213f86a79b7b13bd52fde3a]
link MessageManager to IMessageManager--><g id="link_MessageManager_IMessageManager"><path codeLine="104" d="M1285.75,187.12 C1285.75,187.12 1285.75,367.05 1285.75,367.05 " fill="none" id="MessageManager-to-IMessageManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1292.75,367.05,1285.75,387.05,1278.75,367.05,1292.75,367.05" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="106" d="M2461.5,279.07 C2461.5,279.07 2461.5,334.21 2461.5,334.21 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2461.5,266.07,2457.5,272.07,2461.5,278.07,2465.5,272.07,2461.5,266.07" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2486.5836" y="287.9495">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2435.4148" y="323.533">1</text></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="107" d="M2418.25,279.21 C2418.25,279.21 2418.25,644 2418.25,644 C2418.25,644 2439.57,644 2471.27,644 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2418.25,266.21,2414.25,272.21,2418.25,278.21,2422.25,272.21,2418.25,266.21" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2439.1879" y="287.6676">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2456.1436" y="640.7904">1</text></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="108" d="M2120.5,279.07 C2120.5,279.07 2120.5,395.97 2120.5,395.97 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2120.5,266.07,2116.5,272.07,2120.5,278.07,2124.5,272.07,2120.5,266.07" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2124.8039" y="287.9495">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2098.7531" y="385.0792">1</text></g><!--MD5=[f1b914c86bbf4264254e7be00f738a27]
reverse link UserManager to IMessageManager--><g id="link_UserManager_IMessageManager"><path codeLine="109" d="M1551.75,279.07 C1551.75,279.07 1551.75,387.34 1551.75,387.34 " fill="none" id="UserManager-backto-IMessageManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1551.75,266.07,1547.75,272.07,1551.75,278.07,1555.75,272.07,1551.75,266.07" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1521.3957" y="287.9495">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1554.8117" y="376.6212">1</text></g><!--MD5=[b10f378a107f0b1cd3f676caa667fcd6]
link UserManager to DbUser--><g id="link_UserManager_DbUser"><path codeLine="111" d="M1975,266.24 C1975,266.24 1975,586.76 1975,586.76 " fill="none" id="UserManager-to-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1975,591.76,1979,582.76,1975,586.76,1971,582.76,1975,591.76" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1970.3125" y="287.6993">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1957.1719" y="580.933">1</text></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="113" d="M452.75,470.56 C452.75,470.56 452.75,589.09 452.75,589.09 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="459.75,589.09,452.75,609.09,445.75,589.09,459.75,589.09" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="114" d="M679.17,723.67 C679.17,723.67 679.17,814.2 679.17,814.2 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="679.17,710.67,675.17,716.67,679.17,722.67,683.17,716.67,679.17,710.67" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="688.5918" y="731.7157">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="667.272" y="803.4632">1</text></g><!--MD5=[f728042c19cf1eb2661dd55d1619a952]
reverse link ITokenManager to User--><g id="link_ITokenManager_User"><path codeLine="115" d="M704.33,723.86 C704.33,723.86 704.33,809 704.33,809 C704.33,809 1203.56,809 1406.37,809 " fill="none" id="ITokenManager-backto-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="704.33,710.86,700.33,716.86,704.33,722.86,708.33,716.86,704.33,710.86" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="716.9754" y="731.9301">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1391.5655" y="818.2337">1</text></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="117" d="M2996.83,178.02 C2996.83,178.02 2996.83,589.4 2996.83,589.4 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3003.83,589.4,2996.83,609.4,2989.83,589.39,3003.83,589.4" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="121" d="M2982.17,178.02 C2982.17,178.02 2982.17,589.4 2982.17,589.4 " fill="none" id="UserLocationManager-to-IUserLocationManager-1" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2989.17,589.4,2982.17,609.4,2975.17,589.39,2989.17,589.4" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="118" d="M3283.83,191.1 C3283.83,191.1 3283.83,378.47 3283.83,378.47 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3283.83,178.1,3279.83,184.1,3283.83,190.1,3287.83,184.1,3283.83,178.1" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3299.8237" y="199.8211">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3263.1655" y="367.7711">1</text></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="122" d="M3195.67,191.1 C3195.67,191.1 3195.67,378.47 3195.67,378.47 " fill="none" id="UserLocationManager-backto-IUserLocationProvider-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3195.67,178.1,3191.67,184.1,3195.67,190.1,3199.67,184.1,3195.67,178.1" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3197.0622" y="199.8211">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3162.608" y="367.7711">1</text></g><!--MD5=[5d20175c5fe60285932eacfa6ee8152d]
link IUserLocationManager to UserLocation--><g id="link_IUserLocationManager_UserLocation"><path codeLine="119" d="M2471.35,677 C2430,677 2400.75,677 2400.75,677 C2400.75,677 2400.75,782.99 2400.75,782.99 " fill="none" id="IUserLocationManager-to-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2400.75,787.99,2404.75,778.99,2400.75,782.99,2396.75,778.99,2400.75,787.99" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2456.226" y="674.7701">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2400.7145" y="777.1512">1</text></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="168" d="M2449.5,536.55 C2449.5,536.55 2449.5,601 2449.5,601 C2449.5,601 2287.73,601 2175.57,601 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2449.5,523.55,2445.5,529.55,2449.5,535.55,2453.5,529.55,2449.5,523.55" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2423.2445" y="544.9148">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2183.5431" y="593.586">1</text></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="169" d="M3377.5,492.87 C3377.5,492.87 3377.5,865 3377.5,865 C3377.5,865 2657.58,865 2409.41,865 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="3377.5,479.87,3373.5,485.87,3377.5,491.87,3381.5,485.87,3377.5,479.87" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3370.0516" y="500.9414">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="2417.1059" y="861.8136">1</text></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="171" d="M3579.25,169.55 C3579.25,216.27 3579.25,296 3579.25,296 C3579.25,296 2256.5,296 2256.5,296 C2256.5,296 2256.5,375.78 2256.5,375.78 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2263.5,375.78,2256.5,395.78,2249.5,375.78,2263.5,375.78" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="172" d="M3822,169.77 C3822,169.77 3822,358.39 3822,358.39 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3829,358.39,3822,378.39,3815,358.39,3829,358.39" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="174" d="M4050.5,178.23 C4050.5,242.16 4050.5,357 4050.5,357 C4050.5,357 2987.64,357 2987.64,357 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2987.64,364,2967.64,357,2987.64,350,2987.64,364" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="175" d="M4150.5,178.1 C4150.5,178.1 4150.5,358.47 4150.5,358.47 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="4157.5,358.47,4150.5,378.47,4143.5,358.47,4157.5,358.47" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[88090e3c46681e760d3fab65bce50628]
link UserProvider to SpElement--><g id="link_UserProvider_SpElement"><path codeLine="177" d="M3950.35,174 C3843.39,174 3718.5,174 3718.5,174 C3718.5,174 3718.5,644 3718.5,644 C3718.5,644 4007.38,644 4007.38,644 " fill="none" id="UserProvider-to-SpElement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="4012.38,644,4003.38,640,4007.38,644,4003.38,648,4012.38,644" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="3935.4274" y="173.0196">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="3999.5923" y="639.4551">*</text></g><!--MD5=[f38462d5a69f1e7a321ad47f950d53fd]
link SqlProvider to SpElement--><g id="link_SqlProvider_SpElement"><path codeLine="178" d="M4100.5,479.69 C4100.5,479.69 4100.5,604.42 4100.5,604.42 " fill="none" id="SqlProvider-to-SpElement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="4100.5,609.42,4104.5,600.42,4100.5,604.42,4096.5,600.42,4100.5,609.42" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="4093.0516" y="500.7383">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="4095.1484" y="598.7141">*</text></g><!--MD5=[61783111ed1ab1496484cbd9031ea3bd]
link LeakedPasswordProvider to SpElement--><g id="link_LeakedPasswordProvider_SpElement"><path codeLine="179" d="M3683,169.9 C3683,287.74 3683,677 3683,677 C3683,677 4007.47,677 4007.47,677 " fill="none" id="LeakedPasswordProvider-to-SpElement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="4012.47,677,4003.47,673,4007.47,677,4003.47,681,4012.47,677" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="3999.4072" y="675.32">*</text></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="208" d="M1406.22,925 C1343.7,925 1269.25,925 1269.25,925 C1269.25,925 1269.25,981.74 1269.25,981.74 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1276.25,981.74,1269.25,1001.74,1262.25,981.74,1276.25,981.74" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="209" d="M960.5,898.25 C960.5,954.17 960.5,1061 960.5,1061 C960.5,1061 1123.83,1061 1123.83,1061 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1123.83,1054,1143.83,1061,1123.83,1068,1123.83,1054" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="211" d="M2070.5,728.26 C2070.5,787.9 2070.5,865 2070.5,865 C2070.5,865 1594.53,865 1594.53,865 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1594.53,872,1574.53,865,1594.53,858,1594.53,872" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e3c9eb10d123cf0a36f97bef8dc80753]
@startuml API class diagram

top to bottom direction
skinparam linetype ortho
'Controllers'

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +CreateAsync(userCreate : UserCreate) : Task<ActionResult>
    +LoginAsync(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromTokenAsync() : Task<ActionResult<User>>
    +VerificationLoginAsync(verifyCredentials : VerifyCredentials) : Task<ActionResult<UserToken>>
    +VerifyUserRegisterAsync(verifyCredentials : VerifyCredentials) : Task<ActionResult>
    -GetUserLocation() : UserLocation
}

'Controllers mappings' 

UserController "1" o- - "1" IUserManager
UserController "1" o- - "1" ITokenManager

UserController "1" - -> "1" UserCreate
UserController "1" - -> "1" UserLogin
UserController "1" - -> "1" VerifyCredentials
UserController "1" - -> "1" User
UserController "1" - -> "1" UserToken
UserController "1" - -> "1" UserLocation


'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(verifyCredentials : VerifyCredentials, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(verifyCredentials : VerifyCredentials, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessageAsync(to : string, otp : string) : Task<bool>
    +SendLoginRegistrationMessageAsync(to : string, key : string) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageManager : IMessageManager
    -_logger : ILogger<UserManager>
    -_configuration : IConfiguration
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    -CheckPasswordLeakedForUserAsync(password : string) : Task<bool>
    -IsUserNotVerifiedAsync(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLockedAsync(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : IUserLocationProvider)
}

class MessageManager {
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    - -
    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)
}


'Managers mappings'

IUserManager "1" - -> "1" UserCreate
IUserManager "1" - -> "1" UserLogin
IUserManager "1" - -> "1" UserLocation
IUserManager "1" - -> "1" VerifyCredentials
IUserManager "1" - -> "1" User
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager "1" o- - "1" IUserProvider
UserManager "1" o- - "1" IUserLocationManager
UserManager "1" o- - "1" ILeakedPasswordProvider
UserManager "1" o- - "1" IMessageManager

UserManager "1" - -> "1" DbUser

TokenManager .-|> ITokenManager
ITokenManager "1" *- - "1" UserToken
ITokenManager "1" *- - "1" User

UserLocationManager .- -|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider
IUserLocationManager "1" - -> "1" UserLocation

UserLocationManager .- -|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTriesAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocationAsync(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCodeAsync(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElement[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider "1" *- - "1" DbUser
IUserLocationProvider "1" *- - "1" UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

UserProvider "1" - -> "*" SpElement
SqlProvider "1" - -> "*" SpElement
LeakedPasswordProvider - -> "*" SpElement

'Utility'

class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Models'

class SpElement{
    +Key : string,
    +Value : object,
    +ValueType : SqlDbType
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class VerifyCredentials {
    +Email : string
    +Password : string
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction
skinparam linetype ortho

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +CreateAsync(userCreate : UserCreate) : Task<ActionResult>
    +LoginAsync(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromTokenAsync() : Task<ActionResult<User>>
    +VerificationLoginAsync(verifyCredentials : VerifyCredentials) : Task<ActionResult<UserToken>>
    +VerifyUserRegisterAsync(verifyCredentials : VerifyCredentials) : Task<ActionResult>
    -GetUserLocation() : UserLocation
}


UserController "1" o- - "1" IUserManager
UserController "1" o- - "1" ITokenManager

UserController "1" - -> "1" UserCreate
UserController "1" - -> "1" UserLogin
UserController "1" - -> "1" VerifyCredentials
UserController "1" - -> "1" User
UserController "1" - -> "1" UserToken
UserController "1" - -> "1" UserLocation



Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(verifyCredentials : VerifyCredentials, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(verifyCredentials : VerifyCredentials, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

interface IMessageManager {
    +SendLoginAttemptMessageAsync(to : string, otp : string) : Task<bool>
    +SendLoginRegistrationMessageAsync(to : string, key : string) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageManager : IMessageManager
    -_logger : ILogger<UserManager>
    -_configuration : IConfiguration
    - -
    +UserManager(configuration : IConfiguration, userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
     messageManager : IMessageManager, logger : ILogger<UserManager>)
    -IsVerificationCodeValid(verificationCode : string, user : DbUser) : bool
    -CheckPasswordLeakedForUserAsync(password : string) : Task<bool>
    -IsUserNotVerifiedAsync(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLockedAsync(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : IUserLocationProvider)
}

class MessageManager {
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    - -
    +MessageManager(messageService : EmailMessageService, messageProvider : MailMessageProvider)
}



IUserManager "1" - -> "1" UserCreate
IUserManager "1" - -> "1" UserLogin
IUserManager "1" - -> "1" UserLocation
IUserManager "1" - -> "1" VerifyCredentials
IUserManager "1" - -> "1" User
UserManager .-|> IUserManager
MessageManager .-|> IMessageManager

UserManager "1" o- - "1" IUserProvider
UserManager "1" o- - "1" IUserLocationManager
UserManager "1" o- - "1" ILeakedPasswordProvider
UserManager "1" o- - "1" IMessageManager

UserManager "1" - -> "1" DbUser

TokenManager .-|> ITokenManager
ITokenManager "1" *- - "1" UserToken
ITokenManager "1" *- - "1" User

UserLocationManager .- -|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider
IUserLocationManager "1" - -> "1" UserLocation

UserLocationManager .- -|> IUserLocationManager
UserLocationManager "1" o- - "1" IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTriesAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccessAsync(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocationAsync(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
    +UpdateUserLoginSuccessWithVerificationCodeAsync(userId : int) : Task<DbUser>
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElement[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider "1" *- - "1" DbUser
IUserLocationProvider "1" *- - "1" UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

UserProvider "1" - -> "*" SpElement
SqlProvider "1" - -> "*" SpElement
LeakedPasswordProvider - -> "*" SpElement


class Security{
    - -
    {static}-ComputeHash(password : string) : string
    {static}-HashPassword(password : salt, salt : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string, pepper : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


class SpElement{
    +Key : string,
    +Value : object,
    +ValueType : SqlDbType
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class VerifyCredentials {
    +Email : string
    +Password : string
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>