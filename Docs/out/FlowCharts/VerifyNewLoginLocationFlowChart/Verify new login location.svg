<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="569px" preserveAspectRatio="none" style="width:696px;height:569px;background:#FFFFFF;" version="1.1" viewBox="0 0 696 569" width="696px" zoomAndPan="magnify"><defs/><g><ellipse cx="131" cy="16" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="220" x="21" y="67"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="200" x="31" y="89.457">Receive email &amp; One time password</text><g id="elem_#5"><polygon fill="#90EE90" points="131,143,143,155,131,167,119,155,131,143" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="7" y="222"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="152" x="17" y="244.457">Return ip blocked message</text><g id="elem_#10"><polygon fill="#90EE90" points="211,227.5,223,239.5,211,251.5,199,239.5,211,227.5" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="84.5" y="467"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="207" x="94.5" y="489.457">Return incorrect credentials message</text><g id="elem_#15"><polygon fill="#90EE90" points="295,298,307,310,295,322,283,310,295,298" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="180" x="205" y="377"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="160" x="215" y="399.457">Return user locked message</text><g id="elem_#20"><polygon fill="#90EE90" points="417,382.5,429,394.5,417,406.5,405,394.5,417,382.5" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#ADD8E6" height="35.0938" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="354.5" y="467"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="105" x="364.5" y="489.457">Return users token</text><ellipse cx="417" cy="553" fill="none" rx="10" ry="10" style="stroke:#FF0000;stroke-width:1.0;"/><ellipse cx="417.5" cy="553.5" fill="#FF0000" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><!--MD5=[1c9e3c8fd87602a550371f2500e880ec]
link start to Receive email & One time password--><g id="link_start_Receive email &amp; One time password"><path d="M131,26.25 C131,35.43 131,49.84 131,61.9 " fill="none" id="start-to-Receive email &amp; One time password" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="131,66.91,135,57.91,131,61.91,127,57.91,131,66.91" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e173a0b0292ace8b6bd9ae307ead419c]
link Receive email & One time password to #5--><g id="link_Receive email &amp; One time password_#5"><path d="M131,102.08 C131,112.87 131,126.88 131,137.63 " fill="none" id="Receive email &amp; One time password-to-#5" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="131,142.92,135,133.92,131,137.92,127,133.92,131,142.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="59" x="57.6188" y="132.485">Ip is blocked</text></g><!--MD5=[556588b319764b122b83060284bcf201]
link #5 to Return ip blocked message--><g id="link_#5_Return ip blocked message"><path d="M127.49,163.61 C121.95,175.65 110.97,199.49 102.88,217.06 " fill="none" id="#5-to-Return ip blocked message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="100.68,221.83,108.0704,215.3198,102.7662,217.286,100.8,211.9819,100.68,221.83" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="118" y="199.4189">true</text></g><!--MD5=[46dcf2c2a445c5816f2e190415bdd366]
link #5 to #10--><g id="link_#5_#10"><path d="M136.5,161.67 C149.91,175.5 184.42,211.09 201.35,228.55 " fill="none" id="#5-to-#10" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="205.25,232.57,201.8448,223.3285,201.7648,228.9848,196.1085,228.9048,205.25,232.57" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="93" x="231.2281" y="222.6938">user does not exist</text></g><!--MD5=[8b50378e7ea514942e335c9d1a85cf75]
link #10 to Return incorrect credentials message--><g id="link_#10_Return incorrect credentials message"><path d="M209.49,250.06 C206.07,272.28 197.8,329.12 195,377 C194.09,392.53 194.67,396.45 195,412 C195.35,428.56 196.15,447.26 196.83,461.38 " fill="none" id="#10-to-Return incorrect credentials message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="197.1,466.75,200.6587,457.5665,196.8574,461.7559,192.6681,457.9547,197.1,466.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="199" y="354.4189">true</text></g><!--MD5=[964bdbcd74089faaa499bf5ab2d768b0]
link #10 to #15--><g id="link_#10_#15"><path d="M217.31,245.65 C231.66,257.35 266.86,286.05 284.52,300.46 " fill="none" id="#10-to-#15" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="288.61,303.79,284.1632,295.0022,284.7351,300.63,279.1073,301.202,288.61,303.79" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="67" x="207.8978" y="297.9836">Is user locked</text></g><!--MD5=[1ef02b6714ba5b3c383f1bba62f45f7d]
link #15 to Return user locked message--><g id="link_#15_Return user locked message"><path d="M295,322.13 C295,334.77 295,355.72 295,371.66 " fill="none" id="#15-to-Return user locked message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="295,376.85,299,367.85,295,371.85,291,367.85,295,376.85" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="296" y="354.4189">true</text></g><!--MD5=[354f6a9647aa1417fae839d21f2cfb02]
link #15 to #20--><g id="link_#15_#20"><path d="M301.89,315.34 C318.24,325.7 360.64,352.81 395,377 C398.82,379.69 402.93,382.73 406.55,385.46 " fill="none" id="#15-to-#20" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="410.53,388.49,405.799,379.8518,406.5542,385.4581,400.9479,386.2132,410.53,388.49" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="253" x="436.7866" y="384.2638">Does one time password not match given password</text></g><!--MD5=[c4fdf273b225c2872b9c1e5d5f765f09]
link #20 to Return incorrect credentials message--><g id="link_#20_Return incorrect credentials message"><path d="M410.79,400.94 C406.56,404.45 400.71,408.91 395,412 C353.04,434.7 302.39,452.9 262.95,465.26 " fill="none" id="#20-to-Return incorrect credentials message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="257.71,466.89,267.4923,468.0335,262.4839,465.4035,265.1139,460.3952,257.71,466.89" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19" x="350" y="444.4189">true</text></g><!--MD5=[8f596e11206f2490f3dda5d3f3dc6d21]
link #20 to Return users token--><g id="link_#20_Return users token"><path d="M417,406.65 C417,420.39 417,444.08 417,461.54 " fill="none" id="#20-to-Return users token" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="417,466.73,421,457.73,417,461.73,413,457.73,417,466.73" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0bd9051ed48cda9ae255129bdd4769f8]
link Return users token to end--><g id="link_Return users token_end"><path d="M417,502.28 C417,513.29 417,527.52 417,537.94 " fill="none" id="Return users token-to-end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="417,543,421,534,417,538,413,534,417,543" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ac3f644ace06a3358ecfb917b60eac29]
@startuml Verify new login location

skinparam activity {
    BackgroundColor lightblue
    
    StartColor green
    EndColor red
    
    diamondBackgroundColor lightgreen
}


(*) - -> "Receive email & One time password"

if "Ip is blocked" then
	- ->[true] "Return ip blocked message"
else
	if "user does not exist" then
		- ->[true] "Return incorrect credentials message"
	else
		if "Is user locked" then
			- ->[true] "Return user locked message"
		else
			if "Does one time password not match given password" then
				- ->[true] "Return incorrect credentials message"
			else
				- ->"Return users token"
			end if
		end if
	end if
end if

- ->(*)

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>