<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1075px" preserveAspectRatio="none" style="width:4570px;height:1075px;background:#FFFFFF;" version="1.1" viewBox="0 0 4570 1075" width="4570px" zoomAndPan="magnify"><defs/><g><!--MD5=[29f97d496cbdc4ec81664c6d94dc9bf6]
class UserController--><g id="elem_UserController"><rect codeLine="6" fill="#F1F1F1" height="188.875" id="UserController" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="521" x="575" y="33.5"/><ellipse cx="785.75" cy="49.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M788.5156,45.375 Q788.6719,45.1563 788.8594,45.0469 Q789.0469,44.9375 789.2656,44.9375 Q789.6406,44.9375 789.875,45.1953 Q790.1094,45.4531 790.1094,46.0625 L790.1094,47.5156 Q790.1094,48.125 789.875,48.3906 Q789.6406,48.6563 789.2656,48.6563 Q788.9219,48.6563 788.7188,48.4531 Q788.5156,48.2656 788.4063,47.75 Q788.3594,47.3906 788.1719,47.2031 Q787.8438,46.8281 787.2344,46.6094 Q786.625,46.3906 786,46.3906 Q785.2344,46.3906 784.6016,46.7188 Q783.9688,47.0469 783.4766,47.7969 Q782.9844,48.5469 782.9844,49.5781 L782.9844,50.6719 Q782.9844,51.9063 783.875,52.7266 Q784.7656,53.5469 786.3594,53.5469 Q787.2969,53.5469 787.9531,53.2969 Q788.3438,53.1406 788.7656,52.7031 Q789.0313,52.4375 789.1797,52.3594 Q789.3281,52.2813 789.5313,52.2813 Q789.8594,52.2813 790.1172,52.5391 Q790.375,52.7969 790.375,53.1406 Q790.375,53.4844 790.0313,53.8906 Q789.5313,54.4688 788.7344,54.7969 Q787.6563,55.25 786.3594,55.25 Q784.8438,55.25 783.6406,54.625 Q782.6563,54.125 781.9688,53.0547 Q781.2813,51.9844 781.2813,50.7031 L781.2813,49.5469 Q781.2813,48.2188 781.8984,47.0703 Q782.5156,45.9219 783.6094,45.3047 Q784.7031,44.6875 785.9375,44.6875 Q786.6719,44.6875 787.3203,44.8516 Q787.9688,45.0156 788.5156,45.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="806.25" y="55.2285">UserController</text><line style="stroke:#181818;stroke-width:0.5;" x1="576" x2="1095" y1="65.5" y2="65.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583" y="76.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="595" y="84.0332">_userManager{readonly} : IUserManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="583" y="94.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="595" y="101.6426">_tokenManager : ITokenManager</text><line style="stroke:#181818;stroke-width:1.0;" x1="576" x2="1095" y1="108.7188" y2="108.7188"/><ellipse cx="586" cy="123.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="595" y="127.252">UserController(userManager : IUserManager, tokenManager : ITokenManager)</text><ellipse cx="586" cy="140.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="595" y="144.8613">Create(userCreate : UserCreate) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="158.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="595" y="162.4707">Login(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="175.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="318" x="595" y="180.0801">GetUserFromToken() : Task&lt;ActionResult&lt;User&gt;&gt;</text><ellipse cx="586" cy="193.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="477" x="595" y="197.6895">VerificationLogin(userLogin : UserLogin) : Task&lt;ActionResult&lt;UserToken&gt;&gt;</text><ellipse cx="586" cy="211.0703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="406" x="595" y="215.2988">VerifyUserRegister(UserLogin : UserLogin) : Task&lt;ActionResult&gt;</text></g><!--MD5=[56ab46cd423624563d94b9f2eeeea516]
class IUserManager--><g id="elem_IUserManager"><rect codeLine="25" fill="#F1F1F1" height="136.0469" id="IUserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="653" x="509" y="326.5"/><ellipse cx="785.75" cy="342.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M786.7031,339.1406 L786.7031,345.7969 L788.4219,345.7969 Q789.0313,345.7969 789.2969,346.0313 Q789.5625,346.2656 789.5625,346.6563 Q789.5625,347.0313 789.2969,347.2656 Q789.0313,347.5 788.4219,347.5 L783.2813,347.5 Q782.6719,347.5 782.4063,347.2656 Q782.1406,347.0313 782.1406,346.6406 Q782.1406,346.2656 782.4063,346.0313 Q782.6719,345.7969 783.2813,345.7969 L785,345.7969 L785,339.1406 L783.2813,339.1406 Q782.6719,339.1406 782.4063,338.9063 Q782.1406,338.6719 782.1406,338.2813 Q782.1406,337.9063 782.4063,337.6719 Q782.6719,337.4375 783.2813,337.4375 L788.4219,337.4375 Q789.0313,337.4375 789.2969,337.6719 Q789.5625,337.9063 789.5625,338.2813 Q789.5625,338.6719 789.2969,338.9063 Q789.0313,339.1406 788.4219,339.1406 L786.7031,339.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="91" x="806.25" y="348.2285">IUserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="510" x2="1161" y1="358.5" y2="358.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="510" x2="1161" y1="366.5" y2="366.5"/><ellipse cx="520" cy="380.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="361" x="529" y="385.0332">CreateUserAsync(userCreate : UserCreate) : Task&lt;bool&gt;</text><ellipse cx="520" cy="398.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="495" x="529" y="402.6426">LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="520" cy="416.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="529" y="420.252">GetUserByIDAsync(id : int) : Task&lt;User&gt;</text><ellipse cx="520" cy="433.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="627" x="529" y="437.8613">LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task&lt;User&gt;</text><ellipse cx="520" cy="451.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="595" x="529" y="455.4707">VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[1258d900524f45f247dd7f1e09584eb4]
class ITokenManager--><g id="elem_ITokenManager"><rect codeLine="33" fill="#F1F1F1" height="100.8281" id="ITokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="100.5" y="344"/><ellipse cx="227.25" cy="360" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M228.2031,356.6406 L228.2031,363.2969 L229.9219,363.2969 Q230.5313,363.2969 230.7969,363.5313 Q231.0625,363.7656 231.0625,364.1563 Q231.0625,364.5313 230.7969,364.7656 Q230.5313,365 229.9219,365 L224.7813,365 Q224.1719,365 223.9063,364.7656 Q223.6406,364.5313 223.6406,364.1406 Q223.6406,363.7656 223.9063,363.5313 Q224.1719,363.2969 224.7813,363.2969 L226.5,363.2969 L226.5,356.6406 L224.7813,356.6406 Q224.1719,356.6406 223.9063,356.4063 Q223.6406,356.1719 223.6406,355.7813 Q223.6406,355.4063 223.9063,355.1719 Q224.1719,354.9375 224.7813,354.9375 L229.9219,354.9375 Q230.5313,354.9375 230.7969,355.1719 Q231.0625,355.4063 231.0625,355.7813 Q231.0625,356.1719 230.7969,356.4063 Q230.5313,356.6406 229.9219,356.6406 L228.2031,356.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="247.75" y="365.7285">ITokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="101.5" x2="463.5" y1="376" y2="376"/><line style="stroke:#181818;stroke-width:0.5;" x1="101.5" x2="463.5" y1="384" y2="384"/><ellipse cx="111.5" cy="398.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="120.5" y="402.5332">GenerateUserToken(user : User) : UserToken</text><ellipse cx="111.5" cy="415.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="120.5" y="420.1426">ValidateToken(token : string) : bool</text><ellipse cx="111.5" cy="433.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="120.5" y="437.752">GetUserTokenFromToken(token : string) : UserToken</text></g><!--MD5=[d00c2197046b95564bb4dabcd5edfb06]
class IUserLocationManager--><g id="elem_IUserLocationManager"><rect codeLine="40" fill="#F1F1F1" height="100.8281" id="IUserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="1551.5" y="344"/><ellipse cx="1744.75" cy="360" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1745.7031,356.6406 L1745.7031,363.2969 L1747.4219,363.2969 Q1748.0313,363.2969 1748.2969,363.5313 Q1748.5625,363.7656 1748.5625,364.1563 Q1748.5625,364.5313 1748.2969,364.7656 Q1748.0313,365 1747.4219,365 L1742.2813,365 Q1741.6719,365 1741.4063,364.7656 Q1741.1406,364.5313 1741.1406,364.1406 Q1741.1406,363.7656 1741.4063,363.5313 Q1741.6719,363.2969 1742.2813,363.2969 L1744,363.2969 L1744,356.6406 L1742.2813,356.6406 Q1741.6719,356.6406 1741.4063,356.4063 Q1741.1406,356.1719 1741.1406,355.7813 Q1741.1406,355.4063 1741.4063,355.1719 Q1741.6719,354.9375 1742.2813,354.9375 L1747.4219,354.9375 Q1748.0313,354.9375 1748.2969,355.1719 Q1748.5625,355.4063 1748.5625,355.7813 Q1748.5625,356.1719 1748.2969,356.4063 Q1748.0313,356.6406 1747.4219,356.6406 L1745.7031,356.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="145" x="1765.25" y="365.7285">IUserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1552.5" x2="2090.5" y1="376" y2="376"/><line style="stroke:#181818;stroke-width:0.5;" x1="1552.5" x2="2090.5" y1="384" y2="384"/><ellipse cx="1562.5" cy="398.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="1571.5" y="402.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="1562.5" cy="415.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="1571.5" y="420.1426">LogLocationAsync(userLocation : UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="1562.5" cy="433.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="1571.5" y="437.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[6c06fb0cd17dfe24a13aaf4bb7e771c8]
class TokenManager--><g id="elem_TokenManager"><rect codeLine="46" fill="#F1F1F1" height="83.2188" id="TokenManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="533" x="7" y="86.5"/><ellipse cx="221.25" cy="102.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M224.0156,98.375 Q224.1719,98.1563 224.3594,98.0469 Q224.5469,97.9375 224.7656,97.9375 Q225.1406,97.9375 225.375,98.1953 Q225.6094,98.4531 225.6094,99.0625 L225.6094,100.5156 Q225.6094,101.125 225.375,101.3906 Q225.1406,101.6563 224.7656,101.6563 Q224.4219,101.6563 224.2188,101.4531 Q224.0156,101.2656 223.9063,100.75 Q223.8594,100.3906 223.6719,100.2031 Q223.3438,99.8281 222.7344,99.6094 Q222.125,99.3906 221.5,99.3906 Q220.7344,99.3906 220.1016,99.7188 Q219.4688,100.0469 218.9766,100.7969 Q218.4844,101.5469 218.4844,102.5781 L218.4844,103.6719 Q218.4844,104.9063 219.375,105.7266 Q220.2656,106.5469 221.8594,106.5469 Q222.7969,106.5469 223.4531,106.2969 Q223.8438,106.1406 224.2656,105.7031 Q224.5313,105.4375 224.6797,105.3594 Q224.8281,105.2813 225.0313,105.2813 Q225.3594,105.2813 225.6172,105.5391 Q225.875,105.7969 225.875,106.1406 Q225.875,106.4844 225.5313,106.8906 Q225.0313,107.4688 224.2344,107.7969 Q223.1563,108.25 221.8594,108.25 Q220.3438,108.25 219.1406,107.625 Q218.1563,107.125 217.4688,106.0547 Q216.7813,104.9844 216.7813,103.7031 L216.7813,102.5469 Q216.7813,101.2188 217.3984,100.0703 Q218.0156,98.9219 219.1094,98.3047 Q220.2031,97.6875 221.4375,97.6875 Q222.1719,97.6875 222.8203,97.8516 Q223.4688,98.0156 224.0156,98.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="241.75" y="108.2285">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="539" y1="118.5" y2="118.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="539" y1="126.5" y2="126.5"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="137.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="27" y="145.0332">GetPrincipal(token : string) : ClaimsPrincipal</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="155.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="507" x="27" y="162.6426">ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken</text></g><!--MD5=[24add822970012a00cd97a40cd79feff]
class UserManager--><g id="elem_UserManager"><rect codeLine="52" fill="#F1F1F1" height="241.7031" id="UserManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="938" x="1255.5" y="7"/><ellipse cx="1677.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1680.5156,18.875 Q1680.6719,18.6563 1680.8594,18.5469 Q1681.0469,18.4375 1681.2656,18.4375 Q1681.6406,18.4375 1681.875,18.6953 Q1682.1094,18.9531 1682.1094,19.5625 L1682.1094,21.0156 Q1682.1094,21.625 1681.875,21.8906 Q1681.6406,22.1563 1681.2656,22.1563 Q1680.9219,22.1563 1680.7188,21.9531 Q1680.5156,21.7656 1680.4063,21.25 Q1680.3594,20.8906 1680.1719,20.7031 Q1679.8438,20.3281 1679.2344,20.1094 Q1678.625,19.8906 1678,19.8906 Q1677.2344,19.8906 1676.6016,20.2188 Q1675.9688,20.5469 1675.4766,21.2969 Q1674.9844,22.0469 1674.9844,23.0781 L1674.9844,24.1719 Q1674.9844,25.4063 1675.875,26.2266 Q1676.7656,27.0469 1678.3594,27.0469 Q1679.2969,27.0469 1679.9531,26.7969 Q1680.3438,26.6406 1680.7656,26.2031 Q1681.0313,25.9375 1681.1797,25.8594 Q1681.3281,25.7813 1681.5313,25.7813 Q1681.8594,25.7813 1682.1172,26.0391 Q1682.375,26.2969 1682.375,26.6406 Q1682.375,26.9844 1682.0313,27.3906 Q1681.5313,27.9688 1680.7344,28.2969 Q1679.6563,28.75 1678.3594,28.75 Q1676.8438,28.75 1675.6406,28.125 Q1674.6563,27.625 1673.9688,26.5547 Q1673.2813,25.4844 1673.2813,24.2031 L1673.2813,23.0469 Q1673.2813,21.7188 1673.8984,20.5703 Q1674.5156,19.4219 1675.6094,18.8047 Q1676.7031,18.1875 1677.9375,18.1875 Q1678.6719,18.1875 1679.3203,18.3516 Q1679.9688,18.5156 1680.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1698.25" y="28.7285">UserManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="1256.5" x2="2192.5" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1263.5" y="50.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="1275.5" y="57.5332">_userProvider : IUserProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1263.5" y="67.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="1275.5" y="75.1426">_leakedPasswordProvider : ILeakedPasswordProvider;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1263.5" y="85.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="1275.5" y="92.752">_userLocationManager : IUserLocationManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1263.5" y="103.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231" x="1275.5" y="110.3613">_messageService : IMessageService</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1263.5" y="120.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="1275.5" y="127.9707">_messageProvider : IMessageProvider</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1263.5" y="138.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="1275.5" y="145.5801">_logger : ILogger&lt;UserManager&gt;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1256.5" x2="2192.5" y1="152.6563" y2="152.6563"/><ellipse cx="1266.5" cy="166.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="912" x="1275.5" y="171.1895">UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="680" x="1275.5" y="188.7988">messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger&lt;UserManager&gt;)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1263.5" y="199.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="402" x="1275.5" y="206.4082">CheckPasswordLeakedForUser(password : string) : Task&lt;bool&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1263.5" y="216.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="433" x="1275.5" y="224.0176">IsUserNotVerified(userLocation : UserLocation, user : DbUser) : Task</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1263.5" y="234.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="410" x="1275.5" y="241.627">IsUserLocked(userLocation : UserLocation, user : DbUser) : Task</text></g><!--MD5=[f73269fd56b24b10ecd9be8e99f9cb1e]
class UserLocationManager--><g id="elem_UserLocationManager"><rect codeLine="67" fill="#F1F1F1" height="83.2188" id="UserLocationManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="458" x="2336.5" y="86.5"/><ellipse cx="2491.75" cy="102.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2494.5156,98.375 Q2494.6719,98.1563 2494.8594,98.0469 Q2495.0469,97.9375 2495.2656,97.9375 Q2495.6406,97.9375 2495.875,98.1953 Q2496.1094,98.4531 2496.1094,99.0625 L2496.1094,100.5156 Q2496.1094,101.125 2495.875,101.3906 Q2495.6406,101.6563 2495.2656,101.6563 Q2494.9219,101.6563 2494.7188,101.4531 Q2494.5156,101.2656 2494.4063,100.75 Q2494.3594,100.3906 2494.1719,100.2031 Q2493.8438,99.8281 2493.2344,99.6094 Q2492.625,99.3906 2492,99.3906 Q2491.2344,99.3906 2490.6016,99.7188 Q2489.9688,100.0469 2489.4766,100.7969 Q2488.9844,101.5469 2488.9844,102.5781 L2488.9844,103.6719 Q2488.9844,104.9063 2489.875,105.7266 Q2490.7656,106.5469 2492.3594,106.5469 Q2493.2969,106.5469 2493.9531,106.2969 Q2494.3438,106.1406 2494.7656,105.7031 Q2495.0313,105.4375 2495.1797,105.3594 Q2495.3281,105.2813 2495.5313,105.2813 Q2495.8594,105.2813 2496.1172,105.5391 Q2496.375,105.7969 2496.375,106.1406 Q2496.375,106.4844 2496.0313,106.8906 Q2495.5313,107.4688 2494.7344,107.7969 Q2493.6563,108.25 2492.3594,108.25 Q2490.8438,108.25 2489.6406,107.625 Q2488.6563,107.125 2487.9688,106.0547 Q2487.2813,104.9844 2487.2813,103.7031 L2487.2813,102.5469 Q2487.2813,101.2188 2487.8984,100.0703 Q2488.5156,98.9219 2489.6094,98.3047 Q2490.7031,97.6875 2491.9375,97.6875 Q2492.6719,97.6875 2493.3203,97.8516 Q2493.9688,98.0156 2494.5156,98.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2512.25" y="108.2285">UserLocationManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="2337.5" x2="2793.5" y1="118.5" y2="118.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2344.5" y="129.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="294" x="2356.5" y="137.0332">_userLocationProvider : IUserLocationProvider</text><line style="stroke:#181818;stroke-width:1.0;" x1="2337.5" x2="2793.5" y1="144.1094" y2="144.1094"/><ellipse cx="2347.5" cy="158.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="432" x="2356.5" y="162.6426">UserLocationManager(userLocationProvider : UserLocationProvider)</text></g><!--MD5=[177726c6dccf199602c5c27bb05f2a1e]
class UserCreate--><g id="elem_UserCreate"><rect codeLine="192" fill="#F1F1F1" height="65.6094" id="UserCreate" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="1258.5" y="789"/><ellipse cx="1287" cy="805" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1289.7656,800.875 Q1289.9219,800.6563 1290.1094,800.5469 Q1290.2969,800.4375 1290.5156,800.4375 Q1290.8906,800.4375 1291.125,800.6953 Q1291.3594,800.9531 1291.3594,801.5625 L1291.3594,803.0156 Q1291.3594,803.625 1291.125,803.8906 Q1290.8906,804.1563 1290.5156,804.1563 Q1290.1719,804.1563 1289.9688,803.9531 Q1289.7656,803.7656 1289.6563,803.25 Q1289.6094,802.8906 1289.4219,802.7031 Q1289.0938,802.3281 1288.4844,802.1094 Q1287.875,801.8906 1287.25,801.8906 Q1286.4844,801.8906 1285.8516,802.2188 Q1285.2188,802.5469 1284.7266,803.2969 Q1284.2344,804.0469 1284.2344,805.0781 L1284.2344,806.1719 Q1284.2344,807.4063 1285.125,808.2266 Q1286.0156,809.0469 1287.6094,809.0469 Q1288.5469,809.0469 1289.2031,808.7969 Q1289.5938,808.6406 1290.0156,808.2031 Q1290.2813,807.9375 1290.4297,807.8594 Q1290.5781,807.7813 1290.7813,807.7813 Q1291.1094,807.7813 1291.3672,808.0391 Q1291.625,808.2969 1291.625,808.6406 Q1291.625,808.9844 1291.2813,809.3906 Q1290.7813,809.9688 1289.9844,810.2969 Q1288.9063,810.75 1287.6094,810.75 Q1286.0938,810.75 1284.8906,810.125 Q1283.9063,809.625 1283.2188,808.5547 Q1282.5313,807.4844 1282.5313,806.2031 L1282.5313,805.0469 Q1282.5313,803.7188 1283.1484,802.5703 Q1283.7656,801.4219 1284.8594,800.8047 Q1285.9531,800.1875 1287.1875,800.1875 Q1287.9219,800.1875 1288.5703,800.3516 Q1289.2188,800.5156 1289.7656,800.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1304" y="810.7285">UserCreate</text><line style="stroke:#181818;stroke-width:0.5;" x1="1259.5" x2="1391.5" y1="821" y2="821"/><ellipse cx="1269.5" cy="835.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1278.5" y="839.5332">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1259.5" x2="1391.5" y1="846.6094" y2="846.6094"/></g><!--MD5=[f8bd6c2ec23e906322bbeaf68b53bb4f]
class UserLogin--><g id="elem_UserLogin"><rect codeLine="204" fill="#F1F1F1" height="83.2188" id="UserLogin" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="768.5" y="575.5"/><ellipse cx="800.6" cy="591.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M803.3656,587.375 Q803.5219,587.1563 803.7094,587.0469 Q803.8969,586.9375 804.1156,586.9375 Q804.4906,586.9375 804.725,587.1953 Q804.9594,587.4531 804.9594,588.0625 L804.9594,589.5156 Q804.9594,590.125 804.725,590.3906 Q804.4906,590.6563 804.1156,590.6563 Q803.7719,590.6563 803.5688,590.4531 Q803.3656,590.2656 803.2563,589.75 Q803.2094,589.3906 803.0219,589.2031 Q802.6938,588.8281 802.0844,588.6094 Q801.475,588.3906 800.85,588.3906 Q800.0844,588.3906 799.4516,588.7188 Q798.8188,589.0469 798.3266,589.7969 Q797.8344,590.5469 797.8344,591.5781 L797.8344,592.6719 Q797.8344,593.9063 798.725,594.7266 Q799.6156,595.5469 801.2094,595.5469 Q802.1469,595.5469 802.8031,595.2969 Q803.1938,595.1406 803.6156,594.7031 Q803.8813,594.4375 804.0297,594.3594 Q804.1781,594.2813 804.3813,594.2813 Q804.7094,594.2813 804.9672,594.5391 Q805.225,594.7969 805.225,595.1406 Q805.225,595.4844 804.8813,595.8906 Q804.3813,596.4688 803.5844,596.7969 Q802.5063,597.25 801.2094,597.25 Q799.6938,597.25 798.4906,596.625 Q797.5063,596.125 796.8188,595.0547 Q796.1313,593.9844 796.1313,592.7031 L796.1313,591.5469 Q796.1313,590.2188 796.7484,589.0703 Q797.3656,587.9219 798.4594,587.3047 Q799.5531,586.6875 800.7875,586.6875 Q801.5219,586.6875 802.1703,586.8516 Q802.8188,587.0156 803.3656,587.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="818.4" y="597.2285">UserLogin</text><line style="stroke:#181818;stroke-width:0.5;" x1="769.5" x2="901.5" y1="607.5" y2="607.5"/><ellipse cx="779.5" cy="621.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="788.5" y="626.0332">Email : string</text><ellipse cx="779.5" cy="639.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="788.5" y="643.6426">Password : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="769.5" x2="901.5" y1="650.7188" y2="650.7188"/></g><!--MD5=[6ac818b5870897fde505b1069c30005c]
class IUserProvider--><g id="elem_IUserProvider"><rect codeLine="94" fill="#F1F1F1" height="171.2656" id="IUserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="397" x="2127" y="309"/><ellipse cx="2278.25" cy="325" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2279.2031,321.6406 L2279.2031,328.2969 L2280.9219,328.2969 Q2281.5313,328.2969 2281.7969,328.5313 Q2282.0625,328.7656 2282.0625,329.1563 Q2282.0625,329.5313 2281.7969,329.7656 Q2281.5313,330 2280.9219,330 L2275.7813,330 Q2275.1719,330 2274.9063,329.7656 Q2274.6406,329.5313 2274.6406,329.1406 Q2274.6406,328.7656 2274.9063,328.5313 Q2275.1719,328.2969 2275.7813,328.2969 L2277.5,328.2969 L2277.5,321.6406 L2275.7813,321.6406 Q2275.1719,321.6406 2274.9063,321.4063 Q2274.6406,321.1719 2274.6406,320.7813 Q2274.6406,320.4063 2274.9063,320.1719 Q2275.1719,319.9375 2275.7813,319.9375 L2280.9219,319.9375 Q2281.5313,319.9375 2281.7969,320.1719 Q2282.0625,320.4063 2282.0625,320.7813 Q2282.0625,321.1719 2281.7969,321.4063 Q2281.5313,321.6406 2280.9219,321.6406 L2279.2031,321.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="2298.75" y="330.7285">IUserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2128" x2="2523" y1="341" y2="341"/><line style="stroke:#181818;stroke-width:0.5;" x1="2128" x2="2523" y1="349" y2="349"/><ellipse cx="2138" cy="363.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356" x="2147" y="367.5332">CreateUserAsync(userCreate : DbUser) : Task&lt;DbUser&gt;</text><ellipse cx="2138" cy="380.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2147" y="385.1426">GetUserByEmailAsync(email : string) : Task&lt;DbUser&gt;</text><ellipse cx="2138" cy="398.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="2147" y="402.752">GetUserByIdAsync(id : int) : Task&lt;DbUser&gt;</text><ellipse cx="2138" cy="416.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="2147" y="420.3613">UpdateUserFailedTries(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2138" cy="433.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="2147" y="437.9707">UpdateUserLoginSuccess(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2138" cy="451.3516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="371" x="2147" y="455.5801">UpdateUserLoginNewLocation(userId : int) : Task&lt;DbUser&gt;</text><ellipse cx="2138" cy="468.9609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="298" x="2147" y="473.1895">UpdateUserToVerifiedAsync(userID : int) : Task</text></g><!--MD5=[e3292821846300d7b478166358ada8cf]
class ILeakedPasswordProvider--><g id="elem_ILeakedPasswordProvider"><rect codeLine="104" fill="#F1F1F1" height="65.6094" id="ILeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="408" x="3134.5" y="361.5"/><ellipse cx="3251.75" cy="377.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3252.7031,374.1406 L3252.7031,380.7969 L3254.4219,380.7969 Q3255.0313,380.7969 3255.2969,381.0313 Q3255.5625,381.2656 3255.5625,381.6563 Q3255.5625,382.0313 3255.2969,382.2656 Q3255.0313,382.5 3254.4219,382.5 L3249.2813,382.5 Q3248.6719,382.5 3248.4063,382.2656 Q3248.1406,382.0313 3248.1406,381.6406 Q3248.1406,381.2656 3248.4063,381.0313 Q3248.6719,380.7969 3249.2813,380.7969 L3251,380.7969 L3251,374.1406 L3249.2813,374.1406 Q3248.6719,374.1406 3248.4063,373.9063 Q3248.1406,373.6719 3248.1406,373.2813 Q3248.1406,372.9063 3248.4063,372.6719 Q3248.6719,372.4375 3249.2813,372.4375 L3254.4219,372.4375 Q3255.0313,372.4375 3255.2969,372.6719 Q3255.5625,372.9063 3255.5625,373.2813 Q3255.5625,373.6719 3255.2969,373.9063 Q3255.0313,374.1406 3254.4219,374.1406 L3252.7031,374.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="165" x="3272.25" y="383.2285">ILeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3135.5" x2="3541.5" y1="393.5" y2="393.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="3135.5" x2="3541.5" y1="401.5" y2="401.5"/><ellipse cx="3145.5" cy="415.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="382" x="3154.5" y="420.0332">GetIsPasswordLeakedAsync(password : string) : Task&lt;bool&gt;</text></g><!--MD5=[93e51899d99a79ff80efffde6dbc2b8d]
class IMessageService--><g id="elem_IMessageService"><rect fill="#F1F1F1" height="48" id="IMessageService" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="1377" y="370.5"/><ellipse cx="1392" cy="386.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1394.7656,382.375 Q1394.9219,382.1563 1395.1094,382.0469 Q1395.2969,381.9375 1395.5156,381.9375 Q1395.8906,381.9375 1396.125,382.1953 Q1396.3594,382.4531 1396.3594,383.0625 L1396.3594,384.5156 Q1396.3594,385.125 1396.125,385.3906 Q1395.8906,385.6563 1395.5156,385.6563 Q1395.1719,385.6563 1394.9688,385.4531 Q1394.7656,385.2656 1394.6563,384.75 Q1394.6094,384.3906 1394.4219,384.2031 Q1394.0938,383.8281 1393.4844,383.6094 Q1392.875,383.3906 1392.25,383.3906 Q1391.4844,383.3906 1390.8516,383.7188 Q1390.2188,384.0469 1389.7266,384.7969 Q1389.2344,385.5469 1389.2344,386.5781 L1389.2344,387.6719 Q1389.2344,388.9063 1390.125,389.7266 Q1391.0156,390.5469 1392.6094,390.5469 Q1393.5469,390.5469 1394.2031,390.2969 Q1394.5938,390.1406 1395.0156,389.7031 Q1395.2813,389.4375 1395.4297,389.3594 Q1395.5781,389.2813 1395.7813,389.2813 Q1396.1094,389.2813 1396.3672,389.5391 Q1396.625,389.7969 1396.625,390.1406 Q1396.625,390.4844 1396.2813,390.8906 Q1395.7813,391.4688 1394.9844,391.7969 Q1393.9063,392.25 1392.6094,392.25 Q1391.0938,392.25 1389.8906,391.625 Q1388.9063,391.125 1388.2188,390.0547 Q1387.5313,388.9844 1387.5313,387.7031 L1387.5313,386.5469 Q1387.5313,385.2188 1388.1484,384.0703 Q1388.7656,382.9219 1389.8594,382.3047 Q1390.9531,381.6875 1392.1875,381.6875 Q1392.9219,381.6875 1393.5703,381.8516 Q1394.2188,382.0156 1394.7656,382.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1406" y="392.2285">IMessageService</text><line style="stroke:#181818;stroke-width:0.5;" x1="1378" x2="1515" y1="402.5" y2="402.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1378" x2="1515" y1="410.5" y2="410.5"/></g><!--MD5=[5009355033d421c5ef52ff093b464101]
class IMessageProvider--><g id="elem_IMessageProvider"><rect fill="#F1F1F1" height="48" id="IMessageProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145" x="1197" y="370.5"/><ellipse cx="1212" cy="386.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1214.7656,382.375 Q1214.9219,382.1563 1215.1094,382.0469 Q1215.2969,381.9375 1215.5156,381.9375 Q1215.8906,381.9375 1216.125,382.1953 Q1216.3594,382.4531 1216.3594,383.0625 L1216.3594,384.5156 Q1216.3594,385.125 1216.125,385.3906 Q1215.8906,385.6563 1215.5156,385.6563 Q1215.1719,385.6563 1214.9688,385.4531 Q1214.7656,385.2656 1214.6563,384.75 Q1214.6094,384.3906 1214.4219,384.2031 Q1214.0938,383.8281 1213.4844,383.6094 Q1212.875,383.3906 1212.25,383.3906 Q1211.4844,383.3906 1210.8516,383.7188 Q1210.2188,384.0469 1209.7266,384.7969 Q1209.2344,385.5469 1209.2344,386.5781 L1209.2344,387.6719 Q1209.2344,388.9063 1210.125,389.7266 Q1211.0156,390.5469 1212.6094,390.5469 Q1213.5469,390.5469 1214.2031,390.2969 Q1214.5938,390.1406 1215.0156,389.7031 Q1215.2813,389.4375 1215.4297,389.3594 Q1215.5781,389.2813 1215.7813,389.2813 Q1216.1094,389.2813 1216.3672,389.5391 Q1216.625,389.7969 1216.625,390.1406 Q1216.625,390.4844 1216.2813,390.8906 Q1215.7813,391.4688 1214.9844,391.7969 Q1213.9063,392.25 1212.6094,392.25 Q1211.0938,392.25 1209.8906,391.625 Q1208.9063,391.125 1208.2188,390.0547 Q1207.5313,388.9844 1207.5313,387.7031 L1207.5313,386.5469 Q1207.5313,385.2188 1208.1484,384.0703 Q1208.7656,382.9219 1209.8594,382.3047 Q1210.9531,381.6875 1212.1875,381.6875 Q1212.9219,381.6875 1213.5703,381.8516 Q1214.2188,382.0156 1214.7656,382.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="1226" y="392.2285">IMessageProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1198" x2="1341" y1="402.5" y2="402.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1198" x2="1341" y1="410.5" y2="410.5"/></g><!--MD5=[88f66da615ead437be96f70edff3214c]
class UserToken--><g id="elem_UserToken"><rect codeLine="170" fill="#F1F1F1" height="100.8281" id="UserToken" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="226" y="566.5"/><ellipse cx="246.4" cy="582.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M249.1656,578.375 Q249.3219,578.1563 249.5094,578.0469 Q249.6969,577.9375 249.9156,577.9375 Q250.2906,577.9375 250.525,578.1953 Q250.7594,578.4531 250.7594,579.0625 L250.7594,580.5156 Q250.7594,581.125 250.525,581.3906 Q250.2906,581.6563 249.9156,581.6563 Q249.5719,581.6563 249.3688,581.4531 Q249.1656,581.2656 249.0563,580.75 Q249.0094,580.3906 248.8219,580.2031 Q248.4938,579.8281 247.8844,579.6094 Q247.275,579.3906 246.65,579.3906 Q245.8844,579.3906 245.2516,579.7188 Q244.6188,580.0469 244.1266,580.7969 Q243.6344,581.5469 243.6344,582.5781 L243.6344,583.6719 Q243.6344,584.9063 244.525,585.7266 Q245.4156,586.5469 247.0094,586.5469 Q247.9469,586.5469 248.6031,586.2969 Q248.9938,586.1406 249.4156,585.7031 Q249.6813,585.4375 249.8297,585.3594 Q249.9781,585.2813 250.1813,585.2813 Q250.5094,585.2813 250.7672,585.5391 Q251.025,585.7969 251.025,586.1406 Q251.025,586.4844 250.6813,586.8906 Q250.1813,587.4688 249.3844,587.7969 Q248.3063,588.25 247.0094,588.25 Q245.4938,588.25 244.2906,587.625 Q243.3063,587.125 242.6188,586.0547 Q241.9313,584.9844 241.9313,583.7031 L241.9313,582.5469 Q241.9313,581.2188 242.5484,580.0703 Q243.1656,578.9219 244.2594,578.3047 Q245.3531,577.6875 246.5875,577.6875 Q247.3219,577.6875 247.9703,577.8516 Q248.6188,578.0156 249.1656,578.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="261.6" y="588.2285">UserToken</text><line style="stroke:#181818;stroke-width:0.5;" x1="227" x2="338" y1="598.5" y2="598.5"/><ellipse cx="237" cy="612.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="246" y="617.0332">UserID : int</text><ellipse cx="237" cy="630.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="246" y="634.6426">Email : string</text><ellipse cx="237" cy="648.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="246" y="652.252">Token : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="227" x2="338" y1="659.3281" y2="659.3281"/></g><!--MD5=[3a13148eff96962085f13babcc0d4f9f]
class IUserLocationProvider--><g id="elem_IUserLocationProvider"><rect codeLine="120" fill="#F1F1F1" height="100.8281" id="IUserLocationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="540" x="2559.5" y="344"/><ellipse cx="2755.25" cy="360" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2756.2031,356.6406 L2756.2031,363.2969 L2757.9219,363.2969 Q2758.5313,363.2969 2758.7969,363.5313 Q2759.0625,363.7656 2759.0625,364.1563 Q2759.0625,364.5313 2758.7969,364.7656 Q2758.5313,365 2757.9219,365 L2752.7813,365 Q2752.1719,365 2751.9063,364.7656 Q2751.6406,364.5313 2751.6406,364.1406 Q2751.6406,363.7656 2751.9063,363.5313 Q2752.1719,363.2969 2752.7813,363.2969 L2754.5,363.2969 L2754.5,356.6406 L2752.7813,356.6406 Q2752.1719,356.6406 2751.9063,356.4063 Q2751.6406,356.1719 2751.6406,355.7813 Q2751.6406,355.4063 2751.9063,355.1719 Q2752.1719,354.9375 2752.7813,354.9375 L2757.9219,354.9375 Q2758.5313,354.9375 2758.7969,355.1719 Q2759.0625,355.4063 2759.0625,355.7813 Q2759.0625,356.1719 2758.7969,356.4063 Q2758.5313,356.6406 2757.9219,356.6406 L2756.2031,356.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="2775.75" y="365.7285">IUserLocationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2560.5" x2="3098.5" y1="376" y2="376"/><line style="stroke:#181818;stroke-width:0.5;" x1="2560.5" x2="3098.5" y1="384" y2="384"/><ellipse cx="2570.5" cy="398.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="2579.5" y="402.5332">IsIPLockedAsync(ip : string) : Task&lt;bool&gt;</text><ellipse cx="2570.5" cy="415.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441" x="2579.5" y="420.1426">LogLocationAsync(userLocation: UserLocation) : Task&lt;UserLocation&gt;</text><ellipse cx="2570.5" cy="433.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="514" x="2579.5" y="437.752">UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task&lt;bool&gt;</text></g><!--MD5=[3a675687b1cd1bb713529f5053553131]
class SqlProvider--><g id="elem_SqlProvider"><rect codeLine="108" fill="#F1F1F1" height="100.8281" id="SqlProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="700" x="3577.5" y="344"/><ellipse cx="3886.75" cy="360" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3889.5156,355.875 Q3889.6719,355.6563 3889.8594,355.5469 Q3890.0469,355.4375 3890.2656,355.4375 Q3890.6406,355.4375 3890.875,355.6953 Q3891.1094,355.9531 3891.1094,356.5625 L3891.1094,358.0156 Q3891.1094,358.625 3890.875,358.8906 Q3890.6406,359.1563 3890.2656,359.1563 Q3889.9219,359.1563 3889.7188,358.9531 Q3889.5156,358.7656 3889.4063,358.25 Q3889.3594,357.8906 3889.1719,357.7031 Q3888.8438,357.3281 3888.2344,357.1094 Q3887.625,356.8906 3887,356.8906 Q3886.2344,356.8906 3885.6016,357.2188 Q3884.9688,357.5469 3884.4766,358.2969 Q3883.9844,359.0469 3883.9844,360.0781 L3883.9844,361.1719 Q3883.9844,362.4063 3884.875,363.2266 Q3885.7656,364.0469 3887.3594,364.0469 Q3888.2969,364.0469 3888.9531,363.7969 Q3889.3438,363.6406 3889.7656,363.2031 Q3890.0313,362.9375 3890.1797,362.8594 Q3890.3281,362.7813 3890.5313,362.7813 Q3890.8594,362.7813 3891.1172,363.0391 Q3891.375,363.2969 3891.375,363.6406 Q3891.375,363.9844 3891.0313,364.3906 Q3890.5313,364.9688 3889.7344,365.2969 Q3888.6563,365.75 3887.3594,365.75 Q3885.8438,365.75 3884.6406,365.125 Q3883.6563,364.625 3882.9688,363.5547 Q3882.2813,362.4844 3882.2813,361.2031 L3882.2813,360.0469 Q3882.2813,358.7188 3882.8984,357.5703 Q3883.5156,356.4219 3884.6094,355.8047 Q3885.7031,355.1875 3886.9375,355.1875 Q3887.6719,355.1875 3888.3203,355.3516 Q3888.9688,355.5156 3889.5156,355.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="3907.25" y="365.7285">SqlProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3578.5" x2="4276.5" y1="376" y2="376"/><line style="stroke:#181818;stroke-width:1.0;" x1="3578.5" x2="4276.5" y1="384" y2="384"/><ellipse cx="3588.5" cy="398.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="3597.5" y="402.5332">SqlProvider(connection : string)</text><polygon fill="#FFFF44" points="3588.5,410.9141,3592.5,414.9141,3588.5,418.9141,3584.5,414.9141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="674" x="3597.5" y="420.1426">RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task&lt;DataTable&gt;</text><polygon fill="#FFFF44" points="3588.5,428.5234,3592.5,432.5234,3588.5,436.5234,3584.5,432.5234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="322" x="3597.5" y="437.752">RunQueryAsync(query : string) : Task&lt;DataTable&gt;</text></g><!--MD5=[54606654dd7012b88529a0f0305a5f2d]
class LeakedPasswordProvider--><g id="elem_LeakedPasswordProvider"><rect codeLine="115" fill="#F1F1F1" height="65.6094" id="LeakedPasswordProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="379" x="3246" y="95"/><ellipse cx="3350.75" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3353.5156,106.875 Q3353.6719,106.6563 3353.8594,106.5469 Q3354.0469,106.4375 3354.2656,106.4375 Q3354.6406,106.4375 3354.875,106.6953 Q3355.1094,106.9531 3355.1094,107.5625 L3355.1094,109.0156 Q3355.1094,109.625 3354.875,109.8906 Q3354.6406,110.1563 3354.2656,110.1563 Q3353.9219,110.1563 3353.7188,109.9531 Q3353.5156,109.7656 3353.4063,109.25 Q3353.3594,108.8906 3353.1719,108.7031 Q3352.8438,108.3281 3352.2344,108.1094 Q3351.625,107.8906 3351,107.8906 Q3350.2344,107.8906 3349.6016,108.2188 Q3348.9688,108.5469 3348.4766,109.2969 Q3347.9844,110.0469 3347.9844,111.0781 L3347.9844,112.1719 Q3347.9844,113.4063 3348.875,114.2266 Q3349.7656,115.0469 3351.3594,115.0469 Q3352.2969,115.0469 3352.9531,114.7969 Q3353.3438,114.6406 3353.7656,114.2031 Q3354.0313,113.9375 3354.1797,113.8594 Q3354.3281,113.7813 3354.5313,113.7813 Q3354.8594,113.7813 3355.1172,114.0391 Q3355.375,114.2969 3355.375,114.6406 Q3355.375,114.9844 3355.0313,115.3906 Q3354.5313,115.9688 3353.7344,116.2969 Q3352.6563,116.75 3351.3594,116.75 Q3349.8438,116.75 3348.6406,116.125 Q3347.6563,115.625 3346.9688,114.5547 Q3346.2813,113.4844 3346.2813,112.2031 L3346.2813,111.0469 Q3346.2813,109.7188 3346.8984,108.5703 Q3347.5156,107.4219 3348.6094,106.8047 Q3349.7031,106.1875 3350.9375,106.1875 Q3351.6719,106.1875 3352.3203,106.3516 Q3352.9688,106.5156 3353.5156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="3371.25" y="116.7285">LeakedPasswordProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="3247" x2="3624" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="3247" x2="3624" y1="135" y2="135"/><ellipse cx="3257" cy="149.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3266" y="153.5332">LeakedPasswordProvider(configuration : IConfiguration)</text></g><!--MD5=[615787437c5f23b61c90c6d240d4b67f]
class UserProvider--><g id="elem_UserProvider"><rect codeLine="126" fill="#F1F1F1" height="83.2188" id="UserProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="2883.5" y="86.5"/><ellipse cx="2988.25" cy="102.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2991.0156,98.375 Q2991.1719,98.1563 2991.3594,98.0469 Q2991.5469,97.9375 2991.7656,97.9375 Q2992.1406,97.9375 2992.375,98.1953 Q2992.6094,98.4531 2992.6094,99.0625 L2992.6094,100.5156 Q2992.6094,101.125 2992.375,101.3906 Q2992.1406,101.6563 2991.7656,101.6563 Q2991.4219,101.6563 2991.2188,101.4531 Q2991.0156,101.2656 2990.9063,100.75 Q2990.8594,100.3906 2990.6719,100.2031 Q2990.3438,99.8281 2989.7344,99.6094 Q2989.125,99.3906 2988.5,99.3906 Q2987.7344,99.3906 2987.1016,99.7188 Q2986.4688,100.0469 2985.9766,100.7969 Q2985.4844,101.5469 2985.4844,102.5781 L2985.4844,103.6719 Q2985.4844,104.9063 2986.375,105.7266 Q2987.2656,106.5469 2988.8594,106.5469 Q2989.7969,106.5469 2990.4531,106.2969 Q2990.8438,106.1406 2991.2656,105.7031 Q2991.5313,105.4375 2991.6797,105.3594 Q2991.8281,105.2813 2992.0313,105.2813 Q2992.3594,105.2813 2992.6172,105.5391 Q2992.875,105.7969 2992.875,106.1406 Q2992.875,106.4844 2992.5313,106.8906 Q2992.0313,107.4688 2991.2344,107.7969 Q2990.1563,108.25 2988.8594,108.25 Q2987.3438,108.25 2986.1406,107.625 Q2985.1563,107.125 2984.4688,106.0547 Q2983.7813,104.9844 2983.7813,103.7031 L2983.7813,102.5469 Q2983.7813,101.2188 2984.3984,100.0703 Q2985.0156,98.9219 2986.1094,98.3047 Q2987.2031,97.6875 2988.4375,97.6875 Q2989.1719,97.6875 2989.8203,97.8516 Q2990.4688,98.0156 2991.0156,98.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3008.75" y="108.2285">UserProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="2884.5" x2="3182.5" y1="118.5" y2="118.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="2884.5" x2="3182.5" y1="126.5" y2="126.5"/><ellipse cx="2894.5" cy="140.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="274" x="2903.5" y="145.0332">UserProvider(configuration : IConfiguration)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="2891.5" y="155.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217" x="2903.5" y="162.6426">DRToUser(dr : DataRow) : DbUser</text></g><!--MD5=[a2d8207c5488f269b0816fb28beca551]
class DbUser--><g id="elem_DbUser"><rect codeLine="184" fill="#F1F1F1" height="136.0469" id="DbUser" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="1628.5" y="549"/><ellipse cx="1705.75" cy="565" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1708.5156,560.875 Q1708.6719,560.6563 1708.8594,560.5469 Q1709.0469,560.4375 1709.2656,560.4375 Q1709.6406,560.4375 1709.875,560.6953 Q1710.1094,560.9531 1710.1094,561.5625 L1710.1094,563.0156 Q1710.1094,563.625 1709.875,563.8906 Q1709.6406,564.1563 1709.2656,564.1563 Q1708.9219,564.1563 1708.7188,563.9531 Q1708.5156,563.7656 1708.4063,563.25 Q1708.3594,562.8906 1708.1719,562.7031 Q1707.8438,562.3281 1707.2344,562.1094 Q1706.625,561.8906 1706,561.8906 Q1705.2344,561.8906 1704.6016,562.2188 Q1703.9688,562.5469 1703.4766,563.2969 Q1702.9844,564.0469 1702.9844,565.0781 L1702.9844,566.1719 Q1702.9844,567.4063 1703.875,568.2266 Q1704.7656,569.0469 1706.3594,569.0469 Q1707.2969,569.0469 1707.9531,568.7969 Q1708.3438,568.6406 1708.7656,568.2031 Q1709.0313,567.9375 1709.1797,567.8594 Q1709.3281,567.7813 1709.5313,567.7813 Q1709.8594,567.7813 1710.1172,568.0391 Q1710.375,568.2969 1710.375,568.6406 Q1710.375,568.9844 1710.0313,569.3906 Q1709.5313,569.9688 1708.7344,570.2969 Q1707.6563,570.75 1706.3594,570.75 Q1704.8438,570.75 1703.6406,570.125 Q1702.6563,569.625 1701.9688,568.5547 Q1701.2813,567.4844 1701.2813,566.2031 L1701.2813,565.0469 Q1701.2813,563.7188 1701.8984,562.5703 Q1702.5156,561.4219 1703.6094,560.8047 Q1704.7031,560.1875 1705.9375,560.1875 Q1706.6719,560.1875 1707.3203,560.3516 Q1707.9688,560.5156 1708.5156,560.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1726.25" y="570.7285">DbUser</text><line style="stroke:#181818;stroke-width:0.5;" x1="1629.5" x2="1837.5" y1="581" y2="581"/><ellipse cx="1639.5" cy="595.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="1648.5" y="599.5332">HashedPassword : string</text><ellipse cx="1639.5" cy="612.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1648.5" y="617.1426">Salt : string</text><ellipse cx="1639.5" cy="630.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1648.5" y="634.752">SecretKey : string</text><ellipse cx="1639.5" cy="648.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1648.5" y="652.3613">Count : long</text><ellipse cx="1639.5" cy="665.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="1648.5" y="669.9707">LastRequestDate : datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1629.5" x2="1837.5" y1="677.0469" y2="677.0469"/></g><!--MD5=[1a3d1e414f70b9a6597f64281cc6a626]
class UserLocation--><g id="elem_UserLocation"><rect codeLine="209" fill="#F1F1F1" height="153.6563" id="UserLocation" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165" x="2747" y="540"/><ellipse cx="2784.5" cy="556" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2787.2656,551.875 Q2787.4219,551.6563 2787.6094,551.5469 Q2787.7969,551.4375 2788.0156,551.4375 Q2788.3906,551.4375 2788.625,551.6953 Q2788.8594,551.9531 2788.8594,552.5625 L2788.8594,554.0156 Q2788.8594,554.625 2788.625,554.8906 Q2788.3906,555.1563 2788.0156,555.1563 Q2787.6719,555.1563 2787.4688,554.9531 Q2787.2656,554.7656 2787.1563,554.25 Q2787.1094,553.8906 2786.9219,553.7031 Q2786.5938,553.3281 2785.9844,553.1094 Q2785.375,552.8906 2784.75,552.8906 Q2783.9844,552.8906 2783.3516,553.2188 Q2782.7188,553.5469 2782.2266,554.2969 Q2781.7344,555.0469 2781.7344,556.0781 L2781.7344,557.1719 Q2781.7344,558.4063 2782.625,559.2266 Q2783.5156,560.0469 2785.1094,560.0469 Q2786.0469,560.0469 2786.7031,559.7969 Q2787.0938,559.6406 2787.5156,559.2031 Q2787.7813,558.9375 2787.9297,558.8594 Q2788.0781,558.7813 2788.2813,558.7813 Q2788.6094,558.7813 2788.8672,559.0391 Q2789.125,559.2969 2789.125,559.6406 Q2789.125,559.9844 2788.7813,560.3906 Q2788.2813,560.9688 2787.4844,561.2969 Q2786.4063,561.75 2785.1094,561.75 Q2783.5938,561.75 2782.3906,561.125 Q2781.4063,560.625 2780.7188,559.5547 Q2780.0313,558.4844 2780.0313,557.2031 L2780.0313,556.0469 Q2780.0313,554.7188 2780.6484,553.5703 Q2781.2656,552.4219 2782.3594,551.8047 Q2783.4531,551.1875 2784.6875,551.1875 Q2785.4219,551.1875 2786.0703,551.3516 Q2786.7188,551.5156 2787.2656,551.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="2803.5" y="561.7285">UserLocation</text><line style="stroke:#181818;stroke-width:0.5;" x1="2748" x2="2911" y1="572" y2="572"/><ellipse cx="2758" cy="586.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="2767" y="590.5332">ID : int</text><ellipse cx="2758" cy="603.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="2767" y="608.1426">UserID : int</text><ellipse cx="2758" cy="621.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="2767" y="625.752">IP : string</text><ellipse cx="2758" cy="639.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="2767" y="643.3613">UserAgent : string</text><ellipse cx="2758" cy="656.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="2767" y="660.9707">Successful : bool</text><ellipse cx="2758" cy="674.3516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2767" y="678.5801">CreateDate : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="2748" x2="2911" y1="685.6563" y2="685.6563"/></g><!--MD5=[c40368751ea5476301fbcdc8cb25eba8]
class Security--><g id="elem_Security"><rect codeLine="147" fill="#F1F1F1" height="136.0469" id="Security" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="480" x="3660.5" y="60"/><ellipse cx="3870.75" cy="76" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3873.5156,71.875 Q3873.6719,71.6563 3873.8594,71.5469 Q3874.0469,71.4375 3874.2656,71.4375 Q3874.6406,71.4375 3874.875,71.6953 Q3875.1094,71.9531 3875.1094,72.5625 L3875.1094,74.0156 Q3875.1094,74.625 3874.875,74.8906 Q3874.6406,75.1563 3874.2656,75.1563 Q3873.9219,75.1563 3873.7188,74.9531 Q3873.5156,74.7656 3873.4063,74.25 Q3873.3594,73.8906 3873.1719,73.7031 Q3872.8438,73.3281 3872.2344,73.1094 Q3871.625,72.8906 3871,72.8906 Q3870.2344,72.8906 3869.6016,73.2188 Q3868.9688,73.5469 3868.4766,74.2969 Q3867.9844,75.0469 3867.9844,76.0781 L3867.9844,77.1719 Q3867.9844,78.4063 3868.875,79.2266 Q3869.7656,80.0469 3871.3594,80.0469 Q3872.2969,80.0469 3872.9531,79.7969 Q3873.3438,79.6406 3873.7656,79.2031 Q3874.0313,78.9375 3874.1797,78.8594 Q3874.3281,78.7813 3874.5313,78.7813 Q3874.8594,78.7813 3875.1172,79.0391 Q3875.375,79.2969 3875.375,79.6406 Q3875.375,79.9844 3875.0313,80.3906 Q3874.5313,80.9688 3873.7344,81.2969 Q3872.6563,81.75 3871.3594,81.75 Q3869.8438,81.75 3868.6406,81.125 Q3867.6563,80.625 3866.9688,79.5547 Q3866.2813,78.4844 3866.2813,77.2031 L3866.2813,76.0469 Q3866.2813,74.7188 3866.8984,73.5703 Q3867.5156,72.4219 3868.6094,71.8047 Q3869.7031,71.1875 3870.9375,71.1875 Q3871.6719,71.1875 3872.3203,71.3516 Q3872.9688,71.5156 3873.5156,71.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="3891.25" y="81.7285">Security</text><line style="stroke:#181818;stroke-width:0.5;" x1="3661.5" x2="4139.5" y1="92" y2="92"/><line style="stroke:#181818;stroke-width:1.0;" x1="3661.5" x2="4139.5" y1="100" y2="100"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="3668.5" y="111.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="312" x="3680.5" y="118.5332">GetEncryptedPassword(password : string) : string</text><ellipse cx="3671.5" cy="131.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="197" x="3680.5" y="136.1426">GetSalt(saltLength : int) : string</text><ellipse cx="3671.5" cy="149.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="454" x="3680.5" y="153.752">GetEncryptedAndSaltedPassword(password : string, salt : string) : string</text><ellipse cx="3671.5" cy="167.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="3680.5" y="171.3613">GetHotp(key : string, counter : long) : string</text><ellipse cx="3671.5" cy="184.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="139" x="3680.5" y="188.9707">GetHmacKey() : string</text></g><!--MD5=[530bdd8d88d30015127c6b1b07c38463]
class RegexHelper--><g id="elem_RegexHelper"><rect codeLine="156" fill="#F1F1F1" height="65.6094" id="RegexHelper" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="388" x="4175.5" y="95"/><ellipse cx="4324.75" cy="111" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4327.5156,106.875 Q4327.6719,106.6563 4327.8594,106.5469 Q4328.0469,106.4375 4328.2656,106.4375 Q4328.6406,106.4375 4328.875,106.6953 Q4329.1094,106.9531 4329.1094,107.5625 L4329.1094,109.0156 Q4329.1094,109.625 4328.875,109.8906 Q4328.6406,110.1563 4328.2656,110.1563 Q4327.9219,110.1563 4327.7188,109.9531 Q4327.5156,109.7656 4327.4063,109.25 Q4327.3594,108.8906 4327.1719,108.7031 Q4326.8438,108.3281 4326.2344,108.1094 Q4325.625,107.8906 4325,107.8906 Q4324.2344,107.8906 4323.6016,108.2188 Q4322.9688,108.5469 4322.4766,109.2969 Q4321.9844,110.0469 4321.9844,111.0781 L4321.9844,112.1719 Q4321.9844,113.4063 4322.875,114.2266 Q4323.7656,115.0469 4325.3594,115.0469 Q4326.2969,115.0469 4326.9531,114.7969 Q4327.3438,114.6406 4327.7656,114.2031 Q4328.0313,113.9375 4328.1797,113.8594 Q4328.3281,113.7813 4328.5313,113.7813 Q4328.8594,113.7813 4329.1172,114.0391 Q4329.375,114.2969 4329.375,114.6406 Q4329.375,114.9844 4329.0313,115.3906 Q4328.5313,115.9688 4327.7344,116.2969 Q4326.6563,116.75 4325.3594,116.75 Q4323.8438,116.75 4322.6406,116.125 Q4321.6563,115.625 4320.9688,114.5547 Q4320.2813,113.4844 4320.2813,112.2031 L4320.2813,111.0469 Q4320.2813,109.7188 4320.8984,108.5703 Q4321.5156,107.4219 4322.6094,106.8047 Q4323.7031,106.1875 4324.9375,106.1875 Q4325.6719,106.1875 4326.3203,106.3516 Q4326.9688,106.5156 4327.5156,106.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="4345.25" y="116.7285">RegexHelper</text><line style="stroke:#181818;stroke-width:0.5;" x1="4176.5" x2="4562.5" y1="127" y2="127"/><line style="stroke:#181818;stroke-width:1.0;" x1="4176.5" x2="4562.5" y1="135" y2="135"/><ellipse cx="4186.5" cy="149.3047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="362" x="4195.5" y="153.5332">TryToGetBrowserWithoutVersion(browser : string) : string</text></g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><g id="elem_User"><rect codeLine="176" fill="#F1F1F1" height="136.0469" id="User" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1575.5" y="754"/><ellipse cx="1640.75" cy="770" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1643.5156,765.875 Q1643.6719,765.6563 1643.8594,765.5469 Q1644.0469,765.4375 1644.2656,765.4375 Q1644.6406,765.4375 1644.875,765.6953 Q1645.1094,765.9531 1645.1094,766.5625 L1645.1094,768.0156 Q1645.1094,768.625 1644.875,768.8906 Q1644.6406,769.1563 1644.2656,769.1563 Q1643.9219,769.1563 1643.7188,768.9531 Q1643.5156,768.7656 1643.4063,768.25 Q1643.3594,767.8906 1643.1719,767.7031 Q1642.8438,767.3281 1642.2344,767.1094 Q1641.625,766.8906 1641,766.8906 Q1640.2344,766.8906 1639.6016,767.2188 Q1638.9688,767.5469 1638.4766,768.2969 Q1637.9844,769.0469 1637.9844,770.0781 L1637.9844,771.1719 Q1637.9844,772.4063 1638.875,773.2266 Q1639.7656,774.0469 1641.3594,774.0469 Q1642.2969,774.0469 1642.9531,773.7969 Q1643.3438,773.6406 1643.7656,773.2031 Q1644.0313,772.9375 1644.1797,772.8594 Q1644.3281,772.7813 1644.5313,772.7813 Q1644.8594,772.7813 1645.1172,773.0391 Q1645.375,773.2969 1645.375,773.6406 Q1645.375,773.9844 1645.0313,774.3906 Q1644.5313,774.9688 1643.7344,775.2969 Q1642.6563,775.75 1641.3594,775.75 Q1639.8438,775.75 1638.6406,775.125 Q1637.6563,774.625 1636.9688,773.5547 Q1636.2813,772.4844 1636.2813,771.2031 L1636.2813,770.0469 Q1636.2813,768.7188 1636.8984,767.5703 Q1637.5156,766.4219 1638.6094,765.8047 Q1639.7031,765.1875 1640.9375,765.1875 Q1641.6719,765.1875 1642.3203,765.3516 Q1642.9688,765.5156 1643.5156,765.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1661.25" y="775.7285">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="1576.5" x2="1742.5" y1="786" y2="786"/><ellipse cx="1586.5" cy="800.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="1595.5" y="804.5332">ID : int</text><ellipse cx="1586.5" cy="817.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1595.5" y="822.1426">IsVerified : bool</text><ellipse cx="1586.5" cy="835.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1595.5" y="839.752">IsLocked : bool</text><ellipse cx="1586.5" cy="853.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1595.5" y="857.3613">FailedTries : int</text><ellipse cx="1586.5" cy="870.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="1595.5" y="874.9707">LockedDate datetime?</text><line style="stroke:#181818;stroke-width:0.5;" x1="1576.5" x2="1742.5" y1="882.0469" y2="882.0469"/></g><!--MD5=[d72258e41e132b68712ed2a953e26009]
class UserBase--><g id="elem_UserBase"><rect codeLine="196" fill="#F1F1F1" height="118.4375" id="UserBase" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="1337" y="950"/><ellipse cx="1383.75" cy="966" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1386.5156,961.875 Q1386.6719,961.6563 1386.8594,961.5469 Q1387.0469,961.4375 1387.2656,961.4375 Q1387.6406,961.4375 1387.875,961.6953 Q1388.1094,961.9531 1388.1094,962.5625 L1388.1094,964.0156 Q1388.1094,964.625 1387.875,964.8906 Q1387.6406,965.1563 1387.2656,965.1563 Q1386.9219,965.1563 1386.7188,964.9531 Q1386.5156,964.7656 1386.4063,964.25 Q1386.3594,963.8906 1386.1719,963.7031 Q1385.8438,963.3281 1385.2344,963.1094 Q1384.625,962.8906 1384,962.8906 Q1383.2344,962.8906 1382.6016,963.2188 Q1381.9688,963.5469 1381.4766,964.2969 Q1380.9844,965.0469 1380.9844,966.0781 L1380.9844,967.1719 Q1380.9844,968.4063 1381.875,969.2266 Q1382.7656,970.0469 1384.3594,970.0469 Q1385.2969,970.0469 1385.9531,969.7969 Q1386.3438,969.6406 1386.7656,969.2031 Q1387.0313,968.9375 1387.1797,968.8594 Q1387.3281,968.7813 1387.5313,968.7813 Q1387.8594,968.7813 1388.1172,969.0391 Q1388.375,969.2969 1388.375,969.6406 Q1388.375,969.9844 1388.0313,970.3906 Q1387.5313,970.9688 1386.7344,971.2969 Q1385.6563,971.75 1384.3594,971.75 Q1382.8438,971.75 1381.6406,971.125 Q1380.6563,970.625 1379.9688,969.5547 Q1379.2813,968.4844 1379.2813,967.2031 L1379.2813,966.0469 Q1379.2813,964.7188 1379.8984,963.5703 Q1380.5156,962.4219 1381.6094,961.8047 Q1382.7031,961.1875 1383.9375,961.1875 Q1384.6719,961.1875 1385.3203,961.3516 Q1385.9688,961.5156 1386.5156,961.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1404.25" y="971.7285">UserBase</text><line style="stroke:#181818;stroke-width:0.5;" x1="1338" x2="1499" y1="982" y2="982"/><ellipse cx="1348" cy="996.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1357" y="1000.5332">Email : string</text><ellipse cx="1348" cy="1013.9141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1357" y="1018.1426">FirstName : string</text><ellipse cx="1348" cy="1031.5234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1357" y="1035.752">LastName : string</text><ellipse cx="1348" cy="1049.1328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="1357" y="1053.3613">PhoneNumber : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="1338" x2="1499" y1="1060.4375" y2="1060.4375"/></g><!--MD5=[1dfc107116a4b0bc1198698a4e609bfa]
reverse link UserController to IUserManager--><g id="link_UserController_IUserManager"><path codeLine="20" d="M835.5,236.01 C835.5,266.48 835.5,298.81 835.5,326.2 " fill="none" id="UserController-backto-IUserManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="835.5,222.63,831.5066,228.6344,835.5132,234.63,839.5066,228.6256,835.5,222.63" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[548e9c59867ce01a8de3c5e8efb076c9]
reverse link UserController to ITokenManager--><g id="link_UserController_ITokenManager"><path codeLine="21" d="M627.92,228.28 C545.49,267.71 454.32,311.32 386.35,343.83 " fill="none" id="UserController-backto-ITokenManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="639.75,222.63,632.611,221.6127,628.9262,227.8112,636.0652,228.8285,639.75,222.63" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d4b0c0978a527e7d73578f3b8ff1d639]
link IUserManager to UserCreate--><g id="link_IUserManager_UserCreate"><path codeLine="76" d="M912.87,462.69 C1018.26,554.21 1203.16,714.77 1284.8,785.65 " fill="none" id="IUserManager-to-UserCreate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1288.6,788.96,1284.4416,780.0321,1284.83,785.6756,1279.1865,786.064,1288.6,788.96" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b144519fb167e24c357139cc31a61e5d]
link IUserManager to UserLogin--><g id="link_IUserManager_UserLogin"><path codeLine="77" d="M835.5,462.56 C835.5,497.29 835.5,538.82 835.5,569.91 " fill="none" id="IUserManager-to-UserLogin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="835.5,575.2,839.5,566.2,835.5,570.2,831.5,566.2,835.5,575.2" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5d0d21d87f609d36e9bd211d6cdf12f6]
link UserManager to IUserManager--><g id="link_UserManager_IUserManager"><path codeLine="78" d="M1320.97,249.06 C1238.73,273.53 1154.6,298.56 1079.98,320.76 " fill="none" id="UserManager-to-IUserManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1081.88,327.5,1060.72,326.49,1077.89,314.08,1081.88,327.5" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1231944e95ebfb91f3104517f7260a55]
reverse link UserManager to IUserProvider--><g id="link_UserManager_IUserProvider"><path codeLine="80" d="M2009.43,254.4 C2051.43,272.88 2093.84,291.55 2133.36,308.94 " fill="none" id="UserManager-backto-IUserProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1997.3,249.06,2001.1841,255.1357,2008.2863,253.8871,2004.4022,247.8115,1997.3,249.06" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[536fba823f8263b20c30d29df0fd99b8]
reverse link UserManager to IUserLocationManager--><g id="link_UserManager_IUserLocationManager"><path codeLine="81" d="M1773.19,261.77 C1783.92,291.01 1794.63,320.22 1803.23,343.68 " fill="none" id="UserManager-backto-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1768.6,249.25,1766.9136,256.2611,1772.7369,260.5144,1774.4232,253.5032,1768.6,249.25" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[acaf6dcafaeef567235e025343905109]
reverse link UserManager to ILeakedPasswordProvider--><g id="link_UserManager_ILeakedPasswordProvider"><path codeLine="82" d="M2206.55,231.61 C2244.33,238.05 2281.98,243.96 2318.5,249 C2671.27,297.69 2769.98,231.26 3117.5,309 C3170.21,320.79 3227.08,342.77 3269.93,361.35 " fill="none" id="UserManager-backto-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2193.73,229.4,2198.9667,234.3576,2205.557,231.4305,2200.3203,226.4729,2193.73,229.4" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[bb0f9a6a29584614f488e3bb56770cd7]
reverse link UserManager to IMessageService--><g id="link_UserManager_IMessageService"><path codeLine="83" d="M1586.66,258.43 C1568.74,275.4 1550.65,292.59 1533.5,309 C1511.9,329.67 1487.49,353.41 1470.04,370.45 " fill="none" id="UserManager-backto-IMessageService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1596.59,249.04,1589.4831,250.2615,1587.8772,257.2915,1594.9841,256.07,1596.59,249.04" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[384f0fd38da128e29f09444463ca6de7]
reverse link UserManager to IMessageProvider--><g id="link_UserManager_IMessageProvider"><path codeLine="84" d="M1446.03,255.45 C1416.09,272.22 1386.66,290.18 1359.5,309 C1333.6,326.95 1307.77,352.14 1290.47,370.35 " fill="none" id="UserManager-backto-IMessageProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1457.53,249.08,1450.3432,248.4888,1447.0333,254.8954,1454.2201,255.4866,1457.53,249.08" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4b9cc5a9edb981f7418b8fcf7de3067]
link TokenManager to ITokenManager--><g id="link_TokenManager_ITokenManager"><path codeLine="86" d="M274.89,169.75 C276.28,210.7 278.46,274.62 280.12,323.67 " fill="none" id="TokenManager-to-ITokenManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="287.12,323.45,280.8,343.68,273.13,323.93,287.12,323.45" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8f9038f41d1a9fcfa0da510f3a7dcbcc]
reverse link ITokenManager to UserToken--><g id="link_ITokenManager_UserToken"><path codeLine="87" d="M282.5,458.46 C282.5,492.72 282.5,534.5 282.5,566.42 " fill="none" id="ITokenManager-backto-UserToken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="282.5,445.26,278.5,451.26,282.5,457.26,286.5,451.26,282.5,445.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7358745a089081073f5a601608e5a73]
link UserLocationManager to IUserLocationManager--><g id="link_UserLocationManager_IUserLocationManager"><path codeLine="90" d="M2451.29,169.6 C2325.21,214.43 2121.4,286.88 1979.92,337.18 " fill="none" id="UserLocationManager-to-IUserLocationManager" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="1982.01,343.86,1960.82,343.97,1977.32,330.67,1982.01,343.86" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0a4ead1edd2c2b1fdc9bf52f1c627135]
reverse link UserLocationManager to IUserLocationProvider--><g id="link_UserLocationManager_IUserLocationProvider"><path codeLine="91" d="M2615.56,179.16 C2662.66,226.34 2732.78,296.6 2779.77,343.68 " fill="none" id="UserLocationManager-backto-IUserLocationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2606.17,169.75,2607.5677,176.8243,2614.6355,178.255,2613.2378,171.1807,2606.17,169.75" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebed19925dbee498eddafde4c2e5889a]
reverse link IUserProvider to DbUser--><g id="link_IUserProvider_DbUser"><path codeLine="136" d="M2114.49,477.74 C2112.48,478.5 2110.49,479.25 2108.5,480 C2017.75,514.12 1914.1,551.6 1838.81,578.55 " fill="none" id="IUserProvider-backto-DbUser" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2126.9,473.05,2119.8727,471.4322,2115.6766,477.2967,2122.7039,478.9145,2126.9,473.05" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ebfa5078469ba21b5ab21ca793b470a4]
reverse link IUserLocationProvider to UserLocation--><g id="link_IUserLocationProvider_UserLocation"><path codeLine="137" d="M2829.5,458.45 C2829.5,483.73 2829.5,513.1 2829.5,539.58 " fill="none" id="IUserLocationProvider-backto-UserLocation" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2829.5,445.26,2825.5,451.26,2829.5,457.26,2833.5,451.26,2829.5,445.26" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1d941831239f3bd1b1ef4931734ff75b]
link LeakedPasswordProvider to ILeakedPasswordProvider--><g id="link_LeakedPasswordProvider_ILeakedPasswordProvider"><path codeLine="139" d="M3423.7,161.17 C3407.18,206.22 3376.98,288.57 3357.33,342.15 " fill="none" id="LeakedPasswordProvider-to-ILeakedPasswordProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="3363.82,344.78,3350.37,361.14,3350.68,339.95,3363.82,344.78" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d5b7a4ae7f7e8e823301b74032a4bc45]
link LeakedPasswordProvider to SqlProvider--><g id="link_LeakedPasswordProvider_SqlProvider"><path codeLine="140" d="M3489.37,161.12 C3531.1,185.75 3590.55,220.28 3643.5,249 C3697.32,278.19 3757.69,309.15 3808.88,334.89 " fill="none" id="LeakedPasswordProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3812.2,328.73,3826.94,343.95,3805.93,341.24,3812.2,328.73" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2afc5d4273870e4232a4e992ffb1f14d]
link UserProvider to IUserProvider--><g id="link_UserProvider_IUserProvider"><path codeLine="142" d="M2970.01,169.68 C2927.01,195.64 2868.12,228.21 2812.5,249 C2702.7,290.04 2663.44,274.84 2543.79,308.68 " fill="none" id="UserProvider-to-IUserProvider" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="2545.46,315.48,2524.29,314.42,2541.5,302.05,2545.46,315.48" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[49c1666b2e1039e78c6958b57888cb0d]
link UserProvider to SqlProvider--><g id="link_UserProvider_SqlProvider"><path codeLine="143" d="M3087.35,169.78 C3124.98,196.31 3177.45,229.48 3228.5,249 C3368.56,302.55 3413.62,278.84 3560.5,309 C3605.89,318.32 3654.28,328.96 3700.53,339.47 " fill="none" id="UserProvider-to-SqlProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="3702.26,332.68,3720.2,343.96,3699.14,346.33,3702.26,332.68" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e2cd1f126b2a0e0fb6dd8bdb0da396b]
link User to UserBase--><g id="link_User_UserBase"><path codeLine="163" d="M1575.21,887.7 C1554.23,903.81 1531.63,921.16 1510.3,937.53 " fill="none" id="User-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1514.42,943.2,1494.29,949.82,1505.89,932.09,1514.42,943.2" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[96a28894da16093fd8a9c441876c8015]
link UserCreate to UserBase--><g id="link_UserCreate_UserBase"><path codeLine="164" d="M1341.7,855.22 C1352.31,876.34 1366.66,904.87 1380.07,931.56 " fill="none" id="UserCreate-to-UserBase" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1386.43,928.62,1389.16,949.63,1373.92,934.91,1386.43,928.62" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[64c091ef33e37a15c4a5aacf767b2a5f]
link DbUser to User--><g id="link_DbUser_User"><path codeLine="166" d="M1709.06,685.03 C1703.25,700.97 1696.97,718.2 1690.9,734.86 " fill="none" id="DbUser-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1697.46,737.3,1684.04,753.69,1684.31,732.5,1697.46,737.3" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4ad1332077a4628ae5dd9994b73dc8fd]
@startuml API class diagram

top to bottom direction

'Controllers'

class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +VerifyUserRegister(UserLogin : UserLogin) : Task<ActionResult>
}

'Controllers mappings' 

UserController o- - IUserManager
UserController o- - ITokenManager

'Managers'

Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger<UserManager>
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
        messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
    -IsUserNotVerified(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLocked(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}


'Managers mappings'

IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider
UserManager o- - IMessageService
UserManager o- - IMessageProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider
'Providers'

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}



'Providers mappings'

IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider

'Utility'

class Security{
    - -
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}

'Users mappings'

User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User

'User models' 

class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

@startuml API class diagram

top to bottom direction


class UserController{
    -_userManager{readonly} : IUserManager
    -_tokenManager : ITokenManager
    - -
    +UserController(userManager : IUserManager, tokenManager : ITokenManager)
    +Create(userCreate : UserCreate) : Task<ActionResult<UserToken>>
    +Login(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +GetUserFromToken() : Task<ActionResult<User>>
    +VerificationLogin(userLogin : UserLogin) : Task<ActionResult<UserToken>>
    +VerifyUserRegister(UserLogin : UserLogin) : Task<ActionResult>
}


UserController o- - IUserManager
UserController o- - ITokenManager


Interface IUserManager {
    +CreateUserAsync(userCreate : UserCreate) : Task<bool>
    +LoginAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +GetUserByIDAsync(id : int) : Task<User>
    +LoginWithVerificationCodeAsync(userLogin : UserLogin, userLocation : UserLocation) : Task<User>
    +VerifyUserRegistrationAsync(userLogin : UserLogin, userLocation: UserLocation) : Task<bool>
}

interface ITokenManager {
    +GenerateUserToken(user : User) : UserToken
    +ValidateToken(token : string) : bool
    +GetUserTokenFromToken(token : string) : UserToken
}


interface IUserLocationManager {
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation : UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class TokenManager {
    - -
    -GetPrincipal(token : string) : ClaimsPrincipal
    -ClaimsIdentityToUserToken(identity : ClaimsPrincipal, token : string) : UserToken
}

class UserManager {
    -_userProvider : IUserProvider
    -_leakedPasswordProvider : ILeakedPasswordProvider;
    -_userLocationManager : IUserLocationManager
    -_messageService : IMessageService
    -_messageProvider : IMessageProvider
    -_logger : ILogger<UserManager>
    - -
    +UserManager(userProvider : IUserProvider, leakedPasswordProvider : ILeakedPasswordProvider, userLocationManager : IUserLocationManager,
        messageService : IMessageService, messageProvider : IMessageProvider, logger : ILogger<UserManager>)
    -CheckPasswordLeakedForUser(password : string) : Task<bool>
    -IsUserNotVerified(userLocation : UserLocation, user : DbUser) : Task
    -IsUserLocked(userLocation : UserLocation, user : DbUser) : Task
}

class UserLocationManager {
    -_userLocationProvider : IUserLocationProvider
    - -
    +UserLocationManager(userLocationProvider : UserLocationProvider)
}



IUserManager - -> UserCreate
IUserManager - -> UserLogin
UserManager .-|> IUserManager

UserManager o- - IUserProvider
UserManager o- - IUserLocationManager
UserManager o- - ILeakedPasswordProvider
UserManager o- - IMessageService
UserManager o- - IMessageProvider

TokenManager .-|> ITokenManager
ITokenManager *- - UserToken


UserLocationManager .-|> IUserLocationManager
UserLocationManager o- - IUserLocationProvider

interface IUserProvider {
    +CreateUserAsync(userCreate : DbUser) : Task<DbUser>
    +GetUserByEmailAsync(email : string) : Task<DbUser>
    +GetUserByIdAsync(id : int) : Task<DbUser>
    +UpdateUserFailedTries(userId : int) : Task<DbUser>
    +UpdateUserLoginSuccess(userId : int) : Task<DbUser>
    +UpdateUserLoginNewLocation(userId : int) : Task<DbUser>
    +UpdateUserToVerifiedAsync(userID : int) : Task
}

interface ILeakedPasswordProvider {
    +GetIsPasswordLeakedAsync(password : string) : Task<bool>
}

class SqlProvider {
    - -
    +SqlProvider(connection : string)
    {abstract}#RunSpAsync(storedProcedureName : string, storedProcedureElements : SpElements[]) : Task<DataTable>
    {abstract}#RunQueryAsync(query : string) : Task<DataTable>
}

class LeakedPasswordProvider {
    - -
    +LeakedPasswordProvider(configuration : IConfiguration)
}

interface IUserLocationProvider{
    +IsIPLockedAsync(ip : string) : Task<bool>
    +LogLocationAsync(userLocation: UserLocation) : Task<UserLocation>
    +UserWasLoggedInFromLocationAsync(userLocation : UserLocation) : Task<bool>
}

class UserProvider {
    - -
    +UserProvider(configuration : IConfiguration)
    -DRToUser(dr : DataRow) : DbUser
}




IUserProvider *- - DbUser
IUserLocationProvider *- - UserLocation  

LeakedPasswordProvider .-|> ILeakedPasswordProvider
LeakedPasswordProvider - -|> SqlProvider

UserProvider .-|> IUserProvider
UserProvider - -|> SqlProvider


class Security{
    - -
    {static}-GetEncryptedPassword(password : string) : string
    {static}+GetSalt(saltLength : int) : string
    {static}+GetEncryptedAndSaltedPassword(password : string, salt : string) : string
    {static}+GetHotp(key : string, counter : long) : string
    {static}+GetHmacKey() : string
}

class RegexHelper{
    - -
    {static}+TryToGetBrowserWithoutVersion(browser : string) : string
}


User - -|> UserBase
UserCreate - -|> UserBase

DbUser - -|> User


class UserToken{
    +UserID : int
    +Email : string
    +Token : string
}

class User{
    +ID : int 
    +IsVerified : bool
    +IsLocked : bool
    +FailedTries : int
    +LockedDate datetime?
}

class DbUser{
    +HashedPassword : string
    +Salt : string
    +SecretKey : string
    +Count : long
    +LastRequestDate : datetime?
}

class UserCreate {
    +Password : string
}

class UserBase{
    +Email : string
    +FirstName : string
    +LastName : string
    +PhoneNumber : string
}


class UserLogin{
    +Email : string
    +Password : string 
}

class UserLocation{
    +ID : int
    +UserID : int
    +IP : string
    +UserAgent : string
    +Successful : bool
    +CreateDate : datetime
}


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>